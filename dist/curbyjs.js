/*! curbyjs version 1.0.0 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.curbyjs=t():e.curbyjs=t()}(this,(function(){return function(){var e={669:function(e,t,r){e.exports=r(609)},448:function(e,t,r){"use strict";var n=r(867),i=r(26),s=r(372),a=r(327),o=r(97),u=r(109),h=r(985),l=r(61);e.exports=function(e){return new Promise((function(t,r){var c=e.data,f=e.headers;n.isFormData(c)&&delete f["Content-Type"];var g=new XMLHttpRequest;if(e.auth){var d=e.auth.username||"",p=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";f.Authorization="Basic "+btoa(d+":"+p)}var m=o(e.baseURL,e.url);if(g.open(e.method.toUpperCase(),a(m,e.params,e.paramsSerializer),!0),g.timeout=e.timeout,g.onreadystatechange=function(){if(g&&4===g.readyState&&(0!==g.status||g.responseURL&&0===g.responseURL.indexOf("file:"))){var n="getAllResponseHeaders"in g?u(g.getAllResponseHeaders()):null,s={data:e.responseType&&"text"!==e.responseType?g.response:g.responseText,status:g.status,statusText:g.statusText,headers:n,config:e,request:g};i(t,r,s),g=null}},g.onabort=function(){g&&(r(l("Request aborted",e,"ECONNABORTED",g)),g=null)},g.onerror=function(){r(l("Network Error",e,null,g)),g=null},g.ontimeout=function(){var t="timeout of "+e.timeout+"ms exceeded";e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),r(l(t,e,"ECONNABORTED",g)),g=null},n.isStandardBrowserEnv()){var y=(e.withCredentials||h(m))&&e.xsrfCookieName?s.read(e.xsrfCookieName):void 0;y&&(f[e.xsrfHeaderName]=y)}if("setRequestHeader"in g&&n.forEach(f,(function(e,t){void 0===c&&"content-type"===t.toLowerCase()?delete f[t]:g.setRequestHeader(t,e)})),n.isUndefined(e.withCredentials)||(g.withCredentials=!!e.withCredentials),e.responseType)try{g.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&g.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&g.upload&&g.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){g&&(g.abort(),r(e),g=null)})),c||(c=null),g.send(c)}))}},609:function(e,t,r){"use strict";var n=r(867),i=r(849),s=r(321),a=r(185);function o(e){var t=new s(e),r=i(s.prototype.request,t);return n.extend(r,s.prototype,t),n.extend(r,t),r}var u=o(r(655));u.Axios=s,u.create=function(e){return o(a(u.defaults,e))},u.Cancel=r(263),u.CancelToken=r(972),u.isCancel=r(502),u.all=function(e){return Promise.all(e)},u.spread=r(713),u.isAxiosError=r(268),e.exports=u,e.exports.default=u},263:function(e){"use strict";function t(e){this.message=e}t.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},t.prototype.__CANCEL__=!0,e.exports=t},972:function(e,t,r){"use strict";var n=r(263);function i(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var r=this;e((function(e){r.reason||(r.reason=new n(e),t(r.reason))}))}i.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},i.source=function(){var e;return{token:new i((function(t){e=t})),cancel:e}},e.exports=i},502:function(e){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},321:function(e,t,r){"use strict";var n=r(867),i=r(327),s=r(782),a=r(572),o=r(185);function u(e){this.defaults=e,this.interceptors={request:new s,response:new s}}u.prototype.request=function(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=o(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=[a,void 0],r=Promise.resolve(e);for(this.interceptors.request.forEach((function(e){t.unshift(e.fulfilled,e.rejected)})),this.interceptors.response.forEach((function(e){t.push(e.fulfilled,e.rejected)}));t.length;)r=r.then(t.shift(),t.shift());return r},u.prototype.getUri=function(e){return e=o(this.defaults,e),i(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},n.forEach(["delete","get","head","options"],(function(e){u.prototype[e]=function(t,r){return this.request(o(r||{},{method:e,url:t,data:(r||{}).data}))}})),n.forEach(["post","put","patch"],(function(e){u.prototype[e]=function(t,r,n){return this.request(o(n||{},{method:e,url:t,data:r}))}})),e.exports=u},782:function(e,t,r){"use strict";var n=r(867);function i(){this.handlers=[]}i.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},i.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},i.prototype.forEach=function(e){n.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=i},97:function(e,t,r){"use strict";var n=r(793),i=r(303);e.exports=function(e,t){return e&&!n(t)?i(e,t):t}},61:function(e,t,r){"use strict";var n=r(481);e.exports=function(e,t,r,i,s){var a=new Error(e);return n(a,t,r,i,s)}},572:function(e,t,r){"use strict";var n=r(867),i=r(527),s=r(502),a=r(655);function o(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return o(e),e.headers=e.headers||{},e.data=i(e.data,e.headers,e.transformRequest),e.headers=n.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),n.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||a.adapter)(e).then((function(t){return o(e),t.data=i(t.data,t.headers,e.transformResponse),t}),(function(t){return s(t)||(o(e),t&&t.response&&(t.response.data=i(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},481:function(e){"use strict";e.exports=function(e,t,r,n,i){return e.config=t,r&&(e.code=r),e.request=n,e.response=i,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}},185:function(e,t,r){"use strict";var n=r(867);e.exports=function(e,t){t=t||{};var r={},i=["url","method","data"],s=["headers","auth","proxy","params"],a=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],o=["validateStatus"];function u(e,t){return n.isPlainObject(e)&&n.isPlainObject(t)?n.merge(e,t):n.isPlainObject(t)?n.merge({},t):n.isArray(t)?t.slice():t}function h(i){n.isUndefined(t[i])?n.isUndefined(e[i])||(r[i]=u(void 0,e[i])):r[i]=u(e[i],t[i])}n.forEach(i,(function(e){n.isUndefined(t[e])||(r[e]=u(void 0,t[e]))})),n.forEach(s,h),n.forEach(a,(function(i){n.isUndefined(t[i])?n.isUndefined(e[i])||(r[i]=u(void 0,e[i])):r[i]=u(void 0,t[i])})),n.forEach(o,(function(n){n in t?r[n]=u(e[n],t[n]):n in e&&(r[n]=u(void 0,e[n]))}));var l=i.concat(s).concat(a).concat(o),c=Object.keys(e).concat(Object.keys(t)).filter((function(e){return-1===l.indexOf(e)}));return n.forEach(c,h),r}},26:function(e,t,r){"use strict";var n=r(61);e.exports=function(e,t,r){var i=r.config.validateStatus;r.status&&i&&!i(r.status)?t(n("Request failed with status code "+r.status,r.config,null,r.request,r)):e(r)}},527:function(e,t,r){"use strict";var n=r(867);e.exports=function(e,t,r){return n.forEach(r,(function(r){e=r(e,t)})),e}},655:function(e,t,r){"use strict";var n=r(867),i=r(16),s={"Content-Type":"application/x-www-form-urlencoded"};function a(e,t){!n.isUndefined(e)&&n.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var o,u={adapter:(("undefined"!=typeof XMLHttpRequest||"undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process))&&(o=r(448)),o),transformRequest:[function(e,t){return i(t,"Accept"),i(t,"Content-Type"),n.isFormData(e)||n.isArrayBuffer(e)||n.isBuffer(e)||n.isStream(e)||n.isFile(e)||n.isBlob(e)?e:n.isArrayBufferView(e)?e.buffer:n.isURLSearchParams(e)?(a(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):n.isObject(e)?(a(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300}};u.headers={common:{Accept:"application/json, text/plain, */*"}},n.forEach(["delete","get","head"],(function(e){u.headers[e]={}})),n.forEach(["post","put","patch"],(function(e){u.headers[e]=n.merge(s)})),e.exports=u},849:function(e){"use strict";e.exports=function(e,t){return function(){for(var r=new Array(arguments.length),n=0;n<r.length;n++)r[n]=arguments[n];return e.apply(t,r)}}},327:function(e,t,r){"use strict";var n=r(867);function i(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,r){if(!t)return e;var s;if(r)s=r(t);else if(n.isURLSearchParams(t))s=t.toString();else{var a=[];n.forEach(t,(function(e,t){null!=e&&(n.isArray(e)?t+="[]":e=[e],n.forEach(e,(function(e){n.isDate(e)?e=e.toISOString():n.isObject(e)&&(e=JSON.stringify(e)),a.push(i(t)+"="+i(e))})))})),s=a.join("&")}if(s){var o=e.indexOf("#");-1!==o&&(e=e.slice(0,o)),e+=(-1===e.indexOf("?")?"?":"&")+s}return e}},303:function(e){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},372:function(e,t,r){"use strict";var n=r(867);e.exports=n.isStandardBrowserEnv()?{write:function(e,t,r,i,s,a){var o=[];o.push(e+"="+encodeURIComponent(t)),n.isNumber(r)&&o.push("expires="+new Date(r).toGMTString()),n.isString(i)&&o.push("path="+i),n.isString(s)&&o.push("domain="+s),!0===a&&o.push("secure"),document.cookie=o.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},793:function(e){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},268:function(e){"use strict";e.exports=function(e){return"object"==typeof e&&!0===e.isAxiosError}},985:function(e,t,r){"use strict";var n=r(867);e.exports=n.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");function i(e){var n=e;return t&&(r.setAttribute("href",n),n=r.href),r.setAttribute("href",n),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:"/"===r.pathname.charAt(0)?r.pathname:"/"+r.pathname}}return e=i(window.location.href),function(t){var r=n.isString(t)?i(t):t;return r.protocol===e.protocol&&r.host===e.host}}():function(){return!0}},16:function(e,t,r){"use strict";var n=r(867);e.exports=function(e,t){n.forEach(e,(function(r,n){n!==t&&n.toUpperCase()===t.toUpperCase()&&(e[t]=r,delete e[n])}))}},109:function(e,t,r){"use strict";var n=r(867),i=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,r,s,a={};return e?(n.forEach(e.split("\n"),(function(e){if(s=e.indexOf(":"),t=n.trim(e.substr(0,s)).toLowerCase(),r=n.trim(e.substr(s+1)),t){if(a[t]&&i.indexOf(t)>=0)return;a[t]="set-cookie"===t?(a[t]?a[t]:[]).concat([r]):a[t]?a[t]+", "+r:r}})),a):a}},713:function(e){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},867:function(e,t,r){"use strict";var n=r(849),i=Object.prototype.toString;function s(e){return"[object Array]"===i.call(e)}function a(e){return void 0===e}function o(e){return null!==e&&"object"==typeof e}function u(e){if("[object Object]"!==i.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function h(e){return"[object Function]"===i.call(e)}function l(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),s(e))for(var r=0,n=e.length;r<n;r++)t.call(null,e[r],r,e);else for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.call(null,e[i],i,e)}e.exports={isArray:s,isArrayBuffer:function(e){return"[object ArrayBuffer]"===i.call(e)},isBuffer:function(e){return null!==e&&!a(e)&&null!==e.constructor&&!a(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:o,isPlainObject:u,isUndefined:a,isDate:function(e){return"[object Date]"===i.call(e)},isFile:function(e){return"[object File]"===i.call(e)},isBlob:function(e){return"[object Blob]"===i.call(e)},isFunction:h,isStream:function(e){return o(e)&&h(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)},forEach:l,merge:function e(){var t={};function r(r,n){u(t[n])&&u(r)?t[n]=e(t[n],r):u(r)?t[n]=e({},r):s(r)?t[n]=r.slice():t[n]=r}for(var n=0,i=arguments.length;n<i;n++)l(arguments[n],r);return t},extend:function(e,t,r){return l(t,(function(t,i){e[i]=r&&"function"==typeof t?n(t,r):t})),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}}},742:function(e,t){"use strict";t.byteLength=function(e){var t=u(e),r=t[0],n=t[1];return 3*(r+n)/4-n},t.toByteArray=function(e){var t,r,s=u(e),a=s[0],o=s[1],h=new i(function(e,t,r){return 3*(t+r)/4-r}(0,a,o)),l=0,c=o>0?a-4:a;for(r=0;r<c;r+=4)t=n[e.charCodeAt(r)]<<18|n[e.charCodeAt(r+1)]<<12|n[e.charCodeAt(r+2)]<<6|n[e.charCodeAt(r+3)],h[l++]=t>>16&255,h[l++]=t>>8&255,h[l++]=255&t;2===o&&(t=n[e.charCodeAt(r)]<<2|n[e.charCodeAt(r+1)]>>4,h[l++]=255&t);1===o&&(t=n[e.charCodeAt(r)]<<10|n[e.charCodeAt(r+1)]<<4|n[e.charCodeAt(r+2)]>>2,h[l++]=t>>8&255,h[l++]=255&t);return h},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,s=[],a=16383,o=0,u=n-i;o<u;o+=a)s.push(h(e,o,o+a>u?u:o+a));1===i?(t=e[n-1],s.push(r[t>>2]+r[t<<4&63]+"==")):2===i&&(t=(e[n-2]<<8)+e[n-1],s.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"="));return s.join("")};for(var r=[],n=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,o=s.length;a<o;++a)r[a]=s[a],n[s.charCodeAt(a)]=a;function u(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function h(e,t,n){for(var i,s,a=[],o=t;o<n;o+=3)i=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),a.push(r[(s=i)>>18&63]+r[s>>12&63]+r[s>>6&63]+r[63&s]);return a.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},797:function(e,t,r){var n;!function(i){var s=function(e,t,r){if(!(e instanceof ArrayBuffer||"undefined"!=typeof Buffer&&e instanceof Buffer))throw new Error("Must specify a valid ArrayBuffer or Buffer.");t=t||0,r=r||e.byteLength||e.length,this._view=new Uint8Array(e.buffer||e,t,r),this.bigEndian=!1};s._scratch=new DataView(new ArrayBuffer(8)),Object.defineProperty(s.prototype,"buffer",{get:function(){return"undefined"!=typeof Buffer?Buffer.from(this._view.buffer):this._view.buffer},enumerable:!0,configurable:!1}),Object.defineProperty(s.prototype,"byteLength",{get:function(){return this._view.length},enumerable:!0,configurable:!1}),s.prototype._setBit=function(e,t){t?this._view[e>>3]|=1<<(7&e):this._view[e>>3]&=~(1<<(7&e))},s.prototype.getBits=function(e,t,r){var n=8*this._view.length-e;if(t>n)throw new Error("Cannot get "+t+" bit(s) from offset "+e+", "+n+" available");for(var i=0,s=0;s<t;){var a=t-s,o=7&e,u=this._view[e>>3],h=Math.min(a,8-o);this.bigEndian?(i<<=h,i|=u>>8-h-o&~(255<<h)):i|=(u>>o&~(255<<h))<<s,e+=h,s+=h}return r?(32!==t&&i&1<<t-1&&(i|=-1^(1<<t)-1),i):i>>>0},s.prototype.setBits=function(e,t,r){var n=8*this._view.length-e;if(r>n)throw new Error("Cannot set "+r+" bit(s) from offset "+e+", "+n+" available");for(var i=0;i<r;){var s,a,o,u=r-i,h=7&e,l=e>>3,c=Math.min(u,8-h);if(this.bigEndian){a=t>>r-i-c&(s=~(-1<<c));var f=8-h-c;o=~(s<<f),this._view[l]=this._view[l]&o|a<<f}else a=t&(s=~(255<<c)),t>>=c,o=~(s<<h),this._view[l]=this._view[l]&o|a<<h;e+=c,i+=c}},s.prototype.getBoolean=function(e){return 0!==this.getBits(e,1,!1)},s.prototype.getInt8=function(e){return this.getBits(e,8,!0)},s.prototype.getUint8=function(e){return this.getBits(e,8,!1)},s.prototype.getInt16=function(e){return this.getBits(e,16,!0)},s.prototype.getUint16=function(e){return this.getBits(e,16,!1)},s.prototype.getInt32=function(e){return this.getBits(e,32,!0)},s.prototype.getUint32=function(e){return this.getBits(e,32,!1)},s.prototype.getFloat32=function(e){return s._scratch.setUint32(0,this.getUint32(e)),s._scratch.getFloat32(0)},s.prototype.getFloat64=function(e){return s._scratch.setUint32(0,this.getUint32(e)),s._scratch.setUint32(4,this.getUint32(e+32)),s._scratch.getFloat64(0)},s.prototype.setBoolean=function(e,t){this.setBits(e,t?1:0,1)},s.prototype.setInt8=s.prototype.setUint8=function(e,t){this.setBits(e,t,8)},s.prototype.setInt16=s.prototype.setUint16=function(e,t){this.setBits(e,t,16)},s.prototype.setInt32=s.prototype.setUint32=function(e,t){this.setBits(e,t,32)},s.prototype.setFloat32=function(e,t){s._scratch.setFloat32(0,t),this.setBits(e,s._scratch.getUint32(0),32)},s.prototype.setFloat64=function(e,t){s._scratch.setFloat64(0,t),this.setBits(e,s._scratch.getUint32(0),32),this.setBits(e+32,s._scratch.getUint32(4),32)},s.prototype.getArrayBuffer=function(e,t){for(var r=new Uint8Array(t),n=0;n<t;n++)r[n]=this.getUint8(e+8*n);return r};var a=function(e,t){return function(){if(this._index+t>this._length)throw new Error("Trying to read past the end of the stream");var r=this._view[e](this._index);return this._index+=t,r}},o=function(e,t){return function(r){this._view[e](this._index,r),this._index+=t}};function u(e,t,r){if(0===t)return"";var n=0,i=[],s=!0,a=!!t;for(t||(t=Math.floor((e._length-e._index)/8));n<t;){var o=e.readUint8();if(0===o&&(s=!1,!a))break;s&&i.push(o),n++}var u=String.fromCharCode.apply(null,i);if(!r)return u;try{return decodeURIComponent(escape(u))}catch(e){return u}}var h=function(e,t,r){var n=e instanceof ArrayBuffer||"undefined"!=typeof Buffer&&e instanceof Buffer;if(!(e instanceof s||n))throw new Error("Must specify a valid BitView, ArrayBuffer or Buffer");this._view=n?new s(e,t,r):e,this._index=0,this._startIndex=0,this._length=8*this._view.byteLength};Object.defineProperty(h.prototype,"index",{get:function(){return this._index-this._startIndex},set:function(e){this._index=e+this._startIndex},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"length",{get:function(){return this._length-this._startIndex},set:function(e){this._length=e+this._startIndex},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"bitsLeft",{get:function(){return this._length-this._index},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"byteIndex",{get:function(){return Math.ceil(this._index/8)},set:function(e){this._index=8*e},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"buffer",{get:function(){return this._view.buffer},enumerable:!0,configurable:!1}),Object.defineProperty(h.prototype,"view",{get:function(){return this._view},enumerable:!0,configurable:!1}),Object.defineProperty(h.prototype,"bigEndian",{get:function(){return this._view.bigEndian},set:function(e){this._view.bigEndian=e},enumerable:!0,configurable:!1}),h.prototype.readBits=function(e,t){var r=this._view.getBits(this._index,e,t);return this._index+=e,r},h.prototype.writeBits=function(e,t){this._view.setBits(this._index,e,t),this._index+=t},h.prototype.readBoolean=a("getBoolean",1),h.prototype.readInt8=a("getInt8",8),h.prototype.readUint8=a("getUint8",8),h.prototype.readInt16=a("getInt16",16),h.prototype.readUint16=a("getUint16",16),h.prototype.readInt32=a("getInt32",32),h.prototype.readUint32=a("getUint32",32),h.prototype.readFloat32=a("getFloat32",32),h.prototype.readFloat64=a("getFloat64",64),h.prototype.writeBoolean=o("setBoolean",1),h.prototype.writeInt8=o("setInt8",8),h.prototype.writeUint8=o("setUint8",8),h.prototype.writeInt16=o("setInt16",16),h.prototype.writeUint16=o("setUint16",16),h.prototype.writeInt32=o("setInt32",32),h.prototype.writeUint32=o("setUint32",32),h.prototype.writeFloat32=o("setFloat32",32),h.prototype.writeFloat64=o("setFloat64",64),h.prototype.readASCIIString=function(e){return function(e,t){return u(e,t,!1)}(this,e)},h.prototype.readUTF8String=function(e){return function(e,t){return u(e,t,!0)}(this,e)},h.prototype.writeASCIIString=function(e,t){!function(e,t,r){for(var n=r||t.length+1,i=0;i<n;i++)e.writeUint8(i<t.length?t.charCodeAt(i):0)}(this,e,t)},h.prototype.writeUTF8String=function(e,t){!function(e,t,r){for(var n=function(e){var t,r,n=[];for(t=0;t<e.length;t++)(r=e.charCodeAt(t))<=127?n.push(r):r<=2047?(n.push(r>>6|192),n.push(63&r|128)):r<=65535?(n.push(r>>12|224),n.push(r>>6&63|128),n.push(63&r|128)):(n.push(r>>18|240),n.push(r>>12&63|128),n.push(r>>6&63|128),n.push(63&r|128));return n}(t),i=r||n.length+1,s=0;s<i;s++)e.writeUint8(s<n.length?n[s]:0)}(this,e,t)},h.prototype.readBitStream=function(e){var t=new h(this._view);return t._startIndex=this._index,t._index=this._index,t.length=e,this._index+=e,t},h.prototype.writeBitStream=function(e,t){var r;for(t||(t=e.bitsLeft);t>0;)r=Math.min(t,32),this.writeBits(e.readBits(r),r),t-=r},h.prototype.readArrayBuffer=function(e){var t=this._view.getArrayBuffer(this._index,e);return this._index+=8*e,t},h.prototype.writeArrayBuffer=function(e,t){this.writeBitStream(new h(e),8*t)},void 0===(n=function(){return{BitView:s,BitStream:h}}.call(t,r,t,e))||(e.exports=n)}()},764:function(e,t,r){"use strict";
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */const n=r(742),i=r(645),s="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=u,t.SlowBuffer=function(e){+e!=e&&(e=0);return u.alloc(+e)},t.INSPECT_MAX_BYTES=50;const a=2147483647;function o(e){if(e>a)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,u.prototype),t}function u(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return c(e)}return h(e,t,r)}function h(e,t,r){if("string"==typeof e)return function(e,t){"string"==typeof t&&""!==t||(t="utf8");if(!u.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const r=0|p(e,t);let n=o(r);const i=n.write(e,t);i!==r&&(n=n.slice(0,i));return n}(e,t);if(ArrayBuffer.isView(e))return function(e){if(z(e,Uint8Array)){const t=new Uint8Array(e);return g(t.buffer,t.byteOffset,t.byteLength)}return f(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(z(e,ArrayBuffer)||e&&z(e.buffer,ArrayBuffer))return g(e,t,r);if("undefined"!=typeof SharedArrayBuffer&&(z(e,SharedArrayBuffer)||e&&z(e.buffer,SharedArrayBuffer)))return g(e,t,r);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return u.from(n,t,r);const i=function(e){if(u.isBuffer(e)){const t=0|d(e.length),r=o(t);return 0===r.length||e.copy(r,0,0,t),r}if(void 0!==e.length)return"number"!=typeof e.length||X(e.length)?o(0):f(e);if("Buffer"===e.type&&Array.isArray(e.data))return f(e.data)}(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return u.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function c(e){return l(e),o(e<0?0:0|d(e))}function f(e){const t=e.length<0?0:0|d(e.length),r=o(t);for(let n=0;n<t;n+=1)r[n]=255&e[n];return r}function g(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');let n;return n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),Object.setPrototypeOf(n,u.prototype),n}function d(e){if(e>=a)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a.toString(16)+" bytes");return 0|e}function p(e,t){if(u.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||z(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;let i=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return $(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return G(e).length;default:if(i)return n?-1:$(e).length;t=(""+t).toLowerCase(),i=!0}}function m(e,t,r){let n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return P(this,t,r);case"utf8":case"utf-8":return k(this,t,r);case"ascii":return I(this,t,r);case"latin1":case"binary":return F(this,t,r);case"base64":return B(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return N(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function y(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function v(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),X(r=+r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=u.from(t,n)),u.isBuffer(t))return 0===t.length?-1:b(e,t,r,n,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):b(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function b(e,t,r,n,i){let s,a=1,o=e.length,u=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;a=2,o/=2,u/=2,r/=2}function h(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i){let n=-1;for(s=r;s<o;s++)if(h(e,s)===h(t,-1===n?0:s-n)){if(-1===n&&(n=s),s-n+1===u)return n*a}else-1!==n&&(s-=s-n),n=-1}else for(r+u>o&&(r=o-u),s=r;s>=0;s--){let r=!0;for(let n=0;n<u;n++)if(h(e,s+n)!==h(t,n)){r=!1;break}if(r)return s}return-1}function w(e,t,r,n){r=Number(r)||0;const i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;const s=t.length;let a;for(n>s/2&&(n=s/2),a=0;a<n;++a){const n=parseInt(t.substr(2*a,2),16);if(X(n))return a;e[r+a]=n}return a}function S(e,t,r,n){return W($(t,e.length-r),e,r,n)}function A(e,t,r,n){return W(function(e){const t=[];for(let r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function x(e,t,r,n){return W(G(t),e,r,n)}function E(e,t,r,n){return W(function(e,t){let r,n,i;const s=[];for(let a=0;a<e.length&&!((t-=2)<0);++a)r=e.charCodeAt(a),n=r>>8,i=r%256,s.push(i),s.push(n);return s}(t,e.length-r),e,r,n)}function B(e,t,r){return 0===t&&r===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,r))}function k(e,t,r){r=Math.min(e.length,r);const n=[];let i=t;for(;i<r;){const t=e[i];let s=null,a=t>239?4:t>223?3:t>191?2:1;if(i+a<=r){let r,n,o,u;switch(a){case 1:t<128&&(s=t);break;case 2:r=e[i+1],128==(192&r)&&(u=(31&t)<<6|63&r,u>127&&(s=u));break;case 3:r=e[i+1],n=e[i+2],128==(192&r)&&128==(192&n)&&(u=(15&t)<<12|(63&r)<<6|63&n,u>2047&&(u<55296||u>57343)&&(s=u));break;case 4:r=e[i+1],n=e[i+2],o=e[i+3],128==(192&r)&&128==(192&n)&&128==(192&o)&&(u=(15&t)<<18|(63&r)<<12|(63&n)<<6|63&o,u>65535&&u<1114112&&(s=u))}}null===s?(s=65533,a=1):s>65535&&(s-=65536,n.push(s>>>10&1023|55296),s=56320|1023&s),n.push(s),i+=a}return function(e){const t=e.length;if(t<=C)return String.fromCharCode.apply(String,e);let r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=C));return r}(n)}t.kMaxLength=a,u.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),u.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.buffer}}),Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.byteOffset}}),u.poolSize=8192,u.from=function(e,t,r){return h(e,t,r)},Object.setPrototypeOf(u.prototype,Uint8Array.prototype),Object.setPrototypeOf(u,Uint8Array),u.alloc=function(e,t,r){return function(e,t,r){return l(e),e<=0?o(e):void 0!==t?"string"==typeof r?o(e).fill(t,r):o(e).fill(t):o(e)}(e,t,r)},u.allocUnsafe=function(e){return c(e)},u.allocUnsafeSlow=function(e){return c(e)},u.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==u.prototype},u.compare=function(e,t){if(z(e,Uint8Array)&&(e=u.from(e,e.offset,e.byteLength)),z(t,Uint8Array)&&(t=u.from(t,t.offset,t.byteLength)),!u.isBuffer(e)||!u.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let r=e.length,n=t.length;for(let i=0,s=Math.min(r,n);i<s;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},u.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return u.alloc(0);let r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;const n=u.allocUnsafe(t);let i=0;for(r=0;r<e.length;++r){let t=e[r];if(z(t,Uint8Array))i+t.length>n.length?(u.isBuffer(t)||(t=u.from(t)),t.copy(n,i)):Uint8Array.prototype.set.call(n,t,i);else{if(!u.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(n,i)}i+=t.length}return n},u.byteLength=p,u.prototype._isBuffer=!0,u.prototype.swap16=function(){const e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)y(this,t,t+1);return this},u.prototype.swap32=function(){const e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)y(this,t,t+3),y(this,t+1,t+2);return this},u.prototype.swap64=function(){const e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)y(this,t,t+7),y(this,t+1,t+6),y(this,t+2,t+5),y(this,t+3,t+4);return this},u.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?k(this,0,e):m.apply(this,arguments)},u.prototype.toLocaleString=u.prototype.toString,u.prototype.equals=function(e){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===u.compare(this,e)},u.prototype.inspect=function(){let e="";const r=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},s&&(u.prototype[s]=u.prototype.inspect),u.prototype.compare=function(e,t,r,n,i){if(z(e,Uint8Array)&&(e=u.from(e,e.offset,e.byteLength)),!u.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(this===e)return 0;let s=(i>>>=0)-(n>>>=0),a=(r>>>=0)-(t>>>=0);const o=Math.min(s,a),h=this.slice(n,i),l=e.slice(t,r);for(let e=0;e<o;++e)if(h[e]!==l[e]){s=h[e],a=l[e];break}return s<a?-1:a<s?1:0},u.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},u.prototype.indexOf=function(e,t,r){return v(this,e,t,r,!0)},u.prototype.lastIndexOf=function(e,t,r){return v(this,e,t,r,!1)},u.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}const i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let s=!1;for(;;)switch(n){case"hex":return w(this,e,t,r);case"utf8":case"utf-8":return S(this,e,t,r);case"ascii":case"latin1":case"binary":return A(this,e,t,r);case"base64":return x(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E(this,e,t,r);default:if(s)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),s=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const C=4096;function I(e,t,r){let n="";r=Math.min(e.length,r);for(let i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function F(e,t,r){let n="";r=Math.min(e.length,r);for(let i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function P(e,t,r){const n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);let i="";for(let n=t;n<r;++n)i+=Q[e[n]];return i}function N(e,t,r){const n=e.slice(t,r);let i="";for(let e=0;e<n.length-1;e+=2)i+=String.fromCharCode(n[e]+256*n[e+1]);return i}function D(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function H(e,t,r,n,i,s){if(!u.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<s)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function R(e,t,r,n,i){K(t,n,i,e,r,7);let s=Number(t&BigInt(4294967295));e[r++]=s,s>>=8,e[r++]=s,s>>=8,e[r++]=s,s>>=8,e[r++]=s;let a=Number(t>>BigInt(32)&BigInt(4294967295));return e[r++]=a,a>>=8,e[r++]=a,a>>=8,e[r++]=a,a>>=8,e[r++]=a,r}function O(e,t,r,n,i){K(t,n,i,e,r,7);let s=Number(t&BigInt(4294967295));e[r+7]=s,s>>=8,e[r+6]=s,s>>=8,e[r+5]=s,s>>=8,e[r+4]=s;let a=Number(t>>BigInt(32)&BigInt(4294967295));return e[r+3]=a,a>>=8,e[r+2]=a,a>>=8,e[r+1]=a,a>>=8,e[r]=a,r+8}function T(e,t,r,n,i,s){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function L(e,t,r,n,s){return t=+t,r>>>=0,s||T(e,0,r,4),i.write(e,t,r,n,23,4),r+4}function j(e,t,r,n,s){return t=+t,r>>>=0,s||T(e,0,r,8),i.write(e,t,r,n,52,8),r+8}u.prototype.slice=function(e,t){const r=this.length;(e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);const n=this.subarray(e,t);return Object.setPrototypeOf(n,u.prototype),n},u.prototype.readUintLE=u.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||D(e,t,this.length);let n=this[e],i=1,s=0;for(;++s<t&&(i*=256);)n+=this[e+s]*i;return n},u.prototype.readUintBE=u.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||D(e,t,this.length);let n=this[e+--t],i=1;for(;t>0&&(i*=256);)n+=this[e+--t]*i;return n},u.prototype.readUint8=u.prototype.readUInt8=function(e,t){return e>>>=0,t||D(e,1,this.length),this[e]},u.prototype.readUint16LE=u.prototype.readUInt16LE=function(e,t){return e>>>=0,t||D(e,2,this.length),this[e]|this[e+1]<<8},u.prototype.readUint16BE=u.prototype.readUInt16BE=function(e,t){return e>>>=0,t||D(e,2,this.length),this[e]<<8|this[e+1]},u.prototype.readUint32LE=u.prototype.readUInt32LE=function(e,t){return e>>>=0,t||D(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},u.prototype.readUint32BE=u.prototype.readUInt32BE=function(e,t){return e>>>=0,t||D(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},u.prototype.readBigUInt64LE=Y((function(e){M(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||q(e,this.length-8);const n=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,i=this[++e]+256*this[++e]+65536*this[++e]+r*2**24;return BigInt(n)+(BigInt(i)<<BigInt(32))})),u.prototype.readBigUInt64BE=Y((function(e){M(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||q(e,this.length-8);const n=t*2**24+65536*this[++e]+256*this[++e]+this[++e],i=this[++e]*2**24+65536*this[++e]+256*this[++e]+r;return(BigInt(n)<<BigInt(32))+BigInt(i)})),u.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||D(e,t,this.length);let n=this[e],i=1,s=0;for(;++s<t&&(i*=256);)n+=this[e+s]*i;return i*=128,n>=i&&(n-=Math.pow(2,8*t)),n},u.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||D(e,t,this.length);let n=t,i=1,s=this[e+--n];for(;n>0&&(i*=256);)s+=this[e+--n]*i;return i*=128,s>=i&&(s-=Math.pow(2,8*t)),s},u.prototype.readInt8=function(e,t){return e>>>=0,t||D(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},u.prototype.readInt16LE=function(e,t){e>>>=0,t||D(e,2,this.length);const r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},u.prototype.readInt16BE=function(e,t){e>>>=0,t||D(e,2,this.length);const r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},u.prototype.readInt32LE=function(e,t){return e>>>=0,t||D(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},u.prototype.readInt32BE=function(e,t){return e>>>=0,t||D(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},u.prototype.readBigInt64LE=Y((function(e){M(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||q(e,this.length-8);const n=this[e+4]+256*this[e+5]+65536*this[e+6]+(r<<24);return(BigInt(n)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)})),u.prototype.readBigInt64BE=Y((function(e){M(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||q(e,this.length-8);const n=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(n)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+r)})),u.prototype.readFloatLE=function(e,t){return e>>>=0,t||D(e,4,this.length),i.read(this,e,!0,23,4)},u.prototype.readFloatBE=function(e,t){return e>>>=0,t||D(e,4,this.length),i.read(this,e,!1,23,4)},u.prototype.readDoubleLE=function(e,t){return e>>>=0,t||D(e,8,this.length),i.read(this,e,!0,52,8)},u.prototype.readDoubleBE=function(e,t){return e>>>=0,t||D(e,8,this.length),i.read(this,e,!1,52,8)},u.prototype.writeUintLE=u.prototype.writeUIntLE=function(e,t,r,n){if(e=+e,t>>>=0,r>>>=0,!n){H(this,e,t,r,Math.pow(2,8*r)-1,0)}let i=1,s=0;for(this[t]=255&e;++s<r&&(i*=256);)this[t+s]=e/i&255;return t+r},u.prototype.writeUintBE=u.prototype.writeUIntBE=function(e,t,r,n){if(e=+e,t>>>=0,r>>>=0,!n){H(this,e,t,r,Math.pow(2,8*r)-1,0)}let i=r-1,s=1;for(this[t+i]=255&e;--i>=0&&(s*=256);)this[t+i]=e/s&255;return t+r},u.prototype.writeUint8=u.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||H(this,e,t,1,255,0),this[t]=255&e,t+1},u.prototype.writeUint16LE=u.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||H(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},u.prototype.writeUint16BE=u.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||H(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},u.prototype.writeUint32LE=u.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||H(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},u.prototype.writeUint32BE=u.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||H(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},u.prototype.writeBigUInt64LE=Y((function(e,t=0){return R(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),u.prototype.writeBigUInt64BE=Y((function(e,t=0){return O(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),u.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*r-1);H(this,e,t,r,n-1,-n)}let i=0,s=1,a=0;for(this[t]=255&e;++i<r&&(s*=256);)e<0&&0===a&&0!==this[t+i-1]&&(a=1),this[t+i]=(e/s>>0)-a&255;return t+r},u.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*r-1);H(this,e,t,r,n-1,-n)}let i=r-1,s=1,a=0;for(this[t+i]=255&e;--i>=0&&(s*=256);)e<0&&0===a&&0!==this[t+i+1]&&(a=1),this[t+i]=(e/s>>0)-a&255;return t+r},u.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||H(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},u.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||H(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},u.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||H(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},u.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||H(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},u.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||H(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},u.prototype.writeBigInt64LE=Y((function(e,t=0){return R(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),u.prototype.writeBigInt64BE=Y((function(e,t=0){return O(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),u.prototype.writeFloatLE=function(e,t,r){return L(this,e,t,!0,r)},u.prototype.writeFloatBE=function(e,t,r){return L(this,e,t,!1,r)},u.prototype.writeDoubleLE=function(e,t,r){return j(this,e,t,!0,r)},u.prototype.writeDoubleBE=function(e,t,r){return j(this,e,t,!1,r)},u.prototype.copy=function(e,t,r,n){if(!u.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);const i=n-r;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,n):Uint8Array.prototype.set.call(e,this.subarray(r,n),t),i},u.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!u.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){const t=e.charCodeAt(0);("utf8"===n&&t<128||"latin1"===n)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;let i;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(i=t;i<r;++i)this[i]=e;else{const s=u.isBuffer(e)?e:u.from(e,n),a=s.length;if(0===a)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<r-t;++i)this[i+t]=s[i%a]}return this};const V={};function U(e,t,r){V[e]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function _(e){let t="",r=e.length;const n="-"===e[0]?1:0;for(;r>=n+4;r-=3)t=`_${e.slice(r-3,r)}${t}`;return`${e.slice(0,r)}${t}`}function K(e,t,r,n,i,s){if(e>r||e<t){const n="bigint"==typeof t?"n":"";let i;throw i=s>3?0===t||t===BigInt(0)?`>= 0${n} and < 2${n} ** ${8*(s+1)}${n}`:`>= -(2${n} ** ${8*(s+1)-1}${n}) and < 2 ** ${8*(s+1)-1}${n}`:`>= ${t}${n} and <= ${r}${n}`,new V.ERR_OUT_OF_RANGE("value",i,e)}!function(e,t,r){M(t,"offset"),void 0!==e[t]&&void 0!==e[t+r]||q(t,e.length-(r+1))}(n,i,s)}function M(e,t){if("number"!=typeof e)throw new V.ERR_INVALID_ARG_TYPE(t,"number",e)}function q(e,t,r){if(Math.floor(e)!==e)throw M(e,r),new V.ERR_OUT_OF_RANGE(r||"offset","an integer",e);if(t<0)throw new V.ERR_BUFFER_OUT_OF_BOUNDS;throw new V.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${t}`,e)}U("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),U("ERR_INVALID_ARG_TYPE",(function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`}),TypeError),U("ERR_OUT_OF_RANGE",(function(e,t,r){let n=`The value of "${e}" is out of range.`,i=r;return Number.isInteger(r)&&Math.abs(r)>2**32?i=_(String(r)):"bigint"==typeof r&&(i=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(i=_(i)),i+="n"),n+=` It must be ${t}. Received ${i}`,n}),RangeError);const J=/[^+/0-9A-Za-z-_]/g;function $(e,t){let r;t=t||1/0;const n=e.length;let i=null;const s=[];for(let a=0;a<n;++a){if(r=e.charCodeAt(a),r>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&s.push(239,191,189);continue}if(a+1===n){(t-=3)>-1&&s.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&s.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&s.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;s.push(r)}else if(r<2048){if((t-=2)<0)break;s.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;s.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return s}function G(e){return n.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(J,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function W(e,t,r,n){let i;for(i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function z(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function X(e){return e!=e}const Q=function(){const e="0123456789abcdef",t=new Array(256);for(let r=0;r<16;++r){const n=16*r;for(let i=0;i<16;++i)t[n+i]=e[r]+e[i]}return t}();function Y(e){return"undefined"==typeof BigInt?Z:e}function Z(){throw new Error("BigInt not supported")}},645:function(e,t){
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
t.read=function(e,t,r,n,i){var s,a,o=8*i-n-1,u=(1<<o)-1,h=u>>1,l=-7,c=r?i-1:0,f=r?-1:1,g=e[t+c];for(c+=f,s=g&(1<<-l)-1,g>>=-l,l+=o;l>0;s=256*s+e[t+c],c+=f,l-=8);for(a=s&(1<<-l)-1,s>>=-l,l+=n;l>0;a=256*a+e[t+c],c+=f,l-=8);if(0===s)s=1-h;else{if(s===u)return a?NaN:1/0*(g?-1:1);a+=Math.pow(2,n),s-=h}return(g?-1:1)*a*Math.pow(2,s-n)},t.write=function(e,t,r,n,i,s){var a,o,u,h=8*s-i-1,l=(1<<h)-1,c=l>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,g=n?0:s-1,d=n?1:-1,p=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,a=l):(a=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-a))<1&&(a--,u*=2),(t+=a+c>=1?f/u:f*Math.pow(2,1-c))*u>=2&&(a++,u/=2),a+c>=l?(o=0,a=l):a+c>=1?(o=(t*u-1)*Math.pow(2,i),a+=c):(o=t*Math.pow(2,c-1)*Math.pow(2,i),a=0));i>=8;e[r+g]=255&o,g+=d,o/=256,i-=8);for(a=a<<i|o,h+=i;h>0;e[r+g]=255&a,g+=d,a/=256,h-=8);e[r+g-d]|=128*p}},166:function(e,t){var r,n,i,s,a,o,u,h,l,c,f,g={userAgent:!1},d={},p=p||(r=Math,i=(n={}).lib={},s=i.Base=function(){function e(){}return{extend:function(t){e.prototype=this;var r=new e;return t&&r.mixIn(t),r.hasOwnProperty("init")||(r.init=function(){r.$super.init.apply(this,arguments)}),r.init.prototype=r,r.$super=this,r},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),a=i.WordArray=s.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||u).stringify(this)},concat:function(e){var t=this.words,r=e.words,n=this.sigBytes,i=e.sigBytes;if(this.clamp(),n%4)for(var s=0;s<i;s++){var a=r[s>>>2]>>>24-s%4*8&255;t[n+s>>>2]|=a<<24-(n+s)%4*8}else for(s=0;s<i;s+=4)t[n+s>>>2]=r[s>>>2];return this.sigBytes+=i,this},clamp:function(){var e=this.words,t=this.sigBytes;e[t>>>2]&=4294967295<<32-t%4*8,e.length=r.ceil(t/4)},clone:function(){var e=s.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],n=0;n<e;n+=4)t.push(4294967296*r.random()|0);return new a.init(t,e)}}),o=n.enc={},u=o.Hex={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],i=0;i<r;i++){var s=t[i>>>2]>>>24-i%4*8&255;n.push((s>>>4).toString(16)),n.push((15&s).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n+=2)r[n>>>3]|=parseInt(e.substr(n,2),16)<<24-n%8*4;return new a.init(r,t/2)}},h=o.Latin1={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],i=0;i<r;i++){var s=t[i>>>2]>>>24-i%4*8&255;n.push(String.fromCharCode(s))}return n.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n++)r[n>>>2]|=(255&e.charCodeAt(n))<<24-n%4*8;return new a.init(r,t)}},l=o.Utf8={stringify:function(e){try{return decodeURIComponent(escape(h.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return h.parse(unescape(encodeURIComponent(e)))}},c=i.BufferedBlockAlgorithm=s.extend({reset:function(){this._data=new a.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=l.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(e){var t=this._data,n=t.words,i=t.sigBytes,s=this.blockSize,o=i/(4*s),u=(o=e?r.ceil(o):r.max((0|o)-this._minBufferSize,0))*s,h=r.min(4*u,i);if(u){for(var l=0;l<u;l+=s)this._doProcessBlock(n,l);var c=n.splice(0,u);t.sigBytes-=h}return new a.init(c,h)},clone:function(){var e=s.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),i.Hasher=c.extend({cfg:s.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){c.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,r){return new e.init(r).finalize(t)}},_createHmacHelper:function(e){return function(t,r){return new f.HMAC.init(e,r).finalize(t)}}}),f=n.algo={},n);!function(e){var t,r=(t=p).lib,n=r.Base,i=r.WordArray;(t=t.x64={}).Word=n.extend({init:function(e,t){this.high=e,this.low=t}}),t.WordArray=n.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:8*e.length},toX32:function(){for(var e=this.words,t=e.length,r=[],n=0;n<t;n++){var s=e[n];r.push(s.high),r.push(s.low)}return i.create(r,this.sigBytes)},clone:function(){for(var e=n.clone.call(this),t=e.words=this.words.slice(0),r=t.length,i=0;i<r;i++)t[i]=t[i].clone();return e}})}(),p.lib.Cipher||function(e){var t=(g=p).lib,r=t.Base,n=t.WordArray,i=t.BufferedBlockAlgorithm,s=g.enc.Base64,a=g.algo.EvpKDF,o=t.Cipher=i.extend({cfg:r.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,r){this.cfg=this.cfg.extend(r),this._xformMode=e,this._key=t,this.reset()},reset:function(){i.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(e){return{encrypt:function(t,r,n){return("string"==typeof r?d:f).encrypt(e,t,r,n)},decrypt:function(t,r,n){return("string"==typeof r?d:f).decrypt(e,t,r,n)}}}});t.StreamCipher=o.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var u=g.mode={},h=function(e,t,r){var n=this._iv;n?this._iv=undefined:n=this._prevBlock;for(var i=0;i<r;i++)e[t+i]^=n[i]},l=(t.BlockCipherMode=r.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}})).extend();l.Encryptor=l.extend({processBlock:function(e,t){var r=this._cipher,n=r.blockSize;h.call(this,e,t,n),r.encryptBlock(e,t),this._prevBlock=e.slice(t,t+n)}}),l.Decryptor=l.extend({processBlock:function(e,t){var r=this._cipher,n=r.blockSize,i=e.slice(t,t+n);r.decryptBlock(e,t),h.call(this,e,t,n),this._prevBlock=i}}),u=u.CBC=l,l=(g.pad={}).Pkcs7={pad:function(e,t){for(var r,i=(r=(r=4*t)-e.sigBytes%r)<<24|r<<16|r<<8|r,s=[],a=0;a<r;a+=4)s.push(i);r=n.create(s,r),e.concat(r)},unpad:function(e){e.sigBytes-=255&e.words[e.sigBytes-1>>>2]}},t.BlockCipher=o.extend({cfg:o.cfg.extend({mode:u,padding:l}),reset:function(){o.reset.call(this);var e=(t=this.cfg).iv,t=t.mode;if(this._xformMode==this._ENC_XFORM_MODE)var r=t.createEncryptor;else r=t.createDecryptor,this._minBufferSize=1;this._mode=r.call(t,this,e&&e.words)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var t=this._process(!0)}else t=this._process(!0),e.unpad(t);return t},blockSize:4});var c=t.CipherParams=r.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),f=(u=(g.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext;return((e=e.salt)?n.create([1398893684,1701076831]).concat(e).concat(t):t).toString(s)},parse:function(e){var t=(e=s.parse(e)).words;if(1398893684==t[0]&&1701076831==t[1]){var r=n.create(t.slice(2,4));t.splice(0,4),e.sigBytes-=16}return c.create({ciphertext:e,salt:r})}},t.SerializableCipher=r.extend({cfg:r.extend({format:u}),encrypt:function(e,t,r,n){n=this.cfg.extend(n);var i=e.createEncryptor(r,n);return t=i.finalize(t),i=i.cfg,c.create({ciphertext:t,key:r,iv:i.iv,algorithm:e,mode:i.mode,padding:i.padding,blockSize:e.blockSize,formatter:n.format})},decrypt:function(e,t,r,n){return n=this.cfg.extend(n),t=this._parse(t,n.format),e.createDecryptor(r,n).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}})),g=(g.kdf={}).OpenSSL={execute:function(e,t,r,i){return i||(i=n.random(8)),e=a.create({keySize:t+r}).compute(e,i),r=n.create(e.words.slice(t),4*r),e.sigBytes=4*t,c.create({key:e,iv:r,salt:i})}},d=t.PasswordBasedCipher=f.extend({cfg:f.cfg.extend({kdf:g}),encrypt:function(e,t,r,n){return r=(n=this.cfg.extend(n)).kdf.execute(r,e.keySize,e.ivSize),n.iv=r.iv,(e=f.encrypt.call(this,e,t,r.key,n)).mixIn(r),e},decrypt:function(e,t,r,n){return n=this.cfg.extend(n),t=this._parse(t,n.format),r=n.kdf.execute(r,e.keySize,e.ivSize,t.salt),n.iv=r.iv,f.decrypt.call(this,e,t,r.key,n)}})}(),function(){for(var e=p,t=e.lib.BlockCipher,r=e.algo,n=[],i=[],s=[],a=[],o=[],u=[],h=[],l=[],c=[],f=[],g=[],d=0;256>d;d++)g[d]=128>d?d<<1:d<<1^283;var m=0,y=0;for(d=0;256>d;d++){var v=(v=y^y<<1^y<<2^y<<3^y<<4)>>>8^255&v^99;n[m]=v,i[v]=m;var b=g[m],w=g[b],S=g[w],A=257*g[v]^16843008*v;s[m]=A<<24|A>>>8,a[m]=A<<16|A>>>16,o[m]=A<<8|A>>>24,u[m]=A,A=16843009*S^65537*w^257*b^16843008*m,h[v]=A<<24|A>>>8,l[v]=A<<16|A>>>16,c[v]=A<<8|A>>>24,f[v]=A,m?(m=b^g[g[g[S^b]]],y^=g[g[y]]):m=y=1}var x=[0,1,2,4,8,16,32,64,128,27,54];r=r.AES=t.extend({_doReset:function(){for(var e=(r=this._key).words,t=r.sigBytes/4,r=4*((this._nRounds=t+6)+1),i=this._keySchedule=[],s=0;s<r;s++)if(s<t)i[s]=e[s];else{var a=i[s-1];s%t?6<t&&4==s%t&&(a=n[a>>>24]<<24|n[a>>>16&255]<<16|n[a>>>8&255]<<8|n[255&a]):(a=n[(a=a<<8|a>>>24)>>>24]<<24|n[a>>>16&255]<<16|n[a>>>8&255]<<8|n[255&a],a^=x[s/t|0]<<24),i[s]=i[s-t]^a}for(e=this._invKeySchedule=[],t=0;t<r;t++)s=r-t,a=t%4?i[s]:i[s-4],e[t]=4>t||4>=s?a:h[n[a>>>24]]^l[n[a>>>16&255]]^c[n[a>>>8&255]]^f[n[255&a]]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,s,a,o,u,n)},decryptBlock:function(e,t){var r=e[t+1];e[t+1]=e[t+3],e[t+3]=r,this._doCryptBlock(e,t,this._invKeySchedule,h,l,c,f,i),r=e[t+1],e[t+1]=e[t+3],e[t+3]=r},_doCryptBlock:function(e,t,r,n,i,s,a,o){for(var u=this._nRounds,h=e[t]^r[0],l=e[t+1]^r[1],c=e[t+2]^r[2],f=e[t+3]^r[3],g=4,d=1;d<u;d++){var p=n[h>>>24]^i[l>>>16&255]^s[c>>>8&255]^a[255&f]^r[g++],m=n[l>>>24]^i[c>>>16&255]^s[f>>>8&255]^a[255&h]^r[g++],y=n[c>>>24]^i[f>>>16&255]^s[h>>>8&255]^a[255&l]^r[g++];f=n[f>>>24]^i[h>>>16&255]^s[l>>>8&255]^a[255&c]^r[g++],h=p,l=m,c=y}p=(o[h>>>24]<<24|o[l>>>16&255]<<16|o[c>>>8&255]<<8|o[255&f])^r[g++],m=(o[l>>>24]<<24|o[c>>>16&255]<<16|o[f>>>8&255]<<8|o[255&h])^r[g++],y=(o[c>>>24]<<24|o[f>>>16&255]<<16|o[h>>>8&255]<<8|o[255&l])^r[g++],f=(o[f>>>24]<<24|o[h>>>16&255]<<16|o[l>>>8&255]<<8|o[255&c])^r[g++],e[t]=p,e[t+1]=m,e[t+2]=y,e[t+3]=f},keySize:8});e.AES=t._createHelper(r)}(),function(){function e(e,t){var r=(this._lBlock>>>e^this._rBlock)&t;this._rBlock^=r,this._lBlock^=r<<e}function t(e,t){var r=(this._rBlock>>>e^this._lBlock)&t;this._lBlock^=r,this._rBlock^=r<<e}var r=p,n=(i=r.lib).WordArray,i=i.BlockCipher,s=r.algo,a=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],o=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],u=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],h=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],l=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],c=s.DES=i.extend({_doReset:function(){for(var e=this._key.words,t=[],r=0;56>r;r++){var n=a[r]-1;t[r]=e[n>>>5]>>>31-n%32&1}for(e=this._subKeys=[],n=0;16>n;n++){var i=e[n]=[],s=u[n];for(r=0;24>r;r++)i[r/6|0]|=t[(o[r]-1+s)%28]<<31-r%6,i[4+(r/6|0)]|=t[28+(o[r+24]-1+s)%28]<<31-r%6;for(i[0]=i[0]<<1|i[0]>>>31,r=1;7>r;r++)i[r]>>>=4*(r-1)+3;i[7]=i[7]<<5|i[7]>>>27}for(t=this._invSubKeys=[],r=0;16>r;r++)t[r]=e[15-r]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._subKeys)},decryptBlock:function(e,t){this._doCryptBlock(e,t,this._invSubKeys)},_doCryptBlock:function(r,n,i){this._lBlock=r[n],this._rBlock=r[n+1],e.call(this,4,252645135),e.call(this,16,65535),t.call(this,2,858993459),t.call(this,8,16711935),e.call(this,1,1431655765);for(var s=0;16>s;s++){for(var a=i[s],o=this._lBlock,u=this._rBlock,c=0,f=0;8>f;f++)c|=h[f][((u^a[f])&l[f])>>>0];this._lBlock=u,this._rBlock=o^c}i=this._lBlock,this._lBlock=this._rBlock,this._rBlock=i,e.call(this,1,1431655765),t.call(this,8,16711935),t.call(this,2,858993459),e.call(this,16,65535),e.call(this,4,252645135),r[n]=this._lBlock,r[n+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});r.DES=i._createHelper(c),s=s.TripleDES=i.extend({_doReset:function(){var e=this._key.words;this._des1=c.createEncryptor(n.create(e.slice(0,2))),this._des2=c.createEncryptor(n.create(e.slice(2,4))),this._des3=c.createEncryptor(n.create(e.slice(4,6)))},encryptBlock:function(e,t){this._des1.encryptBlock(e,t),this._des2.decryptBlock(e,t),this._des3.encryptBlock(e,t)},decryptBlock:function(e,t){this._des3.decryptBlock(e,t),this._des2.encryptBlock(e,t),this._des1.decryptBlock(e,t)},keySize:6,ivSize:2,blockSize:2}),r.TripleDES=i._createHelper(s)}(),function(){var e=p,t=e.lib.WordArray;e.enc.Base64={stringify:function(e){var t=e.words,r=e.sigBytes,n=this._map;e.clamp(),e=[];for(var i=0;i<r;i+=3)for(var s=(t[i>>>2]>>>24-i%4*8&255)<<16|(t[i+1>>>2]>>>24-(i+1)%4*8&255)<<8|t[i+2>>>2]>>>24-(i+2)%4*8&255,a=0;4>a&&i+.75*a<r;a++)e.push(n.charAt(s>>>6*(3-a)&63));if(t=n.charAt(64))for(;e.length%4;)e.push(t);return e.join("")},parse:function(e){var r=e.length,n=this._map;(i=n.charAt(64))&&(-1!=(i=e.indexOf(i))&&(r=i));for(var i=[],s=0,a=0;a<r;a++)if(a%4){var o=n.indexOf(e.charAt(a-1))<<a%4*2,u=n.indexOf(e.charAt(a))>>>6-a%4*2;i[s>>>2]|=(o|u)<<24-s%4*8,s++}return t.create(i,s)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(e){function t(e,t,r,n,i,s,a){return((e=e+(t&r|~t&n)+i+a)<<s|e>>>32-s)+t}function r(e,t,r,n,i,s,a){return((e=e+(t&n|r&~n)+i+a)<<s|e>>>32-s)+t}function n(e,t,r,n,i,s,a){return((e=e+(t^r^n)+i+a)<<s|e>>>32-s)+t}function i(e,t,r,n,i,s,a){return((e=e+(r^(t|~n))+i+a)<<s|e>>>32-s)+t}for(var s=p,a=(u=s.lib).WordArray,o=u.Hasher,u=s.algo,h=[],l=0;64>l;l++)h[l]=4294967296*e.abs(e.sin(l+1))|0;u=u.MD5=o.extend({_doReset:function(){this._hash=new a.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,s){for(var a=0;16>a;a++){var o=e[u=s+a];e[u]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8)}a=this._hash.words;var u=e[s+0],l=(o=e[s+1],e[s+2]),c=e[s+3],f=e[s+4],g=e[s+5],d=e[s+6],p=e[s+7],m=e[s+8],y=e[s+9],v=e[s+10],b=e[s+11],w=e[s+12],S=e[s+13],A=e[s+14],x=e[s+15],E=t(E=a[0],C=a[1],k=a[2],B=a[3],u,7,h[0]),B=t(B,E,C,k,o,12,h[1]),k=t(k,B,E,C,l,17,h[2]),C=t(C,k,B,E,c,22,h[3]);E=t(E,C,k,B,f,7,h[4]),B=t(B,E,C,k,g,12,h[5]),k=t(k,B,E,C,d,17,h[6]),C=t(C,k,B,E,p,22,h[7]),E=t(E,C,k,B,m,7,h[8]),B=t(B,E,C,k,y,12,h[9]),k=t(k,B,E,C,v,17,h[10]),C=t(C,k,B,E,b,22,h[11]),E=t(E,C,k,B,w,7,h[12]),B=t(B,E,C,k,S,12,h[13]),k=t(k,B,E,C,A,17,h[14]),E=r(E,C=t(C,k,B,E,x,22,h[15]),k,B,o,5,h[16]),B=r(B,E,C,k,d,9,h[17]),k=r(k,B,E,C,b,14,h[18]),C=r(C,k,B,E,u,20,h[19]),E=r(E,C,k,B,g,5,h[20]),B=r(B,E,C,k,v,9,h[21]),k=r(k,B,E,C,x,14,h[22]),C=r(C,k,B,E,f,20,h[23]),E=r(E,C,k,B,y,5,h[24]),B=r(B,E,C,k,A,9,h[25]),k=r(k,B,E,C,c,14,h[26]),C=r(C,k,B,E,m,20,h[27]),E=r(E,C,k,B,S,5,h[28]),B=r(B,E,C,k,l,9,h[29]),k=r(k,B,E,C,p,14,h[30]),E=n(E,C=r(C,k,B,E,w,20,h[31]),k,B,g,4,h[32]),B=n(B,E,C,k,m,11,h[33]),k=n(k,B,E,C,b,16,h[34]),C=n(C,k,B,E,A,23,h[35]),E=n(E,C,k,B,o,4,h[36]),B=n(B,E,C,k,f,11,h[37]),k=n(k,B,E,C,p,16,h[38]),C=n(C,k,B,E,v,23,h[39]),E=n(E,C,k,B,S,4,h[40]),B=n(B,E,C,k,u,11,h[41]),k=n(k,B,E,C,c,16,h[42]),C=n(C,k,B,E,d,23,h[43]),E=n(E,C,k,B,y,4,h[44]),B=n(B,E,C,k,w,11,h[45]),k=n(k,B,E,C,x,16,h[46]),E=i(E,C=n(C,k,B,E,l,23,h[47]),k,B,u,6,h[48]),B=i(B,E,C,k,p,10,h[49]),k=i(k,B,E,C,A,15,h[50]),C=i(C,k,B,E,g,21,h[51]),E=i(E,C,k,B,w,6,h[52]),B=i(B,E,C,k,c,10,h[53]),k=i(k,B,E,C,v,15,h[54]),C=i(C,k,B,E,o,21,h[55]),E=i(E,C,k,B,m,6,h[56]),B=i(B,E,C,k,x,10,h[57]),k=i(k,B,E,C,d,15,h[58]),C=i(C,k,B,E,S,21,h[59]),E=i(E,C,k,B,f,6,h[60]),B=i(B,E,C,k,b,10,h[61]),k=i(k,B,E,C,l,15,h[62]),C=i(C,k,B,E,y,21,h[63]);a[0]=a[0]+E|0,a[1]=a[1]+C|0,a[2]=a[2]+k|0,a[3]=a[3]+B|0},_doFinalize:function(){var t=this._data,r=t.words,n=8*this._nDataBytes,i=8*t.sigBytes;r[i>>>5]|=128<<24-i%32;var s=e.floor(n/4294967296);for(r[15+(i+64>>>9<<4)]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),r[14+(i+64>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),t.sigBytes=4*(r.length+1),this._process(),r=(t=this._hash).words,n=0;4>n;n++)i=r[n],r[n]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8);return t},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}}),s.MD5=o._createHelper(u),s.HmacMD5=o._createHmacHelper(u)}(Math),function(){var e=p,t=(i=e.lib).WordArray,r=i.Hasher,n=[],i=e.algo.SHA1=r.extend({_doReset:function(){this._hash=new t.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var r=this._hash.words,i=r[0],s=r[1],a=r[2],o=r[3],u=r[4],h=0;80>h;h++){if(16>h)n[h]=0|e[t+h];else{var l=n[h-3]^n[h-8]^n[h-14]^n[h-16];n[h]=l<<1|l>>>31}l=(i<<5|i>>>27)+u+n[h],l=20>h?l+(1518500249+(s&a|~s&o)):40>h?l+(1859775393+(s^a^o)):60>h?l+((s&a|s&o|a&o)-1894007588):l+((s^a^o)-899497514),u=o,o=a,a=s<<30|s>>>2,s=i,i=l}r[0]=r[0]+i|0,r[1]=r[1]+s|0,r[2]=r[2]+a|0,r[3]=r[3]+o|0,r[4]=r[4]+u|0},_doFinalize:function(){var e=this._data,t=e.words,r=8*this._nDataBytes,n=8*e.sigBytes;return t[n>>>5]|=128<<24-n%32,t[14+(n+64>>>9<<4)]=Math.floor(r/4294967296),t[15+(n+64>>>9<<4)]=r,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e}});e.SHA1=r._createHelper(i),e.HmacSHA1=r._createHmacHelper(i)}(),function(e){for(var t=p,r=(i=t.lib).WordArray,n=i.Hasher,i=t.algo,s=[],a=[],o=function(e){return 4294967296*(e-(0|e))|0},u=2,h=0;64>h;){var l;e:{l=u;for(var c=e.sqrt(l),f=2;f<=c;f++)if(!(l%f)){l=!1;break e}l=!0}l&&(8>h&&(s[h]=o(e.pow(u,.5))),a[h]=o(e.pow(u,1/3)),h++),u++}var g=[];i=i.SHA256=n.extend({_doReset:function(){this._hash=new r.init(s.slice(0))},_doProcessBlock:function(e,t){for(var r=this._hash.words,n=r[0],i=r[1],s=r[2],o=r[3],u=r[4],h=r[5],l=r[6],c=r[7],f=0;64>f;f++){if(16>f)g[f]=0|e[t+f];else{var d=g[f-15],p=g[f-2];g[f]=((d<<25|d>>>7)^(d<<14|d>>>18)^d>>>3)+g[f-7]+((p<<15|p>>>17)^(p<<13|p>>>19)^p>>>10)+g[f-16]}d=c+((u<<26|u>>>6)^(u<<21|u>>>11)^(u<<7|u>>>25))+(u&h^~u&l)+a[f]+g[f],p=((n<<30|n>>>2)^(n<<19|n>>>13)^(n<<10|n>>>22))+(n&i^n&s^i&s),c=l,l=h,h=u,u=o+d|0,o=s,s=i,i=n,n=d+p|0}r[0]=r[0]+n|0,r[1]=r[1]+i|0,r[2]=r[2]+s|0,r[3]=r[3]+o|0,r[4]=r[4]+u|0,r[5]=r[5]+h|0,r[6]=r[6]+l|0,r[7]=r[7]+c|0},_doFinalize:function(){var t=this._data,r=t.words,n=8*this._nDataBytes,i=8*t.sigBytes;return r[i>>>5]|=128<<24-i%32,r[14+(i+64>>>9<<4)]=e.floor(n/4294967296),r[15+(i+64>>>9<<4)]=n,t.sigBytes=4*r.length,this._process(),this._hash},clone:function(){var e=n.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=n._createHelper(i),t.HmacSHA256=n._createHmacHelper(i)}(Math),function(){var e=p,t=e.lib.WordArray,r=(n=e.algo).SHA256,n=n.SHA224=r.extend({_doReset:function(){this._hash=new t.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var e=r._doFinalize.call(this);return e.sigBytes-=4,e}});e.SHA224=r._createHelper(n),e.HmacSHA224=r._createHmacHelper(n)}(),function(){function e(){return n.create.apply(n,arguments)}for(var t=p,r=t.lib.Hasher,n=(s=t.x64).Word,i=s.WordArray,s=t.algo,a=[e(1116352408,3609767458),e(1899447441,602891725),e(3049323471,3964484399),e(3921009573,2173295548),e(961987163,4081628472),e(1508970993,3053834265),e(2453635748,2937671579),e(2870763221,3664609560),e(3624381080,2734883394),e(310598401,1164996542),e(607225278,1323610764),e(1426881987,3590304994),e(1925078388,4068182383),e(2162078206,991336113),e(2614888103,633803317),e(3248222580,3479774868),e(3835390401,2666613458),e(4022224774,944711139),e(264347078,2341262773),e(604807628,2007800933),e(770255983,1495990901),e(1249150122,1856431235),e(1555081692,3175218132),e(1996064986,2198950837),e(2554220882,3999719339),e(2821834349,766784016),e(2952996808,2566594879),e(3210313671,3203337956),e(3336571891,1034457026),e(3584528711,2466948901),e(113926993,3758326383),e(338241895,168717936),e(666307205,1188179964),e(773529912,1546045734),e(1294757372,1522805485),e(1396182291,2643833823),e(1695183700,2343527390),e(1986661051,1014477480),e(2177026350,1206759142),e(2456956037,344077627),e(2730485921,1290863460),e(2820302411,3158454273),e(3259730800,3505952657),e(3345764771,106217008),e(3516065817,3606008344),e(3600352804,1432725776),e(4094571909,1467031594),e(275423344,851169720),e(430227734,3100823752),e(506948616,1363258195),e(659060556,3750685593),e(883997877,3785050280),e(958139571,3318307427),e(1322822218,3812723403),e(1537002063,2003034995),e(1747873779,3602036899),e(1955562222,1575990012),e(2024104815,1125592928),e(2227730452,2716904306),e(2361852424,442776044),e(2428436474,593698344),e(2756734187,3733110249),e(3204031479,2999351573),e(3329325298,3815920427),e(3391569614,3928383900),e(3515267271,566280711),e(3940187606,3454069534),e(4118630271,4000239992),e(116418474,1914138554),e(174292421,2731055270),e(289380356,3203993006),e(460393269,320620315),e(685471733,587496836),e(852142971,1086792851),e(1017036298,365543100),e(1126000580,2618297676),e(1288033470,3409855158),e(1501505948,4234509866),e(1607167915,987167468),e(1816402316,1246189591)],o=[],u=0;80>u;u++)o[u]=e();s=s.SHA512=r.extend({_doReset:function(){this._hash=new i.init([new n.init(1779033703,4089235720),new n.init(3144134277,2227873595),new n.init(1013904242,4271175723),new n.init(2773480762,1595750129),new n.init(1359893119,2917565137),new n.init(2600822924,725511199),new n.init(528734635,4215389547),new n.init(1541459225,327033209)])},_doProcessBlock:function(e,t){for(var r=(c=this._hash.words)[0],n=c[1],i=c[2],s=c[3],u=c[4],h=c[5],l=c[6],c=c[7],f=r.high,g=r.low,d=n.high,p=n.low,m=i.high,y=i.low,v=s.high,b=s.low,w=u.high,S=u.low,A=h.high,x=h.low,E=l.high,B=l.low,k=c.high,C=c.low,I=f,F=g,P=d,N=p,D=m,H=y,R=v,O=b,T=w,L=S,j=A,V=x,U=E,_=B,K=k,M=C,q=0;80>q;q++){var J=o[q];if(16>q)var $=J.high=0|e[t+2*q],G=J.low=0|e[t+2*q+1];else{$=((G=($=o[q-15]).high)>>>1|(W=$.low)<<31)^(G>>>8|W<<24)^G>>>7;var W=(W>>>1|G<<31)^(W>>>8|G<<24)^(W>>>7|G<<25),z=((G=(z=o[q-2]).high)>>>19|(X=z.low)<<13)^(G<<3|X>>>29)^G>>>6,X=(X>>>19|G<<13)^(X<<3|G>>>29)^(X>>>6|G<<26),Q=(G=o[q-7]).high,Y=(Z=o[q-16]).high,Z=Z.low;$=($=($=$+Q+((G=W+G.low)>>>0<W>>>0?1:0))+z+((G=G+X)>>>0<X>>>0?1:0))+Y+((G=G+Z)>>>0<Z>>>0?1:0);J.high=$,J.low=G}Q=T&j^~T&U,Z=L&V^~L&_,J=I&P^I&D^P&D;var ee=F&N^F&H^N&H,te=(W=(I>>>28|F<<4)^(I<<30|F>>>2)^(I<<25|F>>>7),z=(F>>>28|I<<4)^(F<<30|I>>>2)^(F<<25|I>>>7),(X=a[q]).high),re=X.low;Y=K+((T>>>14|L<<18)^(T>>>18|L<<14)^(T<<23|L>>>9))+((X=M+((L>>>14|T<<18)^(L>>>18|T<<14)^(L<<23|T>>>9)))>>>0<M>>>0?1:0),K=U,M=_,U=j,_=V,j=T,V=L,T=R+(Y=(Y=(Y=Y+Q+((X=X+Z)>>>0<Z>>>0?1:0))+te+((X=X+re)>>>0<re>>>0?1:0))+$+((X=X+G)>>>0<G>>>0?1:0))+((L=O+X|0)>>>0<O>>>0?1:0)|0,R=D,O=H,D=P,H=N,P=I,N=F,I=Y+(J=W+J+((G=z+ee)>>>0<z>>>0?1:0))+((F=X+G|0)>>>0<X>>>0?1:0)|0}g=r.low=g+F,r.high=f+I+(g>>>0<F>>>0?1:0),p=n.low=p+N,n.high=d+P+(p>>>0<N>>>0?1:0),y=i.low=y+H,i.high=m+D+(y>>>0<H>>>0?1:0),b=s.low=b+O,s.high=v+R+(b>>>0<O>>>0?1:0),S=u.low=S+L,u.high=w+T+(S>>>0<L>>>0?1:0),x=h.low=x+V,h.high=A+j+(x>>>0<V>>>0?1:0),B=l.low=B+_,l.high=E+U+(B>>>0<_>>>0?1:0),C=c.low=C+M,c.high=k+K+(C>>>0<M>>>0?1:0)},_doFinalize:function(){var e=this._data,t=e.words,r=8*this._nDataBytes,n=8*e.sigBytes;return t[n>>>5]|=128<<24-n%32,t[30+(n+128>>>10<<5)]=Math.floor(r/4294967296),t[31+(n+128>>>10<<5)]=r,e.sigBytes=4*t.length,this._process(),this._hash.toX32()},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e},blockSize:32}),t.SHA512=r._createHelper(s),t.HmacSHA512=r._createHmacHelper(s)}(),function(){var e=p,t=(i=e.x64).Word,r=i.WordArray,n=(i=e.algo).SHA512,i=i.SHA384=n.extend({_doReset:function(){this._hash=new r.init([new t.init(3418070365,3238371032),new t.init(1654270250,914150663),new t.init(2438529370,812702999),new t.init(355462360,4144912697),new t.init(1731405415,4290775857),new t.init(2394180231,1750603025),new t.init(3675008525,1694076839),new t.init(1203062813,3204075428)])},_doFinalize:function(){var e=n._doFinalize.call(this);return e.sigBytes-=16,e}});e.SHA384=n._createHelper(i),e.HmacSHA384=n._createHmacHelper(i)}(),function(){var e=p,t=(n=e.lib).WordArray,r=n.Hasher,n=e.algo,i=t.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),s=t.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),a=t.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),o=t.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),u=t.create([0,1518500249,1859775393,2400959708,2840853838]),h=t.create([1352829926,1548603684,1836072691,2053994217,0]);n=n.RIPEMD160=r.extend({_doReset:function(){this._hash=t.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var r=0;16>r;r++){var n=e[w=t+r];e[w]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8)}var l,c,f,g,d,p,m,y,v,b,w=this._hash.words,S=(n=u.words,h.words),A=i.words,x=s.words,E=a.words,B=o.words;p=l=w[0],m=c=w[1],y=f=w[2],v=g=w[3],b=d=w[4];var k;for(r=0;80>r;r+=1)k=l+e[t+A[r]]|0,k=16>r?k+((c^f^g)+n[0]):32>r?k+((c&f|~c&g)+n[1]):48>r?k+(((c|~f)^g)+n[2]):64>r?k+((c&g|f&~g)+n[3]):k+((c^(f|~g))+n[4]),k=(k=(k|=0)<<E[r]|k>>>32-E[r])+d|0,l=d,d=g,g=f<<10|f>>>22,f=c,c=k,k=p+e[t+x[r]]|0,k=16>r?k+((m^(y|~v))+S[0]):32>r?k+((m&v|y&~v)+S[1]):48>r?k+(((m|~y)^v)+S[2]):64>r?k+((m&y|~m&v)+S[3]):k+((m^y^v)+S[4]),k=(k=(k|=0)<<B[r]|k>>>32-B[r])+b|0,p=b,b=v,v=y<<10|y>>>22,y=m,m=k;k=w[1]+f+v|0,w[1]=w[2]+g+b|0,w[2]=w[3]+d+p|0,w[3]=w[4]+l+m|0,w[4]=w[0]+c+y|0,w[0]=k},_doFinalize:function(){var e=this._data,t=e.words,r=8*this._nDataBytes,n=8*e.sigBytes;for(t[n>>>5]|=128<<24-n%32,t[14+(n+64>>>9<<4)]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),e.sigBytes=4*(t.length+1),this._process(),t=(e=this._hash).words,r=0;5>r;r++)n=t[r],t[r]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8);return e},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e}});e.RIPEMD160=r._createHelper(n),e.HmacRIPEMD160=r._createHmacHelper(n)}(Math),function(){var e=p,t=e.enc.Utf8;e.algo.HMAC=e.lib.Base.extend({init:function(e,r){e=this._hasher=new e.init,"string"==typeof r&&(r=t.parse(r));var n=e.blockSize,i=4*n;r.sigBytes>i&&(r=e.finalize(r)),r.clamp();for(var s=this._oKey=r.clone(),a=this._iKey=r.clone(),o=s.words,u=a.words,h=0;h<n;h++)o[h]^=1549556828,u[h]^=909522486;s.sigBytes=a.sigBytes=i,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher;return e=t.finalize(e),t.reset(),t.finalize(this._oKey.clone().concat(e))}})}(),function(){var e,t=p,r=(e=t.lib).Base,n=e.WordArray,i=(e=t.algo).HMAC,s=e.PBKDF2=r.extend({cfg:r.extend({keySize:4,hasher:e.SHA1,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){var r=this.cfg,s=i.create(r.hasher,e),a=n.create(),o=n.create([1]),u=a.words,h=o.words,l=r.keySize;for(r=r.iterations;u.length<l;){var c=s.update(t).finalize(o);s.reset();for(var f=c.words,g=f.length,d=c,p=1;p<r;p++){d=s.finalize(d),s.reset();for(var m=d.words,y=0;y<g;y++)f[y]^=m[y]}a.concat(c),h[0]++}return a.sigBytes=4*l,a}});t.PBKDF2=function(e,t,r){return s.create(r).compute(e,t)}}();
/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
 */
var m,y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function v(e){var t,r,n="";for(t=0;t+3<=e.length;t+=3)r=parseInt(e.substring(t,t+3),16),n+=y.charAt(r>>6)+y.charAt(63&r);for(t+1==e.length?(r=parseInt(e.substring(t,t+1),16),n+=y.charAt(r<<2)):t+2==e.length&&(r=parseInt(e.substring(t,t+2),16),n+=y.charAt(r>>2)+y.charAt((3&r)<<4)),"=";(3&n.length)>0;)n+="=";return n}function b(e){var t,r,n,i="",s=0;for(t=0;t<e.length&&"="!=e.charAt(t);++t)(n=y.indexOf(e.charAt(t)))<0||(0==s?(i+=k(n>>2),r=3&n,s=1):1==s?(i+=k(r<<2|n>>4),r=15&n,s=2):2==s?(i+=k(r),i+=k(n>>2),r=3&n,s=3):(i+=k(r<<2|n>>4),i+=k(15&n),s=0));return 1==s&&(i+=k(r<<2)),i}function w(e){var t,r=b(e),n=new Array;for(0;2*t<r.length;++t)n[t]=parseInt(r.substring(2*t,2*t+2),16);return n}function S(e,t,r){null!=e&&("number"==typeof e?this.fromNumber(e,t,r):null==t&&"string"!=typeof e?this.fromString(e,256):this.fromString(e,t))}function A(){return new S(null)}"Microsoft Internet Explorer"==g.appName?(S.prototype.am=function(e,t,r,n,i,s){for(var a=32767&t,o=t>>15;--s>=0;){var u=32767&this[e],h=this[e++]>>15,l=o*u+h*a;i=((u=a*u+((32767&l)<<15)+r[n]+(1073741823&i))>>>30)+(l>>>15)+o*h+(i>>>30),r[n++]=1073741823&u}return i},m=30):"Netscape"!=g.appName?(S.prototype.am=function(e,t,r,n,i,s){for(;--s>=0;){var a=t*this[e++]+r[n]+i;i=Math.floor(a/67108864),r[n++]=67108863&a}return i},m=26):(S.prototype.am=function(e,t,r,n,i,s){for(var a=16383&t,o=t>>14;--s>=0;){var u=16383&this[e],h=this[e++]>>14,l=o*u+h*a;i=((u=a*u+((16383&l)<<14)+r[n]+i)>>28)+(l>>14)+o*h,r[n++]=268435455&u}return i},m=28),S.prototype.DB=m,S.prototype.DM=(1<<m)-1,S.prototype.DV=1<<m;S.prototype.FV=Math.pow(2,52),S.prototype.F1=52-m,S.prototype.F2=2*m-52;var x,E,B=new Array;for(x="0".charCodeAt(0),E=0;E<=9;++E)B[x++]=E;for(x="a".charCodeAt(0),E=10;E<36;++E)B[x++]=E;for(x="A".charCodeAt(0),E=10;E<36;++E)B[x++]=E;function k(e){return"0123456789abcdefghijklmnopqrstuvwxyz".charAt(e)}function C(e,t){var r=B[e.charCodeAt(t)];return null==r?-1:r}function I(e){var t=A();return t.fromInt(e),t}function F(e){var t,r=1;return 0!=(t=e>>>16)&&(e=t,r+=16),0!=(t=e>>8)&&(e=t,r+=8),0!=(t=e>>4)&&(e=t,r+=4),0!=(t=e>>2)&&(e=t,r+=2),0!=(t=e>>1)&&(e=t,r+=1),r}function P(e){this.m=e}function N(e){this.m=e,this.mp=e.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function D(e,t){return e&t}function H(e,t){return e|t}function R(e,t){return e^t}function O(e,t){return e&~t}function T(e){if(0==e)return-1;var t=0;return 0==(65535&e)&&(e>>=16,t+=16),0==(255&e)&&(e>>=8,t+=8),0==(15&e)&&(e>>=4,t+=4),0==(3&e)&&(e>>=2,t+=2),0==(1&e)&&++t,t}function L(e){for(var t=0;0!=e;)e&=e-1,++t;return t}function j(){}function V(e){return e}function U(e){this.r2=A(),this.q3=A(),S.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}P.prototype.convert=function(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e},P.prototype.revert=function(e){return e},P.prototype.reduce=function(e){e.divRemTo(this.m,null,e)},P.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},P.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},N.prototype.convert=function(e){var t=A();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(S.ZERO)>0&&this.m.subTo(t,t),t},N.prototype.revert=function(e){var t=A();return e.copyTo(t),this.reduce(t),t},N.prototype.reduce=function(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(var t=0;t<this.m.t;++t){var r=32767&e[t],n=r*this.mpl+((r*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(e[r=t+this.m.t]+=this.m.am(0,n,e,t,0,this.m.t);e[r]>=e.DV;)e[r]-=e.DV,e[++r]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)},N.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},N.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},S.prototype.copyTo=function(e){for(var t=this.t-1;t>=0;--t)e[t]=this[t];e.t=this.t,e.s=this.s},S.prototype.fromInt=function(e){this.t=1,this.s=e<0?-1:0,e>0?this[0]=e:e<-1?this[0]=e+this.DV:this.t=0},S.prototype.fromString=function(e,t){var r;if(16==t)r=4;else if(8==t)r=3;else if(256==t)r=8;else if(2==t)r=1;else if(32==t)r=5;else{if(4!=t)return void this.fromRadix(e,t);r=2}this.t=0,this.s=0;for(var n=e.length,i=!1,s=0;--n>=0;){var a=8==r?255&e[n]:C(e,n);a<0?"-"==e.charAt(n)&&(i=!0):(i=!1,0==s?this[this.t++]=a:s+r>this.DB?(this[this.t-1]|=(a&(1<<this.DB-s)-1)<<s,this[this.t++]=a>>this.DB-s):this[this.t-1]|=a<<s,(s+=r)>=this.DB&&(s-=this.DB))}8==r&&0!=(128&e[0])&&(this.s=-1,s>0&&(this[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),i&&S.ZERO.subTo(this,this)},S.prototype.clamp=function(){for(var e=this.s&this.DM;this.t>0&&this[this.t-1]==e;)--this.t},S.prototype.dlShiftTo=function(e,t){var r;for(r=this.t-1;r>=0;--r)t[r+e]=this[r];for(r=e-1;r>=0;--r)t[r]=0;t.t=this.t+e,t.s=this.s},S.prototype.drShiftTo=function(e,t){for(var r=e;r<this.t;++r)t[r-e]=this[r];t.t=Math.max(this.t-e,0),t.s=this.s},S.prototype.lShiftTo=function(e,t){var r,n=e%this.DB,i=this.DB-n,s=(1<<i)-1,a=Math.floor(e/this.DB),o=this.s<<n&this.DM;for(r=this.t-1;r>=0;--r)t[r+a+1]=this[r]>>i|o,o=(this[r]&s)<<n;for(r=a-1;r>=0;--r)t[r]=0;t[a]=o,t.t=this.t+a+1,t.s=this.s,t.clamp()},S.prototype.rShiftTo=function(e,t){t.s=this.s;var r=Math.floor(e/this.DB);if(r>=this.t)t.t=0;else{var n=e%this.DB,i=this.DB-n,s=(1<<n)-1;t[0]=this[r]>>n;for(var a=r+1;a<this.t;++a)t[a-r-1]|=(this[a]&s)<<i,t[a-r]=this[a]>>n;n>0&&(t[this.t-r-1]|=(this.s&s)<<i),t.t=this.t-r,t.clamp()}},S.prototype.subTo=function(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this[r]-e[r],t[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n-=e.s;r<this.t;)n+=this[r],t[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n-=e[r],t[r++]=n&this.DM,n>>=this.DB;n-=e.s}t.s=n<0?-1:0,n<-1?t[r++]=this.DV+n:n>0&&(t[r++]=n),t.t=r,t.clamp()},S.prototype.multiplyTo=function(e,t){var r=this.abs(),n=e.abs(),i=r.t;for(t.t=i+n.t;--i>=0;)t[i]=0;for(i=0;i<n.t;++i)t[i+r.t]=r.am(0,n[i],t,i,0,r.t);t.s=0,t.clamp(),this.s!=e.s&&S.ZERO.subTo(t,t)},S.prototype.squareTo=function(e){for(var t=this.abs(),r=e.t=2*t.t;--r>=0;)e[r]=0;for(r=0;r<t.t-1;++r){var n=t.am(r,t[r],e,2*r,0,1);(e[r+t.t]+=t.am(r+1,2*t[r],e,2*r+1,n,t.t-r-1))>=t.DV&&(e[r+t.t]-=t.DV,e[r+t.t+1]=1)}e.t>0&&(e[e.t-1]+=t.am(r,t[r],e,2*r,0,1)),e.s=0,e.clamp()},S.prototype.divRemTo=function(e,t,r){var n=e.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t)return null!=t&&t.fromInt(0),void(null!=r&&this.copyTo(r));null==r&&(r=A());var s=A(),a=this.s,o=e.s,u=this.DB-F(n[n.t-1]);u>0?(n.lShiftTo(u,s),i.lShiftTo(u,r)):(n.copyTo(s),i.copyTo(r));var h=s.t,l=s[h-1];if(0!=l){var c=l*(1<<this.F1)+(h>1?s[h-2]>>this.F2:0),f=this.FV/c,g=(1<<this.F1)/c,d=1<<this.F2,p=r.t,m=p-h,y=null==t?A():t;for(s.dlShiftTo(m,y),r.compareTo(y)>=0&&(r[r.t++]=1,r.subTo(y,r)),S.ONE.dlShiftTo(h,y),y.subTo(s,s);s.t<h;)s[s.t++]=0;for(;--m>=0;){var v=r[--p]==l?this.DM:Math.floor(r[p]*f+(r[p-1]+d)*g);if((r[p]+=s.am(0,v,r,m,0,h))<v)for(s.dlShiftTo(m,y),r.subTo(y,r);r[p]<--v;)r.subTo(y,r)}null!=t&&(r.drShiftTo(h,t),a!=o&&S.ZERO.subTo(t,t)),r.t=h,r.clamp(),u>0&&r.rShiftTo(u,r),a<0&&S.ZERO.subTo(r,r)}}},S.prototype.invDigit=function(){if(this.t<1)return 0;var e=this[0];if(0==(1&e))return 0;var t=3&e;return(t=(t=(t=(t=t*(2-(15&e)*t)&15)*(2-(255&e)*t)&255)*(2-((65535&e)*t&65535))&65535)*(2-e*t%this.DV)%this.DV)>0?this.DV-t:-t},S.prototype.isEven=function(){return 0==(this.t>0?1&this[0]:this.s)},S.prototype.exp=function(e,t){if(e>4294967295||e<1)return S.ONE;var r=A(),n=A(),i=t.convert(this),s=F(e)-1;for(i.copyTo(r);--s>=0;)if(t.sqrTo(r,n),(e&1<<s)>0)t.mulTo(n,i,r);else{var a=r;r=n,n=a}return t.revert(r)},S.prototype.toString=function(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(16==e)t=4;else if(8==e)t=3;else if(2==e)t=1;else if(32==e)t=5;else{if(4!=e)return this.toRadix(e);t=2}var r,n=(1<<t)-1,i=!1,s="",a=this.t,o=this.DB-a*this.DB%t;if(a-- >0)for(o<this.DB&&(r=this[a]>>o)>0&&(i=!0,s=k(r));a>=0;)o<t?(r=(this[a]&(1<<o)-1)<<t-o,r|=this[--a]>>(o+=this.DB-t)):(r=this[a]>>(o-=t)&n,o<=0&&(o+=this.DB,--a)),r>0&&(i=!0),i&&(s+=k(r));return i?s:"0"},S.prototype.negate=function(){var e=A();return S.ZERO.subTo(this,e),e},S.prototype.abs=function(){return this.s<0?this.negate():this},S.prototype.compareTo=function(e){var t=this.s-e.s;if(0!=t)return t;var r=this.t;if(0!=(t=r-e.t))return this.s<0?-t:t;for(;--r>=0;)if(0!=(t=this[r]-e[r]))return t;return 0},S.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+F(this[this.t-1]^this.s&this.DM)},S.prototype.mod=function(e){var t=A();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(S.ZERO)>0&&e.subTo(t,t),t},S.prototype.modPowInt=function(e,t){var r;return r=e<256||t.isEven()?new P(t):new N(t),this.exp(e,r)},S.ZERO=I(0),S.ONE=I(1),j.prototype.convert=V,j.prototype.revert=V,j.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r)},j.prototype.sqrTo=function(e,t){e.squareTo(t)},U.prototype.convert=function(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=A();return e.copyTo(t),this.reduce(t),t},U.prototype.revert=function(e){return e},U.prototype.reduce=function(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)},U.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},U.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)};var _=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],K=(1<<26)/_[_.length-1];
/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
 */
function M(){this.i=0,this.j=0,this.S=new Array}S.prototype.chunkSize=function(e){return Math.floor(Math.LN2*this.DB/Math.log(e))},S.prototype.toRadix=function(e){if(null==e&&(e=10),0==this.signum()||e<2||e>36)return"0";var t=this.chunkSize(e),r=Math.pow(e,t),n=I(r),i=A(),s=A(),a="";for(this.divRemTo(n,i,s);i.signum()>0;)a=(r+s.intValue()).toString(e).substr(1)+a,i.divRemTo(n,i,s);return s.intValue().toString(e)+a},S.prototype.fromRadix=function(e,t){this.fromInt(0),null==t&&(t=10);for(var r=this.chunkSize(t),n=Math.pow(t,r),i=!1,s=0,a=0,o=0;o<e.length;++o){var u=C(e,o);u<0?"-"==e.charAt(o)&&0==this.signum()&&(i=!0):(a=t*a+u,++s>=r&&(this.dMultiply(n),this.dAddOffset(a,0),s=0,a=0))}s>0&&(this.dMultiply(Math.pow(t,s)),this.dAddOffset(a,0)),i&&S.ZERO.subTo(this,this)},S.prototype.fromNumber=function(e,t,r){if("number"==typeof t)if(e<2)this.fromInt(1);else for(this.fromNumber(e,r),this.testBit(e-1)||this.bitwiseTo(S.ONE.shiftLeft(e-1),H,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(S.ONE.shiftLeft(e-1),this);else{var n=new Array,i=7&e;n.length=1+(e>>3),t.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}},S.prototype.bitwiseTo=function(e,t,r){var n,i,s=Math.min(e.t,this.t);for(n=0;n<s;++n)r[n]=t(this[n],e[n]);if(e.t<this.t){for(i=e.s&this.DM,n=s;n<this.t;++n)r[n]=t(this[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=s;n<e.t;++n)r[n]=t(i,e[n]);r.t=e.t}r.s=t(this.s,e.s),r.clamp()},S.prototype.changeBit=function(e,t){var r=S.ONE.shiftLeft(e);return this.bitwiseTo(r,t,r),r},S.prototype.addTo=function(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this[r]+e[r],t[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n+=e.s;r<this.t;)n+=this[r],t[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n+=e[r],t[r++]=n&this.DM,n>>=this.DB;n+=e.s}t.s=n<0?-1:0,n>0?t[r++]=n:n<-1&&(t[r++]=this.DV+n),t.t=r,t.clamp()},S.prototype.dMultiply=function(e){this[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()},S.prototype.dAddOffset=function(e,t){if(0!=e){for(;this.t<=t;)this[this.t++]=0;for(this[t]+=e;this[t]>=this.DV;)this[t]-=this.DV,++t>=this.t&&(this[this.t++]=0),++this[t]}},S.prototype.multiplyLowerTo=function(e,t,r){var n,i=Math.min(this.t+e.t,t);for(r.s=0,r.t=i;i>0;)r[--i]=0;for(n=r.t-this.t;i<n;++i)r[i+this.t]=this.am(0,e[i],r,i,0,this.t);for(n=Math.min(e.t,t);i<n;++i)this.am(0,e[i],r,i,0,t-i);r.clamp()},S.prototype.multiplyUpperTo=function(e,t,r){--t;var n=r.t=this.t+e.t-t;for(r.s=0;--n>=0;)r[n]=0;for(n=Math.max(t-this.t,0);n<e.t;++n)r[this.t+n-t]=this.am(t-n,e[n],r,0,0,this.t+n-t);r.clamp(),r.drShiftTo(1,r)},S.prototype.modInt=function(e){if(e<=0)return 0;var t=this.DV%e,r=this.s<0?e-1:0;if(this.t>0)if(0==t)r=this[0]%e;else for(var n=this.t-1;n>=0;--n)r=(t*r+this[n])%e;return r},S.prototype.millerRabin=function(e){var t=this.subtract(S.ONE),r=t.getLowestSetBit();if(r<=0)return!1;var n=t.shiftRight(r);(e=e+1>>1)>_.length&&(e=_.length);for(var i=A(),s=0;s<e;++s){i.fromInt(_[Math.floor(Math.random()*_.length)]);var a=i.modPow(n,this);if(0!=a.compareTo(S.ONE)&&0!=a.compareTo(t)){for(var o=1;o++<r&&0!=a.compareTo(t);)if(0==(a=a.modPowInt(2,this)).compareTo(S.ONE))return!1;if(0!=a.compareTo(t))return!1}}return!0},S.prototype.clone=
/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
 */
function(){var e=A();return this.copyTo(e),e},S.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},S.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},S.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16},S.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1},S.prototype.toByteArray=function(){var e=this.t,t=new Array;t[0]=this.s;var r,n=this.DB-e*this.DB%8,i=0;if(e-- >0)for(n<this.DB&&(r=this[e]>>n)!=(this.s&this.DM)>>n&&(t[i++]=r|this.s<<this.DB-n);e>=0;)n<8?(r=(this[e]&(1<<n)-1)<<8-n,r|=this[--e]>>(n+=this.DB-8)):(r=this[e]>>(n-=8)&255,n<=0&&(n+=this.DB,--e)),0!=(128&r)&&(r|=-256),0==i&&(128&this.s)!=(128&r)&&++i,(i>0||r!=this.s)&&(t[i++]=r);return t},S.prototype.equals=function(e){return 0==this.compareTo(e)},S.prototype.min=function(e){return this.compareTo(e)<0?this:e},S.prototype.max=function(e){return this.compareTo(e)>0?this:e},S.prototype.and=function(e){var t=A();return this.bitwiseTo(e,D,t),t},S.prototype.or=function(e){var t=A();return this.bitwiseTo(e,H,t),t},S.prototype.xor=function(e){var t=A();return this.bitwiseTo(e,R,t),t},S.prototype.andNot=function(e){var t=A();return this.bitwiseTo(e,O,t),t},S.prototype.not=function(){for(var e=A(),t=0;t<this.t;++t)e[t]=this.DM&~this[t];return e.t=this.t,e.s=~this.s,e},S.prototype.shiftLeft=function(e){var t=A();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t},S.prototype.shiftRight=function(e){var t=A();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t},S.prototype.getLowestSetBit=function(){for(var e=0;e<this.t;++e)if(0!=this[e])return e*this.DB+T(this[e]);return this.s<0?this.t*this.DB:-1},S.prototype.bitCount=function(){for(var e=0,t=this.s&this.DM,r=0;r<this.t;++r)e+=L(this[r]^t);return e},S.prototype.testBit=function(e){var t=Math.floor(e/this.DB);return t>=this.t?0!=this.s:0!=(this[t]&1<<e%this.DB)},S.prototype.setBit=function(e){return this.changeBit(e,H)},S.prototype.clearBit=function(e){return this.changeBit(e,O)},S.prototype.flipBit=function(e){return this.changeBit(e,R)},S.prototype.add=function(e){var t=A();return this.addTo(e,t),t},S.prototype.subtract=function(e){var t=A();return this.subTo(e,t),t},S.prototype.multiply=function(e){var t=A();return this.multiplyTo(e,t),t},S.prototype.divide=function(e){var t=A();return this.divRemTo(e,t,null),t},S.prototype.remainder=function(e){var t=A();return this.divRemTo(e,null,t),t},S.prototype.divideAndRemainder=function(e){var t=A(),r=A();return this.divRemTo(e,t,r),new Array(t,r)},S.prototype.modPow=function(e,t){var r,n,i=e.bitLength(),s=I(1);if(i<=0)return s;r=i<18?1:i<48?3:i<144?4:i<768?5:6,n=i<8?new P(t):t.isEven()?new U(t):new N(t);var a=new Array,o=3,u=r-1,h=(1<<r)-1;if(a[1]=n.convert(this),r>1){var l=A();for(n.sqrTo(a[1],l);o<=h;)a[o]=A(),n.mulTo(l,a[o-2],a[o]),o+=2}var c,f,g=e.t-1,d=!0,p=A();for(i=F(e[g])-1;g>=0;){for(i>=u?c=e[g]>>i-u&h:(c=(e[g]&(1<<i+1)-1)<<u-i,g>0&&(c|=e[g-1]>>this.DB+i-u)),o=r;0==(1&c);)c>>=1,--o;if((i-=o)<0&&(i+=this.DB,--g),d)a[c].copyTo(s),d=!1;else{for(;o>1;)n.sqrTo(s,p),n.sqrTo(p,s),o-=2;o>0?n.sqrTo(s,p):(f=s,s=p,p=f),n.mulTo(p,a[c],s)}for(;g>=0&&0==(e[g]&1<<i);)n.sqrTo(s,p),f=s,s=p,p=f,--i<0&&(i=this.DB-1,--g)}return n.revert(s)},S.prototype.modInverse=function(e){var t=e.isEven();if(this.isEven()&&t||0==e.signum())return S.ZERO;for(var r=e.clone(),n=this.clone(),i=I(1),s=I(0),a=I(0),o=I(1);0!=r.signum();){for(;r.isEven();)r.rShiftTo(1,r),t?(i.isEven()&&s.isEven()||(i.addTo(this,i),s.subTo(e,s)),i.rShiftTo(1,i)):s.isEven()||s.subTo(e,s),s.rShiftTo(1,s);for(;n.isEven();)n.rShiftTo(1,n),t?(a.isEven()&&o.isEven()||(a.addTo(this,a),o.subTo(e,o)),a.rShiftTo(1,a)):o.isEven()||o.subTo(e,o),o.rShiftTo(1,o);r.compareTo(n)>=0?(r.subTo(n,r),t&&i.subTo(a,i),s.subTo(o,s)):(n.subTo(r,n),t&&a.subTo(i,a),o.subTo(s,o))}return 0!=n.compareTo(S.ONE)?S.ZERO:o.compareTo(e)>=0?o.subtract(e):o.signum()<0?(o.addTo(e,o),o.signum()<0?o.add(e):o):o},S.prototype.pow=function(e){return this.exp(e,new j)},S.prototype.gcd=function(e){var t=this.s<0?this.negate():this.clone(),r=e.s<0?e.negate():e.clone();if(t.compareTo(r)<0){var n=t;t=r,r=n}var i=t.getLowestSetBit(),s=r.getLowestSetBit();if(s<0)return t;for(i<s&&(s=i),s>0&&(t.rShiftTo(s,t),r.rShiftTo(s,r));t.signum()>0;)(i=t.getLowestSetBit())>0&&t.rShiftTo(i,t),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),t.compareTo(r)>=0?(t.subTo(r,t),t.rShiftTo(1,t)):(r.subTo(t,r),r.rShiftTo(1,r));return s>0&&r.lShiftTo(s,r),r},S.prototype.isProbablePrime=function(e){var t,r=this.abs();if(1==r.t&&r[0]<=_[_.length-1]){for(t=0;t<_.length;++t)if(r[0]==_[t])return!0;return!1}if(r.isEven())return!1;for(t=1;t<_.length;){for(var n=_[t],i=t+1;i<_.length&&n<K;)n*=_[i++];for(n=r.modInt(n);t<i;)if(n%_[t++]==0)return!1}return r.millerRabin(e)},S.prototype.square=function(){var e=A();return this.squareTo(e),e},M.prototype.init=function(e){var t,r,n;for(t=0;t<256;++t)this.S[t]=t;for(r=0,t=0;t<256;++t)r=r+this.S[t]+e[t%e.length]&255,n=this.S[t],this.S[t]=this.S[r],this.S[r]=n;this.i=0,this.j=0},M.prototype.next=function(){var e;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,e=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=e,this.S[e+this.S[this.i]&255]};var q,J,$;
/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
 */function G(){!function(e){J[$++]^=255&e,J[$++]^=e>>8&255,J[$++]^=e>>16&255,J[$++]^=e>>24&255,$>=256&&($-=256)}((new Date).getTime())}if(null==J){var W;if(J=new Array,$=0,void 0!==d&&(void 0!==d.crypto||void 0!==d.msCrypto)){var z=d.crypto||d.msCrypto;if(z.getRandomValues){var X=new Uint8Array(32);for(z.getRandomValues(X),W=0;W<32;++W)J[$++]=X[W]}else if("Netscape"==g.appName&&g.appVersion<"5"){var Q=d.crypto.random(32);for(W=0;W<Q.length;++W)J[$++]=255&Q.charCodeAt(W)}}for(;$<256;)W=Math.floor(65536*Math.random()),J[$++]=W>>>8,J[$++]=255&W;$=0,G()}function Y(){if(null==q){for(G(),(q=new M).init(J),$=0;$<J.length;++$)J[$]=0;$=0}return q.next()}function Z(){}
/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
 */
function ee(e,t){return new S(e,t)}function te(e,t,r){for(var n="",i=0;n.length<t;)n+=r(String.fromCharCode.apply(String,e.concat([(4278190080&i)>>24,(16711680&i)>>16,(65280&i)>>8,255&i]))),i+=1;return n}function re(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function ne(e,t,r){for(var n="",i=0;n.length<t;)n+=r(e+String.fromCharCode.apply(String,[(4278190080&i)>>24,(16711680&i)>>16,(65280&i)>>8,255&i])),i+=1;return n}
/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
 */
function ie(e,t){this.x=t,this.q=e}function se(e,t,r,n){this.curve=e,this.x=t,this.y=r,this.z=null==n?S.ONE:n,this.zinv=null}function ae(e,t,r){this.q=e,this.a=this.fromBigInteger(t),this.b=this.fromBigInteger(r),this.infinity=new se(this,null,null)}Z.prototype.nextBytes=function(e){var t;for(t=0;t<e.length;++t)e[t]=Y()},re.prototype.doPublic=function(e){return e.modPowInt(this.e,this.n)},re.prototype.setPublic=function(e,t){if(this.isPublic=!0,this.isPrivate=!1,"string"!=typeof e)this.n=e,this.e=t;else{if(!(null!=e&&null!=t&&e.length>0&&t.length>0))throw"Invalid RSA public key";this.n=ee(e,16),this.e=parseInt(t,16)}},re.prototype.encrypt=function(e){var t=function(e,t){if(t<e.length+11)throw"Message too long for RSA";for(var r=new Array,n=e.length-1;n>=0&&t>0;){var i=e.charCodeAt(n--);i<128?r[--t]=i:i>127&&i<2048?(r[--t]=63&i|128,r[--t]=i>>6|192):(r[--t]=63&i|128,r[--t]=i>>6&63|128,r[--t]=i>>12|224)}r[--t]=0;for(var s=new Z,a=new Array;t>2;){for(a[0]=0;0==a[0];)s.nextBytes(a);r[--t]=a[0]}return r[--t]=2,r[--t]=0,new S(r)}(e,this.n.bitLength()+7>>3);if(null==t)return null;var r=this.doPublic(t);if(null==r)return null;var n=r.toString(16);return 0==(1&n.length)?n:"0"+n},re.prototype.encryptOAEP=function(e,t,r){var n=function(e,t,r,n){var i=ue.crypto.MessageDigest,s=ue.crypto.Util,a=null;if(r||(r="sha1"),"string"==typeof r&&(a=i.getCanonicalAlgName(r),n=i.getHashLength(a),r=function(e){return Ae(s.hashHex(xe(e),a))}),e.length+2*n+2>t)throw"Message too long for RSA";var o,u="";for(o=0;o<t-e.length-2*n-2;o+=1)u+="\0";var h=r("")+u+""+e,l=new Array(n);(new Z).nextBytes(l);var c=te(l,h.length,r),f=[];for(o=0;o<h.length;o+=1)f[o]=h.charCodeAt(o)^c.charCodeAt(o);var g=te(f,l.length,r),d=[0];for(o=0;o<l.length;o+=1)d[o+1]=l[o]^g.charCodeAt(o);return new S(d.concat(f))}(e,this.n.bitLength()+7>>3,t,r);if(null==n)return null;var i=this.doPublic(n);if(null==i)return null;var s=i.toString(16);return 0==(1&s.length)?s:"0"+s},re.prototype.type="RSA",re.prototype.doPrivate=function(e){if(null==this.p||null==this.q)return e.modPow(this.d,this.n);for(var t=e.mod(this.p).modPow(this.dmp1,this.p),r=e.mod(this.q).modPow(this.dmq1,this.q);t.compareTo(r)<0;)t=t.add(this.p);return t.subtract(r).multiply(this.coeff).mod(this.p).multiply(this.q).add(r)},re.prototype.setPrivate=function(e,t,r){if(this.isPrivate=!0,"string"!=typeof e)this.n=e,this.e=t,this.d=r;else{if(!(null!=e&&null!=t&&e.length>0&&t.length>0))throw"Invalid RSA private key";this.n=ee(e,16),this.e=parseInt(t,16),this.d=ee(r,16)}},re.prototype.setPrivateEx=function(e,t,r,n,i,s,a,o){if(this.isPrivate=!0,this.isPublic=!1,null==e)throw"RSASetPrivateEx N == null";if(null==t)throw"RSASetPrivateEx E == null";if(0==e.length)throw"RSASetPrivateEx N.length == 0";if(0==t.length)throw"RSASetPrivateEx E.length == 0";if(!(null!=e&&null!=t&&e.length>0&&t.length>0))throw"Invalid RSA private key in RSASetPrivateEx";this.n=ee(e,16),this.e=parseInt(t,16),this.d=ee(r,16),this.p=ee(n,16),this.q=ee(i,16),this.dmp1=ee(s,16),this.dmq1=ee(a,16),this.coeff=ee(o,16)},re.prototype.generate=function(e,t){var r=new Z,n=e>>1;this.e=parseInt(t,16);for(var i=new S(t,16);;){for(;this.p=new S(e-n,1,r),0!=this.p.subtract(S.ONE).gcd(i).compareTo(S.ONE)||!this.p.isProbablePrime(10););for(;this.q=new S(n,1,r),0!=this.q.subtract(S.ONE).gcd(i).compareTo(S.ONE)||!this.q.isProbablePrime(10););if(this.p.compareTo(this.q)<=0){var s=this.p;this.p=this.q,this.q=s}var a=this.p.subtract(S.ONE),o=this.q.subtract(S.ONE),u=a.multiply(o);if(0==u.gcd(i).compareTo(S.ONE)&&(this.n=this.p.multiply(this.q),this.n.bitLength()==e)){this.d=i.modInverse(u),this.dmp1=this.d.mod(a),this.dmq1=this.d.mod(o),this.coeff=this.q.modInverse(this.p);break}}this.isPrivate=!0},re.prototype.decrypt=function(e){if(e.length!=Math.ceil(this.n.bitLength()/4))throw new Error("wrong ctext length");var t=ee(e,16),r=this.doPrivate(t);return null==r?null:
/*! (c) Tom Wu | http://www-cs-students.stanford.edu/~tjw/jsbn/
 */
function(e,t){for(var r=e.toByteArray(),n=0;n<r.length&&0==r[n];)++n;if(r.length-n!=t-1||2!=r[n])return null;for(++n;0!=r[n];)if(++n>=r.length)return null;for(var i="";++n<r.length;){var s=255&r[n];s<128?i+=String.fromCharCode(s):s>191&&s<224?(i+=String.fromCharCode((31&s)<<6|63&r[n+1]),++n):(i+=String.fromCharCode((15&s)<<12|(63&r[n+1])<<6|63&r[n+2]),n+=2)}return i}(r,this.n.bitLength()+7>>3)},re.prototype.decryptOAEP=function(e,t,r){if(e.length!=Math.ceil(this.n.bitLength()/4))throw new Error("wrong ctext length");var n=ee(e,16),i=this.doPrivate(n);return null==i?null:function(e,t,r,n){var i=ue.crypto.MessageDigest,s=ue.crypto.Util,a=null;for(r||(r="sha1"),"string"==typeof r&&(a=i.getCanonicalAlgName(r),n=i.getHashLength(a),r=function(e){return Ae(s.hashHex(xe(e),a))}),e=e.toByteArray(),o=0;o<e.length;o+=1)e[o]&=255;for(;e.length<t;)e.unshift(0);if((e=String.fromCharCode.apply(String,e)).length<2*n+2)throw"Cipher too short";var o,u=e.substr(1,n),h=e.substr(n+1),l=ne(h,n,r),c=[];for(o=0;o<u.length;o+=1)c[o]=u.charCodeAt(o)^l.charCodeAt(o);var f=ne(String.fromCharCode.apply(String,c),e.length-n,r),g=[];for(o=0;o<h.length;o+=1)g[o]=h.charCodeAt(o)^f.charCodeAt(o);if((g=String.fromCharCode.apply(String,g)).substr(0,n)!==r(""))throw"Hash mismatch";var d=(g=g.substr(n)).indexOf("");if((-1!=d?g.substr(0,d).lastIndexOf("\0"):-1)+1!=d)throw"Malformed data";return g.substr(d+1)}(i,this.n.bitLength()+7>>3,t,r)},ie.prototype.equals=function(e){return e==this||this.q.equals(e.q)&&this.x.equals(e.x)},ie.prototype.toBigInteger=function(){return this.x},ie.prototype.negate=function(){return new ie(this.q,this.x.negate().mod(this.q))},ie.prototype.add=function(e){return new ie(this.q,this.x.add(e.toBigInteger()).mod(this.q))},ie.prototype.subtract=function(e){return new ie(this.q,this.x.subtract(e.toBigInteger()).mod(this.q))},ie.prototype.multiply=function(e){return new ie(this.q,this.x.multiply(e.toBigInteger()).mod(this.q))},ie.prototype.square=function(){return new ie(this.q,this.x.square().mod(this.q))},ie.prototype.divide=function(e){return new ie(this.q,this.x.multiply(e.toBigInteger().modInverse(this.q)).mod(this.q))},se.prototype.getX=function(){return null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))},se.prototype.getY=function(){return null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))},se.prototype.equals=function(e){return e==this||(this.isInfinity()?e.isInfinity():e.isInfinity()?this.isInfinity():!!e.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(e.z)).mod(this.curve.q).equals(S.ZERO)&&e.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(e.z)).mod(this.curve.q).equals(S.ZERO))},se.prototype.isInfinity=function(){return null==this.x&&null==this.y||this.z.equals(S.ZERO)&&!this.y.toBigInteger().equals(S.ZERO)},se.prototype.negate=function(){return new se(this.curve,this.x,this.y.negate(),this.z)},se.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var t=e.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(e.z)).mod(this.curve.q),r=e.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(e.z)).mod(this.curve.q);if(S.ZERO.equals(r))return S.ZERO.equals(t)?this.twice():this.curve.getInfinity();var n=new S("3"),i=this.x.toBigInteger(),s=this.y.toBigInteger(),a=(e.x.toBigInteger(),e.y.toBigInteger(),r.square()),o=a.multiply(r),u=i.multiply(a),h=t.square().multiply(this.z),l=h.subtract(u.shiftLeft(1)).multiply(e.z).subtract(o).multiply(r).mod(this.curve.q),c=u.multiply(n).multiply(t).subtract(s.multiply(o)).subtract(h.multiply(t)).multiply(e.z).add(t.multiply(o)).mod(this.curve.q),f=o.multiply(this.z).multiply(e.z).mod(this.curve.q);return new se(this.curve,this.curve.fromBigInteger(l),this.curve.fromBigInteger(c),f)},se.prototype.twice=function(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var e=new S("3"),t=this.x.toBigInteger(),r=this.y.toBigInteger(),n=r.multiply(this.z),i=n.multiply(r).mod(this.curve.q),s=this.curve.a.toBigInteger(),a=t.square().multiply(e);S.ZERO.equals(s)||(a=a.add(this.z.square().multiply(s)));var o=(a=a.mod(this.curve.q)).square().subtract(t.shiftLeft(3).multiply(i)).shiftLeft(1).multiply(n).mod(this.curve.q),u=a.multiply(e).multiply(t).subtract(i.shiftLeft(1)).shiftLeft(2).multiply(i).subtract(a.square().multiply(a)).mod(this.curve.q),h=n.square().multiply(n).shiftLeft(3).mod(this.curve.q);return new se(this.curve,this.curve.fromBigInteger(o),this.curve.fromBigInteger(u),h)},se.prototype.multiply=function(e){if(this.isInfinity())return this;if(0==e.signum())return this.curve.getInfinity();var t,r=e,n=r.multiply(new S("3")),i=this.negate(),s=this,a=this.curve.q.subtract(e),o=a.multiply(new S("3")),u=new se(this.curve,this.x,this.y),h=u.negate();for(t=n.bitLength()-2;t>0;--t){s=s.twice();var l=n.testBit(t);l!=r.testBit(t)&&(s=s.add(l?this:i))}for(t=o.bitLength()-2;t>0;--t){u=u.twice();var c=o.testBit(t);c!=a.testBit(t)&&(u=u.add(c?u:h))}return s},se.prototype.multiplyTwo=function(e,t,r){var n;n=e.bitLength()>r.bitLength()?e.bitLength()-1:r.bitLength()-1;for(var i=this.curve.getInfinity(),s=this.add(t);n>=0;)i=i.twice(),e.testBit(n)?i=r.testBit(n)?i.add(s):i.add(this):r.testBit(n)&&(i=i.add(t)),--n;return i},ae.prototype.getQ=function(){return this.q},ae.prototype.getA=function(){return this.a},ae.prototype.getB=function(){return this.b},ae.prototype.equals=function(e){return e==this||this.q.equals(e.q)&&this.a.equals(e.a)&&this.b.equals(e.b)},ae.prototype.getInfinity=function(){return this.infinity},ae.prototype.fromBigInteger=function(e){return new ie(this.q,e)},ae.prototype.decodePointHex=function(e){switch(parseInt(e.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:return null;case 4:case 6:case 7:var t=(e.length-2)/2,r=e.substr(2,t),n=e.substr(t+2,t);return new se(this,this.fromBigInteger(new S(r,16)),this.fromBigInteger(new S(n,16)));default:return null}},
/*! (c) Stefan Thomas | https://github.com/bitcoinjs/bitcoinjs-lib
 */
ie.prototype.getByteLength=function(){return Math.floor((this.toBigInteger().bitLength()+7)/8)},se.prototype.getEncoded=function(e){var t=function(e,t){var r=e.toByteArrayUnsigned();if(t<r.length)r=r.slice(r.length-t);else for(;t>r.length;)r.unshift(0);return r},r=this.getX().toBigInteger(),n=this.getY().toBigInteger(),i=t(r,32);return e?n.isEven()?i.unshift(2):i.unshift(3):(i.unshift(4),i=i.concat(t(n,32))),i},se.decodeFrom=function(e,t){t[0];var r=t.length-1,n=t.slice(1,1+r/2),i=t.slice(1+r/2,1+r);n.unshift(0),i.unshift(0);var s=new S(n),a=new S(i);return new se(e,e.fromBigInteger(s),e.fromBigInteger(a))},se.decodeFromHex=function(e,t){t.substr(0,2);var r=t.length-2,n=t.substr(2,r/2),i=t.substr(2+r/2,r/2),s=new S(n,16),a=new S(i,16);return new se(e,e.fromBigInteger(s),e.fromBigInteger(a))},se.prototype.add2D=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;if(this.x.equals(e.x))return this.y.equals(e.y)?this.twice():this.curve.getInfinity();var t=e.x.subtract(this.x),r=e.y.subtract(this.y).divide(t),n=r.square().subtract(this.x).subtract(e.x),i=r.multiply(this.x.subtract(n)).subtract(this.y);return new se(this.curve,n,i)},se.prototype.twice2D=function(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var e=this.curve.fromBigInteger(S.valueOf(2)),t=this.curve.fromBigInteger(S.valueOf(3)),r=this.x.square().multiply(t).add(this.curve.a).divide(this.y.multiply(e)),n=r.square().subtract(this.x.multiply(e)),i=r.multiply(this.x.subtract(n)).subtract(this.y);return new se(this.curve,n,i)},se.prototype.multiply2D=function(e){if(this.isInfinity())return this;if(0==e.signum())return this.curve.getInfinity();var t,r=e,n=r.multiply(new S("3")),i=this.negate(),s=this;for(t=n.bitLength()-2;t>0;--t){s=s.twice();var a=n.testBit(t);a!=r.testBit(t)&&(s=s.add2D(a?this:i))}return s},se.prototype.isOnCurve=function(){var e=this.getX().toBigInteger(),t=this.getY().toBigInteger(),r=this.curve.getA().toBigInteger(),n=this.curve.getB().toBigInteger(),i=this.curve.getQ(),s=t.multiply(t).mod(i),a=e.multiply(e).multiply(e).add(r.multiply(e)).add(n).mod(i);return s.equals(a)},se.prototype.toString=function(){return"("+this.getX().toBigInteger().toString()+","+this.getY().toBigInteger().toString()+")"},se.prototype.validate=function(){var e=this.curve.getQ();if(this.isInfinity())throw new Error("Point is at infinity.");var t=this.getX().toBigInteger(),r=this.getY().toBigInteger();if(t.compareTo(S.ONE)<0||t.compareTo(e.subtract(S.ONE))>0)throw new Error("x coordinate out of bounds");if(r.compareTo(S.ONE)<0||r.compareTo(e.subtract(S.ONE))>0)throw new Error("y coordinate out of bounds");if(!this.isOnCurve())throw new Error("Point is not on the curve.");if(this.multiply(e).isInfinity())throw new Error("Point is not a scalar multiple of G.");return!0};
/*! Mike Samuel (c) 2009 | code.google.com/p/json-sans-eval
 */
var oe=function(){var e=new RegExp('(?:false|true|null|[\\{\\}\\[\\]]|(?:-?\\b(?:0|[1-9][0-9]*)(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?\\b)|(?:"(?:[^\\0-\\x08\\x0a-\\x1f"\\\\]|\\\\(?:["/\\\\bfnrt]|u[0-9A-Fa-f]{4}))*"))',"g"),t=new RegExp("\\\\(?:([^u])|u(.{4}))","g"),r={'"':'"',"/":"/","\\":"\\",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"};function n(e,t,n){return t?r[t]:String.fromCharCode(parseInt(n,16))}var i=new String(""),s=Object.hasOwnProperty;return function(r,a){var o,u,h=r.match(e),l=h[0],c=!1;"{"===l?o={}:"["===l?o=[]:(o=[],c=!0);for(var f=[o],g=1-c,d=h.length;g<d;++g){var p;switch((l=h[g]).charCodeAt(0)){default:(p=f[0])[u||p.length]=+l,u=void 0;break;case 34:if(-1!==(l=l.substring(1,l.length-1)).indexOf("\\")&&(l=l.replace(t,n)),p=f[0],!u){if(!(p instanceof Array)){u=l||i;break}u=p.length}p[u]=l,u=void 0;break;case 91:p=f[0],f.unshift(p[u||p.length]=[]),u=void 0;break;case 93:f.shift();break;case 102:(p=f[0])[u||p.length]=!1,u=void 0;break;case 110:(p=f[0])[u||p.length]=null,u=void 0;break;case 116:(p=f[0])[u||p.length]=!0,u=void 0;break;case 123:p=f[0],f.unshift(p[u||p.length]={}),u=void 0;break;case 125:f.shift()}}if(c){if(1!==f.length)throw new Error;o=o[0]}else if(f.length)throw new Error;if(a){var m=function(e,t){var r=e[t];if(r&&"object"==typeof r){var n=null;for(var i in r)if(s.call(r,i)&&r!==e){var o=m(r,i);void 0!==o?r[i]=o:(n||(n=[]),n.push(i))}if(n)for(var u=n.length;--u>=0;)delete r[n[u]]}return a.call(e,t,r)};o=m({"":o},"")}return o}}();void 0!==ue&&ue||(ue={}),void 0!==ue.asn1&&ue.asn1||(ue.asn1={}),ue.asn1.ASN1Util=new function(){this.integerToByteHex=function(e){var t=e.toString(16);return t.length%2==1&&(t="0"+t),t},this.bigIntToMinTwosComplementsHex=function(e){var t=e.toString(16);if("-"!=t.substr(0,1))t.length%2==1?t="0"+t:t.match(/^[0-7]/)||(t="00"+t);else{var r=t.substr(1).length;r%2==1?r+=1:t.match(/^[0-7]/)||(r+=2);for(var n="",i=0;i<r;i++)n+="f";t=new S(n,16).xor(e).add(S.ONE).toString(16).replace(/^-/,"")}return t},this.getPEMStringFromHex=function(e,t){return Ce(e,t)},this.newObject=function(e){var t=ue.asn1,r=t.ASN1Object,n=t.DERBoolean,i=t.DERInteger,s=t.DERBitString,a=t.DEROctetString,o=t.DERNull,u=t.DERObjectIdentifier,h=t.DEREnumerated,l=t.DERUTF8String,c=t.DERNumericString,f=t.DERPrintableString,g=t.DERTeletexString,d=t.DERIA5String,p=t.DERUTCTime,m=t.DERGeneralizedTime,y=t.DERVisibleString,v=t.DERBMPString,b=t.DERSequence,w=t.DERSet,S=t.DERTaggedObject,A=t.ASN1Util.newObject;if(e instanceof t.ASN1Object)return e;var x=Object.keys(e);if(1!=x.length)throw new Error("key of param shall be only one.");var E=x[0];if(-1==":asn1:bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:visstr:bmpstr:seq:set:tag:".indexOf(":"+E+":"))throw new Error("undefined key: "+E);if("bool"==E)return new n(e[E]);if("int"==E)return new i(e[E]);if("bitstr"==E)return new s(e[E]);if("octstr"==E)return new a(e[E]);if("null"==E)return new o(e[E]);if("oid"==E)return new u(e[E]);if("enum"==E)return new h(e[E]);if("utf8str"==E)return new l(e[E]);if("numstr"==E)return new c(e[E]);if("prnstr"==E)return new f(e[E]);if("telstr"==E)return new g(e[E]);if("ia5str"==E)return new d(e[E]);if("utctime"==E)return new p(e[E]);if("gentime"==E)return new m(e[E]);if("visstr"==E)return new y(e[E]);if("bmpstr"==E)return new v(e[E]);if("asn1"==E)return new r(e[E]);if("seq"==E){for(var B=e[E],k=[],C=0;C<B.length;C++){var I=A(B[C]);k.push(I)}return new b({array:k})}if("set"==E){for(B=e[E],k=[],C=0;C<B.length;C++){I=A(B[C]);k.push(I)}return new w({array:k})}if("tag"==E){var F=e[E];if("[object Array]"===Object.prototype.toString.call(F)&&3==F.length){var P=A(F[2]);return new S({tag:F[0],explicit:F[1],obj:P})}return new S(F)}},this.jsonToASN1HEX=function(e){return this.newObject(e).getEncodedHex()}},ue.asn1.ASN1Util.oidHexToInt=function(e){for(var t="",r=parseInt(e.substr(0,2),16),n=(t=Math.floor(r/40)+"."+r%40,""),i=2;i<e.length;i+=2){var s=("00000000"+parseInt(e.substr(i,2),16).toString(2)).slice(-8);if(n+=s.substr(1,7),"0"==s.substr(0,1))t=t+"."+new S(n,2).toString(10),n=""}return t},ue.asn1.ASN1Util.oidIntToHex=function(e){var t=function(e){var t=e.toString(16);return 1==t.length&&(t="0"+t),t},r=function(e){var r="",n=new S(e,10).toString(2),i=7-n.length%7;7==i&&(i=0);for(var s="",a=0;a<i;a++)s+="0";n=s+n;for(a=0;a<n.length-1;a+=7){var o=n.substr(a,7);a!=n.length-7&&(o="1"+o),r+=t(parseInt(o,2))}return r};if(!e.match(/^[0-9.]+$/))throw"malformed oid string: "+e;var n="",i=e.split("."),s=40*parseInt(i[0])+parseInt(i[1]);n+=t(s),i.splice(0,2);for(var a=0;a<i.length;a++)n+=r(i[a]);return n},ue.asn1.ASN1Object=function(e){this.params=null,this.getLengthHexFromValue=function(){if(void 0===this.hV||null==this.hV)throw new Error("this.hV is null or undefined");if(this.hV.length%2==1)throw new Error("value hex must be even length: n="+"".length+",v="+this.hV);var e=this.hV.length/2,t=e.toString(16);if(t.length%2==1&&(t="0"+t),e<128)return t;var r=t.length/2;if(r>15)throw"ASN.1 length too long to represent by 8x: n = "+e.toString(16);return(128+r).toString(16)+t},this.getEncodedHex=function(){return(null==this.hTLV||this.isModified)&&(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV},this.getValueHex=function(){return this.getEncodedHex(),this.hV},this.getFreshValueHex=function(){return""},this.setByParam=function(e){this.params=e},null!=e&&null!=e.tlv&&(this.hTLV=e.tlv,this.isModified=!1)},ue.asn1.DERAbstractString=function(e){ue.asn1.DERAbstractString.superclass.constructor.call(this);this.getString=function(){return this.s},this.setString=function(e){this.hTLV=null,this.isModified=!0,this.s=e,this.hV=we(this.s).toLowerCase()},this.setStringHex=function(e){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=e},this.getFreshValueHex=function(){return this.hV},void 0!==e&&("string"==typeof e?this.setString(e):void 0!==e.str?this.setString(e.str):void 0!==e.hex&&this.setStringHex(e.hex))},Je(ue.asn1.DERAbstractString,ue.asn1.ASN1Object),ue.asn1.DERAbstractTime=function(e){ue.asn1.DERAbstractTime.superclass.constructor.call(this);this.localDateToUTC=function(e){var t=e.getTime()+6e4*e.getTimezoneOffset();return new Date(t)},this.formatDate=function(e,t,r){var n=this.zeroPadding,i=this.localDateToUTC(e),s=String(i.getFullYear());"utc"==t&&(s=s.substr(2,2));var a=s+n(String(i.getMonth()+1),2)+n(String(i.getDate()),2)+n(String(i.getHours()),2)+n(String(i.getMinutes()),2)+n(String(i.getSeconds()),2);if(!0===r){var o=i.getMilliseconds();if(0!=o){var u=n(String(o),3);a=a+"."+(u=u.replace(/[0]+$/,""))}}return a+"Z"},this.zeroPadding=function(e,t){return e.length>=t?e:new Array(t-e.length+1).join("0")+e},this.getString=function(){return this.s},this.setString=function(e){this.hTLV=null,this.isModified=!0,this.s=e,this.hV=pe(e)},this.setByDateValue=function(e,t,r,n,i,s){var a=new Date(Date.UTC(e,t-1,r,n,i,s,0));this.setByDate(a)},this.getFreshValueHex=function(){return this.hV}},Je(ue.asn1.DERAbstractTime,ue.asn1.ASN1Object),ue.asn1.DERAbstractStructured=function(e){ue.asn1.DERAbstractString.superclass.constructor.call(this);this.setByASN1ObjectArray=function(e){this.hTLV=null,this.isModified=!0,this.asn1Array=e},this.appendASN1Object=function(e){this.hTLV=null,this.isModified=!0,this.asn1Array.push(e)},this.asn1Array=new Array,void 0!==e&&void 0!==e.array&&(this.asn1Array=e.array)},Je(ue.asn1.DERAbstractStructured,ue.asn1.ASN1Object),ue.asn1.DERBoolean=function(e){ue.asn1.DERBoolean.superclass.constructor.call(this),this.hT="01",this.hTLV=0==e?"010100":"0101ff"},Je(ue.asn1.DERBoolean,ue.asn1.ASN1Object),ue.asn1.DERInteger=function(e){ue.asn1.DERInteger.superclass.constructor.call(this),this.hT="02",this.setByBigInteger=function(e){this.hTLV=null,this.isModified=!0,this.hV=ue.asn1.ASN1Util.bigIntToMinTwosComplementsHex(e)},this.setByInteger=function(e){var t=new S(String(e),10);this.setByBigInteger(t)},this.setValueHex=function(e){this.hV=e},this.getFreshValueHex=function(){return this.hV},void 0!==e&&(void 0!==e.bigint?this.setByBigInteger(e.bigint):void 0!==e.int?this.setByInteger(e.int):"number"==typeof e?this.setByInteger(e):void 0!==e.hex&&this.setValueHex(e.hex))},Je(ue.asn1.DERInteger,ue.asn1.ASN1Object),ue.asn1.DERBitString=function(e){if(void 0!==e&&void 0!==e.obj){var t=ue.asn1.ASN1Util.newObject(e.obj);e.hex="00"+t.getEncodedHex()}ue.asn1.DERBitString.superclass.constructor.call(this),this.hT="03",this.setHexValueIncludingUnusedBits=function(e){this.hTLV=null,this.isModified=!0,this.hV=e},this.setUnusedBitsAndHexValue=function(e,t){if(e<0||7<e)throw"unused bits shall be from 0 to 7: u = "+e;var r="0"+e;this.hTLV=null,this.isModified=!0,this.hV=r+t},this.setByBinaryString=function(e){var t=8-(e=e.replace(/0+$/,"")).length%8;8==t&&(t=0);for(var r=0;r<=t;r++)e+="0";var n="";for(r=0;r<e.length-1;r+=8){var i=e.substr(r,8),s=parseInt(i,2).toString(16);1==s.length&&(s="0"+s),n+=s}this.hTLV=null,this.isModified=!0,this.hV="0"+t+n},this.setByBooleanArray=function(e){for(var t="",r=0;r<e.length;r++)1==e[r]?t+="1":t+="0";this.setByBinaryString(t)},this.newFalseArray=function(e){for(var t=new Array(e),r=0;r<e;r++)t[r]=!1;return t},this.getFreshValueHex=function(){return this.hV},void 0!==e&&("string"==typeof e&&e.toLowerCase().match(/^[0-9a-f]+$/)?this.setHexValueIncludingUnusedBits(e):void 0!==e.hex?this.setHexValueIncludingUnusedBits(e.hex):void 0!==e.bin?this.setByBinaryString(e.bin):void 0!==e.array&&this.setByBooleanArray(e.array))},Je(ue.asn1.DERBitString,ue.asn1.ASN1Object),ue.asn1.DEROctetString=function(e){if(void 0!==e&&void 0!==e.obj){var t=ue.asn1.ASN1Util.newObject(e.obj);e.hex=t.getEncodedHex()}ue.asn1.DEROctetString.superclass.constructor.call(this,e),this.hT="04"},Je(ue.asn1.DEROctetString,ue.asn1.DERAbstractString),ue.asn1.DERNull=function(){ue.asn1.DERNull.superclass.constructor.call(this),this.hT="05",this.hTLV="0500"},Je(ue.asn1.DERNull,ue.asn1.ASN1Object),ue.asn1.DERObjectIdentifier=function(e){ue.asn1.DERObjectIdentifier.superclass.constructor.call(this),this.hT="06",this.setValueHex=function(e){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=e},this.setValueOidString=function(e){var t=_e(e);if(null==t)throw new Error("malformed oid string: "+e);this.hTLV=null,this.isModified=!0,this.s=null,this.hV=t},this.setValueName=function(e){var t=ue.asn1.x509.OID.name2oid(e);if(""===t)throw new Error("DERObjectIdentifier oidName undefined: "+e);this.setValueOidString(t)},this.setValueNameOrOid=function(e){e.match(/^[0-2].[0-9.]+$/)?this.setValueOidString(e):this.setValueName(e)},this.getFreshValueHex=function(){return this.hV},this.setByParam=function(e){"string"==typeof e?this.setValueNameOrOid(e):void 0!==e.oid?this.setValueNameOrOid(e.oid):void 0!==e.name?this.setValueNameOrOid(e.name):void 0!==e.hex&&this.setValueHex(e.hex)},void 0!==e&&this.setByParam(e)},Je(ue.asn1.DERObjectIdentifier,ue.asn1.ASN1Object),ue.asn1.DEREnumerated=function(e){ue.asn1.DEREnumerated.superclass.constructor.call(this),this.hT="0a",this.setByBigInteger=function(e){this.hTLV=null,this.isModified=!0,this.hV=ue.asn1.ASN1Util.bigIntToMinTwosComplementsHex(e)},this.setByInteger=function(e){var t=new S(String(e),10);this.setByBigInteger(t)},this.setValueHex=function(e){this.hV=e},this.getFreshValueHex=function(){return this.hV},void 0!==e&&(void 0!==e.int?this.setByInteger(e.int):"number"==typeof e?this.setByInteger(e):void 0!==e.hex&&this.setValueHex(e.hex))},Je(ue.asn1.DEREnumerated,ue.asn1.ASN1Object),ue.asn1.DERUTF8String=function(e){ue.asn1.DERUTF8String.superclass.constructor.call(this,e),this.hT="0c"},Je(ue.asn1.DERUTF8String,ue.asn1.DERAbstractString),ue.asn1.DERNumericString=function(e){ue.asn1.DERNumericString.superclass.constructor.call(this,e),this.hT="12"},Je(ue.asn1.DERNumericString,ue.asn1.DERAbstractString),ue.asn1.DERPrintableString=function(e){ue.asn1.DERPrintableString.superclass.constructor.call(this,e),this.hT="13"},Je(ue.asn1.DERPrintableString,ue.asn1.DERAbstractString),ue.asn1.DERTeletexString=function(e){ue.asn1.DERTeletexString.superclass.constructor.call(this,e),this.hT="14"},Je(ue.asn1.DERTeletexString,ue.asn1.DERAbstractString),ue.asn1.DERIA5String=function(e){ue.asn1.DERIA5String.superclass.constructor.call(this,e),this.hT="16"},Je(ue.asn1.DERIA5String,ue.asn1.DERAbstractString),ue.asn1.DERVisibleString=function(e){ue.asn1.DERIA5String.superclass.constructor.call(this,e),this.hT="1a"},Je(ue.asn1.DERVisibleString,ue.asn1.DERAbstractString),ue.asn1.DERBMPString=function(e){ue.asn1.DERBMPString.superclass.constructor.call(this,e),this.hT="1e"},Je(ue.asn1.DERBMPString,ue.asn1.DERAbstractString),ue.asn1.DERUTCTime=function(e){ue.asn1.DERUTCTime.superclass.constructor.call(this,e),this.hT="17",this.setByDate=function(e){this.hTLV=null,this.isModified=!0,this.date=e,this.s=this.formatDate(this.date,"utc"),this.hV=pe(this.s)},this.getFreshValueHex=function(){return void 0===this.date&&void 0===this.s&&(this.date=new Date,this.s=this.formatDate(this.date,"utc"),this.hV=pe(this.s)),this.hV},void 0!==e&&(void 0!==e.str?this.setString(e.str):"string"==typeof e&&e.match(/^[0-9]{12}Z$/)?this.setString(e):void 0!==e.hex?this.setStringHex(e.hex):void 0!==e.date&&this.setByDate(e.date))},Je(ue.asn1.DERUTCTime,ue.asn1.DERAbstractTime),ue.asn1.DERGeneralizedTime=function(e){ue.asn1.DERGeneralizedTime.superclass.constructor.call(this,e),this.hT="18",this.withMillis=!1,this.setByDate=function(e){this.hTLV=null,this.isModified=!0,this.date=e,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=pe(this.s)},this.getFreshValueHex=function(){return void 0===this.date&&void 0===this.s&&(this.date=new Date,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=pe(this.s)),this.hV},void 0!==e&&(void 0!==e.str?this.setString(e.str):"string"==typeof e&&e.match(/^[0-9]{14}Z$/)?this.setString(e):void 0!==e.hex?this.setStringHex(e.hex):void 0!==e.date&&this.setByDate(e.date),!0===e.millis&&(this.withMillis=!0))},Je(ue.asn1.DERGeneralizedTime,ue.asn1.DERAbstractTime),ue.asn1.DERSequence=function(e){ue.asn1.DERSequence.superclass.constructor.call(this,e),this.hT="30",this.getFreshValueHex=function(){for(var e="",t=0;t<this.asn1Array.length;t++){e+=this.asn1Array[t].getEncodedHex()}return this.hV=e,this.hV}},Je(ue.asn1.DERSequence,ue.asn1.DERAbstractStructured),ue.asn1.DERSet=function(e){ue.asn1.DERSet.superclass.constructor.call(this,e),this.hT="31",this.sortFlag=!0,this.getFreshValueHex=function(){for(var e=new Array,t=0;t<this.asn1Array.length;t++){var r=this.asn1Array[t];e.push(r.getEncodedHex())}return 1==this.sortFlag&&e.sort(),this.hV=e.join(""),this.hV},void 0!==e&&void 0!==e.sortflag&&0==e.sortflag&&(this.sortFlag=!1)},Je(ue.asn1.DERSet,ue.asn1.DERAbstractStructured),ue.asn1.DERTaggedObject=function(e){ue.asn1.DERTaggedObject.superclass.constructor.call(this);var t=ue.asn1;this.hT="a0",this.hV="",this.isExplicit=!0,this.asn1Object=null,this.setASN1Object=function(e,t,r){this.hT=t,this.isExplicit=e,this.asn1Object=r,this.isExplicit?(this.hV=this.asn1Object.getEncodedHex(),this.hTLV=null,this.isModified=!0):(this.hV=null,this.hTLV=r.getEncodedHex(),this.hTLV=this.hTLV.replace(/^../,t),this.isModified=!1)},this.getFreshValueHex=function(){return this.hV},this.setByParam=function(e){null!=e.tag&&(this.hT=e.tag),null!=e.explicit&&(this.isExplicit=e.explicit),null!=e.tage&&(this.hT=e.tage,this.isExplicit=!0),null!=e.tagi&&(this.hT=e.tagi,this.isExplicit=!1),null!=e.obj&&(e.obj instanceof t.ASN1Object?(this.asn1Object=e.obj,this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)):"object"==typeof e.obj&&(this.asn1Object=t.ASN1Util.newObject(e.obj),this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)))},null!=e&&this.setByParam(e)},Je(ue.asn1.DERTaggedObject,ue.asn1.ASN1Object);var ue,he,le,ce=new function(){};function fe(e){for(var t=new Array,r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}function ge(e){for(var t="",r=0;r<e.length;r++)String.fromCharCode(e[r]);return t}function de(e){for(var t="",r=0;r<e.length;r++){var n=e[r].toString(16);1==n.length&&(n="0"+n),t+=n}return t}function pe(e){return de(fe(e))}function me(e){return e=(e=(e=e.replace(/\=/g,"")).replace(/\+/g,"-")).replace(/\//g,"_")}function ye(e){return e.length%4==2?e+="==":e.length%4==3&&(e+="="),e=(e=e.replace(/-/g,"+")).replace(/_/g,"/")}function ve(e){return e.length%2==1&&(e="0"+e),me(v(e))}function be(e){return b(ye(e))}function we(e){return Ne(Le(e))}function Se(e){return decodeURIComponent(De(e))}function Ae(e){for(var t="",r=0;r<e.length-1;r+=2)t+=String.fromCharCode(parseInt(e.substr(r,2),16));return t}function xe(e){for(var t="",r=0;r<e.length;r++)t+=("0"+e.charCodeAt(r).toString(16)).slice(-2);return t}function Ee(e){return v(e)}function Be(e){var t=Ee(e).replace(/(.{64})/g,"$1\r\n");return t=t.replace(/\r\n$/,"")}function ke(e){return b(e.replace(/[^0-9A-Za-z\/+=]*/g,""))}function Ce(e,t){return"-----BEGIN "+t+"-----\r\n"+Be(e)+"\r\n-----END "+t+"-----\r\n"}function Ie(e,t){if(-1==e.indexOf("-----BEGIN "))throw"can't find PEM header: "+t;return ke(e=void 0!==t?(e=e.replace(new RegExp("^[^]*-----BEGIN "+t+"-----"),"")).replace(new RegExp("-----END "+t+"-----[^]*$"),""):(e=e.replace(/^[^]*-----BEGIN [^-]+-----/,"")).replace(/-----END [^-]+-----[^]*$/,""))}function Fe(e){var t,r,n,i,s,a,o,u,h,l,c;if(c=e.match(/^(\d{2}|\d{4})(\d\d)(\d\d)(\d\d)(\d\d)(\d\d)(|\.\d+)Z$/))return u=c[1],t=parseInt(u),2===u.length&&(50<=t&&t<100?t=1900+t:0<=t&&t<50&&(t=2e3+t)),r=parseInt(c[2])-1,n=parseInt(c[3]),i=parseInt(c[4]),s=parseInt(c[5]),a=parseInt(c[6]),o=0,""!==(h=c[7])&&(l=(h.substr(1)+"00").substr(0,3),o=parseInt(l)),Date.UTC(t,r,n,i,s,a,o);throw"unsupported zulu format: "+e}function Pe(e){return~~(Fe(e)/1e3)}function Ne(e){return e.replace(/%/g,"")}function De(e){return e.replace(/(..)/g,"%$1")}function He(e){var t="malformed IPv6 address";if(!e.match(/^[0-9A-Fa-f:]+$/))throw t;var r=(e=e.toLowerCase()).split(":").length-1;if(r<2)throw t;var n=":".repeat(7-r+2),i=(e=e.replace("::",n)).split(":");if(8!=i.length)throw t;for(var s=0;s<8;s++)i[s]=("0000"+i[s]).slice(-4);return i.join("")}function Re(e){if(!e.match(/^[0-9A-Fa-f]{32}$/))throw"malformed IPv6 address octet";for(var t=(e=e.toLowerCase()).match(/.{1,4}/g),r=0;r<8;r++)t[r]=t[r].replace(/^0+/,""),""==t[r]&&(t[r]="0");var n=(e=":"+t.join(":")+":").match(/:(0:){2,}/g);if(null===n)return e.slice(1,-1);var i="";for(r=0;r<n.length;r++)n[r].length>i.length&&(i=n[r]);return(e=e.replace(i,"::")).slice(1,-1)}function Oe(e){var t="malformed hex value";if(!e.match(/^([0-9A-Fa-f][0-9A-Fa-f]){1,}$/))throw t;if(8!=e.length)return 32==e.length?Re(e):e;try{return parseInt(e.substr(0,2),16)+"."+parseInt(e.substr(2,2),16)+"."+parseInt(e.substr(4,2),16)+"."+parseInt(e.substr(6,2),16)}catch(e){throw t}}function Te(e){return e.match(/.{4}/g).map((function(e){var t=parseInt(e.substr(0,2),16),r=parseInt(e.substr(2),16);if(0==t&r<128)return String.fromCharCode(r);if(t<8){var n=128|63&r;return Se((192|(7&t)<<3|(192&r)>>6).toString(16)+n.toString(16))}n=128|(15&t)<<2|(192&r)>>6;var i=128|63&r;return Se((224|(240&t)>>4).toString(16)+n.toString(16)+i.toString(16))})).join("")}function Le(e){for(var t=encodeURIComponent(e),r="",n=0;n<t.length;n++)"%"==t[n]?(r+=t.substr(n,3),n+=2):r=r+"%"+pe(t[n]);return r}function je(e){return!(e.length%2!=0||!e.match(/^[0-9a-f]+$/)&&!e.match(/^[0-9A-F]+$/))}function Ve(e){return e.length%2==1?"0"+e:e.substr(0,1)>"7"?"00"+e:e}function Ue(e){e=(e=(e=e.replace(/^\s*\[\s*/,"")).replace(/\s*\]\s*$/,"")).replace(/\s*/g,"");try{return e.split(/,/).map((function(e,t,r){var n=parseInt(e);if(n<0||255<n)throw"integer not in range 0-255";return("00"+n.toString(16)).slice(-2)})).join("")}catch(e){throw"malformed integer array string: "+e}}ce.getLblen=function(e,t){if("8"!=e.substr(t+2,1))return 1;var r=parseInt(e.substr(t+3,1));return 0==r?-1:0<r&&r<10?r+1:-2},ce.getL=function(e,t){var r=ce.getLblen(e,t);return r<1?"":e.substr(t+2,2*r)},ce.getVblen=function(e,t){var r;return""==(r=ce.getL(e,t))?-1:("8"===r.substr(0,1)?new S(r.substr(2),16):new S(r,16)).intValue()},ce.getVidx=function(e,t){var r=ce.getLblen(e,t);return r<0?r:t+2*(r+1)},ce.getV=function(e,t){var r=ce.getVidx(e,t),n=ce.getVblen(e,t);return e.substr(r,2*n)},ce.getTLV=function(e,t){return e.substr(t,2)+ce.getL(e,t)+ce.getV(e,t)},ce.getTLVblen=function(e,t){return 2+2*ce.getLblen(e,t)+2*ce.getVblen(e,t)},ce.getNextSiblingIdx=function(e,t){return ce.getVidx(e,t)+2*ce.getVblen(e,t)},ce.getChildIdx=function(e,t){var r,n,i,s=ce,a=[];r=s.getVidx(e,t),n=2*s.getVblen(e,t),"03"==e.substr(t,2)&&(r+=2,n-=2),i=0;for(var o=r;i<=n;){var u=s.getTLVblen(e,o);if((i+=u)<=n&&a.push(o),o+=u,i>=n)break}return a},ce.getNthChildIdx=function(e,t,r){return ce.getChildIdx(e,t)[r]},ce.getIdxbyList=function(e,t,r,n){var i,s,a=ce;return 0==r.length?void 0!==n&&e.substr(t,2)!==n?-1:t:(i=r.shift())>=(s=a.getChildIdx(e,t)).length?-1:a.getIdxbyList(e,s[i],r,n)},ce.getIdxbyListEx=function(e,t,r,n){var i,s,a=ce;if(0==r.length)return void 0!==n&&e.substr(t,2)!==n?-1:t;i=r.shift(),s=a.getChildIdx(e,t);for(var o=0,u=0;u<s.length;u++){var h=e.substr(s[u],2);if("number"==typeof i&&!a.isContextTag(h)&&o==i||"string"==typeof i&&a.isContextTag(h,i))return a.getIdxbyListEx(e,s[u],r,n);a.isContextTag(h)||o++}return-1},ce.getTLVbyList=function(e,t,r,n){var i=ce,s=i.getIdxbyList(e,t,r,n);return-1==s||s>=e.length?null:i.getTLV(e,s)},ce.getTLVbyListEx=function(e,t,r,n){var i=ce,s=i.getIdxbyListEx(e,t,r,n);return-1==s?null:i.getTLV(e,s)},ce.getVbyList=function(e,t,r,n,i){var s,a,o=ce;return-1==(s=o.getIdxbyList(e,t,r,n))||s>=e.length?null:(a=o.getV(e,s),!0===i&&(a=a.substr(2)),a)},ce.getVbyListEx=function(e,t,r,n,i){var s,a,o=ce;return-1==(s=o.getIdxbyListEx(e,t,r,n))?null:(a=o.getV(e,s),"03"==e.substr(s,2)&&!1!==i&&(a=a.substr(2)),a)},ce.getInt=function(e,t,r){null==r&&(r=-1);try{var n=e.substr(t,2);if("02"!=n&&"03"!=n)return r;var i=ce.getV(e,t);return"02"==n?parseInt(i,16):qe(i)}catch(e){return r}},ce.getOID=function(e,t,r){null==r&&(r=null);try{return"06"!=e.substr(t,2)?r:Ke(ce.getV(e,t))}catch(e){return r}},ce.getOIDName=function(e,t,r){null==r&&(r=null);try{var n=ce.getOID(e,t,r);if(n==r)return r;var i=ue.asn1.x509.OID.oid2name(n);return""==i?n:i}catch(e){return r}},ce.getString=function(e,t,r){null==r&&(r=null);try{return Ae(ce.getV(e,t))}catch(e){return r}},ce.hextooidstr=function(e){var t=function(e,t){return e.length>=t?e:new Array(t-e.length+1).join("0")+e},r=[],n=e.substr(0,2),i=parseInt(n,16);r[0]=new String(Math.floor(i/40)),r[1]=new String(i%40);for(var s=e.substr(2),a=[],o=0;o<s.length/2;o++)a.push(parseInt(s.substr(2*o,2),16));var u=[],h="";for(o=0;o<a.length;o++)128&a[o]?h+=t((127&a[o]).toString(2),7):(h+=t((127&a[o]).toString(2),7),u.push(new String(parseInt(h,2))),h="");var l=r.join(".");return u.length>0&&(l=l+"."+u.join(".")),l},ce.dump=function(e,t,r,n){var i=ce,s=i.getV,a=i.dump,o=i.getChildIdx,u=e;e instanceof ue.asn1.ASN1Object&&(u=e.getEncodedHex());var h=function(e,t){return e.length<=2*t?e:e.substr(0,t)+"..(total "+e.length/2+"bytes).."+e.substr(e.length-t,t)};void 0===t&&(t={ommit_long_octet:32}),void 0===r&&(r=0),void 0===n&&(n="");var l,c=t.ommit_long_octet;if("01"==(l=u.substr(r,2)))return"00"==(f=s(u,r))?n+"BOOLEAN FALSE\n":n+"BOOLEAN TRUE\n";if("02"==l)return n+"INTEGER "+h(f=s(u,r),c)+"\n";if("03"==l){var f=s(u,r);if(i.isASN1HEX(f.substr(2))){var g=n+"BITSTRING, encapsulates\n";return g+=a(f.substr(2),t,0,n+"  ")}return n+"BITSTRING "+h(f,c)+"\n"}if("04"==l){f=s(u,r);if(i.isASN1HEX(f)){g=n+"OCTETSTRING, encapsulates\n";return g+=a(f,t,0,n+"  ")}return n+"OCTETSTRING "+h(f,c)+"\n"}if("05"==l)return n+"NULL\n";if("06"==l){var d=s(u,r),p=ue.asn1.ASN1Util.oidHexToInt(d),m=ue.asn1.x509.OID.oid2name(p),y=p.replace(/\./g," ");return""!=m?n+"ObjectIdentifier "+m+" ("+y+")\n":n+"ObjectIdentifier ("+y+")\n"}if("0a"==l)return n+"ENUMERATED "+parseInt(s(u,r))+"\n";if("0c"==l)return n+"UTF8String '"+Se(s(u,r))+"'\n";if("13"==l)return n+"PrintableString '"+Se(s(u,r))+"'\n";if("14"==l)return n+"TeletexString '"+Se(s(u,r))+"'\n";if("16"==l)return n+"IA5String '"+Se(s(u,r))+"'\n";if("17"==l)return n+"UTCTime "+Se(s(u,r))+"\n";if("18"==l)return n+"GeneralizedTime "+Se(s(u,r))+"\n";if("1a"==l)return n+"VisualString '"+Se(s(u,r))+"'\n";if("1e"==l)return n+"BMPString '"+Te(s(u,r))+"'\n";if("30"==l){if("3000"==u.substr(r,4))return n+"SEQUENCE {}\n";g=n+"SEQUENCE\n";var v=t;if((2==(S=o(u,r)).length||3==S.length)&&"06"==u.substr(S[0],2)&&"04"==u.substr(S[S.length-1],2)){m=i.oidname(s(u,S[0]));var b=JSON.parse(JSON.stringify(t));b.x509ExtName=m,v=b}for(var w=0;w<S.length;w++)g+=a(u,v,S[w],n+"  ");return g}if("31"==l){g=n+"SET\n";var S=o(u,r);for(w=0;w<S.length;w++)g+=a(u,t,S[w],n+"  ");return g}if(0!=(128&(l=parseInt(l,16)))){var A=31&l;if(0!=(32&l)){for(g=n+"["+A+"]\n",S=o(u,r),w=0;w<S.length;w++)g+=a(u,t,S[w],n+"  ");return g}f=s(u,r);if(ce.isASN1HEX(f)){var g=n+"["+A+"]\n";return g+=a(f,t,0,n+"  ")}return("68747470"==f.substr(0,8)||"subjectAltName"===t.x509ExtName&&2==A)&&(f=Se(f)),g=n+"["+A+"] "+f+"\n"}return n+"UNKNOWN("+l+") "+s(u,r)+"\n"},ce.isContextTag=function(e,t){var r,n;e=e.toLowerCase();try{r=parseInt(e,16)}catch(e){return-1}if(void 0===t)return 128==(192&r);try{return null!=t.match(/^\[[0-9]+\]$/)&&(!((n=parseInt(t.substr(1,t.length-1),10))>31)&&(128==(192&r)&&(31&r)==n))}catch(e){return!1}},ce.isASN1HEX=function(e){var t=ce;if(e.length%2==1)return!1;var r=t.getVblen(e,0),n=e.substr(0,2),i=t.getL(e,0);return e.length-n.length-i.length==2*r},ce.checkStrictDER=function(e,t,r,n,i){var s=ce;if(void 0===r){if("string"!=typeof e)throw new Error("not hex string");if(e=e.toLowerCase(),!ue.lang.String.isHex(e))throw new Error("not hex string");r=e.length,i=(n=e.length/2)<128?1:Math.ceil(n.toString(16))+1}if(s.getL(e,t).length>2*i)throw new Error("L of TLV too long: idx="+t);var a=s.getVblen(e,t);if(a>n)throw new Error("value of L too long than hex: idx="+t);var o=s.getTLV(e,t),u=o.length-2-s.getL(e,t).length;if(u!==2*a)throw new Error("V string length and L's value not the same:"+u+"/"+2*a);if(0===t&&e.length!=o.length)throw new Error("total length and TLV length unmatch:"+e.length+"!="+o.length);var h=e.substr(t,2);if("02"===h){var l=s.getVidx(e,t);if("00"==e.substr(l,2)&&e.charCodeAt(l+2)<56)throw new Error("not least zeros for DER INTEGER")}if(32&parseInt(h,16)){for(var c=s.getVblen(e,t),f=0,g=s.getChildIdx(e,t),d=0;d<g.length;d++){f+=s.getTLV(e,g[d]).length,s.checkStrictDER(e,g[d],r,n,i)}if(2*c!=f)throw new Error("sum of children's TLV length and L unmatch: "+2*c+"!="+f)}},ce.oidname=function(e){var t=ue.asn1;ue.lang.String.isHex(e)&&(e=t.ASN1Util.oidHexToInt(e));var r=t.x509.OID.oid2name(e);return""===r&&(r=e),r},void 0!==ue&&ue||(ue={}),void 0!==ue.asn1&&ue.asn1||(ue.asn1={}),void 0!==ue.asn1.x509&&ue.asn1.x509||(ue.asn1.x509={}),ue.asn1.x509.Certificate=function(e){ue.asn1.x509.Certificate.superclass.constructor.call(this);var t=ue.asn1,r=t.DERBitString,n=t.DERSequence,i=t.x509,s=i.TBSCertificate,a=i.AlgorithmIdentifier;this.params=void 0,this.setByParam=function(e){this.params=e},this.sign=function(){var e=this.params,t=e.sigalg;null!=e.sigalg.name&&(t=e.sigalg.name);var r=e.tbsobj.getEncodedHex(),n=new ue.crypto.Signature({alg:t});n.init(e.cakey),n.updateHex(r),e.sighex=n.sign()},this.getPEM=function(){return Ce(this.getEncodedHex(),"CERTIFICATE")},this.getEncodedHex=function(){var e=this.params;if(null!=e.tbsobj&&null!=e.tbsobj||(e.tbsobj=new s(e)),null==e.sighex&&null!=e.cakey&&this.sign(),null==e.sighex)throw new Error("sighex or cakey parameter not defined");var t=[];return t.push(e.tbsobj),t.push(new a({name:e.sigalg})),t.push(new r({hex:"00"+e.sighex})),new n({array:t}).getEncodedHex()},null!=e&&(this.params=e)},Je(ue.asn1.x509.Certificate,ue.asn1.ASN1Object),ue.asn1.x509.TBSCertificate=function(e){ue.asn1.x509.TBSCertificate.superclass.constructor.call(this);var t=ue.asn1,r=t.x509,n=t.DERTaggedObject,i=t.DERInteger,s=t.DERSequence,a=r.AlgorithmIdentifier,o=r.Time,u=r.X500Name,h=r.Extensions,l=r.SubjectPublicKeyInfo;this.params=null,this.setByParam=function(e){this.params=e},this.getEncodedHex=function(){var e=[],t=this.params;if(null!=t.version||1!=t.version){var r=2;null!=t.version&&(r=t.version-1);var c=new n({obj:new i({int:r})});e.push(c)}return e.push(new i(t.serial)),e.push(new a({name:t.sigalg})),e.push(new u(t.issuer)),e.push(new s({array:[new o(t.notbefore),new o(t.notafter)]})),e.push(new u(t.subject)),e.push(new l($e.getKey(t.sbjpubkey))),void 0!==t.ext&&t.ext.length>0&&e.push(new n({tag:"a3",obj:new h(t.ext)})),new ue.asn1.DERSequence({array:e}).getEncodedHex()},void 0!==e&&this.setByParam(e)},Je(ue.asn1.x509.TBSCertificate,ue.asn1.ASN1Object),ue.asn1.x509.Extensions=function(e){ue.asn1.x509.Extensions.superclass.constructor.call(this);var t=ue.asn1,r=t.DERSequence,n=t.x509;this.aParam=[],this.setByParam=function(e){this.aParam=e},this.getEncodedHex=function(){for(var e=[],t=0;t<this.aParam.length;t++){var i=this.aParam[t],s=i.extname,a=null;if(null!=i.extn)a=new n.PrivateExtension(i);else if("subjectKeyIdentifier"==s)a=new n.SubjectKeyIdentifier(i);else if("keyUsage"==s)a=new n.KeyUsage(i);else if("subjectAltName"==s)a=new n.SubjectAltName(i);else if("issuerAltName"==s)a=new n.IssuerAltName(i);else if("basicConstraints"==s)a=new n.BasicConstraints(i);else if("cRLDistributionPoints"==s)a=new n.CRLDistributionPoints(i);else if("certificatePolicies"==s)a=new n.CertificatePolicies(i);else if("authorityKeyIdentifier"==s)a=new n.AuthorityKeyIdentifier(i);else if("extKeyUsage"==s)a=new n.ExtKeyUsage(i);else if("authorityInfoAccess"==s)a=new n.AuthorityInfoAccess(i);else if("cRLNumber"==s)a=new n.CRLNumber(i);else if("cRLReason"==s)a=new n.CRLReason(i);else if("ocspNonce"==s)a=new n.OCSPNonce(i);else if("ocspNoCheck"==s)a=new n.OCSPNoCheck(i);else if("adobeTimeStamp"==s)a=new n.AdobeTimeStamp(i);else{if("subjectDirectoryAttributes"!=s)throw new Error("extension not supported:"+JSON.stringify(i));a=new n.SubjectDirectoryAttributes(i)}null!=a&&e.push(a)}return new r({array:e}).getEncodedHex()},null!=e&&this.setByParam(e)},Je(ue.asn1.x509.Extensions,ue.asn1.ASN1Object),ue.asn1.x509.Extension=function(e){ue.asn1.x509.Extension.superclass.constructor.call(this);var t=ue.asn1,r=t.DERObjectIdentifier,n=t.DEROctetString,i=(t.DERBitString,t.DERBoolean),s=t.DERSequence;this.getEncodedHex=function(){var e=new r({oid:this.oid}),t=new n({hex:this.getExtnValueHex()}),a=new Array;return a.push(e),this.critical&&a.push(new i),a.push(t),new s({array:a}).getEncodedHex()},this.critical=!1,void 0!==e&&void 0!==e.critical&&(this.critical=e.critical)},Je(ue.asn1.x509.Extension,ue.asn1.ASN1Object),ue.asn1.x509.KeyUsage=function(e){ue.asn1.x509.KeyUsage.superclass.constructor.call(this,e);var t=Xe.KEYUSAGE_NAME;if(this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.15",void 0!==e&&(void 0!==e.bin&&(this.asn1ExtnValue=new ue.asn1.DERBitString(e)),void 0!==e.names&&void 0!==e.names.length)){for(var r=e.names,n="000000000",i=0;i<r.length;i++)for(var s=0;s<t.length;s++)r[i]===t[s]&&(n=n.substring(0,s)+"1"+n.substring(s+1,n.length));this.asn1ExtnValue=new ue.asn1.DERBitString({bin:n})}},Je(ue.asn1.x509.KeyUsage,ue.asn1.x509.Extension),ue.asn1.x509.BasicConstraints=function(e){ue.asn1.x509.BasicConstraints.superclass.constructor.call(this,e);var t=ue.asn1,r=t.DERBoolean,n=t.DERInteger,i=t.DERSequence;this.getExtnValueHex=function(){var e=new Array;this.cA&&e.push(new r),this.pathLen>-1&&e.push(new n({int:this.pathLen}));var t=new i({array:e});return this.asn1ExtnValue=t,this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.19",this.cA=!1,this.pathLen=-1,void 0!==e&&(void 0!==e.cA&&(this.cA=e.cA),void 0!==e.pathLen&&(this.pathLen=e.pathLen))},Je(ue.asn1.x509.BasicConstraints,ue.asn1.x509.Extension),ue.asn1.x509.CRLDistributionPoints=function(e){ue.asn1.x509.CRLDistributionPoints.superclass.constructor.call(this,e);var t=ue.asn1,r=t.x509;this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.setByDPArray=function(e){for(var n=[],i=0;i<e.length;i++)if(e[i]instanceof ue.asn1.ASN1Object)n.push(e[i]);else{var s=new r.DistributionPoint(e[i]);n.push(s)}this.asn1ExtnValue=new t.DERSequence({array:n})},this.setByOneURI=function(e){var t=new r.DistributionPoint({fulluri:e});this.setByDPArray([t])},this.oid="2.5.29.31",void 0!==e&&(void 0!==e.array?this.setByDPArray(e.array):void 0!==e.uri&&this.setByOneURI(e.uri))},Je(ue.asn1.x509.CRLDistributionPoints,ue.asn1.x509.Extension),ue.asn1.x509.DistributionPoint=function(e){ue.asn1.x509.DistributionPoint.superclass.constructor.call(this);var t=ue.asn1,r=t.x509.DistributionPointName;this.getEncodedHex=function(){var e=new t.DERSequence;if(null!=this.asn1DP){var r=new t.DERTaggedObject({explicit:!0,tag:"a0",obj:this.asn1DP});e.appendASN1Object(r)}return this.hTLV=e.getEncodedHex(),this.hTLV},void 0!==e&&(void 0!==e.dpobj?this.asn1DP=e.dpobj:void 0!==e.dpname?this.asn1DP=new r(e.dpname):void 0!==e.fulluri&&(this.asn1DP=new r({full:[{uri:e.fulluri}]})))},Je(ue.asn1.x509.DistributionPoint,ue.asn1.ASN1Object),ue.asn1.x509.DistributionPointName=function(e){ue.asn1.x509.DistributionPointName.superclass.constructor.call(this);var t=ue.asn1,r=t.DERTaggedObject;if(this.getEncodedHex=function(){if("full"!=this.type)throw new Error("currently type shall be 'full': "+this.type);return this.asn1Obj=new r({explicit:!1,tag:this.tag,obj:this.asn1V}),this.hTLV=this.asn1Obj.getEncodedHex(),this.hTLV},void 0!==e)if(t.x509.GeneralNames.prototype.isPrototypeOf(e))this.type="full",this.tag="a0",this.asn1V=e;else{if(void 0===e.full)throw new Error("This class supports GeneralNames only as argument");this.type="full",this.tag="a0",this.asn1V=new t.x509.GeneralNames(e.full)}},Je(ue.asn1.x509.DistributionPointName,ue.asn1.ASN1Object),ue.asn1.x509.CertificatePolicies=function(e){ue.asn1.x509.CertificatePolicies.superclass.constructor.call(this,e);var t=ue.asn1,r=t.x509,n=t.DERSequence,i=r.PolicyInformation;this.params=null,this.getExtnValueHex=function(){for(var e=[],t=0;t<this.params.array.length;t++)e.push(new i(this.params.array[t]));var r=new n({array:e});return this.asn1ExtnValue=r,this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.32",void 0!==e&&(this.params=e)},Je(ue.asn1.x509.CertificatePolicies,ue.asn1.x509.Extension),ue.asn1.x509.PolicyInformation=function(e){ue.asn1.x509.PolicyInformation.superclass.constructor.call(this,e);var t=ue.asn1,r=t.DERSequence,n=t.DERObjectIdentifier,i=t.x509.PolicyQualifierInfo;this.params=null,this.getEncodedHex=function(){if(void 0===this.params.policyoid&&void 0===this.params.array)throw new Error("parameter oid and array missing");var e=[new n(this.params.policyoid)];if(void 0!==this.params.array){for(var t=[],s=0;s<this.params.array.length;s++)t.push(new i(this.params.array[s]));t.length>0&&e.push(new r({array:t}))}return new r({array:e}).getEncodedHex()},void 0!==e&&(this.params=e)},Je(ue.asn1.x509.PolicyInformation,ue.asn1.ASN1Object),ue.asn1.x509.PolicyQualifierInfo=function(e){ue.asn1.x509.PolicyQualifierInfo.superclass.constructor.call(this,e);var t=ue.asn1,r=t.DERSequence,n=t.DERIA5String,i=t.DERObjectIdentifier,s=t.x509.UserNotice;this.params=null,this.getEncodedHex=function(){return void 0!==this.params.cps?new r({array:[new i({oid:"1.3.6.1.5.5.7.2.1"}),new n({str:this.params.cps})]}).getEncodedHex():null!=this.params.unotice?new r({array:[new i({oid:"1.3.6.1.5.5.7.2.2"}),new s(this.params.unotice)]}).getEncodedHex():void 0},void 0!==e&&(this.params=e)},Je(ue.asn1.x509.PolicyQualifierInfo,ue.asn1.ASN1Object),ue.asn1.x509.UserNotice=function(e){ue.asn1.x509.UserNotice.superclass.constructor.call(this,e);var t=ue.asn1.DERSequence,r=(ue.asn1.DERInteger,ue.asn1.x509.DisplayText),n=ue.asn1.x509.NoticeReference;this.params=null,this.getEncodedHex=function(){var e=[];return void 0!==this.params.noticeref&&e.push(new n(this.params.noticeref)),void 0!==this.params.exptext&&e.push(new r(this.params.exptext)),new t({array:e}).getEncodedHex()},void 0!==e&&(this.params=e)},Je(ue.asn1.x509.UserNotice,ue.asn1.ASN1Object),ue.asn1.x509.NoticeReference=function(e){ue.asn1.x509.NoticeReference.superclass.constructor.call(this,e);var t=ue.asn1.DERSequence,r=ue.asn1.DERInteger,n=ue.asn1.x509.DisplayText;this.params=null,this.getEncodedHex=function(){var e=[];if(void 0!==this.params.org&&e.push(new n(this.params.org)),void 0!==this.params.noticenum){for(var i=[],s=this.params.noticenum,a=0;a<s.length;a++)i.push(new r(s[a]));e.push(new t({array:i}))}if(0==e.length)throw new Error("parameter is empty");return new t({array:e}).getEncodedHex()},void 0!==e&&(this.params=e)},Je(ue.asn1.x509.NoticeReference,ue.asn1.ASN1Object),ue.asn1.x509.DisplayText=function(e){ue.asn1.x509.DisplayText.superclass.constructor.call(this,e),this.hT="0c",void 0!==e&&("ia5"===e.type?this.hT="16":"vis"===e.type?this.hT="1a":"bmp"===e.type&&(this.hT="1e"))},Je(ue.asn1.x509.DisplayText,ue.asn1.DERAbstractString),ue.asn1.x509.ExtKeyUsage=function(e){ue.asn1.x509.ExtKeyUsage.superclass.constructor.call(this,e);var t=ue.asn1;this.setPurposeArray=function(e){this.asn1ExtnValue=new t.DERSequence;for(var r=0;r<e.length;r++){var n=new t.DERObjectIdentifier(e[r]);this.asn1ExtnValue.appendASN1Object(n)}},this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.37",void 0!==e&&void 0!==e.array&&this.setPurposeArray(e.array)},Je(ue.asn1.x509.ExtKeyUsage,ue.asn1.x509.Extension),ue.asn1.x509.AuthorityKeyIdentifier=function(e){ue.asn1.x509.AuthorityKeyIdentifier.superclass.constructor.call(this,e);var t=ue,r=t.asn1,n=r.DERTaggedObject,i=r.x509.GeneralNames;t.crypto.Util.isKey;this.asn1KID=null,this.asn1CertIssuer=null,this.asn1CertSN=null,this.getExtnValueHex=function(){var e=new Array;this.asn1KID&&e.push(new n({explicit:!1,tag:"80",obj:this.asn1KID})),this.asn1CertIssuer&&e.push(new n({explicit:!1,tag:"a1",obj:new i([{dn:this.asn1CertIssuer}])})),this.asn1CertSN&&e.push(new n({explicit:!1,tag:"82",obj:this.asn1CertSN}));var t=new r.DERSequence({array:e});return this.asn1ExtnValue=t,this.asn1ExtnValue.getEncodedHex()},this.setKIDByParam=function(e){if(void 0!==e.str||void 0!==e.hex)this.asn1KID=new ue.asn1.DEROctetString(e);else if("object"==typeof e&&ue.crypto.Util.isKey(e)||"string"==typeof e&&-1!=e.indexOf("BEGIN ")){var t=e;"string"==typeof e&&(t=$e.getKey(e));var r=$e.getKeyID(t);this.asn1KID=new ue.asn1.DEROctetString({hex:r})}},this.setCertIssuerByParam=function(e){void 0!==e.str||void 0!==e.ldapstr||void 0!==e.hex||void 0!==e.certsubject||void 0!==e.certissuer?this.asn1CertIssuer=new ue.asn1.x509.X500Name(e):"string"==typeof e&&-1!=e.indexOf("BEGIN ")&&-1!=e.indexOf("CERTIFICATE")&&(this.asn1CertIssuer=new ue.asn1.x509.X500Name({certissuer:e}))},this.setCertSNByParam=function(e){if(void 0!==e.str||void 0!==e.bigint||void 0!==e.hex)this.asn1CertSN=new ue.asn1.DERInteger(e);else if("string"==typeof e&&-1!=e.indexOf("BEGIN ")&&e.indexOf("CERTIFICATE")){var t=new Xe;t.readCertPEM(e);var r=t.getSerialNumberHex();this.asn1CertSN=new ue.asn1.DERInteger({hex:r})}},this.oid="2.5.29.35",void 0!==e&&(void 0!==e.kid&&this.setKIDByParam(e.kid),void 0!==e.issuer&&this.setCertIssuerByParam(e.issuer),void 0!==e.sn&&this.setCertSNByParam(e.sn),void 0!==e.issuersn&&"string"==typeof e.issuersn&&-1!=e.issuersn.indexOf("BEGIN ")&&e.issuersn.indexOf("CERTIFICATE")&&(this.setCertSNByParam(e.issuersn),this.setCertIssuerByParam(e.issuersn)))},Je(ue.asn1.x509.AuthorityKeyIdentifier,ue.asn1.x509.Extension),ue.asn1.x509.SubjectKeyIdentifier=function(e){ue.asn1.x509.SubjectKeyIdentifier.superclass.constructor.call(this,e);var t=ue.asn1.DEROctetString;this.asn1KID=null,this.getExtnValueHex=function(){return this.asn1ExtnValue=this.asn1KID,this.asn1ExtnValue.getEncodedHex()},this.setKIDByParam=function(e){if(void 0!==e.str||void 0!==e.hex)this.asn1KID=new t(e);else if("object"==typeof e&&ue.crypto.Util.isKey(e)||"string"==typeof e&&-1!=e.indexOf("BEGIN")){var r=e;"string"==typeof e&&(r=$e.getKey(e));var n=$e.getKeyID(r);this.asn1KID=new ue.asn1.DEROctetString({hex:n})}},this.oid="2.5.29.14",void 0!==e&&void 0!==e.kid&&this.setKIDByParam(e.kid)},Je(ue.asn1.x509.SubjectKeyIdentifier,ue.asn1.x509.Extension),ue.asn1.x509.AuthorityInfoAccess=function(e){ue.asn1.x509.AuthorityInfoAccess.superclass.constructor.call(this,e),this.setAccessDescriptionArray=function(e){for(var t=new Array,r=ue.asn1,n=r.DERSequence,i=r.DERObjectIdentifier,s=r.x509.GeneralName,a=0;a<e.length;a++){var o,u=e[a];if(void 0!==u.ocsp)o=new n({array:[new i({oid:"1.3.6.1.5.5.7.48.1"}),new s({uri:u.ocsp})]});else{if(void 0===u.caissuer)throw new Error("unknown AccessMethod parameter: "+JSON.stringify(u));o=new n({array:[new i({oid:"1.3.6.1.5.5.7.48.2"}),new s({uri:u.caissuer})]})}t.push(o)}this.asn1ExtnValue=new n({array:t})},this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.oid="1.3.6.1.5.5.7.1.1",void 0!==e&&void 0!==e.array&&this.setAccessDescriptionArray(e.array)},Je(ue.asn1.x509.AuthorityInfoAccess,ue.asn1.x509.Extension),ue.asn1.x509.SubjectAltName=function(e){ue.asn1.x509.SubjectAltName.superclass.constructor.call(this,e),this.setNameArray=function(e){this.asn1ExtnValue=new ue.asn1.x509.GeneralNames(e)},this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.17",void 0!==e&&void 0!==e.array&&this.setNameArray(e.array)},Je(ue.asn1.x509.SubjectAltName,ue.asn1.x509.Extension),ue.asn1.x509.IssuerAltName=function(e){ue.asn1.x509.IssuerAltName.superclass.constructor.call(this,e),this.setNameArray=function(e){this.asn1ExtnValue=new ue.asn1.x509.GeneralNames(e)},this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.18",void 0!==e&&void 0!==e.array&&this.setNameArray(e.array)},Je(ue.asn1.x509.IssuerAltName,ue.asn1.x509.Extension),ue.asn1.x509.SubjectDirectoryAttributes=function(e){ue.asn1.x509.SubjectDirectoryAttributes.superclass.constructor.call(this,e);var t=ue.asn1,r=t.DERSequence,n=t.ASN1Util.newObject,i=t.x509.OID.name2oid;this.params=null,this.getExtnValueHex=function(){for(var e=[],t=0;t<this.params.array.length;t++){var s=this.params.array[t],a={seq:[{oid:"1.2.3.4"},{set:[{utf8str:"DE"}]}]};if("dateOfBirth"==s.attr)a.seq[0].oid=i(s.attr),a.seq[1].set[0]={gentime:s.str};else if("placeOfBirth"==s.attr)a.seq[0].oid=i(s.attr),a.seq[1].set[0]={utf8str:s.str};else if("gender"==s.attr)a.seq[0].oid=i(s.attr),a.seq[1].set[0]={prnstr:s.str};else if("countryOfCitizenship"==s.attr)a.seq[0].oid=i(s.attr),a.seq[1].set[0]={prnstr:s.str};else{if("countryOfResidence"!=s.attr)throw new Error("unsupported attribute: "+s.attr);a.seq[0].oid=i(s.attr),a.seq[1].set[0]={prnstr:s.str}}e.push(new n(a))}var o=new r({array:e});return this.asn1ExtnValue=o,this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.9",void 0!==e&&(this.params=e)},Je(ue.asn1.x509.SubjectDirectoryAttributes,ue.asn1.x509.Extension),ue.asn1.x509.PrivateExtension=function(e){ue.asn1.x509.PrivateExtension.superclass.constructor.call(this,e);var t=ue,r=t.lang.String.isHex,n=t.asn1,i=n.x509.OID.name2oid,s=n.ASN1Util.newObject;this.params=null,this.setByParam=function(e){this.oid=i(e.extname),this.params=e},this.getExtnValueHex=function(){if(null==this.params.extname||null==this.params.extn)throw new Error("extname or extnhex not specified");var e=this.params.extn;if("string"==typeof e&&r(e))return e;if("object"==typeof e)try{return s(e).getEncodedHex()}catch(e){}throw new Error("unsupported extn value")},null!=e&&this.setByParam(e)},Je(ue.asn1.x509.PrivateExtension,ue.asn1.x509.Extension),ue.asn1.x509.CRL=function(e){ue.asn1.x509.CRL.superclass.constructor.call(this);var t=ue.asn1,r=t.DERSequence,n=t.DERBitString,i=t.x509,s=i.AlgorithmIdentifier,a=i.TBSCertList;this.params=void 0,this.setByParam=function(e){this.params=e},this.sign=function(){var e=new a(this.params).getEncodedHex(),t=new ue.crypto.Signature({alg:this.params.sigalg});t.init(this.params.cakey),t.updateHex(e);var r=t.sign();this.params.sighex=r},this.getPEM=function(){return Ce(this.getEncodedHex(),"X509 CRL")},this.getEncodedHex=function(){var e=this.params;if(null==e.tbsobj&&(e.tbsobj=new a(e)),null==e.sighex&&null!=e.cakey&&this.sign(),null==e.sighex)throw new Error("sighex or cakey parameter not defined");var t=[];return t.push(e.tbsobj),t.push(new s({name:e.sigalg})),t.push(new n({hex:"00"+e.sighex})),new r({array:t}).getEncodedHex()},null!=e&&(this.params=e)},Je(ue.asn1.x509.CRL,ue.asn1.ASN1Object),ue.asn1.x509.TBSCertList=function(e){ue.asn1.x509.TBSCertList.superclass.constructor.call(this);var t=ue.asn1,r=t.DERInteger,n=t.DERSequence,i=t.DERTaggedObject,s=(t.DERObjectIdentifier,t.x509),a=s.AlgorithmIdentifier,o=s.Time,u=s.Extensions,h=s.X500Name;this.params=null,this.setByParam=function(e){this.params=e},this.getRevCertSequence=function(){for(var e=[],t=this.params.revcert,i=0;i<t.length;i++){var s=[new r(t[i].sn),new o(t[i].date)];null!=t[i].ext&&s.push(new u(t[i].ext)),e.push(new n({array:s}))}return new n({array:e})},this.getEncodedHex=function(){var e=[],t=this.params;if(null!=t.version){var s=t.version-1,l=new r({int:s});e.push(l)}if(e.push(new a({name:t.sigalg})),e.push(new h(t.issuer)),e.push(new o(t.thisupdate)),null!=t.nextupdate&&e.push(new o(t.nextupdate)),null!=t.revcert&&e.push(this.getRevCertSequence()),null!=t.ext){var c=new u(t.ext);e.push(new i({tag:"a0",explicit:!0,obj:c}))}return new n({array:e}).getEncodedHex()},void 0!==e&&this.setByParam(e)},Je(ue.asn1.x509.TBSCertList,ue.asn1.ASN1Object),ue.asn1.x509.CRLEntry=function(e){ue.asn1.x509.CRLEntry.superclass.constructor.call(this);var t=ue.asn1;this.setCertSerial=function(e){this.sn=new t.DERInteger(e)},this.setRevocationDate=function(e){this.time=new t.x509.Time(e)},this.getEncodedHex=function(){var e=new t.DERSequence({array:[this.sn,this.time]});return this.TLV=e.getEncodedHex(),this.TLV},void 0!==e&&(void 0!==e.time&&this.setRevocationDate(e.time),void 0!==e.sn&&this.setCertSerial(e.sn))},Je(ue.asn1.x509.CRLEntry,ue.asn1.ASN1Object),ue.asn1.x509.CRLNumber=function(e){ue.asn1.x509.CRLNumber.superclass.constructor.call(this,e),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new ue.asn1.DERInteger(this.params.num),this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.20",null!=e&&(this.params=e)},Je(ue.asn1.x509.CRLNumber,ue.asn1.x509.Extension),ue.asn1.x509.CRLReason=function(e){ue.asn1.x509.CRLReason.superclass.constructor.call(this,e),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new ue.asn1.DEREnumerated(this.params.code),this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.21",null!=e&&(this.params=e)},Je(ue.asn1.x509.CRLReason,ue.asn1.x509.Extension),ue.asn1.x509.OCSPNonce=function(e){ue.asn1.x509.OCSPNonce.superclass.constructor.call(this,e),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new ue.asn1.DEROctetString(this.params),this.asn1ExtnValue.getEncodedHex()},this.oid="1.3.6.1.5.5.7.48.1.2",null!=e&&(this.params=e)},Je(ue.asn1.x509.OCSPNonce,ue.asn1.x509.Extension),ue.asn1.x509.OCSPNoCheck=function(e){ue.asn1.x509.OCSPNoCheck.superclass.constructor.call(this,e),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new ue.asn1.DERNull,this.asn1ExtnValue.getEncodedHex()},this.oid="1.3.6.1.5.5.7.48.1.5",null!=e&&(this.params=e)},Je(ue.asn1.x509.OCSPNoCheck,ue.asn1.x509.Extension),ue.asn1.x509.AdobeTimeStamp=function(e){ue.asn1.x509.AdobeTimeStamp.superclass.constructor.call(this,e);var t=ue.asn1,r=t.DERInteger,n=t.DERBoolean,i=t.DERSequence,s=t.x509.GeneralName;this.params=null,this.getExtnValueHex=function(){var e=this.params,t=[new r(1)];return t.push(new s({uri:e.uri})),null!=e.reqauth&&t.push(new n(e.reqauth)),this.asn1ExtnValue=new i({array:t}),this.asn1ExtnValue.getEncodedHex()},this.oid="1.2.840.113583.1.1.9.1",void 0!==e&&this.setByParam(e)},Je(ue.asn1.x509.AdobeTimeStamp,ue.asn1.x509.Extension),ue.asn1.x509.X500Name=function(e){ue.asn1.x509.X500Name.superclass.constructor.call(this),this.asn1Array=[],this.paramArray=[],this.sRule="utf8";var t=ue.asn1,r=t.x509,n=r.RDN;this.setByString=function(e,t){void 0!==t&&(this.sRule=t);var r=e.split("/");r.shift();for(var i=[],s=0;s<r.length;s++)if(r[s].match(/^[^=]+=.+$/))i.push(r[s]);else{var a=i.length-1;i[a]=i[a]+"/"+r[s]}for(s=0;s<i.length;s++)this.asn1Array.push(new n({str:i[s],rule:this.sRule}))},this.setByLdapString=function(e,t){void 0!==t&&(this.sRule=t);var n=r.X500Name.ldapToCompat(e);this.setByString(n,t)},this.setByObject=function(e,t){for(var r in void 0!==t&&(this.sRule=t),e)if(e.hasOwnProperty(r)){var i=new n({str:r+"="+e[r],rule:this.sRule});this.asn1Array?this.asn1Array.push(i):this.asn1Array=[i]}},this.setByParam=function(e){var t;(void 0!==e.rule&&(this.sRule=e.rule),void 0!==e.array)?this.paramArray=e.array:void 0!==e.str?this.setByString(e.str):void 0!==e.ldapstr?this.setByLdapString(e.ldapstr):void 0!==e.hex?this.hTLV=e.hex:void 0!==e.certissuer?((t=new Xe).readCertPEM(e.certissuer),this.hTLV=t.getIssuerHex()):void 0!==e.certsubject?((t=new Xe).readCertPEM(e.certsubject),this.hTLV=t.getSubjectHex()):"object"==typeof e&&void 0===e.certsubject&&void 0===e.certissuer&&this.setByObject(e)},this.getEncodedHex=function(){if("string"==typeof this.hTLV)return this.hTLV;if(0==this.asn1Array.length&&this.paramArray.length>0)for(var e=0;e<this.paramArray.length;e++){var r={array:this.paramArray[e]};"utf8"!=this.sRule&&(r.rule=this.sRule);var i=new n(r);this.asn1Array.push(i)}var s=new t.DERSequence({array:this.asn1Array});return this.hTLV=s.getEncodedHex(),this.hTLV},void 0!==e&&this.setByParam(e)},Je(ue.asn1.x509.X500Name,ue.asn1.ASN1Object),ue.asn1.x509.X500Name.compatToLDAP=function(e){if("/"!==e.substr(0,1))throw"malformed input";var t=(e=e.substr(1)).split("/");return t.reverse(),(t=t.map((function(e){return e.replace(/,/,"\\,")}))).join(",")},ue.asn1.x509.X500Name.onelineToLDAP=function(e){return ue.asn1.x509.X500Name.compatToLDAP(e)},ue.asn1.x509.X500Name.ldapToCompat=function(e){for(var t=e.split(","),r=!1,n=[],i=0;t.length>0;i++){var s=t.shift();if(!0===r){var a=(n.pop()+","+s).replace(/\\,/g,",");n.push(a),r=!1}else n.push(s);"\\"===s.substr(-1,1)&&(r=!0)}return(n=n.map((function(e){return e.replace("/","\\/")}))).reverse(),"/"+n.join("/")},ue.asn1.x509.X500Name.ldapToOneline=function(e){return ue.asn1.x509.X500Name.ldapToCompat(e)},ue.asn1.x509.RDN=function(e){ue.asn1.x509.RDN.superclass.constructor.call(this),this.asn1Array=[],this.paramArray=[],this.sRule="utf8";var t=ue.asn1.x509.AttributeTypeAndValue;this.setByParam=function(e){void 0!==e.rule&&(this.sRule=e.rule),void 0!==e.str&&this.addByMultiValuedString(e.str),void 0!==e.array&&(this.paramArray=e.array)},this.addByString=function(e){this.asn1Array.push(new ue.asn1.x509.AttributeTypeAndValue({str:e,rule:this.sRule}))},this.addByMultiValuedString=function(e){for(var t=ue.asn1.x509.RDN.parseString(e),r=0;r<t.length;r++)this.addByString(t[r])},this.getEncodedHex=function(){if(0==this.asn1Array.length&&this.paramArray.length>0)for(var e=0;e<this.paramArray.length;e++){var r=this.paramArray[e];void 0!==r.rule&&"utf8"!=this.sRule&&(r.rule=this.sRule);var n=new t(r);this.asn1Array.push(n)}var i=new ue.asn1.DERSet({array:this.asn1Array});return this.TLV=i.getEncodedHex(),this.TLV},void 0!==e&&this.setByParam(e)},Je(ue.asn1.x509.RDN,ue.asn1.ASN1Object),ue.asn1.x509.RDN.parseString=function(e){for(var t=e.split(/\+/),r=!1,n=[],i=0;t.length>0;i++){var s=t.shift();if(!0===r){var a=(n.pop()+"+"+s).replace(/\\\+/g,"+");n.push(a),r=!1}else n.push(s);"\\"===s.substr(-1,1)&&(r=!0)}var o=!1,u=[];for(i=0;n.length>0;i++){s=n.shift();if(!0===o){var h=u.pop();if(s.match(/"$/)){a=(h+"+"+s).replace(/^([^=]+)="(.*)"$/,"$1=$2");u.push(a),o=!1}else u.push(h+"+"+s)}else u.push(s);s.match(/^[^=]+="/)&&(o=!0)}return u},ue.asn1.x509.AttributeTypeAndValue=function(e){ue.asn1.x509.AttributeTypeAndValue.superclass.constructor.call(this),this.sRule="utf8",this.sType=null,this.sValue=null,this.dsType=null;var t=ue,r=t.asn1,n=r.DERSequence,i=r.DERUTF8String,s=r.DERPrintableString,a=r.DERTeletexString,o=r.DERIA5String,u=r.DERVisibleString,h=r.DERBMPString,l=t.lang.String.isMail,c=t.lang.String.isPrintable;this.setByParam=function(e){if(void 0!==e.rule&&(this.sRule=e.rule),void 0!==e.ds&&(this.dsType=e.ds),void 0===e.value&&void 0!==e.str){var t=e.str.match(/^([^=]+)=(.+)$/);if(!t)throw new Error("malformed attrTypeAndValueStr: "+attrTypeAndValueStr);this.sType=t[1],this.sValue=t[2]}else this.sType=e.type,this.sValue=e.value},this.setByString=function(e,t){void 0!==t&&(this.sRule=t);var r=e.match(/^([^=]+)=(.+)$/);if(!r)throw new Error("malformed attrTypeAndValueStr: "+attrTypeAndValueStr);this.setByAttrTypeAndValueStr(r[1],r[2])},this._getDsType=function(){var e=this.sType,t=this.sValue,r=this.sRule;return"prn"===r?"CN"==e&&l(t)?"ia5":c(t)?"prn":"utf8":"utf8"===r?"CN"==e&&l(t)?"ia5":"C"==e?"prn":"utf8":"utf8"},this.setByAttrTypeAndValueStr=function(e,t,r){void 0!==r&&(this.sRule=r),this.sType=e,this.sValue=t},this.getValueObj=function(e,t){if("utf8"==e)return new i({str:t});if("prn"==e)return new s({str:t});if("tel"==e)return new a({str:t});if("ia5"==e)return new o({str:t});if("vis"==e)return new u({str:t});if("bmp"==e)return new h({str:t});throw new Error("unsupported directory string type: type="+e+" value="+t)},this.getEncodedHex=function(){null==this.dsType&&(this.dsType=this._getDsType());var e=ue.asn1.x509.OID.atype2obj(this.sType),t=this.getValueObj(this.dsType,this.sValue),r=new n({array:[e,t]});return this.TLV=r.getEncodedHex(),this.TLV},void 0!==e&&this.setByParam(e)},Je(ue.asn1.x509.AttributeTypeAndValue,ue.asn1.ASN1Object),ue.asn1.x509.SubjectPublicKeyInfo=function(e){ue.asn1.x509.SubjectPublicKeyInfo.superclass.constructor.call(this);var t=ue,r=t.asn1,n=r.DERInteger,i=r.DERBitString,s=r.DERObjectIdentifier,a=r.DERSequence,o=r.ASN1Util.newObject,u=r.x509.AlgorithmIdentifier,h=t.crypto;h.ECDSA,h.DSA;this.getASN1Object=function(){if(null==this.asn1AlgId||null==this.asn1SubjPKey)throw"algId and/or subjPubKey not set";return new a({array:[this.asn1AlgId,this.asn1SubjPKey]})},this.getEncodedHex=function(){var e=this.getASN1Object();return this.hTLV=e.getEncodedHex(),this.hTLV},this.setPubKey=function(e){try{if(e instanceof re){var t=o({seq:[{int:{bigint:e.n}},{int:{int:e.e}}]}).getEncodedHex();this.asn1AlgId=new u({name:"rsaEncryption"}),this.asn1SubjPKey=new i({hex:"00"+t})}}catch(e){}try{if(e instanceof ue.crypto.ECDSA){var r=new s({name:e.curveName});this.asn1AlgId=new u({name:"ecPublicKey",asn1params:r}),this.asn1SubjPKey=new i({hex:"00"+e.pubKeyHex})}}catch(e){}try{if(e instanceof ue.crypto.DSA){r=new o({seq:[{int:{bigint:e.p}},{int:{bigint:e.q}},{int:{bigint:e.g}}]});this.asn1AlgId=new u({name:"dsa",asn1params:r});var a=new n({bigint:e.y});this.asn1SubjPKey=new i({hex:"00"+a.getEncodedHex()})}}catch(e){}},void 0!==e&&this.setPubKey(e)},Je(ue.asn1.x509.SubjectPublicKeyInfo,ue.asn1.ASN1Object),ue.asn1.x509.Time=function(e){ue.asn1.x509.Time.superclass.constructor.call(this);var t=ue.asn1,r=t.DERUTCTime,n=t.DERGeneralizedTime;this.setTimeParams=function(e){this.timeParams=e},this.getEncodedHex=function(){var e=null;return e=null!=this.timeParams?"utc"==this.type?new r(this.timeParams):new n(this.timeParams):"utc"==this.type?new r:new n,this.TLV=e.getEncodedHex(),this.TLV},this.type="utc",void 0!==e&&(void 0!==e.type?this.type=e.type:void 0!==e.str&&(e.str.match(/^[0-9]{12}Z$/)&&(this.type="utc"),e.str.match(/^[0-9]{14}Z$/)&&(this.type="gen")),this.timeParams=e)},Je(ue.asn1.x509.Time,ue.asn1.ASN1Object),ue.asn1.x509.AlgorithmIdentifier=function(e){ue.asn1.x509.AlgorithmIdentifier.superclass.constructor.call(this),this.nameAlg=null,this.asn1Alg=null,this.asn1Params=null,this.paramEmpty=!1;var t=ue.asn1,r=t.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV;if(this.getEncodedHex=function(){if(null===this.nameAlg&&null===this.asn1Alg)throw new Error("algorithm not specified");if(null!==this.nameAlg){var e=null;for(var n in r)n===this.nameAlg&&(e=r[n]);if(null!==e)return this.hTLV=e,this.hTLV}null!==this.nameAlg&&null===this.asn1Alg&&(this.asn1Alg=t.x509.OID.name2obj(this.nameAlg));var i=[this.asn1Alg];null!==this.asn1Params&&i.push(this.asn1Params);var s=new t.DERSequence({array:i});return this.hTLV=s.getEncodedHex(),this.hTLV},void 0!==e&&(void 0!==e.name&&(this.nameAlg=e.name),void 0!==e.asn1params&&(this.asn1Params=e.asn1params),void 0!==e.paramempty&&(this.paramEmpty=e.paramempty)),null===this.asn1Params&&!1===this.paramEmpty&&null!==this.nameAlg){void 0!==this.nameAlg.name&&(this.nameAlg=this.nameAlg.name);var n=this.nameAlg.toLowerCase();"withdsa"!==n.substr(-7,7)&&"withecdsa"!==n.substr(-9,9)&&(this.asn1Params=new t.DERNull)}},Je(ue.asn1.x509.AlgorithmIdentifier,ue.asn1.ASN1Object),ue.asn1.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV={SHAwithRSAandMGF1:"300d06092a864886f70d01010a3000",SHA256withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040201a11a301806092a864886f70d010108300b0609608648016503040201a203020120",SHA384withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040202a11a301806092a864886f70d010108300b0609608648016503040202a203020130",SHA512withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040203a11a301806092a864886f70d010108300b0609608648016503040203a203020140"},ue.asn1.x509.GeneralName=function(e){ue.asn1.x509.GeneralName.superclass.constructor.call(this);var t={rfc822:"81",dns:"82",dn:"a4",uri:"86",ip:"87"},r=ue.asn1,n=(r.DERSequence,r.DEROctetString),i=r.DERIA5String,s=r.DERTaggedObject,a=r.ASN1Object,o=r.x509.X500Name,u=Ie;this.explicit=!1,this.setByParam=function(e){var r=null;if(void 0!==e){if(void 0!==e.rfc822&&(this.type="rfc822",r=new i({str:e[this.type]})),void 0!==e.dns&&(this.type="dns",r=new i({str:e[this.type]})),void 0!==e.uri&&(this.type="uri",r=new i({str:e[this.type]})),void 0!==e.dn&&(this.type="dn",this.explicit=!0,r="string"==typeof e.dn?new o({str:e.dn}):e.dn instanceof ue.asn1.x509.X500Name?e.dn:new o(e.dn)),void 0!==e.ldapdn&&(this.type="dn",this.explicit=!0,r=new o({ldapstr:e.ldapdn})),void 0!==e.certissuer){this.type="dn",this.explicit=!0;var h=null;if((c=e.certissuer).match(/^[0-9A-Fa-f]+$/),-1!=c.indexOf("-----BEGIN ")&&(h=u(c)),null==h)throw"certissuer param not cert";(f=new Xe).hex=h;var l=f.getIssuerHex();(r=new a).hTLV=l}if(void 0!==e.certsubj){this.type="dn",this.explicit=!0;var c,f;h=null;if((c=e.certsubj).match(/^[0-9A-Fa-f]+$/),-1!=c.indexOf("-----BEGIN ")&&(h=u(c)),null==h)throw"certsubj param not cert";(f=new Xe).hex=h;l=f.getSubjectHex();(r=new a).hTLV=l}if(void 0!==e.ip){this.type="ip",this.explicit=!1;var g,d=e.ip,p="malformed IP address";if(d.match(/^[0-9.]+[.][0-9.]+$/)){if(8!==(g=Ue("["+d.split(".").join(",")+"]")).length)throw p}else if(d.match(/^[0-9A-Fa-f:]+:[0-9A-Fa-f:]+$/))g=He(d);else{if(!d.match(/^([0-9A-Fa-f][0-9A-Fa-f]){1,}$/))throw p;g=d}r=new n({hex:g})}if(null==this.type)throw"unsupported type in params="+e;this.asn1Obj=new s({explicit:this.explicit,tag:t[this.type],obj:r})}},this.getEncodedHex=function(){return this.asn1Obj.getEncodedHex()},void 0!==e&&this.setByParam(e)},Je(ue.asn1.x509.GeneralName,ue.asn1.ASN1Object),ue.asn1.x509.GeneralNames=function(e){ue.asn1.x509.GeneralNames.superclass.constructor.call(this);var t=ue.asn1;this.setByParamArray=function(e){for(var r=0;r<e.length;r++){var n=new t.x509.GeneralName(e[r]);this.asn1Array.push(n)}},this.getEncodedHex=function(){return new t.DERSequence({array:this.asn1Array}).getEncodedHex()},this.asn1Array=new Array,void 0!==e&&this.setByParamArray(e)},Je(ue.asn1.x509.GeneralNames,ue.asn1.ASN1Object),ue.asn1.x509.OID=new function(e){this.atype2oidList={CN:"2.5.4.3",L:"2.5.4.7",ST:"2.5.4.8",O:"2.5.4.10",OU:"2.5.4.11",C:"2.5.4.6",STREET:"2.5.4.9",DC:"0.9.2342.19200300.100.1.25",UID:"0.9.2342.19200300.100.1.1",SN:"2.5.4.4",T:"2.5.4.12",DN:"2.5.4.49",E:"1.2.840.113549.1.9.1",description:"2.5.4.13",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",serialNumber:"2.5.4.5",uniqueIdentifier:"2.5.4.45",organizationIdentifier:"2.5.4.97",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3"},this.name2oidList={sha1:"1.3.14.3.2.26",sha256:"2.16.840.1.101.3.4.2.1",sha384:"2.16.840.1.101.3.4.2.2",sha512:"2.16.840.1.101.3.4.2.3",sha224:"2.16.840.1.101.3.4.2.4",md5:"1.2.840.113549.2.5",md2:"1.3.14.7.2.2.1",ripemd160:"1.3.36.3.2.1",MD2withRSA:"1.2.840.113549.1.1.2",MD4withRSA:"1.2.840.113549.1.1.3",MD5withRSA:"1.2.840.113549.1.1.4",SHA1withRSA:"1.2.840.113549.1.1.5","pkcs1-MGF":"1.2.840.113549.1.1.8",rsaPSS:"1.2.840.113549.1.1.10",SHA224withRSA:"1.2.840.113549.1.1.14",SHA256withRSA:"1.2.840.113549.1.1.11",SHA384withRSA:"1.2.840.113549.1.1.12",SHA512withRSA:"1.2.840.113549.1.1.13",SHA1withECDSA:"1.2.840.10045.4.1",SHA224withECDSA:"1.2.840.10045.4.3.1",SHA256withECDSA:"1.2.840.10045.4.3.2",SHA384withECDSA:"1.2.840.10045.4.3.3",SHA512withECDSA:"1.2.840.10045.4.3.4",dsa:"1.2.840.10040.4.1",SHA1withDSA:"1.2.840.10040.4.3",SHA224withDSA:"2.16.840.1.101.3.4.3.1",SHA256withDSA:"2.16.840.1.101.3.4.3.2",rsaEncryption:"1.2.840.113549.1.1.1",commonName:"2.5.4.3",countryName:"2.5.4.6",localityName:"2.5.4.7",stateOrProvinceName:"2.5.4.8",streetAddress:"2.5.4.9",organizationName:"2.5.4.10",organizationalUnitName:"2.5.4.11",domainComponent:"0.9.2342.19200300.100.1.25",userId:"0.9.2342.19200300.100.1.1",surname:"2.5.4.4",givenName:"2.5.4.42",title:"2.5.4.12",distinguishedName:"2.5.4.49",emailAddress:"1.2.840.113549.1.9.1",description:"2.5.4.13",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",uniqueIdentifier:"2.5.4.45",organizationIdentifier:"2.5.4.97",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3",subjectDirectoryAttributes:"2.5.29.9",subjectKeyIdentifier:"2.5.29.14",keyUsage:"2.5.29.15",subjectAltName:"2.5.29.17",issuerAltName:"2.5.29.18",basicConstraints:"2.5.29.19",cRLNumber:"2.5.29.20",cRLReason:"2.5.29.21",nameConstraints:"2.5.29.30",cRLDistributionPoints:"2.5.29.31",certificatePolicies:"2.5.29.32",anyPolicy:"2.5.29.32.0",authorityKeyIdentifier:"2.5.29.35",policyConstraints:"2.5.29.36",extKeyUsage:"2.5.29.37",authorityInfoAccess:"1.3.6.1.5.5.7.1.1",ocsp:"1.3.6.1.5.5.7.48.1",ocspBasic:"1.3.6.1.5.5.7.48.1.1",ocspNonce:"1.3.6.1.5.5.7.48.1.2",ocspNoCheck:"1.3.6.1.5.5.7.48.1.5",caIssuers:"1.3.6.1.5.5.7.48.2",anyExtendedKeyUsage:"2.5.29.37.0",serverAuth:"1.3.6.1.5.5.7.3.1",clientAuth:"1.3.6.1.5.5.7.3.2",codeSigning:"1.3.6.1.5.5.7.3.3",emailProtection:"1.3.6.1.5.5.7.3.4",timeStamping:"1.3.6.1.5.5.7.3.8",ocspSigning:"1.3.6.1.5.5.7.3.9",dateOfBirth:"1.3.6.1.5.5.7.9.1",placeOfBirth:"1.3.6.1.5.5.7.9.2",gender:"1.3.6.1.5.5.7.9.3",countryOfCitizenship:"1.3.6.1.5.5.7.9.4",countryOfResidence:"1.3.6.1.5.5.7.9.5",ecPublicKey:"1.2.840.10045.2.1","P-256":"1.2.840.10045.3.1.7",secp256r1:"1.2.840.10045.3.1.7",secp256k1:"1.3.132.0.10",secp384r1:"1.3.132.0.34",pkcs5PBES2:"1.2.840.113549.1.5.13",pkcs5PBKDF2:"1.2.840.113549.1.5.12","des-EDE3-CBC":"1.2.840.113549.3.7",data:"1.2.840.113549.1.7.1","signed-data":"1.2.840.113549.1.7.2","enveloped-data":"1.2.840.113549.1.7.3","digested-data":"1.2.840.113549.1.7.5","encrypted-data":"1.2.840.113549.1.7.6","authenticated-data":"1.2.840.113549.1.9.16.1.2",tstinfo:"1.2.840.113549.1.9.16.1.4",signingCertificate:"1.2.840.113549.1.9.16.2.12",timeStampToken:"1.2.840.113549.1.9.16.2.14",signaturePolicyIdentifier:"1.2.840.113549.1.9.16.2.15",etsArchiveTimeStamp:"1.2.840.113549.1.9.16.2.27",signingCertificateV2:"1.2.840.113549.1.9.16.2.47",etsArchiveTimeStampV2:"1.2.840.113549.1.9.16.2.48",extensionRequest:"1.2.840.113549.1.9.14",contentType:"1.2.840.113549.1.9.3",messageDigest:"1.2.840.113549.1.9.4",signingTime:"1.2.840.113549.1.9.5",counterSignature:"1.2.840.113549.1.9.6",archiveTimeStampV3:"0.4.0.1733.2.4",pdfRevocationInfoArchival:"1.2.840.113583.1.1.8",adobeTimeStamp:"1.2.840.113583.1.1.9.1"},this.objCache={},this.name2obj=function(e){if(void 0!==this.objCache[e])return this.objCache[e];if(void 0===this.name2oidList[e])throw"Name of ObjectIdentifier not defined: "+e;var t=this.name2oidList[e],r=new ue.asn1.DERObjectIdentifier({oid:t});return this.objCache[e]=r,r},this.atype2obj=function(e){if(void 0!==this.objCache[e])return this.objCache[e];var t;if(e.match(/^\d+\.\d+\.[0-9.]+$/))t=e;else if(void 0!==this.atype2oidList[e])t=this.atype2oidList[e];else{if(void 0===this.name2oidList[e])throw"AttributeType name undefined: "+e;t=this.name2oidList[e]}var r=new ue.asn1.DERObjectIdentifier({oid:t});return this.objCache[e]=r,r}},ue.asn1.x509.OID.oid2name=function(e){var t=ue.asn1.x509.OID.name2oidList;for(var r in t)if(t[r]==e)return r;return""},ue.asn1.x509.OID.oid2atype=function(e){var t=ue.asn1.x509.OID.atype2oidList;for(var r in t)if(t[r]==e)return r;return e},ue.asn1.x509.OID.name2oid=function(e){if(e.match(/^[0-9.]+$/))return e;var t=ue.asn1.x509.OID.name2oidList;return void 0===t[e]?"":t[e]},ue.asn1.x509.X509Util={},ue.asn1.x509.X509Util.newCertPEM=function(e){var t=ue.asn1.x509;t.TBSCertificate;return new(0,t.Certificate)(e).getPEM()},void 0!==ue&&ue||(ue={}),void 0!==ue.asn1&&ue.asn1||(ue.asn1={}),void 0!==ue.asn1.cms&&ue.asn1.cms||(ue.asn1.cms={}),ue.asn1.cms.Attribute=function(e){var t=Error,r=ue.asn1,n=r.DERSequence,i=r.DERSet,s=r.DERObjectIdentifier;this.params=null,this.typeOid=null,this.setByParam=function(e){this.params=e},this.getValueArray=function(){throw new t("not yet implemented abstract")},this.getEncodedHex=function(){var e=new s({oid:this.typeOid}),t=new i({array:this.getValueArray()});return new n({array:[e,t]}).getEncodedHex()}},Je(ue.asn1.cms.Attribute,ue.asn1.ASN1Object),ue.asn1.cms.ContentType=function(e){var t=ue.asn1;t.cms.ContentType.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.3",this.getValueArray=function(){return[new t.DERObjectIdentifier(this.params.type)]},null!=e&&this.setByParam(e)},Je(ue.asn1.cms.ContentType,ue.asn1.cms.Attribute),ue.asn1.cms.MessageDigest=function(e){var t=ue.asn1,r=t.DEROctetString;t.cms.MessageDigest.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.4",this.getValueArray=function(){return[new r(this.params)]},null!=e&&this.setByParam(e)},Je(ue.asn1.cms.MessageDigest,ue.asn1.cms.Attribute),ue.asn1.cms.SigningTime=function(e){var t=ue.asn1;t.cms.SigningTime.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.5",this.getValueArray=function(){return[new t.x509.Time(this.params)]},null!=e&&this.setByParam(e)},Je(ue.asn1.cms.SigningTime,ue.asn1.cms.Attribute),ue.asn1.cms.SigningCertificate=function(e){var t=Error,r=ue,n=r.asn1,i=n.DERSequence,s=n.cms,a=s.ESSCertID;r.crypto;s.SigningCertificate.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.12",this.getValueArray=function(){if(null==this.params||null==this.params||null==this.params.array)throw new t("parameter 'array' not specified");for(var r=this.params.array,n=[],s=0;s<r.length;s++){var o=r[s];0!=e.hasis||"string"!=typeof o||-1==o.indexOf("-----BEGIN")&&!ce.isASN1HEX(o)||(o={cert:o}),0!=o.hasis&&0==e.hasis&&(o.hasis=!1),n.push(new a(o))}var u=new i({array:n});return[new i({array:[u]})]},null!=e&&this.setByParam(e)},Je(ue.asn1.cms.SigningCertificate,ue.asn1.cms.Attribute),ue.asn1.cms.ESSCertID=function(e){ue.asn1.cms.ESSCertID.superclass.constructor.call(this);var t=Error,r=ue,n=r.asn1,i=n.DEROctetString,s=n.DERSequence,a=n.cms.IssuerSerial;this.params=null,this.getCertHash=function(e,n){if(null!=e.hash)return e.hash;if("string"==typeof e&&-1==e.indexOf("-----BEGIN")&&!ce.isASN1HEX(e))return e;var i,s,a;if("string"==typeof e)i=e;else{if(null==e.cert)throw new t("hash nor cert unspecified");i=e.cert}if(s=-1!=i.indexOf("-----BEGIN")?Ie(i):i,"string"==typeof e&&(-1!=e.indexOf("-----BEGIN")?s=Ie(e):ce.isASN1HEX(e)&&(s=e)),null!=e.alg)a=e.alg;else{if(null==n)throw new t("hash alg unspecified");a=n}return r.crypto.Util.hashHex(s,a)},this.getEncodedHex=function(){var e=this.params,t=this.getCertHash(e,"sha1"),r=[];return r.push(new i({hex:t})),("string"==typeof e&&-1!=e.indexOf("-----BEGIN")||null!=e.cert&&0!=e.hasis||null!=e.issuer&&null!=e.serial)&&r.push(new a(e)),new s({array:r}).getEncodedHex()},null!=e&&this.setByParam(e)},Je(ue.asn1.cms.ESSCertID,ue.asn1.ASN1Object),ue.asn1.cms.SigningCertificateV2=function(e){var t=Error,r=ue,n=r.asn1,i=n.DERSequence,s=(n.x509,n.cms),a=s.ESSCertIDv2;r.crypto;s.SigningCertificateV2.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.47",this.getValueArray=function(){if(null==this.params||null==this.params||null==this.params.array)throw new t("parameter 'array' not specified");for(var r=this.params.array,n=[],s=0;s<r.length;s++){var o=r[s];null==e.alg&&0!=e.hasis||"string"!=typeof o||-1==o.indexOf("-----BEGIN")&&!ce.isASN1HEX(o)||(o={cert:o}),null==o.alg&&null!=e.alg&&(o.alg=e.alg),0!=o.hasis&&0==e.hasis&&(o.hasis=!1),n.push(new a(o))}var u=new i({array:n});return[new i({array:[u]})]},null!=e&&this.setByParam(e)},Je(ue.asn1.cms.SigningCertificateV2,ue.asn1.cms.Attribute),ue.asn1.cms.ESSCertIDv2=function(e){ue.asn1.cms.ESSCertIDv2.superclass.constructor.call(this);Error;var t=ue.asn1,r=t.DEROctetString,n=t.DERSequence,i=t.cms.IssuerSerial,s=t.x509.AlgorithmIdentifier;this.params=null,this.getEncodedHex=function(){var e=this.params,t=this.getCertHash(e,"sha256"),a=[];return null!=e.alg&&"sha256"!=e.alg&&a.push(new s({name:e.alg})),a.push(new r({hex:t})),("string"==typeof e&&-1!=e.indexOf("-----BEGIN")||null!=e.cert&&0!=e.hasis||null!=e.issuer&&null!=e.serial)&&a.push(new i(e)),new n({array:a}).getEncodedHex()},null!=e&&this.setByParam(e)},Je(ue.asn1.cms.ESSCertIDv2,ue.asn1.cms.ESSCertID),ue.asn1.cms.IssuerSerial=function(e){var t=Error,r=ue.asn1,n=r.DERInteger,i=r.DERSequence,s=r.cms,a=r.x509.GeneralNames,o=Xe;s.IssuerSerial.superclass.constructor.call(this),this.setByParam=function(e){this.params=e},this.getEncodedHex=function(){var e,r,s=this.params;if("string"==typeof s&&-1!=s.indexOf("-----BEGIN")||null!=s.cert){var u;u=null!=s.cert?s.cert:s;var h=new o;h.readCertPEM(u),e=h.getIssuer(),r={hex:h.getSerialNumberHex()}}else{if(null==s.issuer||!s.serial)throw new t("cert or issuer and serial parameter not specified");e=s.issuer,r=s.serial}var l=new a([{dn:e}]),c=new n(r);return new i({array:[l,c]}).getEncodedHex()},null!=e&&this.setByParam(e)},Je(ue.asn1.cms.IssuerSerial,ue.asn1.ASN1Object),ue.asn1.cms.SignerIdentifier=function(e){var t=ue.asn1,r=(t.DERInteger,t.DERSequence,t.cms),n=r.IssuerAndSerialNumber,i=r.SubjectKeyIdentifier;t.x509.X500Name,Error;r.SignerIdentifier.superclass.constructor.call(this),this.params=null,this.getEncodedHex=function(){var e=this.params;if("isssn"==e.type)return new n(e).getEncodedHex();if("skid"==e.type)return new i(e).getEncodedHex();throw new Error("wrong property for isssn or skid")},null!=e&&this.setByParam(e)},Je(ue.asn1.cms.SignerIdentifier,ue.asn1.ASN1Object),ue.asn1.cms.IssuerAndSerialNumber=function(e){var t=ue.asn1,r=t.DERInteger,n=t.DERSequence,i=t.cms,s=t.x509.X500Name,a=Xe,o=Error;i.IssuerAndSerialNumber.superclass.constructor.call(this),this.params=null,this.getEncodedHex=function(){var e,t,i=this.params;if("string"==typeof i&&-1!=i.indexOf("-----BEGIN")||null!=i.cert){var u;u=null!=i.cert?i.cert:i;var h=new a;h.readCertPEM(u),e=h.getIssuer(),t={hex:h.getSerialNumberHex()}}else{if(null==i.issuer||!i.serial)throw new o("cert or issuer and serial parameter not specified");e=i.issuer,t=i.serial}var l=new s(e),c=new r(t);return new n({array:[l,c]}).getEncodedHex()},this.setByParam=function(e){this.params=e},null!=e&&this.setByParam(e)},Je(ue.asn1.cms.IssuerAndSerialNumber,ue.asn1.ASN1Object),ue.asn1.cms.SubjectKeyIdentifier=function(e){var t=ue.asn1,r=(t.DERInteger,t.DERSequence,t.ASN1Util.newObject),n=t.cms,i=(n.IssuerAndSerialName,n.SubjectKeyIdentifier,t.x509.X500Name,Xe),s=Error;n.SubjectKeyIdentifier.superclass.constructor.call(this),this.getEncodedHex=function(){var e,t=this.params;if(null==t.cert&&null==t.skid)throw new s("property cert nor skid undefined");null!=t.cert?e=new i(t.cert).getExtSubjectKeyIdentifier().kid.hex:null!=t.skid&&(e=t.skid);return r({tag:{tage:"a0",obj:{octstr:{hex:e}}}}).getEncodedHex()},null!=e&&this.setByParam(e)},Je(ue.asn1.cms.SubjectKeyIdentifier,ue.asn1.ASN1Object),ue.asn1.cms.AttributeList=function(e){var t=Error,r=ue.asn1,n=r.DERSet,i=r.cms;i.AttributeList.superclass.constructor.call(this),this.params=null,this.hTLV=null,this.setByParam=function(e){this.params=e},this.getEncodedHex=function(){var e=this.params;if(null!=this.hTLV)return this.hTLV;var r=!0;null!=e.sortflag&&(r=e.sortflag);for(var s=e.array,a=[],o=0;o<s.length;o++){var u=s[o],h=u.attr;if("contentType"==h)a.push(new i.ContentType(u));else if("messageDigest"==h)a.push(new i.MessageDigest(u));else if("signingTime"==h)a.push(new i.SigningTime(u));else if("signingCertificate"==h)a.push(new i.SigningCertificate(u));else if("signingCertificateV2"==h)a.push(new i.SigningCertificateV2(u));else if("signaturePolicyIdentifier"==h)a.push(new ue.asn1.cades.SignaturePolicyIdentifier(u));else{if("signatureTimeStamp"!=h&&"timeStampToken"!=h)throw new t("unknown attr: "+h);a.push(new ue.asn1.cades.SignatureTimeStamp(u))}}var l=new n({array:a,sortflag:r});return this.hTLV=l.getEncodedHex(),this.hTLV},null!=e&&this.setByParam(e)},Je(ue.asn1.cms.AttributeList,ue.asn1.ASN1Object),ue.asn1.cms.SignerInfo=function(e){var t=Error,r=ue,n=r.asn1,i=n.DERInteger,s=n.DEROctetString,a=n.DERSequence,o=n.DERTaggedObject,u=n.cms,h=u.SignerIdentifier,l=u.AttributeList,c=(u.ContentType,u.EncapsulatedContentInfo,u.MessageDigest,u.SignedData,n.x509.AlgorithmIdentifier),f=r.crypto,g=$e;u.SignerInfo.superclass.constructor.call(this),this.params=null,this.sign=function(){var e=this.params,t=e.sigalg,r=new l(e.sattrs).getEncodedHex(),n=g.getKey(e.signkey),i=new f.Signature({alg:t});i.init(n),i.updateHex(r);var s=i.sign();e.sighex=s},this.getEncodedHex=function(){var e=this.params,r=[];if(r.push(new i({int:e.version})),r.push(new h(e.id)),r.push(new c({name:e.hashalg})),null!=e.sattrs){var n=new l(e.sattrs);try{r.push(new o({tag:"a0",explicit:!1,obj:n}))}catch(e){throw new t("si sattr error: "+e)}}if(null!=e.sigalgfield?r.push(new c({name:e.sigalgfield})):r.push(new c({name:e.sigalg})),null==e.sighex&&null!=e.signkey&&this.sign(),r.push(new s({hex:e.sighex})),null!=e.uattrs){n=new l(e.uattrs);try{r.push(new o({tag:"a1",explicit:!1,obj:n}))}catch(e){throw new t("si uattr error: "+e)}}return new a({array:r}).getEncodedHex()},null!=e&&this.setByParam(e)},Je(ue.asn1.cms.SignerInfo,ue.asn1.ASN1Object),ue.asn1.cms.EncapsulatedContentInfo=function(e){var t=ue.asn1,r=t.DERTaggedObject,n=t.DERSequence,i=t.DERObjectIdentifier,s=t.DEROctetString;t.cms.EncapsulatedContentInfo.superclass.constructor.call(this),this.params=null,this.getEncodedHex=function(){var e=this.params,t=[];if(t.push(new i(e.type)),null!=e.content&&(null!=e.content.hex||null!=e.content.str)&&1!=e.isDetached){var a=new s(e.content),o=new r({tag:"a0",explicit:!0,obj:a});t.push(o)}return new n({array:t}).getEncodedHex()},this.setByParam=function(e){this.params=e},null!=e&&this.setByParam(e)},Je(ue.asn1.cms.EncapsulatedContentInfo,ue.asn1.ASN1Object),ue.asn1.cms.ContentInfo=function(e){var t=ue.asn1,r=t.DERTaggedObject,n=t.DERSequence,i=t.DERObjectIdentifier;t.x509.OID.name2obj;ue.asn1.cms.ContentInfo.superclass.constructor.call(this),this.params=null,this.getEncodedHex=function(){var e=this.params,t=[];t.push(new i(e.type));var s=new r({tag:"a0",explicit:!0,obj:e.obj});return t.push(s),new n({array:t}).getEncodedHex()},this.setByParam=function(e){this.params=e},null!=e&&this.setByParam(e)},Je(ue.asn1.cms.ContentInfo,ue.asn1.ASN1Object),ue.asn1.cms.SignedData=function(e){Error;var t=ue.asn1,r=(t.ASN1Object,t.DERInteger),n=t.DERSet,i=t.DERSequence,s=(t.DERTaggedObject,t.cms),a=s.EncapsulatedContentInfo,o=s.SignerInfo,u=s.ContentInfo,h=s.CertificateSet,l=s.RevocationInfoChoices,c=t.x509.AlgorithmIdentifier;ue.asn1.cms.SignedData.superclass.constructor.call(this),this.params=null,this.checkAndFixParam=function(){var e=this.params;this._setDigestAlgs(e),this._setContentTypeByEContent(e),this._setMessageDigestByEContent(e),this._setSignerInfoVersion(e),this._setSignedDataVersion(e)},this._setDigestAlgs=function(e){for(var t={},r=e.sinfos,n=0;n<r.length;n++){t[r[n].hashalg]=1}e.hashalgs=Object.keys(t).sort()},this._setContentTypeByEContent=function(e){for(var t=e.econtent.type,r=e.sinfos,n=0;n<r.length;n++){var i=r[n];this._getAttrParamByName(i,"contentType").type=t}},this._setMessageDigestByEContent=function(e){var t=e.econtent,r=(e.econtent.type,t.content.hex);null==r&&"data"==t.type&&null!=t.content.str&&(r=xe(t.content.str));for(var n=e.sinfos,i=0;i<n.length;i++){var s=n[i],a=s.hashalg,o=this._getAttrParamByName(s,"messageDigest"),u=ue.crypto.Util.hashHex(r,a);o.hex=u}},this._getAttrParamByName=function(e,t){for(var r=e.sattrs.array,n=0;n<r.length;n++)if(r[n].attr==t)return r[n]},this._setSignerInfoVersion=function(e){for(var t=e.sinfos,r=0;r<t.length;r++){var n=t[r],i=1;"skid"==n.id.type&&(i=3),n.version=i}},this._setSignedDataVersion=function(e){var t=this._getSignedDataVersion(e);e.version=t},this._getSignedDataVersion=function(e){if(null!=e.revinfos)for(var t=e.revinfos,r=0;r<t.length;r++){if(null!=t[r].ocsp)return 5}var n=e.sinfos;for(r=0;r<n.length;r++){if(3==e.sinfos[r].version)return 3}return"data"!=e.econtent.type?3:1},this.getEncodedHex=function(){var e=this.params;null!=this.getEncodedHexPrepare&&this.getEncodedHexPrepare(),1!=e.fixed&&this.checkAndFixParam();var t=[];t.push(new r({int:e.version}));for(var s=[],u=0;u<e.hashalgs.length;u++){var f=e.hashalgs[u];s.push(new c({name:f}))}t.push(new n({array:s})),t.push(new a(e.econtent)),null!=e.certs&&t.push(new h(e.certs)),null!=e.revinfos&&t.push(new l(e.revinfos));var g=[];for(u=0;u<e.sinfos.length;u++){var d=e.sinfos[u];g.push(new o(d))}return t.push(new n({array:g})),new i({array:t}).getEncodedHex()},this.getContentInfo=function(){return new u({type:"signed-data",obj:this})},this.getContentInfoEncodedHex=function(){return this.getContentInfo().getEncodedHex()},null!=e&&this.setByParam(e)},Je(ue.asn1.cms.SignedData,ue.asn1.ASN1Object),ue.asn1.cms.CertificateSet=function(e){ue.asn1.cms.CertificateSet.superclass.constructor.call(this);var t=Error,r=ue.asn1,n=r.DERTaggedObject,i=r.DERSet,s=r.ASN1Object;this.params=null,this.getEncodedHex=function(){var e,r=this.params,a=[];if(r instanceof Array)e=r;else{if(null==r.array)throw new t("cert array not specified");e=r.array}for(var o=0;o<e.length;o++){var u=Ie(e[o]),h=new s;h.hTLV=u,a.push(h)}var l={array:a};0==r.sortflag&&(l.sortflag=!1);var c=new i(l);return new n({tag:"a0",explicit:!1,obj:c}).getEncodedHex()},null!=e&&this.setByParam(e)},Je(ue.asn1.cms.CertificateSet,ue.asn1.ASN1Object),ue.asn1.cms.RevocationInfoChoices=function(e){ue.asn1.cms.RevocationInfoChoices.superclass.constructor.call(this),this.params=null,this.getEncodedHex=function(){var e=this.params;if(!e instanceof Array)throw new Error("params is not array");for(var t=[],r=0;r<e.length;r++)t.push(new ue.asn1.cms.RevocationInfoChoice(e[r]));return ue.asn1.ASN1Util.newObject({tag:{tagi:"a1",obj:{set:t}}}).getEncodedHex()},null!=e&&this.setByParam(e)},Je(ue.asn1.cms.RevocationInfoChoices,ue.asn1.ASN1Object),ue.asn1.cms.RevocationInfoChoice=function(e){ue.asn1.cms.RevocationInfoChoice.superclass.constructor.call(this),this.params=null,this.getEncodedHex=function(){var e=this.params;if(null!=e.crl&&"string"==typeof e.crl){var t=e.crl;return-1!=e.crl.indexOf("-----BEGIN")&&(t=Ie(e.crl)),t}if(null!=e.ocsp)return ue.asn1.ASN1Util.newObject({tag:{tagi:"a1",obj:new ue.asn1.cms.OtherRevocationFormat(e)}}).getEncodedHex();throw new Error("property crl or ocsp undefined")},null!=e&&this.setByParam(e)},Je(ue.asn1.cms.RevocationInfoChoice,ue.asn1.ASN1Object),ue.asn1.cms.OtherRevocationFormat=function(e){ue.asn1.cms.OtherRevocationFormat.superclass.constructor.call(this);var t=Error,r=ue,n=r.asn1.ASN1Util.newObject,i=r.lang.String.isHex;this.params=null,this.getEncodedHex=function(){var e=this.params;if(null==e.ocsp)throw new t("property ocsp not specified");if(!i(e.ocsp)||!ce.isASN1HEX(e.ocsp))throw new t("ocsp value not ASN.1 hex string");return n({seq:[{oid:"1.3.6.1.5.5.7.16.2"},{asn1:{tlv:e.ocsp}}]}).getEncodedHex()},null!=e&&this.setByParam(e)},Je(ue.asn1.cms.OtherRevocationFormat,ue.asn1.ASN1Object),ue.asn1.cms.CMSUtil=new function(){},ue.asn1.cms.CMSUtil.newSignedData=function(e){return new ue.asn1.cms.SignedData(e)},ue.asn1.cms.CMSUtil.verifySignedData=function(e){var t=ue,r=t.asn1,n=r.cms,i=(n.SignerInfo,n.SignedData,n.SigningTime,n.SigningCertificate,n.SigningCertificateV2,r.cades.SignaturePolicyIdentifier,t.lang.String.isHex),s=ce,a=s.getVbyList,o=s.getTLVbyList,u=s.getIdxbyList,h=s.getChildIdx,l=s.getTLV,c=s.oidname,f=t.crypto.Util.hashHex;void 0===e.cms&&i(e.cms);var g=e.cms,d=function(e,t){var r=t.idx;t.signerid_issuer1=o(e,r,[1,0],"30"),t.signerid_serial1=a(e,r,[1,1],"02"),t.hashalg=c(a(e,r,[2,0],"06"));var n=u(e,r,[3],"a0");t.idxSignedAttrs=n,p(e,t,n);var i=h(e,r).length;if(i<6)throw"malformed SignerInfo";t.sigalg=c(a(e,r,[i-2,0],"06")),t.sigval=a(e,r,[i-1],"04")},p=function(e,t,r){var n=h(e,r);t.signedAttrIdxList=n;for(var i=0;i<n.length;i++){var s,o=n[i],u=a(e,o,[0],"06");"2a864886f70d010905"===u?(s=Se(a(e,o,[1,0])),t.saSigningTime=s):"2a864886f70d010904"===u&&(s=a(e,o,[1,0],"04"),t.saMessageDigest=s)}},m=function(e,t,r,n){r.verifyDetail={};var i=r.verifyDetail,s=t.parse.econtent,a=r.hashalg,o=r.saMessageDigest;i.validMessageDigest=!1,f(s,a)===o&&(i.validMessageDigest=!0),function(e,t,r,n){var i,s=t.parse.certsIdx;if(void 0===t.certs){i=[],t.certkeys=[];for(var a=h(e,s),o=0;o<a.length;o++){var u=l(e,a[o]),c=new Xe;c.readCertHex(u),i[o]=c,t.certkeys[o]=c.getPublicKey()}t.certs=i}else i=t.certs;for(t.cccc=i.length,t.cccci=a.length,o=0;o<i.length;o++){var f=c.getIssuerHex(),g=c.getSerialNumberHex();r.signerid_issuer1===f&&r.signerid_serial1===g&&(r.certkey_idx=o)}}(e,t,r),i.validSignatureValue=!1;var u=r.sigalg,c="31"+l(e,r.idxSignedAttrs).substr(2);r.signedattrshex=c;var g=t.certs[r.certkey_idx].getPublicKey(),d=new ue.crypto.Signature({alg:u});d.init(g),d.updateHex(c);var p=d.verify(r.sigval);i.validSignatureValue_isValid=p,!0===p&&(i.validSignatureValue=!0),r.isValid=!1,i.validMessageDigest&&i.validSignatureValue&&(r.isValid=!0)},y={isValid:!1,parse:{}};return function(e,t){if("2a864886f70d010702"!==a(e,0,[0],"06"))return t;t.cmsType="signedData",t.econtent=a(e,0,[1,0,2,1,0]),function(e,t){for(var r,n=3;n<6;n++)if(void 0!==(r=u(e,0,[1,0,n]))){var i=e.substr(r,2);"a0"===i&&(t.certsIdx=r),"a1"===i&&(t.revinfosIdx=r),"31"===i&&(t.signerinfosIdx=r)}}(e,t),t.signerInfos=[],function(e,t){var r=t.signerinfosIdx;if(void 0!==r){var n=h(e,r);t.signerInfoIdxList=n;for(var i=0;i<n.length;i++){var s={idx:n[i]};d(e,s),t.signerInfos.push(s)}}}(e,t)}(g,y.parse),function(e,t){for(var r=t.parse.signerInfos,n=r.length,i=!0,s=0;s<n;s++){var a=r[s];m(e,t,a,s),a.isValid||(i=!1)}t.isValid=i}(g,y),y},ue.asn1.cms.CMSParser=function(){var e=Error,t=Xe,r=new t,n=ce,i=n.getV,s=n.getTLV,a=(n.getIdxbyList,n.getTLVbyList),o=n.getTLVbyListEx,u=n.getVbyList,h=n.getVbyListEx,l=n.getChildIdx;this.getCMSSignedData=function(e){var t=a(e,0,[1,0]);return this.getSignedData(t)},this.getSignedData=function(e){var t=l(e,0),r={},n=i(e,t[0]),a=parseInt(n,16);r.version=a;var u=s(e,t[1]);r.hashalgs=this.getHashAlgArray(u);var h=s(e,t[2]);r.econtent=this.getEContent(h);var c=o(e,0,["[0]"]);null!=c&&(r.certs=this.getCertificateSet(c));o(e,0,["[1]"]);var f=o(e,0,[3]);return r.sinfos=this.getSignerInfos(f),r},this.getHashAlgArray=function(e){for(var r=l(e,0),n=new t,i=[],a=0;a<r.length;a++){var o=s(e,r[a]),u=n.getAlgorithmIdentifierName(o);i.push(u)}return i},this.getEContent=function(e){var t={},r=u(e,0,[0]),n=u(e,0,[1,0]);return t.type=ue.asn1.x509.OID.oid2name(ce.hextooidstr(r)),t.content={hex:n},t},this.getSignerInfos=function(e){for(var t=[],r=l(e,0),n=0;n<r.length;n++){var i=s(e,r[n]),a=this.getSignerInfo(i);t.push(a)}return t},this.getSignerInfo=function(e){var t={},i=l(e,0),a=n.getInt(e,i[0],-1);-1!=a&&(t.version=a);var u=s(e,i[1]),c=this.getIssuerAndSerialNumber(u);t.id=c;var f=s(e,i[2]),g=r.getAlgorithmIdentifierName(f);t.hashalg=g;var d=o(e,0,["[0]"]);if(null!=d){var p=this.getAttributeList(d);t.sattrs=p}var m=o(e,0,[3]),y=r.getAlgorithmIdentifierName(m);t.sigalg=y;var v=h(e,0,[4]);t.sighex=v;var b=o(e,0,["[1]"]);if(null!=b){var w=this.getAttributeList(b);t.uattrs=w}return t},this.getSignerIdentifier=function(e){if("30"==e.substr(0,2))return this.getIssuerAndSerialNumber(e);throw new Error("SKID of signerIdentifier not supported")},this.getIssuerAndSerialNumber=function(e){var t={type:"isssn"},n=l(e,0),a=s(e,n[0]);t.issuer=r.getX500Name(a);var o=i(e,n[1]);return t.serial={hex:o},t},this.getAttributeList=function(e){for(var t=[],r=l(e,0),n=0;n<r.length;n++){var i=s(e,r[n]),a=this.getAttribute(i);t.push(a)}return{array:t}},this.getAttribute=function(e){var t={},r=l(e,0),i=n.getOID(e,r[0]),a=ue.asn1.x509.OID.oid2name(i);t.attr=a;var o=s(e,r[1]),u=l(o,0);if(1==u.length)t.valhex=s(o,u[0]);else{for(var h=[],c=0;c<u.length;c++)h.push(s(o,u[c]));t.valhex=h}return"contentType"==a?this.setContentType(t):"messageDigest"==a?this.setMessageDigest(t):"signingTime"==a?this.setSigningTime(t):"signingCertificate"==a?this.setSigningCertificate(t):"signingCertificateV2"==a?this.setSigningCertificateV2(t):"signaturePolicyIdentifier"==a&&this.setSignaturePolicyIdentifier(t),t},this.setContentType=function(e){var t=n.getOIDName(e.valhex,0,null);null!=t&&(e.type=t,delete e.valhex)},this.setSigningTime=function(e){var t=Se(i(e.valhex,0));e.str=t,delete e.valhex},this.setMessageDigest=function(e){var t=i(e.valhex,0);e.hex=t,delete e.valhex},this.setSigningCertificate=function(e){var t=l(e.valhex,0);if(t.length>0){for(var r=s(e.valhex,t[0]),n=l(r,0),i=[],a=0;a<n.length;a++){var o=s(r,n[a]),u=this.getESSCertID(o);i.push(u)}e.array=i}if(t.length>1){var h=s(e.valhex,t[1]);e.polhex=h}delete e.valhex},this.setSignaturePolicyIdentifier=function(e){var r=l(e.valhex,0);if(r.length>0){var a=n.getOID(e.valhex,r[0]);e.oid=a}if(r.length>1){var o=new t,u=l(e.valhex,r[1]),h=s(e.valhex,u[0]),c=o.getAlgorithmIdentifierName(h);e.alg=c;var f=i(e.valhex,u[1]);e.hash=f}delete e.valhex},this.setSigningCertificateV2=function(e){var t=l(e.valhex,0);if(t.length>0){for(var r=s(e.valhex,t[0]),n=l(r,0),i=[],a=0;a<n.length;a++){var o=s(r,n[a]),u=this.getESSCertIDv2(o);i.push(u)}e.array=i}if(t.length>1){var h=s(e.valhex,t[1]);e.polhex=h}delete e.valhex},this.getESSCertID=function(e){var t={},r=l(e,0);if(r.length>0){var n=i(e,r[0]);t.hash=n}if(r.length>1){var a=s(e,r[1]),o=this.getIssuerSerial(a);null!=o.serial&&(t.serial=o.serial),null!=o.issuer&&(t.issuer=o.issuer)}return t},this.getESSCertIDv2=function(t){var n={},a=l(t,0);if(a.length<1||3<a.length)throw new e("wrong number of elements");var o=0;if("30"==t.substr(a[0],2)){var u=s(t,a[0]);n.alg=r.getAlgorithmIdentifierName(u),o++}else n.alg="sha256";var h=i(t,a[o]);if(n.hash=h,a.length>o+1){var c=s(t,a[o+1]),f=this.getIssuerSerial(c);n.issuer=f.issuer,n.serial=f.serial}return n},this.getIssuerSerial=function(e){var t={},n=l(e,0),a=s(e,n[0]),o=r.getGeneralNames(a)[0].dn;t.issuer=o;var u=i(e,n[1]);return t.serial={hex:u},t},this.getCertificateSet=function(e){for(var t=l(e,0),r=[],n=0;n<t.length;n++){var i=s(e,t[n]);if("30"==i.substr(0,2)){var a=Ce(i,"CERTIFICATE");r.push(a)}}return{array:r,sortflag:!1}}},void 0!==ue&&ue||(ue={}),void 0!==ue.asn1&&ue.asn1||(ue.asn1={}),void 0!==ue.asn1.tsp&&ue.asn1.tsp||(ue.asn1.tsp={}),ue.asn1.tsp.TimeStampToken=function(e){var t=ue.asn1.tsp;t.TimeStampToken.superclass.constructor.call(this),this.params=null,this.getEncodedHexPrepare=function(){var e=new t.TSTInfo(this.params.econtent.content);this.params.econtent.content.hex=e.getEncodedHex()},null!=e&&this.setByParam(e)},Je(ue.asn1.tsp.TimeStampToken,ue.asn1.cms.SignedData),ue.asn1.tsp.TSTInfo=function(e){Error;var t=ue.asn1,r=t.DERSequence,n=t.DERInteger,i=t.DERBoolean,s=t.DERGeneralizedTime,a=t.DERObjectIdentifier,o=t.DERTaggedObject,u=t.tsp,h=u.MessageImprint,l=u.Accuracy,c=(t.x509.X500Name,t.x509.GeneralName);if(u.TSTInfo.superclass.constructor.call(this),this.dVersion=new n({int:1}),this.dPolicy=null,this.dMessageImprint=null,this.dSerial=null,this.dGenTime=null,this.dAccuracy=null,this.dOrdering=null,this.dNonce=null,this.dTsa=null,this.getEncodedHex=function(){var e=[this.dVersion];if(null==this.dPolicy)throw new Error("policy shall be specified.");if(e.push(this.dPolicy),null==this.dMessageImprint)throw new Error("messageImprint shall be specified.");if(e.push(this.dMessageImprint),null==this.dSerial)throw new Error("serialNumber shall be specified.");if(e.push(this.dSerial),null==this.dGenTime)throw new Error("genTime shall be specified.");e.push(this.dGenTime),null!=this.dAccuracy&&e.push(this.dAccuracy),null!=this.dOrdering&&e.push(this.dOrdering),null!=this.dNonce&&e.push(this.dNonce),null!=this.dTsa&&e.push(this.dTsa);var t=new r({array:e});return this.hTLV=t.getEncodedHex(),this.hTLV},void 0!==e){if("string"==typeof e.policy){if(!e.policy.match(/^[0-9.]+$/))throw"policy shall be oid like 0.1.4.134";this.dPolicy=new a({oid:e.policy})}void 0!==e.messageImprint&&(this.dMessageImprint=new h(e.messageImprint)),void 0!==e.serial&&(this.dSerial=new n(e.serial)),void 0!==e.genTime&&(this.dGenTime=new s(e.genTime)),void 0!==e.accuracy&&(this.dAccuracy=new l(e.accuracy)),void 0!==e.ordering&&1==e.ordering&&(this.dOrdering=new i),void 0!==e.nonce&&(this.dNonce=new n(e.nonce)),void 0!==e.tsa&&(this.dTsa=new o({tag:"a0",explicit:!0,obj:new c({dn:e.tsa})}))}},Je(ue.asn1.tsp.TSTInfo,ue.asn1.ASN1Object),ue.asn1.tsp.Accuracy=function(e){var t=ue.asn1,r=t.ASN1Util.newObject;t.tsp.Accuracy.superclass.constructor.call(this),this.params=null,this.getEncodedHex=function(){var e=this.params,t=[];return null!=e.seconds&&"number"==typeof e.seconds&&t.push({int:e.seconds}),null!=e.millis&&"number"==typeof e.millis&&t.push({tag:{tagi:"80",obj:{int:e.millis}}}),null!=e.micros&&"number"==typeof e.micros&&t.push({tag:{tagi:"81",obj:{int:e.micros}}}),r({seq:t}).getEncodedHex()},null!=e&&this.setByParam(e)},Je(ue.asn1.tsp.Accuracy,ue.asn1.ASN1Object),ue.asn1.tsp.MessageImprint=function(e){var t=ue.asn1,r=t.DERSequence,n=t.DEROctetString,i=t.x509.AlgorithmIdentifier;t.tsp.MessageImprint.superclass.constructor.call(this),this.params=null,this.getEncodedHex=function(){var e=this.params,t=new i({name:e.alg}),s=new n({hex:e.hash});return new r({array:[t,s]}).getEncodedHex()},void 0!==e&&this.setByParam(e)},Je(ue.asn1.tsp.MessageImprint,ue.asn1.ASN1Object),ue.asn1.tsp.TimeStampReq=function(e){var t=ue.asn1,r=t.DERSequence,n=t.DERInteger,i=t.DERBoolean,s=(t.ASN1Object,t.DERObjectIdentifier),a=t.tsp,o=a.MessageImprint;a.TimeStampReq.superclass.constructor.call(this),this.params=null,this.getEncodedHex=function(){var e=this.params,t=[];return t.push(new n({int:1})),e.messageImprint instanceof ue.asn1.ASN1Object?t.push(e.messageImprint):t.push(new o(e.messageImprint)),null!=e.policy&&t.push(new s(e.policy)),null!=e.nonce&&t.push(new n(e.nonce)),1==e.certreq&&t.push(new i),new r({array:t}).getEncodedHex()},null!=e&&this.setByParam(e)},Je(ue.asn1.tsp.TimeStampReq,ue.asn1.ASN1Object),ue.asn1.tsp.TimeStampResp=function(e){var t=ue.asn1,r=t.DERSequence,n=(t.ASN1Object,t.tsp),i=n.PKIStatusInfo;n.TimeStampResp.superclass.constructor.call(this),this.params=null,this.getEncodedHex=function(){var e=this.params,s=[new i(e.statusinfo)];return null!=e.econtent&&s.push(new n.TimeStampToken(e).getContentInfo()),null!=e.tst&&e.tst instanceof t.ASN1Object&&s.push(e.tst),new r({array:s}).getEncodedHex()},null!=e&&this.setByParam(e)},Je(ue.asn1.tsp.TimeStampResp,ue.asn1.ASN1Object),ue.asn1.tsp.PKIStatusInfo=function(e){var t=Error,r=ue.asn1,n=r.DERSequence,i=r.tsp,s=i.PKIStatus,a=i.PKIFreeText,o=i.PKIFailureInfo;i.PKIStatusInfo.superclass.constructor.call(this),this.params=null,this.getEncodedHex=function(){var e=this.params,r=[];if("string"==typeof e)r.push(new s(e));else{if(null==e.status)throw new t("property 'status' unspecified");r.push(new s(e.status)),null!=e.statusstr&&r.push(new a(e.statusstr)),null!=e.failinfo&&r.push(new o(e.failinfo))}return new n({array:r}).getEncodedHex()},null!=e&&this.setByParam(e)},Je(ue.asn1.tsp.PKIStatusInfo,ue.asn1.ASN1Object),ue.asn1.tsp.PKIStatus=function(e){var t=Error,r=ue.asn1,n=r.DERInteger;r.tsp.PKIStatus.superclass.constructor.call(this);var i={granted:0,grantedWithMods:1,rejection:2,waiting:3,revocationWarning:4,revocationNotification:5};this.params=null,this.getEncodedHex=function(){var e,r=this.params;if("string"==typeof r)try{e=i[r]}catch(e){throw new t("undefined name: "+r)}else{if("number"!=typeof r)throw new t("unsupported params");e=r}return new n({int:e}).getEncodedHex()},null!=e&&this.setByParam(e)},Je(ue.asn1.tsp.PKIStatus,ue.asn1.ASN1Object),ue.asn1.tsp.PKIFreeText=function(e){var t=Error,r=ue.asn1,n=r.DERSequence,i=r.DERUTF8String;r.tsp.PKIFreeText.superclass.constructor.call(this),this.params=null,this.getEncodedHex=function(){var e=this.params;if(!e instanceof Array)throw new t("wrong params: not array");for(var r=[],s=0;s<e.length;s++)r.push(new i({str:e[s]}));return new n({array:r}).getEncodedHex()},null!=e&&this.setByParam(e)},Je(ue.asn1.tsp.PKIFreeText,ue.asn1.ASN1Object),ue.asn1.tsp.PKIFailureInfo=function(e){var t=Error,r=ue.asn1,n=r.DERBitString,i=r.tsp.PKIFailureInfo,s={badAlg:0,badRequest:2,badDataFormat:5,timeNotAvailable:14,unacceptedPolicy:15,unacceptedExtension:16,addInfoNotAvailable:17,systemFailure:25};i.superclass.constructor.call(this),this.params=null,this.getEncodedHex=function(){var e,r=this.params;if("string"==typeof r)try{e=s[r]}catch(e){throw new t("undefined name: "+r)}else{if("number"!=typeof r)throw new t("wrong params");e=r}return new n({bin:e.toString(2)}).getEncodedHex()},null!=e&&this.setByParam(e)},Je(ue.asn1.tsp.PKIFailureInfo,ue.asn1.ASN1Object),ue.asn1.tsp.AbstractTSAAdapter=function(e){this.getTSTHex=function(e,t){throw"not implemented yet"}},ue.asn1.tsp.SimpleTSAAdapter=function(e){var t=ue,r=t.asn1.tsp,n=t.crypto.Util.hashHex;r.SimpleTSAAdapter.superclass.constructor.call(this),this.params=null,this.serial=0,this.getTSTHex=function(e,t){var i=n(e,t);this.params.econtent.content.messageImprint={alg:t,hash:i},this.params.econtent.content.serial={int:this.serial++};var s=Math.floor(1e9*Math.random());return this.params.econtent.content.nonce={int:s},new r.TimeStampToken(this.params).getContentInfoEncodedHex()},void 0!==e&&(this.params=e)},Je(ue.asn1.tsp.SimpleTSAAdapter,ue.asn1.tsp.AbstractTSAAdapter),ue.asn1.tsp.FixedTSAAdapter=function(e){var t=ue,r=t.asn1.tsp,n=t.crypto.Util.hashHex;r.FixedTSAAdapter.superclass.constructor.call(this),this.params=null,this.getTSTHex=function(e,t){var i=n(e,t);return this.params.econtent.content.messageImprint={alg:t,hash:i},new r.TimeStampToken(this.params).getContentInfoEncodedHex()},void 0!==e&&(this.params=e)},Je(ue.asn1.tsp.FixedTSAAdapter,ue.asn1.tsp.AbstractTSAAdapter),ue.asn1.tsp.TSPUtil=new function(){},ue.asn1.tsp.TSPUtil.newTimeStampToken=function(e){return new ue.asn1.tsp.TimeStampToken(e)},ue.asn1.tsp.TSPUtil.parseTimeStampReq=function(e){var t=ce,r=t.getChildIdx,n=t.getV,i=t.getTLV,s={certreq:!1},a=r(e,0);if(a.length<2)throw"TimeStampReq must have at least 2 items";var o=i(e,a[1]);s.messageImprint=ue.asn1.tsp.TSPUtil.parseMessageImprint(o);for(var u=2;u<a.length;u++){var h=a[u],l=e.substr(h,2);if("06"==l){var c=n(e,h);s.policy=t.hextooidstr(c)}"02"==l&&(s.nonce=n(e,h)),"01"==l&&(s.certreq=!0)}return s},ue.asn1.tsp.TSPUtil.parseMessageImprint=function(e){var t=ce,r=t.getChildIdx,n=t.getV,i=t.getIdxbyList,s={};if("30"!=e.substr(0,2))throw"head of messageImprint hex shall be '30'";r(e,0);var a=n(e,i(e,0,[0,0])),o=t.hextooidstr(a),u=ue.asn1.x509.OID.oid2name(o);if(""==u)throw"hashAlg name undefined: "+o;var h=u,l=i(e,0,[1]);return s.alg=h,s.hash=n(e,l),s},ue.asn1.tsp.TSPParser=function(){Error;var e=new Xe,t=ce,r=t.getV,n=t.getTLV,i=t.getIdxbyList,s=(t.getTLVbyListEx,t.getChildIdx),a=["granted","grantedWithMods","rejection","waiting","revocationWarning","revocationNotification"],o={0:"badAlg",2:"badRequest",5:"badDataFormat",14:"timeNotAvailable",15:"unacceptedPolicy",16:"unacceptedExtension",17:"addInfoNotAvailable",25:"systemFailure"};this.getResponse=function(e){var t=s(e,0);if(1==t.length)return this.getPKIStatusInfo(n(e,t[0]));if(t.length>1){var r=this.getPKIStatusInfo(n(e,t[0])),i=n(e,t[1]),a=this.getToken(i);return a.statusinfo=r,a}},this.getToken=function(e){var t=(new ue.asn1.cms.CMSParser).getCMSSignedData(e);return this.setTSTInfo(t),t},this.setTSTInfo=function(e){var t=e.econtent;if("tstinfo"==t.type){var r=t.content.hex,n=this.getTSTInfo(r);t.content=n}},this.getTSTInfo=function(t){var i={},a=s(t,0),o=r(t,a[1]);i.policy=Ke(o);var u=n(t,a[2]);i.messageImprint=this.getMessageImprint(u);var h=r(t,a[3]);i.serial={hex:h};var l=r(t,a[4]);i.genTime={str:Se(l)};var c=0;if(a.length>5&&"30"==t.substr(a[5],2)){var f=n(t,a[5]);i.accuracy=this.getAccuracy(f),c++}a.length>5+c&&"01"==t.substr(a[5+c],2)&&("ff"==r(t,a[5+c])&&(i.ordering=!0),c++);if(a.length>5+c&&"02"==t.substr(a[5+c],2)){var g=r(t,a[5+c]);i.nonce={hex:g},c++}if(a.length>5+c&&"a0"==t.substr(a[5+c],2)){var d=n(t,a[5+c]);d="30"+d.substr(2),pGeneralNames=e.getGeneralNames(d);var p=pGeneralNames[0].dn;i.tsa=p,c++}if(a.length>5+c&&"a1"==t.substr(a[5+c],2)){var m=n(t,a[5+c]);m="30"+m.substr(2);var y=e.getExtParamArray(m);i.ext=y,c++}return i},this.getAccuracy=function(e){for(var t={},n=s(e,0),i=0;i<n.length;i++){var a=e.substr(n[i],2),o=r(e,n[i]),u=parseInt(o,16);"02"==a?t.seconds=u:"80"==a?t.millis=u:"81"==a&&(t.micros=u)}return t},this.getMessageImprint=function(e){if("30"!=e.substr(0,2))throw new Error("head of messageImprint hex shall be x30");var n={},a=(s(e,0),i(e,0,[0,0])),o=r(e,a),u=t.hextooidstr(o),h=ue.asn1.x509.OID.oid2name(u);if(""==h)throw new Error("hashAlg name undefined: "+u);var l=h,c=i(e,0,[1]);return n.alg=l,n.hash=r(e,c),n},this.getPKIStatusInfo=function(e){var t={},i=s(e,0),o=0;try{var u=r(e,i[0]),h=parseInt(u,16);t.status=a[h]}catch(e){}if(i.length>1&&"30"==e.substr(i[1],2)){var l=n(e,i[1]);t.statusstr=this.getPKIFreeText(l),o++}if(i.length>o&&"03"==e.substr(i[1+o],2)){var c=n(e,i[1+o]);t.failinfo=this.getPKIFailureInfo(c)}return t},this.getPKIFreeText=function(e){for(var r=[],n=s(e,0),i=0;i<n.length;i++)r.push(t.getString(e,n[i]));return r},this.getPKIFailureInfo=function(e){var r=t.getInt(e,0);return null!=o[r]?o[r]:r}},void 0!==ue&&ue||(ue={}),void 0!==ue.asn1&&ue.asn1||(ue.asn1={}),void 0!==ue.asn1.cades&&ue.asn1.cades||(ue.asn1.cades={}),ue.asn1.cades.SignaturePolicyIdentifier=function(e){var t=ue.asn1.cades,r=t.SignaturePolicyId;t.SignaturePolicyIdentifier.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.15",this.params=null,this.getValueArray=function(){return[new r(this.params)]},this.setByParam=function(e){this.params=e},null!=e&&this.setByParam(e)},Je(ue.asn1.cades.SignaturePolicyIdentifier,ue.asn1.cms.Attribute),ue.asn1.cades.SignaturePolicyId=function(e){var t=ue.asn1,r=t.DERSequence,n=t.DERObjectIdentifier,i=(t.x509.AlgorithmIdentifier,t.cades),s=i.SignaturePolicyId,a=i.OtherHashAlgAndValue;s.superclass.constructor.call(this),this.params=null,this.getEncodedHex=function(){var e=this.params,t=[];return t.push(new n(e.oid)),t.push(new a(e)),new r({array:t}).getEncodedHex()},this.setByParam=function(e){this.params=e},null!=e&&this.setByParam(e)},Je(ue.asn1.cades.SignaturePolicyId,ue.asn1.ASN1Object),ue.asn1.cades.OtherHashAlgAndValue=function(e){var t=Error,r=ue.asn1,n=r.DERSequence,i=r.DEROctetString,s=r.x509.AlgorithmIdentifier;r.cades.OtherHashAlgAndValue.superclass.constructor.call(this),this.params=null,this.getEncodedHex=function(){var e=this.params;if(null==e.alg)throw new t("property 'alg' not specified");if(null==e.hash&&null==e.cert)throw new t("property 'hash' nor 'cert' not specified");var r=null;if(null!=e.hash)r=e.hash;else if(null!=e.cert){if("string"!=typeof e.cert)throw new t("cert not string");var a=e.cert;-1!=e.cert.indexOf("-----BEGIN")&&(a=Ie(e.cert)),r=ue.crypto.Util.hashHex(a,e.alg)}var o=[];return o.push(new s({name:e.alg})),o.push(new i({hex:r})),new n({array:o}).getEncodedHex()},null!=e&&this.setByParam(e)},Je(ue.asn1.cades.OtherHashAlgAndValue,ue.asn1.ASN1Object),ue.asn1.cades.OtherHashValue=function(e){ue.asn1.cades.OtherHashValue.superclass.constructor.call(this);var t=Error,r=ue,n=(r.lang.String.isHex,r.asn1.DEROctetString);r.crypto.Util.hashHex;this.params=null,this.getEncodedHex=function(){var e=this.params;if(null==e.hash&&null==e.cert)throw new t("hash or cert not specified");var r=null;if(null!=e.hash)r=e.hash;else if(null!=e.cert){if("string"!=typeof e.cert)throw new t("cert not string");var i=e.cert;-1!=e.cert.indexOf("-----BEGIN")&&(i=Ie(e.cert)),r=ue.crypto.Util.hashHex(i,"sha1")}return new n({hex:r}).getEncodedHex()},null!=e&&this.setByParam(e)},Je(ue.asn1.cades.OtherHashValue,ue.asn1.ASN1Object),ue.asn1.cades.SignatureTimeStamp=function(e){var t=Error,r=ue,n=r.lang.String.isHex,i=r.asn1,s=i.ASN1Object;i.x509;i.cades.SignatureTimeStamp.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.14",this.params=null,this.getValueArray=function(){var e=this.params;if(null!=e.tst){if(n(e.tst))return(i=new s).hTLV=e.tst,[i];if(e.tst instanceof s)return[e.tst];throw new t("params.tst has wrong value")}if(null!=e.res){var r=e.res;if(r instanceof s&&(r=r.getEncodedHex()),"string"!=typeof r||!n(r))throw new t("params.res has wrong value");var i;ce.getTLVbyList(r,0,[1]);return(i=new s).hTLV=e.tst,[i]}},null!=e&&this.setByParam(e)},Je(ue.asn1.cades.SignatureTimeStamp,ue.asn1.cms.Attribute),ue.asn1.cades.CompleteCertificateRefs=function(e){var t=Error,r=ue,n=r.asn1,i=n.DERSequence,s=n.cades,a=s.OtherCertID,o=r.lang.String.isHex;s.CompleteCertificateRefs.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.21",this.params=null,this.getValueArray=function(){for(var e=this.params,r=[],n=0;n<e.array.length;n++){var s=e.array[n];if("string"==typeof s)if(-1!=s.indexOf("-----BEGIN"))s={cert:s};else{if(!o(s))throw new t("unsupported value: "+s);s={hash:s}}null!=e.alg&&null==s.alg&&(s.alg=e.alg),null!=e.hasis&&null==s.hasis&&(s.hasis=e.hasis);var u=new a(s);r.push(u)}return[new i({array:r})]},null!=e&&this.setByParam(e)},Je(ue.asn1.cades.CompleteCertificateRefs,ue.asn1.cms.Attribute),ue.asn1.cades.OtherCertID=function(e){var t=ue.asn1,r=t.DERSequence,n=t.cms.IssuerSerial,i=t.cades,s=i.OtherHashValue,a=i.OtherHashAlgAndValue;i.OtherCertID.superclass.constructor.call(this),this.params=e,this.getEncodedHex=function(){var e=this.params;"string"==typeof e&&(-1!=e.indexOf("-----BEGIN")?e={cert:e}:_isHex(e)&&(e={hash:e}));var t=[],i=null;if(i=null!=e.alg?new a(e):new s(e),t.push(i),null!=e.cert&&1==e.hasis||null!=e.issuer&&null!=e.serial){var o=new n(e);t.push(o)}return new r({array:t}).getEncodedHex()},null!=e&&this.setByParam(e)},Je(ue.asn1.cades.OtherCertID,ue.asn1.ASN1Object),ue.asn1.cades.OtherHash=function(e){Error;var t=ue,r=t.asn1,n=(r.cms,r.cades),i=n.OtherHashAlgAndValue,s=n.OtherHashValue,a=(t.crypto.Util.hashHex,t.lang.String.isHex);n.OtherHash.superclass.constructor.call(this),this.params=null,this.getEncodedHex=function(){var e=this.params;"string"==typeof e&&(-1!=e.indexOf("-----BEGIN")?e={cert:e}:a(e)&&(e={hash:e}));return(null!=e.alg?new i(e):new s(e)).getEncodedHex()},null!=e&&this.setByParam(e)},Je(ue.asn1.cades.OtherHash,ue.asn1.ASN1Object),ue.asn1.cades.CAdESUtil=new function(){},ue.asn1.cades.CAdESUtil.parseSignedDataForAddingUnsigned=function(e){return(new ue.asn1.cms.CMSParser).getCMSSignedData(e)},ue.asn1.cades.CAdESUtil.parseSignerInfoForAddingUnsigned=function(e,t,r){var n=ce,i=n.getChildIdx,s=n.getTLV,a=n.getV,o=ue.asn1,u=o.ASN1Object,h=o.cms,l=h.AttributeList,c=h.SignerInfo,f={},g=i(e,t);if(6!=g.length)throw"not supported items for SignerInfo (!=6)";var d=g.shift();f.version=s(e,d);var p=g.shift();f.si=s(e,p);var m=g.shift();f.digalg=s(e,m);var y=g.shift();f.sattrs=s(e,y);var v=g.shift();f.sigalg=s(e,v);var b=g.shift();f.sig=s(e,b),f.sigval=a(e,b);var w=null;return f.obj=new c,(w=new u).hTLV=f.version,f.obj.dCMSVersion=w,(w=new u).hTLV=f.si,f.obj.dSignerIdentifier=w,(w=new u).hTLV=f.digalg,f.obj.dDigestAlgorithm=w,(w=new u).hTLV=f.sattrs,f.obj.dSignedAttrs=w,(w=new u).hTLV=f.sigalg,f.obj.dSigAlg=w,(w=new u).hTLV=f.sig,f.obj.dSig=w,f.obj.dUnsignedAttrs=new l,f},void 0!==ue.asn1.csr&&ue.asn1.csr||(ue.asn1.csr={}),ue.asn1.csr.CertificationRequest=function(e){var t=ue.asn1,r=t.DERBitString,n=t.DERSequence,i=t.csr,s=(t.x509,i.CertificationRequestInfo);i.CertificationRequest.superclass.constructor.call(this),this.setByParam=function(e){this.params=e},this.sign=function(){var e=new s(this.params).getEncodedHex(),t=new ue.crypto.Signature({alg:this.params.sigalg});t.init(this.params.sbjprvkey),t.updateHex(e);var r=t.sign();this.params.sighex=r},this.getPEM=function(){return Ce(this.getEncodedHex(),"CERTIFICATE REQUEST")},this.getEncodedHex=function(){var e=this.params,t=new ue.asn1.csr.CertificationRequestInfo(this.params),i=new ue.asn1.x509.AlgorithmIdentifier({name:e.sigalg});if(null==e.sighex&&null!=e.sbjprvkey&&this.sign(),null==e.sighex)throw new Error("sighex or sbjprvkey parameter not defined");var s=new r({hex:"00"+e.sighex});return new n({array:[t,i,s]}).getEncodedHex()},void 0!==e&&this.setByParam(e)},Je(ue.asn1.csr.CertificationRequest,ue.asn1.ASN1Object),ue.asn1.csr.CertificationRequestInfo=function(e){var t=ue.asn1,r=(t.DERBitString,t.DERSequence),n=t.DERInteger,i=t.DERUTF8String,s=t.DERTaggedObject,a=t.ASN1Util.newObject,o=t.csr,u=t.x509,h=u.X500Name,l=u.Extensions,c=u.SubjectPublicKeyInfo;o.CertificationRequestInfo.superclass.constructor.call(this),this.params=null,this.setByParam=function(e){null!=e&&(this.params=e)},this.getEncodedHex=function(){var e=this.params,t=[];if(t.push(new n({int:0})),t.push(new h(e.subject)),t.push(new c($e.getKey(e.sbjpubkey))),null!=e.extreq){var o=new l(e.extreq),u=a({tag:{tag:"a0",explict:!0,obj:{seq:[{oid:"1.2.840.113549.1.9.14"},{set:[o]}]}}});t.push(u)}else t.push(new s({tag:"a0",explicit:!1,obj:new i({str:""})}));return new r({array:t}).getEncodedHex()},null!=e&&this.setByParam(e)},Je(ue.asn1.csr.CertificationRequestInfo,ue.asn1.ASN1Object),ue.asn1.csr.CSRUtil=new function(){},ue.asn1.csr.CSRUtil.newCSRPEM=function(e){return new ue.asn1.csr.CertificationRequest(e).getPEM()},ue.asn1.csr.CSRUtil.getParam=function(e){var t=ce,r=t.getV;_getIdxbyList=t.getIdxbyList,_getTLVbyList=t.getTLVbyList,_getTLVbyListEx=t.getTLVbyListEx,_getVbyListEx=t.getVbyListEx;var n={};if(-1==e.indexOf("-----BEGIN CERTIFICATE REQUEST"))throw new Error("argument is not PEM file");var i=Ie(e,"CERTIFICATE REQUEST");try{var s=_getTLVbyListEx(i,0,[0,1]);if("3000"==s)n.subject={};else{var a=new Xe;n.subject=a.getX500Name(s)}}catch(e){}var o=_getTLVbyListEx(i,0,[0,2]),u=$e.getKey(o,null,"pkcs8pub");n.sbjpubkey=$e.getPEM(u,"PKCS8PUB");var h,l,c=(h=i,l=_getIdxbyList(h,0,[0,3,0,0],"06"),"2a864886f70d01090e"!=r(h,l)?null:_getTLVbyList(h,0,[0,3,0,1,0],"30"));a=new Xe;null!=c&&(n.extreq=a.getExtParamArray(c));try{var f=_getTLVbyListEx(i,0,[1],"30");a=new Xe;n.sigalg=a.getAlgorithmIdentifierName(f)}catch(e){}try{var g=_getVbyListEx(i,0,[2]);n.sighex=g}catch(e){}return n},void 0!==ue&&ue||(ue={}),void 0!==ue.asn1&&ue.asn1||(ue.asn1={}),void 0!==ue.asn1.ocsp&&ue.asn1.ocsp||(ue.asn1.ocsp={}),ue.asn1.ocsp.DEFAULT_HASH="sha1",ue.asn1.ocsp.OCSPResponse=function(e){ue.asn1.ocsp.OCSPResponse.superclass.constructor.call(this);ue.asn1.DEREnumerated;var t=ue.asn1.ASN1Util.newObject,r=ue.asn1.ocsp.ResponseBytes,n=["successful","malformedRequest","internalError","tryLater","_not_used_","sigRequired","unauthorized"];this.params=null,this._getStatusCode=function(){var e=this.params.resstatus;return"number"==typeof e?e:"string"!=typeof e?-1:n.indexOf(e)},this.setByParam=function(e){this.params=e},this.getEncodedHex=function(){var e=this.params,n=this._getStatusCode();if(-1==n)throw new Error("responseStatus not supported: "+e.resstatus);if(0!=n)return t({seq:[{enum:{int:n}}]}).getEncodedHex();var i=new r(e);return t({seq:[{enum:{int:0}},{tag:{tag:"a0",explicit:!0,obj:i}}]}).getEncodedHex()},void 0!==e&&this.setByParam(e)},Je(ue.asn1.ocsp.OCSPResponse,ue.asn1.ASN1Object),ue.asn1.ocsp.ResponseBytes=function(e){ue.asn1.ocsp.ResponseBytes.superclass.constructor.call(this);var t=ue.asn1,r=t.DERSequence,n=t.DERObjectIdentifier,i=t.DEROctetString,s=t.ocsp.BasicOCSPResponse;this.params=null,this.setByParam=function(e){this.params=e},this.getEncodedHex=function(){var e=this.params;if("ocspBasic"!=e.restype)throw new Error("not supported responseType: "+e.restype);var t=new s(e),a=[];return a.push(new n({name:"ocspBasic"})),a.push(new i({hex:t.getEncodedHex()})),new r({array:a}).getEncodedHex()},void 0!==e&&this.setByParam(e)},Je(ue.asn1.ocsp.ResponseBytes,ue.asn1.ASN1Object),ue.asn1.ocsp.BasicOCSPResponse=function(e){ue.asn1.ocsp.BasicOCSPResponse.superclass.constructor.call(this);var t=Error,r=ue.asn1,n=r.ASN1Object,i=r.DERSequence,s=(r.DERGeneralizedTime,r.DERTaggedObject),a=r.DERBitString,o=(r.x509.Extensions,r.x509.AlgorithmIdentifier),u=r.ocsp;u.ResponderID;_SingleResponseList=u.SingleResponseList,_ResponseData=u.ResponseData,this.params=null,this.setByParam=function(e){this.params=e},this.sign=function(){var e=this.params,t=e.tbsresp.getEncodedHex(),r=new ue.crypto.Signature({alg:e.sigalg});r.init(e.reskey),r.updateHex(t),e.sighex=r.sign()},this.getEncodedHex=function(){var e=this.params;null==e.tbsresp&&(e.tbsresp=new _ResponseData(e)),null==e.sighex&&null!=e.reskey&&this.sign();var r=[];if(r.push(e.tbsresp),r.push(new o({name:e.sigalg})),r.push(new a({hex:"00"+e.sighex})),null!=e.certs&&null!=e.certs.length){for(var u=[],h=0;h<e.certs.length;h++){var l=e.certs[h],c=null;if(ce.isASN1HEX(l))c=l;else{if(!l.match(/-----BEGIN/))throw new t("certs["+h+"] not hex or PEM");c=Ie(l)}u.push(new n({tlv:c}))}var f=new i({array:u});r.push(new s({tag:"a0",explicit:!0,obj:f}))}return new i({array:r}).getEncodedHex()},void 0!==e&&this.setByParam(e)},Je(ue.asn1.ocsp.BasicOCSPResponse,ue.asn1.ASN1Object),ue.asn1.ocsp.ResponseData=function(e){ue.asn1.ocsp.ResponseData.superclass.constructor.call(this);var t=Error,r=ue.asn1,n=r.DERSequence,i=r.DERGeneralizedTime,s=r.DERTaggedObject,a=r.x509.Extensions,o=r.ocsp,u=o.ResponderID;_SingleResponseList=o.SingleResponseList,this.params=null,this.getEncodedHex=function(){var e=this.params;null!=e.respid&&new t("respid not specified"),null!=e.prodat&&new t("prodat not specified"),null!=e.array&&new t("array not specified");var r=[];if(r.push(new u(e.respid)),r.push(new i(e.prodat)),r.push(new _SingleResponseList(e.array)),null!=e.ext){var o=new a(e.ext);r.push(new s({tag:"a1",explicit:!0,obj:o}))}return new n({array:r}).getEncodedHex()},this.setByParam=function(e){this.params=e},void 0!==e&&this.setByParam(e)},Je(ue.asn1.ocsp.ResponseData,ue.asn1.ASN1Object),ue.asn1.ocsp.ResponderID=function(e){ue.asn1.ocsp.ResponderID.superclass.constructor.call(this);var t=ue.asn1,r=t.ASN1Util.newObject,n=t.x509.X500Name;this.params=null,this.getEncodedHex=function(){var e=this.params;if(null!=e.key)return r({tag:{tag:"a2",explicit:!0,obj:{octstr:{hex:e.key}}}}).getEncodedHex();if(null!=e.name)return r({tag:{tag:"a1",explicit:!0,obj:new n(e.name)}}).getEncodedHex();throw new Error("key or name not specified")},this.setByParam=function(e){this.params=e},void 0!==e&&this.setByParam(e)},Je(ue.asn1.ocsp.ResponderID,ue.asn1.ASN1Object),ue.asn1.ocsp.SingleResponseList=function(e){ue.asn1.ocsp.SingleResponseList.superclass.constructor.call(this);var t=ue.asn1,r=t.DERSequence,n=t.ocsp.SingleResponse;this.params=null,this.getEncodedHex=function(){var e=this.params;if("object"!=typeof e||null==e.length)throw new Error("params not specified properly");for(var t=[],i=0;i<e.length;i++)t.push(new n(e[i]));return new r({array:t}).getEncodedHex()},this.setByParam=function(e){this.params=e},void 0!==e&&this.setByParam(e)},Je(ue.asn1.ocsp.SingleResponseList,ue.asn1.ASN1Object),ue.asn1.ocsp.SingleResponse=function(e){var t=Error,r=ue.asn1,n=r.DERSequence,i=r.DERGeneralizedTime,s=r.DERTaggedObject,a=r.ocsp,o=a.CertID,u=a.CertStatus,h=r.x509.Extensions;a.SingleResponse.superclass.constructor.call(this),this.params=null,this.getEncodedHex=function(){var e=this.params,r=[];if(null==e.certid)throw new t("certid unspecified");if(null==e.status)throw new t("status unspecified");if(null==e.thisupdate)throw new t("thisupdate unspecified");if(r.push(new o(e.certid)),r.push(new u(e.status)),r.push(new i(e.thisupdate)),null!=e.nextupdate){var a=new i(e.nextupdate);r.push(new s({tag:"a0",explicit:!0,obj:a}))}if(null!=e.ext){var l=new h(e.ext);r.push(new s({tag:"a1",explicit:!0,obj:l}))}return new n({array:r}).getEncodedHex()},this.setByParam=function(e){this.params=e},void 0!==e&&this.setByParam(e)},Je(ue.asn1.ocsp.SingleResponse,ue.asn1.ASN1Object),ue.asn1.ocsp.CertID=function(e){var t=ue,r=t.asn1,n=r.DEROctetString,i=r.DERInteger,s=r.DERSequence,a=r.x509.AlgorithmIdentifier,o=r.ocsp,u=o.DEFAULT_HASH,h=t.crypto.Util.hashHex,l=Xe,c=ce;if(o.CertID.superclass.constructor.call(this),this.dHashAlg=null,this.dIssuerNameHash=null,this.dIssuerKeyHash=null,this.dSerialNumber=null,this.setByValue=function(e,t,r,s){void 0===s&&(s=u),this.dHashAlg=new a({name:s}),this.dIssuerNameHash=new n({hex:e}),this.dIssuerKeyHash=new n({hex:t}),this.dSerialNumber=new i({hex:r})},this.setByCert=function(e,t,r){void 0===r&&(r=u);var n=new l;n.readCertPEM(t);var i=new l;i.readCertPEM(e);var s=i.getPublicKeyHex(),a=c.getVbyList(s,0,[1],"03",!0),o=n.getSerialNumberHex(),f=h(i.getSubjectHex(),r),g=h(a,r);this.setByValue(f,g,o,r),this.hoge=n.getSerialNumberHex()},this.getEncodedHex=function(){if(null===this.dHashAlg&&null===this.dIssuerNameHash&&null===this.dIssuerKeyHash&&null===this.dSerialNumber)throw"not yet set values";var e=[this.dHashAlg,this.dIssuerNameHash,this.dIssuerKeyHash,this.dSerialNumber],t=new s({array:e});return this.hTLV=t.getEncodedHex(),this.hTLV},void 0!==e){var f=e;if(void 0!==f.issuerCert&&void 0!==f.subjectCert){var g=u;void 0===f.alg&&(g=void 0),this.setByCert(f.issuerCert,f.subjectCert,g)}else{if(void 0===f.issname||void 0===f.isskey||void 0===f.sbjsn)throw new Error("invalid constructor arguments");g=u;void 0===f.alg&&(g=void 0),this.setByValue(f.issname,f.isskey,f.sbjsn,g)}}},Je(ue.asn1.ocsp.CertID,ue.asn1.ASN1Object),ue.asn1.ocsp.CertStatus=function(e){ue.asn1.ocsp.CertStatus.superclass.constructor.call(this),this.params=null,this.getEncodedHex=function(){var e=this.params;if("good"==e.status)return"8000";if("unknown"==e.status)return"8200";if("revoked"==e.status){var t=[{gentime:{str:e.time}}];null!=e.reason&&t.push({tag:{tag:"a0",explicit:!0,obj:{enum:{int:e.reason}}}});var r={tag:"a1",explicit:!1,obj:{seq:t}};return ue.asn1.ASN1Util.newObject({tag:r}).getEncodedHex()}throw new Error("bad status")},this.setByParam=function(e){this.params=e},void 0!==e&&this.setByParam(e)},Je(ue.asn1.ocsp.CertStatus,ue.asn1.ASN1Object),ue.asn1.ocsp.Request=function(e){var t=ue.asn1,r=t.DERSequence,n=t.ocsp;if(n.Request.superclass.constructor.call(this),this.dReqCert=null,this.dExt=null,this.getEncodedHex=function(){var e=[];if(null===this.dReqCert)throw"reqCert not set";e.push(this.dReqCert);var t=new r({array:e});return this.hTLV=t.getEncodedHex(),this.hTLV},void 0!==e){var i=new n.CertID(e);this.dReqCert=i}},Je(ue.asn1.ocsp.Request,ue.asn1.ASN1Object),ue.asn1.ocsp.TBSRequest=function(e){var t=ue.asn1,r=t.DERSequence,n=t.ocsp;n.TBSRequest.superclass.constructor.call(this),this.version=0,this.dRequestorName=null,this.dRequestList=[],this.dRequestExt=null,this.setRequestListByParam=function(e){for(var t=[],r=0;r<e.length;r++){var i=new n.Request(e[0]);t.push(i)}this.dRequestList=t},this.getEncodedHex=function(){var e=[];if(0!==this.version)throw"not supported version: "+this.version;if(null!==this.dRequestorName)throw"requestorName not supported";var t=new r({array:this.dRequestList});if(e.push(t),null!==this.dRequestExt)throw"requestExtensions not supported";var n=new r({array:e});return this.hTLV=n.getEncodedHex(),this.hTLV},void 0!==e&&void 0!==e.reqList&&this.setRequestListByParam(e.reqList)},Je(ue.asn1.ocsp.TBSRequest,ue.asn1.ASN1Object),ue.asn1.ocsp.OCSPRequest=function(e){var t=ue.asn1,r=t.DERSequence,n=t.ocsp;if(n.OCSPRequest.superclass.constructor.call(this),this.dTbsRequest=null,this.dOptionalSignature=null,this.getEncodedHex=function(){var e=[];if(null===this.dTbsRequest)throw"tbsRequest not set";if(e.push(this.dTbsRequest),null!==this.dOptionalSignature)throw"optionalSignature not supported";var t=new r({array:e});return this.hTLV=t.getEncodedHex(),this.hTLV},void 0!==e&&void 0!==e.reqList){var i=new n.TBSRequest(e);this.dTbsRequest=i}},Je(ue.asn1.ocsp.OCSPRequest,ue.asn1.ASN1Object),ue.asn1.ocsp.OCSPUtil={},ue.asn1.ocsp.OCSPUtil.getRequestHex=function(e,t,r){var n=ue.asn1.ocsp;void 0===r&&(r=n.DEFAULT_HASH);var i={alg:r,issuerCert:e,subjectCert:t};return new n.OCSPRequest({reqList:[i]}).getEncodedHex()},ue.asn1.ocsp.OCSPUtil.getOCSPResponseInfo=function(e){var t=ce,r=t.getVbyList,n=t.getVbyListEx,i=t.getIdxbyList,s=(t.getIdxbyListEx,t.getV),a={};try{var o=n(e,0,[0],"0a");a.responseStatus=parseInt(o,16)}catch(e){}if(0!==a.responseStatus)return a;try{var u=i(e,0,[1,0,1,0,0,2,0,1]);"80"===e.substr(u,2)?a.certStatus="good":"a1"===e.substr(u,2)?(a.certStatus="revoked",a.revocationTime=Se(r(e,u,[0]))):"82"===e.substr(u,2)&&(a.certStatus="unknown")}catch(e){}try{var h=i(e,0,[1,0,1,0,0,2,0,2]);a.thisUpdate=Se(s(e,h))}catch(e){}try{var l=i(e,0,[1,0,1,0,0,2,0,3]);"a0"===e.substr(l,2)&&(a.nextUpdate=Se(r(e,l,[0])))}catch(e){}return a},ue.asn1.ocsp.OCSPParser=function(){var e=Error,t=Xe,r=new t,n=ce,i=n.getV,s=n.getTLV,a=n.getIdxbyList,o=n.getVbyList,u=n.getTLVbyList,h=n.getVbyListEx,l=n.getTLVbyListEx,c=n.getChildIdx;this.getOCSPRequest=function(t){var r=c(t,0);if(1!=r.length&&2!=r.length)throw new e("wrong number elements: "+r.length);return this.getTBSRequest(s(t,r[0]))},this.getTBSRequest=function(e){var t={},n=l(e,0,[0],"30");t.array=this.getRequestList(n);var i=l(e,0,["[2]",0],"30");return null!=i&&(t.ext=r.getExtParamArray(i)),t},this.getRequestList=function(e){for(var t=[],r=c(e,0),n=0;n<r.length;n++){e=s(e,r[n]);t.push(this.getRequest(e))}return t},this.getRequest=function(t){var n=c(t,0);if(1!=n.length&&2!=n.length)throw new e("wrong number elements: "+n.length);var i=this.getCertID(s(t,n[0]));if(2==n.length){var o=a(t,0,[1,0]);i.ext=r.getExtParamArray(s(t,o))}return i},this.getCertID=function(r){var n=c(r,0);if(4!=n.length)throw new e("wrong number elements: "+n.length);var a=new t,o={};return o.alg=a.getAlgorithmIdentifierName(s(r,n[0])),o.issname=i(r,n[1]),o.isskey=i(r,n[2]),o.sbjsn=i(r,n[3]),o},this.getOCSPResponse=function(e){var t,r=c(e,0),n=i(e,r[0]),s=parseInt(n);if(1==r.length)return{resstatus:s};var a=u(e,0,[1,0]);return(t=this.getResponseBytes(a)).resstatus=s,t},this.getResponseBytes=function(e){var t,r=c(e,0),n=u(e,0,[1,0]);t=this.getBasicOCSPResponse(n);var s=i(e,r[0]);return t.restype=ue.asn1.x509.OID.oid2name(Ke(s)),t},this.getBasicOCSPResponse=function(e){var t,r=c(e,0);t=this.getResponseData(s(e,r[0]));var n=new Xe;t.alg=n.getAlgorithmIdentifierName(s(e,r[1]));var a=i(e,r[2]);t.sighex=a.substr(2);var o=h(e,0,["[0]"]);if(null!=o){for(var u=c(o,0),l=[],f=0;f<u.length;f++){var g=s(o,u[f]);l.push(g)}t.certs=l}return t},this.getResponseData=function(e){var t=c(e,0),r=t.length,n={},a=0;"a0"==e.substr(t[0],2)&&a++,n.respid=this.getResponderID(s(e,t[a++]));var o=i(e,t[a++]);if(n.prodat=Se(o),n.array=this.getSingleResponseList(s(e,t[a++])),"a1"==e.substr(t[r-1],2)){var h=u(e,t[r-1],[0]),l=new Xe;n.ext=l.getExtParamArray(h)}return n},this.getResponderID=function(e){var t={};if("a2"==e.substr(0,2)){var r=o(e,0,[0]);t.key=r}if("a1"==e.substr(0,2)){var n=u(e,0,[0]),i=new Xe;t.name=i.getX500Name(n)}return t},this.getSingleResponseList=function(e){for(var t=c(e,0),r=[],n=0;n<t.length;n++){var i=this.getSingleResponse(s(e,t[n]));r.push(i)}return r},this.getSingleResponse=function(e){var t=c(e,0),r={},n=this.getCertID(s(e,t[0]));r.certid=n;var a=this.getCertStatus(s(e,t[1]));if(r.status=a,"18"==e.substr(t[2],2)){var h=i(e,t[2]);r.thisupdate=Se(h)}for(var l=3;l<t.length;l++){if("a0"==e.substr(t[l],2)){var f=o(e,t[l],[0],"18");r.nextupdate=Se(f)}if("a1"==e.substr(t[l],2)){var g=new Xe,d=u(e,0,[l,0]);r.ext=g.getExtParamArray(d)}}return r},this.getCertStatus=function(e){var t={};if("8000"==e)return{status:"good"};if("8200"==e)return{status:"unknown"};if("a1"==e.substr(0,2)){t.status="revoked";var r=Se(o(e,0,[0]));t.time=r}return t}},void 0!==ue&&ue||(ue={}),void 0!==ue.lang&&ue.lang||(ue.lang={}),ue.lang.String=function(){},"function"==typeof Buffer?(he=function(e){return me(Buffer.from(e,"utf8").toString("base64"))},le=function(e){return Buffer.from(ye(e),"base64").toString("utf8")}):(he=function(e){return ve(Ne(Le(e)))},le=function(e){return decodeURIComponent(De(be(e)))}),ue.lang.String.isInteger=function(e){return!!e.match(/^[0-9]+$/)||!!e.match(/^-[0-9]+$/)},ue.lang.String.isHex=function(e){return je(e)},ue.lang.String.isBase64=function(e){return!(!(e=e.replace(/\s+/g,"")).match(/^[0-9A-Za-z+\/]+={0,3}$/)||e.length%4!=0)},ue.lang.String.isBase64URL=function(e){return!e.match(/[+/=]/)&&(e=ye(e),ue.lang.String.isBase64(e))},ue.lang.String.isIntegerArray=function(e){return!!(e=e.replace(/\s+/g,"")).match(/^\[[0-9,]+\]$/)},ue.lang.String.isPrintable=function(e){return null!==e.match(/^[0-9A-Za-z '()+,-./:=?]*$/)},ue.lang.String.isIA5=function(e){return null!==e.match(/^[\x20-\x21\x23-\x7f]*$/)},ue.lang.String.isMail=function(e){return null!==e.match(/^[A-Za-z0-9]{1}[A-Za-z0-9_.-]*@{1}[A-Za-z0-9_.-]{1,}\.[A-Za-z0-9]{1,}$/)};function _e(e){var t=function(e){var t=e.toString(16);return 1==t.length&&(t="0"+t),t},r=function(e){var r="",n=parseInt(e,10).toString(2),i=7-n.length%7;7==i&&(i=0);for(var s="",a=0;a<i;a++)s+="0";n=s+n;for(a=0;a<n.length-1;a+=7){var o=n.substr(a,7);a!=n.length-7&&(o="1"+o),r+=t(parseInt(o,2))}return r};try{if(!e.match(/^[0-9.]+$/))return null;var n="",i=e.split("."),s=40*parseInt(i[0],10)+parseInt(i[1],10);n+=t(s),i.splice(0,2);for(var a=0;a<i.length;a++)n+=r(i[a]);return n}catch(e){return null}}function Ke(e){if(!je(e))return null;try{var t=[],r=e.substr(0,2),n=parseInt(r,16);t[0]=new String(Math.floor(n/40)),t[1]=new String(n%40);for(var i=e.substr(2),s=[],a=0;a<i.length/2;a++)s.push(parseInt(i.substr(2*a,2),16));var o=[],u="";for(a=0;a<s.length;a++)128&s[a]?u+=Me((127&s[a]).toString(2),7):(u+=Me((127&s[a]).toString(2),7),o.push(new String(parseInt(u,2))),u="");var h=t.join(".");return o.length>0&&(h=h+"."+o.join(".")),h}catch(e){return null}}var Me=function(e,t,r){return null==r&&(r="0"),e.length>=t?e:new Array(t-e.length+1).join(r)+e};function qe(e){try{var t=e.substr(0,2);if("00"==t)return parseInt(e.substr(2),16);var r=parseInt(t,16),n=e.substr(2),i=parseInt(n,16).toString(2);return"0"==i&&(i="00000000"),i=i.slice(0,0-r),parseInt(i,2)}catch(e){return-1}}function Je(e,t){var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e,e.superclass=t.prototype,t.prototype.constructor==Object.prototype.constructor&&(t.prototype.constructor=t)}void 0!==ue&&ue||(ue={}),void 0!==ue.crypto&&ue.crypto||(ue.crypto={}),ue.crypto.Util=new function(){this.DIGESTINFOHEAD={sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",ripemd160:"3021300906052b2403020105000414"},this.DEFAULTPROVIDER={md5:"cryptojs",sha1:"cryptojs",sha224:"cryptojs",sha256:"cryptojs",sha384:"cryptojs",sha512:"cryptojs",ripemd160:"cryptojs",hmacmd5:"cryptojs",hmacsha1:"cryptojs",hmacsha224:"cryptojs",hmacsha256:"cryptojs",hmacsha384:"cryptojs",hmacsha512:"cryptojs",hmacripemd160:"cryptojs",MD5withRSA:"cryptojs/jsrsa",SHA1withRSA:"cryptojs/jsrsa",SHA224withRSA:"cryptojs/jsrsa",SHA256withRSA:"cryptojs/jsrsa",SHA384withRSA:"cryptojs/jsrsa",SHA512withRSA:"cryptojs/jsrsa",RIPEMD160withRSA:"cryptojs/jsrsa",MD5withECDSA:"cryptojs/jsrsa",SHA1withECDSA:"cryptojs/jsrsa",SHA224withECDSA:"cryptojs/jsrsa",SHA256withECDSA:"cryptojs/jsrsa",SHA384withECDSA:"cryptojs/jsrsa",SHA512withECDSA:"cryptojs/jsrsa",RIPEMD160withECDSA:"cryptojs/jsrsa",SHA1withDSA:"cryptojs/jsrsa",SHA224withDSA:"cryptojs/jsrsa",SHA256withDSA:"cryptojs/jsrsa",MD5withRSAandMGF1:"cryptojs/jsrsa",SHAwithRSAandMGF1:"cryptojs/jsrsa",SHA1withRSAandMGF1:"cryptojs/jsrsa",SHA224withRSAandMGF1:"cryptojs/jsrsa",SHA256withRSAandMGF1:"cryptojs/jsrsa",SHA384withRSAandMGF1:"cryptojs/jsrsa",SHA512withRSAandMGF1:"cryptojs/jsrsa",RIPEMD160withRSAandMGF1:"cryptojs/jsrsa"},this.CRYPTOJSMESSAGEDIGESTNAME={md5:p.algo.MD5,sha1:p.algo.SHA1,sha224:p.algo.SHA224,sha256:p.algo.SHA256,sha384:p.algo.SHA384,sha512:p.algo.SHA512,ripemd160:p.algo.RIPEMD160},this.getDigestInfoHex=function(e,t){if(void 0===this.DIGESTINFOHEAD[t])throw"alg not supported in Util.DIGESTINFOHEAD: "+t;return this.DIGESTINFOHEAD[t]+e},this.getPaddedDigestInfoHex=function(e,t,r){var n=this.getDigestInfoHex(e,t),i=r/4;if(n.length+22>i)throw"key is too short for SigAlg: keylen="+r+","+t;for(var s="0001",a="00"+n,o="",u=i-s.length-a.length,h=0;h<u;h+=2)o+="ff";return s+o+a},this.hashString=function(e,t){return new ue.crypto.MessageDigest({alg:t}).digestString(e)},this.hashHex=function(e,t){return new ue.crypto.MessageDigest({alg:t}).digestHex(e)},this.sha1=function(e){return this.hashString(e,"sha1")},this.sha256=function(e){return this.hashString(e,"sha256")},this.sha256Hex=function(e){return this.hashHex(e,"sha256")},this.sha512=function(e){return this.hashString(e,"sha512")},this.sha512Hex=function(e){return this.hashHex(e,"sha512")},this.isKey=function(e){return e instanceof re||e instanceof ue.crypto.DSA||e instanceof ue.crypto.ECDSA}},ue.crypto.Util.md5=function(e){return new ue.crypto.MessageDigest({alg:"md5",prov:"cryptojs"}).digestString(e)},ue.crypto.Util.ripemd160=function(e){return new ue.crypto.MessageDigest({alg:"ripemd160",prov:"cryptojs"}).digestString(e)},ue.crypto.Util.SECURERANDOMGEN=new Z,ue.crypto.Util.getRandomHexOfNbytes=function(e){var t=new Array(e);return ue.crypto.Util.SECURERANDOMGEN.nextBytes(t),de(t)},ue.crypto.Util.getRandomBigIntegerOfNbytes=function(e){return new S(ue.crypto.Util.getRandomHexOfNbytes(e),16)},ue.crypto.Util.getRandomHexOfNbits=function(e){var t=e%8,r=new Array((e-t)/8+1);return ue.crypto.Util.SECURERANDOMGEN.nextBytes(r),r[0]=(255<<t&255^255)&r[0],de(r)},ue.crypto.Util.getRandomBigIntegerOfNbits=function(e){return new S(ue.crypto.Util.getRandomHexOfNbits(e),16)},ue.crypto.Util.getRandomBigIntegerZeroToMax=function(e){for(var t=e.bitLength();;){var r=ue.crypto.Util.getRandomBigIntegerOfNbits(t);if(-1!=e.compareTo(r))return r}},ue.crypto.Util.getRandomBigIntegerMinToMax=function(e,t){var r=e.compareTo(t);if(1==r)throw"biMin is greater than biMax";if(0==r)return e;var n=t.subtract(e);return ue.crypto.Util.getRandomBigIntegerZeroToMax(n).add(e)},ue.crypto.MessageDigest=function(e){this.setAlgAndProvider=function(e,t){if(null!==(e=ue.crypto.MessageDigest.getCanonicalAlgName(e))&&void 0===t&&(t=ue.crypto.Util.DEFAULTPROVIDER[e]),-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(e)&&"cryptojs"==t){try{this.md=ue.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[e].create()}catch(t){throw"setAlgAndProvider hash alg set fail alg="+e+"/"+t}this.updateString=function(e){this.md.update(e)},this.updateHex=function(e){var t=p.enc.Hex.parse(e);this.md.update(t)},this.digest=function(){return this.md.finalize().toString(p.enc.Hex)},this.digestString=function(e){return this.updateString(e),this.digest()},this.digestHex=function(e){return this.updateHex(e),this.digest()}}if(-1!=":sha256:".indexOf(e)&&"sjcl"==t){try{this.md=new sjcl.hash.sha256}catch(t){throw"setAlgAndProvider hash alg set fail alg="+e+"/"+t}this.updateString=function(e){this.md.update(e)},this.updateHex=function(e){var t=sjcl.codec.hex.toBits(e);this.md.update(t)},this.digest=function(){var e=this.md.finalize();return sjcl.codec.hex.fromBits(e)},this.digestString=function(e){return this.updateString(e),this.digest()},this.digestHex=function(e){return this.updateHex(e),this.digest()}}},this.updateString=function(e){throw"updateString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.updateHex=function(e){throw"updateHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digest=function(){throw"digest() not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestString=function(e){throw"digestString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestHex=function(e){throw"digestHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},void 0!==e&&void 0!==e.alg&&(this.algName=e.alg,void 0===e.prov&&(this.provName=ue.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName))},ue.crypto.MessageDigest.getCanonicalAlgName=function(e){return"string"==typeof e&&(e=(e=e.toLowerCase()).replace(/-/,"")),e},ue.crypto.MessageDigest.getHashLength=function(e){var t=ue.crypto.MessageDigest,r=t.getCanonicalAlgName(e);if(void 0===t.HASHLENGTH[r])throw"not supported algorithm: "+e;return t.HASHLENGTH[r]},ue.crypto.MessageDigest.HASHLENGTH={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,ripemd160:20},ue.crypto.Mac=function(e){this.setAlgAndProvider=function(e,t){if(null==(e=e.toLowerCase())&&(e="hmacsha1"),"hmac"!=(e=e.toLowerCase()).substr(0,4))throw"setAlgAndProvider unsupported HMAC alg: "+e;void 0===t&&(t=ue.crypto.Util.DEFAULTPROVIDER[e]),this.algProv=e+"/"+t;var r=e.substr(4);if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(r)&&"cryptojs"==t){try{var n=ue.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[r];this.mac=p.algo.HMAC.create(n,this.pass)}catch(e){throw"setAlgAndProvider hash alg set fail hashAlg="+r+"/"+e}this.updateString=function(e){this.mac.update(e)},this.updateHex=function(e){var t=p.enc.Hex.parse(e);this.mac.update(t)},this.doFinal=function(){return this.mac.finalize().toString(p.enc.Hex)},this.doFinalString=function(e){return this.updateString(e),this.doFinal()},this.doFinalHex=function(e){return this.updateHex(e),this.doFinal()}}},this.updateString=function(e){throw"updateString(str) not supported for this alg/prov: "+this.algProv},this.updateHex=function(e){throw"updateHex(hex) not supported for this alg/prov: "+this.algProv},this.doFinal=function(){throw"digest() not supported for this alg/prov: "+this.algProv},this.doFinalString=function(e){throw"digestString(str) not supported for this alg/prov: "+this.algProv},this.doFinalHex=function(e){throw"digestHex(hex) not supported for this alg/prov: "+this.algProv},this.setPassword=function(e){if("string"==typeof e){var t=e;return e.length%2!=1&&e.match(/^[0-9A-Fa-f]+$/)||(t=xe(e)),void(this.pass=p.enc.Hex.parse(t))}if("object"!=typeof e)throw"KJUR.crypto.Mac unsupported password type: "+e;t=null;if(void 0!==e.hex){if(e.hex.length%2!=0||!e.hex.match(/^[0-9A-Fa-f]+$/))throw"Mac: wrong hex password: "+e.hex;t=e.hex}if(void 0!==e.utf8&&(t=we(e.utf8)),void 0!==e.rstr&&(t=xe(e.rstr)),void 0!==e.b64&&(t=b(e.b64)),void 0!==e.b64u&&(t=be(e.b64u)),null==t)throw"KJUR.crypto.Mac unsupported password type: "+e;this.pass=p.enc.Hex.parse(t)},void 0!==e&&(void 0!==e.pass&&this.setPassword(e.pass),void 0!==e.alg&&(this.algName=e.alg,void 0===e.prov&&(this.provName=ue.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName)))},ue.crypto.Signature=function(e){var t=null;if(this._setAlgNames=function(){var e=this.algName.match(/^(.+)with(.+)$/);e&&(this.mdAlgName=e[1].toLowerCase(),this.pubkeyAlgName=e[2].toLowerCase(),"rsaandmgf1"==this.pubkeyAlgName&&"sha"==this.mdAlgName&&(this.mdAlgName="sha1"))},this._zeroPaddingOfSignature=function(e,t){for(var r="",n=t/4-e.length,i=0;i<n;i++)r+="0";return r+e},this.setAlgAndProvider=function(e,t){if(this._setAlgNames(),"cryptojs/jsrsa"!=t)throw new Error("provider not supported: "+t);if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(this.mdAlgName)){try{this.md=new ue.crypto.MessageDigest({alg:this.mdAlgName})}catch(e){throw new Error("setAlgAndProvider hash alg set fail alg="+this.mdAlgName+"/"+e)}this.init=function(e,t){var r=null;try{r=void 0===t?$e.getKey(e):$e.getKey(e,t)}catch(e){throw"init failed:"+e}if(!0===r.isPrivate)this.prvKey=r,this.state="SIGN";else{if(!0!==r.isPublic)throw"init failed.:"+r;this.pubKey=r,this.state="VERIFY"}},this.updateString=function(e){this.md.updateString(e)},this.updateHex=function(e){this.md.updateHex(e)},this.sign=function(){if(this.sHashHex=this.md.digest(),void 0===this.prvKey&&void 0!==this.ecprvhex&&void 0!==this.eccurvename&&void 0!==ue.crypto.ECDSA&&(this.prvKey=new ue.crypto.ECDSA({curve:this.eccurvename,prv:this.ecprvhex})),this.prvKey instanceof re&&"rsaandmgf1"===this.pubkeyAlgName)this.hSign=this.prvKey.signWithMessageHashPSS(this.sHashHex,this.mdAlgName,this.pssSaltLen);else if(this.prvKey instanceof re&&"rsa"===this.pubkeyAlgName)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex,this.mdAlgName);else if(this.prvKey instanceof ue.crypto.ECDSA)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex);else{if(!(this.prvKey instanceof ue.crypto.DSA))throw"Signature: unsupported private key alg: "+this.pubkeyAlgName;this.hSign=this.prvKey.signWithMessageHash(this.sHashHex)}return this.hSign},this.signString=function(e){return this.updateString(e),this.sign()},this.signHex=function(e){return this.updateHex(e),this.sign()},this.verify=function(e){if(this.sHashHex=this.md.digest(),void 0===this.pubKey&&void 0!==this.ecpubhex&&void 0!==this.eccurvename&&void 0!==ue.crypto.ECDSA&&(this.pubKey=new ue.crypto.ECDSA({curve:this.eccurvename,pub:this.ecpubhex})),this.pubKey instanceof re&&"rsaandmgf1"===this.pubkeyAlgName)return this.pubKey.verifyWithMessageHashPSS(this.sHashHex,e,this.mdAlgName,this.pssSaltLen);if(this.pubKey instanceof re&&"rsa"===this.pubkeyAlgName)return this.pubKey.verifyWithMessageHash(this.sHashHex,e);if(void 0!==ue.crypto.ECDSA&&this.pubKey instanceof ue.crypto.ECDSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,e);if(void 0!==ue.crypto.DSA&&this.pubKey instanceof ue.crypto.DSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,e);throw"Signature: unsupported public key alg: "+this.pubkeyAlgName}}},this.init=function(e,t){throw"init(key, pass) not supported for this alg:prov="+this.algProvName},this.updateString=function(e){throw"updateString(str) not supported for this alg:prov="+this.algProvName},this.updateHex=function(e){throw"updateHex(hex) not supported for this alg:prov="+this.algProvName},this.sign=function(){throw"sign() not supported for this alg:prov="+this.algProvName},this.signString=function(e){throw"digestString(str) not supported for this alg:prov="+this.algProvName},this.signHex=function(e){throw"digestHex(hex) not supported for this alg:prov="+this.algProvName},this.verify=function(e){throw"verify(hSigVal) not supported for this alg:prov="+this.algProvName},this.initParams=e,void 0!==e&&(void 0!==e.alg&&(this.algName=e.alg,void 0===e.prov?this.provName=ue.crypto.Util.DEFAULTPROVIDER[this.algName]:this.provName=e.prov,this.algProvName=this.algName+":"+this.provName,this.setAlgAndProvider(this.algName,this.provName),this._setAlgNames()),void 0!==e.psssaltlen&&(this.pssSaltLen=e.psssaltlen),void 0!==e.prvkeypem)){if(void 0!==e.prvkeypas)throw"both prvkeypem and prvkeypas parameters not supported";try{t=$e.getKey(e.prvkeypem);this.init(t)}catch(e){throw"fatal error to load pem private key: "+e}}},ue.crypto.Cipher=function(e){},ue.crypto.Cipher.encrypt=function(e,t,r){if(t instanceof re&&t.isPublic){var n=ue.crypto.Cipher.getAlgByKeyAndName(t,r);if("RSA"===n)return t.encrypt(e);if("RSAOAEP"===n)return t.encryptOAEP(e,"sha1");var i=n.match(/^RSAOAEP(\d+)$/);if(null!==i)return t.encryptOAEP(e,"sha"+i[1]);throw"Cipher.encrypt: unsupported algorithm for RSAKey: "+r}throw"Cipher.encrypt: unsupported key or algorithm"},ue.crypto.Cipher.decrypt=function(e,t,r){if(t instanceof re&&t.isPrivate){var n=ue.crypto.Cipher.getAlgByKeyAndName(t,r);if("RSA"===n)return t.decrypt(e);if("RSAOAEP"===n)return t.decryptOAEP(e,"sha1");var i=n.match(/^RSAOAEP(\d+)$/);if(null!==i)return t.decryptOAEP(e,"sha"+i[1]);throw"Cipher.decrypt: unsupported algorithm for RSAKey: "+r}throw"Cipher.decrypt: unsupported key or algorithm"},ue.crypto.Cipher.getAlgByKeyAndName=function(e,t){if(e instanceof re){if(-1!=":RSA:RSAOAEP:RSAOAEP224:RSAOAEP256:RSAOAEP384:RSAOAEP512:".indexOf(t))return t;if(null==t)return"RSA";throw"getAlgByKeyAndName: not supported algorithm name for RSAKey: "+t}throw"getAlgByKeyAndName: not supported algorithm name: "+t},ue.crypto.OID=new function(){this.oidhex2name={"2a864886f70d010101":"rsaEncryption","2a8648ce3d0201":"ecPublicKey","2a8648ce380401":"dsa","2a8648ce3d030107":"secp256r1","2b8104001f":"secp192k1","2b81040021":"secp224r1","2b8104000a":"secp256k1","2b81040023":"secp521r1","2b81040022":"secp384r1","2a8648ce380403":"SHA1withDSA","608648016503040301":"SHA224withDSA","608648016503040302":"SHA256withDSA"}},void 0!==ue&&ue||(ue={}),void 0!==ue.crypto&&ue.crypto||(ue.crypto={}),ue.crypto.ECDSA=function(e){var t=Error,r=S,n=se,i=ue.crypto.ECDSA,s=ue.crypto.ECParameterDB,a=i.getName,o=ce,u=o.getVbyListEx,h=o.isASN1HEX,l=new Z;this.type="EC",this.isPrivate=!1,this.isPublic=!1,this.getBigRandom=function(e){return new r(e.bitLength(),l).mod(e.subtract(r.ONE)).add(r.ONE)},this.setNamedCurve=function(e){this.ecparams=s.getByName(e),this.prvKeyHex=null,this.pubKeyHex=null,this.curveName=e},this.setPrivateKeyHex=function(e){this.isPrivate=!0,this.prvKeyHex=e},this.setPublicKeyHex=function(e){this.isPublic=!0,this.pubKeyHex=e},this.getPublicKeyXYHex=function(){var e=this.pubKeyHex;if("04"!==e.substr(0,2))throw"this method supports uncompressed format(04) only";var t=this.ecparams.keylen/4;if(e.length!==2+2*t)throw"malformed public key hex length";var r={};return r.x=e.substr(2,t),r.y=e.substr(2+t),r},this.getShortNISTPCurveName=function(){var e=this.curveName;return"secp256r1"===e||"NIST P-256"===e||"P-256"===e||"prime256v1"===e?"P-256":"secp384r1"===e||"NIST P-384"===e||"P-384"===e?"P-384":null},this.generateKeyPairHex=function(){var e=this.ecparams.n,t=this.getBigRandom(e),r=this.ecparams.G.multiply(t),n=r.getX().toBigInteger(),i=r.getY().toBigInteger(),s=this.ecparams.keylen/4,a=("0000000000"+t.toString(16)).slice(-s),o="04"+("0000000000"+n.toString(16)).slice(-s)+("0000000000"+i.toString(16)).slice(-s);return this.setPrivateKeyHex(a),this.setPublicKeyHex(o),{ecprvhex:a,ecpubhex:o}},this.signWithMessageHash=function(e){return this.signHex(e,this.prvKeyHex)},this.signHex=function(e,t){var n=new r(t,16),s=this.ecparams.n,a=new r(e.substring(0,this.ecparams.keylen/4),16);do{var o=this.getBigRandom(s),u=this.ecparams.G.multiply(o).getX().toBigInteger().mod(s)}while(u.compareTo(r.ZERO)<=0);var h=o.modInverse(s).multiply(a.add(n.multiply(u))).mod(s);return i.biRSSigToASN1Sig(u,h)},this.sign=function(e,t){var n=t,i=this.ecparams.n,s=r.fromByteArrayUnsigned(e);do{var a=this.getBigRandom(i),o=this.ecparams.G.multiply(a).getX().toBigInteger().mod(i)}while(o.compareTo(S.ZERO)<=0);var u=a.modInverse(i).multiply(s.add(n.multiply(o))).mod(i);return this.serializeSig(o,u)},this.verifyWithMessageHash=function(e,t){return this.verifyHex(e,t,this.pubKeyHex)},this.verifyHex=function(e,t,s){try{var a,o,u=i.parseSigHex(t);a=u.r,o=u.s;var h=n.decodeFromHex(this.ecparams.curve,s),l=new r(e.substring(0,this.ecparams.keylen/4),16);return this.verifyRaw(l,a,o,h)}catch(e){return!1}},this.verify=function(e,t,i){var s,a,o;if(Bitcoin.Util.isArray(t)){var u=this.parseSig(t);s=u.r,a=u.s}else{if("object"!=typeof t||!t.r||!t.s)throw"Invalid value for signature";s=t.r,a=t.s}if(i instanceof se)o=i;else{if(!Bitcoin.Util.isArray(i))throw"Invalid format for pubkey value, must be byte array or ECPointFp";o=n.decodeFrom(this.ecparams.curve,i)}var h=r.fromByteArrayUnsigned(e);return this.verifyRaw(h,s,a,o)},this.verifyRaw=function(e,t,n,i){var s=this.ecparams.n,a=this.ecparams.G;if(t.compareTo(r.ONE)<0||t.compareTo(s)>=0)return!1;if(n.compareTo(r.ONE)<0||n.compareTo(s)>=0)return!1;var o=n.modInverse(s),u=e.multiply(o).mod(s),h=t.multiply(o).mod(s);return a.multiply(u).add(i.multiply(h)).getX().toBigInteger().mod(s).equals(t)},this.serializeSig=function(e,t){var r=e.toByteArraySigned(),n=t.toByteArraySigned(),i=[];return i.push(2),i.push(r.length),(i=i.concat(r)).push(2),i.push(n.length),(i=i.concat(n)).unshift(i.length),i.unshift(48),i},this.parseSig=function(e){var t;if(48!=e[0])throw new Error("Signature not a valid DERSequence");if(2!=e[t=2])throw new Error("First element in signature must be a DERInteger");var n=e.slice(t+2,t+2+e[t+1]);if(2!=e[t+=2+e[t+1]])throw new Error("Second element in signature must be a DERInteger");var i=e.slice(t+2,t+2+e[t+1]);return t+=2+e[t+1],{r:r.fromByteArrayUnsigned(n),s:r.fromByteArrayUnsigned(i)}},this.parseSigCompact=function(e){if(65!==e.length)throw"Signature has the wrong length";var t=e[0]-27;if(t<0||t>7)throw"Invalid signature type";var n=this.ecparams.n;return{r:r.fromByteArrayUnsigned(e.slice(1,33)).mod(n),s:r.fromByteArrayUnsigned(e.slice(33,65)).mod(n),i:t}},this.readPKCS5PrvKeyHex=function(e){if(!1===h(e))throw new Error("not ASN.1 hex string");var t,r,n;try{t=u(e,0,["[0]",0],"06"),r=u(e,0,[1],"04");try{n=u(e,0,["[1]",0],"03")}catch(e){}}catch(e){throw new Error("malformed PKCS#1/5 plain ECC private key")}if(this.curveName=a(t),void 0===this.curveName)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(n),this.setPrivateKeyHex(r),this.isPublic=!1},this.readPKCS8PrvKeyHex=function(e){if(!1===h(e))throw new t("not ASN.1 hex string");var r,n,i;try{u(e,0,[1,0],"06"),r=u(e,0,[1,1],"06"),n=u(e,0,[2,0,1],"04");try{i=u(e,0,[2,0,"[1]",0],"03")}catch(e){}}catch(e){throw new t("malformed PKCS#8 plain ECC private key")}if(this.curveName=a(r),void 0===this.curveName)throw new t("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(i),this.setPrivateKeyHex(n),this.isPublic=!1},this.readPKCS8PubKeyHex=function(e){if(!1===h(e))throw new t("not ASN.1 hex string");var r,n;try{u(e,0,[0,0],"06"),r=u(e,0,[0,1],"06"),n=u(e,0,[1],"03")}catch(e){throw new t("malformed PKCS#8 ECC public key")}if(this.curveName=a(r),null===this.curveName)throw new t("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(n)},this.readCertPubKeyHex=function(e,r){if(!1===h(e))throw new t("not ASN.1 hex string");var n,i;try{n=u(e,0,[0,5,0,1],"06"),i=u(e,0,[0,5,1],"03")}catch(e){throw new t("malformed X.509 certificate ECC public key")}if(this.curveName=a(n),null===this.curveName)throw new t("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(i)},void 0!==e&&void 0!==e.curve&&(this.curveName=e.curve),void 0===this.curveName&&(this.curveName="secp256r1"),this.setNamedCurve(this.curveName),void 0!==e&&(void 0!==e.prv&&this.setPrivateKeyHex(e.prv),void 0!==e.pub&&this.setPublicKeyHex(e.pub))},ue.crypto.ECDSA.parseSigHex=function(e){var t=ue.crypto.ECDSA.parseSigHexInHexRS(e);return{r:new S(t.r,16),s:new S(t.s,16)}},ue.crypto.ECDSA.parseSigHexInHexRS=function(e){var t=ce,r=t.getChildIdx,n=t.getV;if(t.checkStrictDER(e,0),"30"!=e.substr(0,2))throw new Error("signature is not a ASN.1 sequence");var i=r(e,0);if(2!=i.length)throw new Error("signature shall have two elements");var s=i[0],a=i[1];if("02"!=e.substr(s,2))throw new Error("1st item not ASN.1 integer");if("02"!=e.substr(a,2))throw new Error("2nd item not ASN.1 integer");return{r:n(e,s),s:n(e,a)}},ue.crypto.ECDSA.asn1SigToConcatSig=function(e){var t=ue.crypto.ECDSA.parseSigHexInHexRS(e),r=t.r,n=t.s;if("00"==r.substr(0,2)&&r.length%32==2&&(r=r.substr(2)),"00"==n.substr(0,2)&&n.length%32==2&&(n=n.substr(2)),r.length%32==30&&(r="00"+r),n.length%32==30&&(n="00"+n),r.length%32!=0)throw"unknown ECDSA sig r length error";if(n.length%32!=0)throw"unknown ECDSA sig s length error";return r+n},ue.crypto.ECDSA.concatSigToASN1Sig=function(e){if(e.length/2*8%128!=0)throw"unknown ECDSA concatinated r-s sig  length error";var t=e.substr(0,e.length/2),r=e.substr(e.length/2);return ue.crypto.ECDSA.hexRSSigToASN1Sig(t,r)},ue.crypto.ECDSA.hexRSSigToASN1Sig=function(e,t){var r=new S(e,16),n=new S(t,16);return ue.crypto.ECDSA.biRSSigToASN1Sig(r,n)},ue.crypto.ECDSA.biRSSigToASN1Sig=function(e,t){var r=ue.asn1,n=new r.DERInteger({bigint:e}),i=new r.DERInteger({bigint:t});return new r.DERSequence({array:[n,i]}).getEncodedHex()},ue.crypto.ECDSA.getName=function(e){return"2b8104001f"===e?"secp192k1":"2a8648ce3d030107"===e?"secp256r1":"2b8104000a"===e?"secp256k1":"2b81040021"===e?"secp224r1":"2b81040022"===e?"secp384r1":-1!=="|secp256r1|NIST P-256|P-256|prime256v1|".indexOf(e)?"secp256r1":-1!=="|secp256k1|".indexOf(e)?"secp256k1":-1!=="|secp224r1|NIST P-224|P-224|".indexOf(e)?"secp224r1":-1!=="|secp384r1|NIST P-384|P-384|".indexOf(e)?"secp384r1":null},void 0!==ue&&ue||(ue={}),void 0!==ue.crypto&&ue.crypto||(ue.crypto={}),ue.crypto.ECParameterDB=new function(){var e={},t={};function r(e){return new S(e,16)}this.getByName=function(r){var n=r;if(void 0!==t[n]&&(n=t[r]),void 0!==e[n])return e[n];throw"unregistered EC curve name: "+n},this.regist=function(n,i,s,a,o,u,h,l,c,f,g,d){e[n]={};var p=r(s),m=r(a),y=r(o),v=r(u),b=r(h),w=new ae(p,m,y),S=w.decodePointHex("04"+l+c);e[n].name=n,e[n].keylen=i,e[n].curve=w,e[n].G=S,e[n].n=v,e[n].h=b,e[n].oid=g,e[n].info=d;for(var A=0;A<f.length;A++)t[f[A]]=n}},ue.crypto.ECParameterDB.regist("secp128r1",128,"FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC","E87579C11079F43DD824993C2CEE5ED3","FFFFFFFE0000000075A30D1B9038A115","1","161FF7528B899B2D0C28607CA52C5B86","CF5AC8395BAFEB13C02DA292DDED7A83",[],"","secp128r1 : SECG curve over a 128 bit prime field"),ue.crypto.ECParameterDB.regist("secp160k1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73","0","7","0100000000000000000001B8FA16DFAB9ACA16B6B3","1","3B4C382CE37AA192A4019E763036F4F5DD4D7EBB","938CF935318FDCED6BC28286531733C3F03C4FEE",[],"","secp160k1 : SECG curve over a 160 bit prime field"),ue.crypto.ECParameterDB.regist("secp160r1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC","1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45","0100000000000000000001F4C8F927AED3CA752257","1","4A96B5688EF573284664698968C38BB913CBFC82","23A628553168947D59DCC912042351377AC5FB32",[],"","secp160r1 : SECG curve over a 160 bit prime field"),ue.crypto.ECParameterDB.regist("secp192k1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37","0","3","FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D","1","DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D","9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D",[]),ue.crypto.ECParameterDB.regist("secp192r1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC","64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1","FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831","1","188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF1012","07192B95FFC8DA78631011ED6B24CDD573F977A11E794811",[]),ue.crypto.ECParameterDB.regist("secp224r1",224,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE","B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4","FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D","1","B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21","BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34",[]),ue.crypto.ECParameterDB.regist("secp256k1",256,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F","0","7","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141","1","79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798","483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8",[]),ue.crypto.ECParameterDB.regist("secp256r1",256,"FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC","5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B","FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551","1","6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296","4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5",["NIST P-256","P-256","prime256v1"]),ue.crypto.ECParameterDB.regist("secp384r1",384,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFC","B3312FA7E23EE7E4988E056BE3F82D19181D9C6EFE8141120314088F5013875AC656398D8A2ED19D2A85C8EDD3EC2AEF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC7634D81F4372DDF581A0DB248B0A77AECEC196ACCC52973","1","AA87CA22BE8B05378EB1C71EF320AD746E1D3B628BA79B9859F741E082542A385502F25DBF55296C3A545E3872760AB7","3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f",["NIST P-384","P-384"]),ue.crypto.ECParameterDB.regist("secp521r1",521,"1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC","051953EB9618E1C9A1F929A21A0B68540EEA2DA725B99B315F3B8B489918EF109E156193951EC7E937B1652C0BD3BB1BF073573DF883D2C34F1EF451FD46B503F00","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA51868783BF2F966B7FCC0148F709A5D03BB5C9B8899C47AEBB6FB71E91386409","1","C6858E06B70404E9CD9E3ECB662395B4429C648139053FB521F828AF606B4D3DBAA14B5E77EFE75928FE1DC127A2FFA8DE3348B3C1856A429BF97E7E31C2E5BD66","011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650",["NIST P-521","P-521"]),void 0!==ue&&ue||(ue={}),void 0!==ue.crypto&&ue.crypto||(ue.crypto={}),ue.crypto.DSA=function(){var e=ce,t=(e.getVbyList,e.getVbyListEx),r=e.isASN1HEX,n=S;this.p=null,this.q=null,this.g=null,this.y=null,this.x=null,this.type="DSA",this.isPrivate=!1,this.isPublic=!1,this.setPrivate=function(e,t,r,n,i){this.isPrivate=!0,this.p=e,this.q=t,this.g=r,this.y=n,this.x=i},this.setPrivateHex=function(e,t,r,n,i){var s,a,o,u,h;s=new S(e,16),a=new S(t,16),o=new S(r,16),u="string"==typeof n&&n.length>1?new S(n,16):null,h=new S(i,16),this.setPrivate(s,a,o,u,h)},this.setPublic=function(e,t,r,n){this.isPublic=!0,this.p=e,this.q=t,this.g=r,this.y=n,this.x=null},this.setPublicHex=function(e,t,r,n){var i,s,a,o;i=new S(e,16),s=new S(t,16),a=new S(r,16),o=new S(n,16),this.setPublic(i,s,a,o)},this.signWithMessageHash=function(e){var t=this.p,r=this.q,n=this.g,i=(this.y,this.x),s=ue.crypto.Util.getRandomBigIntegerMinToMax(S.ONE.add(S.ONE),r.subtract(S.ONE)),a=new S(e.substr(0,r.bitLength()/4),16),o=n.modPow(s,t).mod(r),u=s.modInverse(r).multiply(a.add(i.multiply(o))).mod(r);return ue.asn1.ASN1Util.jsonToASN1HEX({seq:[{int:{bigint:o}},{int:{bigint:u}}]})},this.verifyWithMessageHash=function(e,t){var r=this.p,n=this.q,i=this.g,s=this.y,a=this.parseASN1Signature(t),o=a[0],u=a[1],h=new S(e.substr(0,n.bitLength()/4),16);if(S.ZERO.compareTo(o)>0||o.compareTo(n)>0)throw"invalid DSA signature";if(S.ZERO.compareTo(u)>=0||u.compareTo(n)>0)throw"invalid DSA signature";var l=u.modInverse(n),c=h.multiply(l).mod(n),f=o.multiply(l).mod(n);return 0==i.modPow(c,r).multiply(s.modPow(f,r)).mod(r).mod(n).compareTo(o)},this.parseASN1Signature=function(e){try{return[new n(t(e,0,[0],"02"),16),new n(t(e,0,[1],"02"),16)]}catch(e){throw new Error("malformed ASN.1 DSA signature")}},this.readPKCS5PrvKeyHex=function(e){var n,i,s,a,o;if(!1===r(e))throw new Error("not ASN.1 hex string");try{n=t(e,0,[1],"02"),i=t(e,0,[2],"02"),s=t(e,0,[3],"02"),a=t(e,0,[4],"02"),o=t(e,0,[5],"02")}catch(e){throw new Error("malformed PKCS#1/5 plain DSA private key")}this.setPrivateHex(n,i,s,a,o)},this.readPKCS8PrvKeyHex=function(e){var n,i,s,a;if(!1===r(e))throw new Error("not ASN.1 hex string");try{n=t(e,0,[1,1,0],"02"),i=t(e,0,[1,1,1],"02"),s=t(e,0,[1,1,2],"02"),a=t(e,0,[2,0],"02")}catch(e){throw new Error("malformed PKCS#8 plain DSA private key")}this.setPrivateHex(n,i,s,null,a)},this.readPKCS8PubKeyHex=function(e){var n,i,s,a;if(!1===r(e))throw new Error("not ASN.1 hex string");try{n=t(e,0,[0,1,0],"02"),i=t(e,0,[0,1,1],"02"),s=t(e,0,[0,1,2],"02"),a=t(e,0,[1,0],"02")}catch(e){throw new Error("malformed PKCS#8 DSA public key")}this.setPublicHex(n,i,s,a)},this.readCertPubKeyHex=function(e,n){var i,s,a,o;if(!1===r(e))throw new Error("not ASN.1 hex string");try{i=t(e,0,[0,5,0,1,0],"02"),s=t(e,0,[0,5,0,1,1],"02"),a=t(e,0,[0,5,0,1,2],"02"),o=t(e,0,[0,5,1,0],"02")}catch(e){throw new Error("malformed X.509 certificate DSA public key")}this.setPublicHex(i,s,a,o)}};var $e=function(){var e=function(e,r,n){return t(p.AES,e,r,n)},t=function(e,t,r,n){var i=p.enc.Hex.parse(t),s=p.enc.Hex.parse(r),a=p.enc.Hex.parse(n),o={};o.key=s,o.iv=a,o.ciphertext=i;var u=e.decrypt(o,s,{iv:a});return p.enc.Hex.stringify(u)},r=function(e,t,r){return n(p.AES,e,t,r)},n=function(e,t,r,n){var i=p.enc.Hex.parse(t),s=p.enc.Hex.parse(r),a=p.enc.Hex.parse(n),o=e.encrypt(i,s,{iv:a}),u=p.enc.Hex.parse(o.toString());return p.enc.Base64.stringify(u)},i={"AES-256-CBC":{proc:e,eproc:r,keylen:32,ivlen:16},"AES-192-CBC":{proc:e,eproc:r,keylen:24,ivlen:16},"AES-128-CBC":{proc:e,eproc:r,keylen:16,ivlen:16},"DES-EDE3-CBC":{proc:function(e,r,n){return t(p.TripleDES,e,r,n)},eproc:function(e,t,r){return n(p.TripleDES,e,t,r)},keylen:24,ivlen:8},"DES-CBC":{proc:function(e,r,n){return t(p.DES,e,r,n)},eproc:function(e,t,r){return n(p.DES,e,t,r)},keylen:8,ivlen:8}},s=function(e){var t={},r=e.match(new RegExp("DEK-Info: ([^,]+),([0-9A-Fa-f]+)","m"));r&&(t.cipher=r[1],t.ivsalt=r[2]);var n=e.match(new RegExp("-----BEGIN ([A-Z]+) PRIVATE KEY-----"));n&&(t.type=n[1]);var i=-1,s=0;-1!=e.indexOf("\r\n\r\n")&&(i=e.indexOf("\r\n\r\n"),s=2),-1!=e.indexOf("\n\n")&&(i=e.indexOf("\n\n"),s=1);var a=e.indexOf("-----END");if(-1!=i&&-1!=a){var o=e.substring(i+2*s,a-s);o=o.replace(/\s+/g,""),t.data=o}return t},a=function(e,t,r){for(var n=r.substring(0,16),s=p.enc.Hex.parse(n),a=p.enc.Utf8.parse(t),o=i[e].keylen+i[e].ivlen,u="",h=null;;){var l=p.algo.MD5.create();if(null!=h&&l.update(h),l.update(a),l.update(s),h=l.finalize(),(u+=p.enc.Hex.stringify(h)).length>=2*o)break}var c={};return c.keyhex=u.substr(0,2*i[e].keylen),c.ivhex=u.substr(2*i[e].keylen,2*i[e].ivlen),c},o=function(e,t,r,n){var s=p.enc.Base64.parse(e),a=p.enc.Hex.stringify(s);return(0,i[t].proc)(a,r,n)};return{version:"1.0.0",parsePKCS5PEM:function(e){return s(e)},getKeyAndUnusedIvByPasscodeAndIvsalt:function(e,t,r){return a(e,t,r)},decryptKeyB64:function(e,t,r,n){return o(e,t,r,n)},getDecryptedKeyHex:function(e,t){var r=s(e),n=(r.type,r.cipher),i=r.ivsalt,u=r.data,h=a(n,t,i).keyhex;return o(u,n,h,i)},getEncryptedPKCS5PEMFromPrvKeyHex:function(e,t,r,n,s){var o="";if(void 0!==n&&null!=n||(n="AES-256-CBC"),void 0===i[n])throw new Error("KEYUTIL unsupported algorithm: "+n);void 0!==s&&null!=s||(s=function(e){var t=p.lib.WordArray.random(e);return p.enc.Hex.stringify(t)}(i[n].ivlen).toUpperCase());var u=function(e,t,r,n){return(0,i[t].eproc)(e,r,n)}(t,n,a(n,r,s).keyhex,s);o="-----BEGIN "+e+" PRIVATE KEY-----\r\n";return o+="Proc-Type: 4,ENCRYPTED\r\n",o+="DEK-Info: "+n+","+s+"\r\n",o+="\r\n",o+=u.replace(/(.{64})/g,"$1\r\n"),o+="\r\n-----END "+e+" PRIVATE KEY-----\r\n"},parseHexOfEncryptedPKCS8:function(e){var t=ce,r=t.getChildIdx,n=t.getV,i={},s=r(e,0);if(2!=s.length)throw new Error("malformed format: SEQUENCE(0).items != 2: "+s.length);i.ciphertext=n(e,s[1]);var a=r(e,s[0]);if(2!=a.length)throw new Error("malformed format: SEQUENCE(0.0).items != 2: "+a.length);if("2a864886f70d01050d"!=n(e,a[0]))throw new Error("this only supports pkcs5PBES2");var o=r(e,a[1]);if(2!=a.length)throw new Error("malformed format: SEQUENCE(0.0.1).items != 2: "+o.length);var u=r(e,o[1]);if(2!=u.length)throw new Error("malformed format: SEQUENCE(0.0.1.1).items != 2: "+u.length);if("2a864886f70d0307"!=n(e,u[0]))throw"this only supports TripleDES";i.encryptionSchemeAlg="TripleDES",i.encryptionSchemeIV=n(e,u[1]);var h=r(e,o[0]);if(2!=h.length)throw new Error("malformed format: SEQUENCE(0.0.1.0).items != 2: "+h.length);if("2a864886f70d01050c"!=n(e,h[0]))throw new Error("this only supports pkcs5PBKDF2");var l=r(e,h[1]);if(l.length<2)throw new Error("malformed format: SEQUENCE(0.0.1.0.1).items < 2: "+l.length);i.pbkdf2Salt=n(e,l[0]);var c=n(e,l[1]);try{i.pbkdf2Iter=parseInt(c,16)}catch(e){throw new Error("malformed format pbkdf2Iter: "+c)}return i},getPBKDF2KeyHexFromParam:function(e,t){var r=p.enc.Hex.parse(e.pbkdf2Salt),n=e.pbkdf2Iter,i=p.PBKDF2(t,r,{keySize:6,iterations:n});return p.enc.Hex.stringify(i)},_getPlainPKCS8HexFromEncryptedPKCS8PEM:function(e,t){var r=Ie(e,"ENCRYPTED PRIVATE KEY"),n=this.parseHexOfEncryptedPKCS8(r),i=$e.getPBKDF2KeyHexFromParam(n,t),s={};s.ciphertext=p.enc.Hex.parse(n.ciphertext);var a=p.enc.Hex.parse(i),o=p.enc.Hex.parse(n.encryptionSchemeIV),u=p.TripleDES.decrypt(s,a,{iv:o});return p.enc.Hex.stringify(u)},getKeyFromEncryptedPKCS8PEM:function(e,t){var r=this._getPlainPKCS8HexFromEncryptedPKCS8PEM(e,t);return this.getKeyFromPlainPrivatePKCS8Hex(r)},parsePlainPrivatePKCS8Hex:function(e){var t=ce,r=t.getChildIdx,n=t.getV,i={algparam:null};if("30"!=e.substr(0,2))throw new Error("malformed plain PKCS8 private key(code:001)");var s=r(e,0);if(s.length<3)throw new Error("malformed plain PKCS8 private key(code:002)");if("30"!=e.substr(s[1],2))throw new Error("malformed PKCS8 private key(code:003)");var a=r(e,s[1]);if(2!=a.length)throw new Error("malformed PKCS8 private key(code:004)");if("06"!=e.substr(a[0],2))throw new Error("malformed PKCS8 private key(code:005)");if(i.algoid=n(e,a[0]),"06"==e.substr(a[1],2)&&(i.algparam=n(e,a[1])),"04"!=e.substr(s[2],2))throw new Error("malformed PKCS8 private key(code:006)");return i.keyidx=t.getVidx(e,s[2]),i},getKeyFromPlainPrivatePKCS8PEM:function(e){var t=Ie(e,"PRIVATE KEY");return this.getKeyFromPlainPrivatePKCS8Hex(t)},getKeyFromPlainPrivatePKCS8Hex:function(e){var t,r=this.parsePlainPrivatePKCS8Hex(e);if("2a864886f70d010101"==r.algoid)t=new re;else if("2a8648ce380401"==r.algoid)t=new ue.crypto.DSA;else{if("2a8648ce3d0201"!=r.algoid)throw new Error("unsupported private key algorithm");t=new ue.crypto.ECDSA}return t.readPKCS8PrvKeyHex(e),t},_getKeyFromPublicPKCS8Hex:function(e){var t,r=ce.getVbyList(e,0,[0,0],"06");if("2a864886f70d010101"===r)t=new re;else if("2a8648ce380401"===r)t=new ue.crypto.DSA;else{if("2a8648ce3d0201"!==r)throw new Error("unsupported PKCS#8 public key hex");t=new ue.crypto.ECDSA}return t.readPKCS8PubKeyHex(e),t},parsePublicRawRSAKeyHex:function(e){var t=ce,r=t.getChildIdx,n=t.getV,i={};if("30"!=e.substr(0,2))throw new Error("malformed RSA key(code:001)");var s=r(e,0);if(2!=s.length)throw new Error("malformed RSA key(code:002)");if("02"!=e.substr(s[0],2))throw new Error("malformed RSA key(code:003)");if(i.n=n(e,s[0]),"02"!=e.substr(s[1],2))throw new Error("malformed RSA key(code:004)");return i.e=n(e,s[1]),i},parsePublicPKCS8Hex:function(e){var t=ce,r=t.getChildIdx,n=t.getV,i={algparam:null},s=r(e,0);if(2!=s.length)throw new Error("outer DERSequence shall have 2 elements: "+s.length);var a=s[0];if("30"!=e.substr(a,2))throw new Error("malformed PKCS8 public key(code:001)");var o=r(e,a);if(2!=o.length)throw new Error("malformed PKCS8 public key(code:002)");if("06"!=e.substr(o[0],2))throw new Error("malformed PKCS8 public key(code:003)");if(i.algoid=n(e,o[0]),"06"==e.substr(o[1],2)?i.algparam=n(e,o[1]):"30"==e.substr(o[1],2)&&(i.algparam={},i.algparam.p=t.getVbyList(e,o[1],[0],"02"),i.algparam.q=t.getVbyList(e,o[1],[1],"02"),i.algparam.g=t.getVbyList(e,o[1],[2],"02")),"03"!=e.substr(s[1],2))throw new Error("malformed PKCS8 public key(code:004)");return i.key=n(e,s[1]).substr(2),i}}}();$e.getKey=function(e,t,r){var n=(m=ce).getChildIdx,i=(m.getV,m.getVbyList),s=ue.crypto,a=s.ECDSA,o=s.DSA,u=re,h=Ie,l=$e;if(void 0!==u&&e instanceof u)return e;if(void 0!==a&&e instanceof a)return e;if(void 0!==o&&e instanceof o)return e;if(void 0!==e.curve&&void 0!==e.xy&&void 0===e.d)return new a({pub:e.xy,curve:e.curve});if(void 0!==e.curve&&void 0!==e.d)return new a({prv:e.d,curve:e.curve});if(void 0===e.kty&&void 0!==e.n&&void 0!==e.e&&void 0===e.d)return(I=new u).setPublic(e.n,e.e),I;if(void 0===e.kty&&void 0!==e.n&&void 0!==e.e&&void 0!==e.d&&void 0!==e.p&&void 0!==e.q&&void 0!==e.dp&&void 0!==e.dq&&void 0!==e.co&&void 0===e.qi)return(I=new u).setPrivateEx(e.n,e.e,e.d,e.p,e.q,e.dp,e.dq,e.co),I;if(void 0===e.kty&&void 0!==e.n&&void 0!==e.e&&void 0!==e.d&&void 0===e.p)return(I=new u).setPrivate(e.n,e.e,e.d),I;if(void 0!==e.p&&void 0!==e.q&&void 0!==e.g&&void 0!==e.y&&void 0===e.x)return(I=new o).setPublic(e.p,e.q,e.g,e.y),I;if(void 0!==e.p&&void 0!==e.q&&void 0!==e.g&&void 0!==e.y&&void 0!==e.x)return(I=new o).setPrivate(e.p,e.q,e.g,e.y,e.x),I;if("RSA"===e.kty&&void 0!==e.n&&void 0!==e.e&&void 0===e.d)return(I=new u).setPublic(be(e.n),be(e.e)),I;if("RSA"===e.kty&&void 0!==e.n&&void 0!==e.e&&void 0!==e.d&&void 0!==e.p&&void 0!==e.q&&void 0!==e.dp&&void 0!==e.dq&&void 0!==e.qi)return(I=new u).setPrivateEx(be(e.n),be(e.e),be(e.d),be(e.p),be(e.q),be(e.dp),be(e.dq),be(e.qi)),I;if("RSA"===e.kty&&void 0!==e.n&&void 0!==e.e&&void 0!==e.d)return(I=new u).setPrivate(be(e.n),be(e.e),be(e.d)),I;if("EC"===e.kty&&void 0!==e.crv&&void 0!==e.x&&void 0!==e.y&&void 0===e.d){var c=(C=new a({curve:e.crv})).ecparams.keylen/4,f="04"+("0000000000"+be(e.x)).slice(-c)+("0000000000"+be(e.y)).slice(-c);return C.setPublicKeyHex(f),C}if("EC"===e.kty&&void 0!==e.crv&&void 0!==e.x&&void 0!==e.y&&void 0!==e.d){c=(C=new a({curve:e.crv})).ecparams.keylen/4,f="04"+("0000000000"+be(e.x)).slice(-c)+("0000000000"+be(e.y)).slice(-c);var g=("0000000000"+be(e.d)).slice(-c);return C.setPublicKeyHex(f),C.setPrivateKeyHex(g),C}if("pkcs5prv"===r){var d,p=e,m=ce;if(9===(d=n(p,0)).length)(I=new u).readPKCS5PrvKeyHex(p);else if(6===d.length)(I=new o).readPKCS5PrvKeyHex(p);else{if(!(d.length>2&&"04"===p.substr(d[1],2)))throw new Error("unsupported PKCS#1/5 hexadecimal key");(I=new a).readPKCS5PrvKeyHex(p)}return I}if("pkcs8prv"===r)return I=l.getKeyFromPlainPrivatePKCS8Hex(e);if("pkcs8pub"===r)return l._getKeyFromPublicPKCS8Hex(e);if("x509pub"===r)return Xe.getPublicKeyFromCertHex(e);if(-1!=e.indexOf("-END CERTIFICATE-",0)||-1!=e.indexOf("-END X509 CERTIFICATE-",0)||-1!=e.indexOf("-END TRUSTED CERTIFICATE-",0))return Xe.getPublicKeyFromCertPEM(e);if(-1!=e.indexOf("-END PUBLIC KEY-")){var y=Ie(e,"PUBLIC KEY");return l._getKeyFromPublicPKCS8Hex(y)}if(-1!=e.indexOf("-END RSA PRIVATE KEY-")&&-1==e.indexOf("4,ENCRYPTED")){var v=h(e,"RSA PRIVATE KEY");return l.getKey(v,null,"pkcs5prv")}if(-1!=e.indexOf("-END DSA PRIVATE KEY-")&&-1==e.indexOf("4,ENCRYPTED")){var b=i(N=h(e,"DSA PRIVATE KEY"),0,[1],"02"),w=i(N,0,[2],"02"),A=i(N,0,[3],"02"),x=i(N,0,[4],"02"),E=i(N,0,[5],"02");return(I=new o).setPrivate(new S(b,16),new S(w,16),new S(A,16),new S(x,16),new S(E,16)),I}if(-1!=e.indexOf("-END EC PRIVATE KEY-")&&-1==e.indexOf("4,ENCRYPTED")){v=h(e,"EC PRIVATE KEY");return l.getKey(v,null,"pkcs5prv")}if(-1!=e.indexOf("-END PRIVATE KEY-"))return l.getKeyFromPlainPrivatePKCS8PEM(e);if(-1!=e.indexOf("-END RSA PRIVATE KEY-")&&-1!=e.indexOf("4,ENCRYPTED")){var B=l.getDecryptedKeyHex(e,t),k=new re;return k.readPKCS5PrvKeyHex(B),k}if(-1!=e.indexOf("-END EC PRIVATE KEY-")&&-1!=e.indexOf("4,ENCRYPTED")){var C,I=i(N=l.getDecryptedKeyHex(e,t),0,[1],"04"),F=i(N,0,[2,0],"06"),P=i(N,0,[3,0],"03").substr(2);if(void 0===ue.crypto.OID.oidhex2name[F])throw new Error("undefined OID(hex) in KJUR.crypto.OID: "+F);return(C=new a({curve:ue.crypto.OID.oidhex2name[F]})).setPublicKeyHex(P),C.setPrivateKeyHex(I),C.isPublic=!1,C}if(-1!=e.indexOf("-END DSA PRIVATE KEY-")&&-1!=e.indexOf("4,ENCRYPTED")){var N;b=i(N=l.getDecryptedKeyHex(e,t),0,[1],"02"),w=i(N,0,[2],"02"),A=i(N,0,[3],"02"),x=i(N,0,[4],"02"),E=i(N,0,[5],"02");return(I=new o).setPrivate(new S(b,16),new S(w,16),new S(A,16),new S(x,16),new S(E,16)),I}if(-1!=e.indexOf("-END ENCRYPTED PRIVATE KEY-"))return l.getKeyFromEncryptedPKCS8PEM(e,t);throw new Error("not supported argument")},$e.generateKeypair=function(e,t){if("RSA"==e){var r=t;(a=new re).generate(r,"10001"),a.isPrivate=!0,a.isPublic=!0;var n=new re,i=a.n.toString(16),s=a.e.toString(16);return n.setPublic(i,s),n.isPrivate=!1,n.isPublic=!0,(o={}).prvKeyObj=a,o.pubKeyObj=n,o}if("EC"==e){var a,o,u=t,h=new ue.crypto.ECDSA({curve:u}).generateKeyPairHex();return(a=new ue.crypto.ECDSA({curve:u})).setPublicKeyHex(h.ecpubhex),a.setPrivateKeyHex(h.ecprvhex),a.isPrivate=!0,a.isPublic=!1,(n=new ue.crypto.ECDSA({curve:u})).setPublicKeyHex(h.ecpubhex),n.isPrivate=!1,n.isPublic=!0,(o={}).prvKeyObj=a,o.pubKeyObj=n,o}throw new Error("unknown algorithm: "+e)},$e.getPEM=function(e,t,r,n,i,s){var a=ue,o=a.asn1,u=o.DERObjectIdentifier,h=o.DERInteger,l=o.ASN1Util.newObject,c=o.x509.SubjectPublicKeyInfo,f=a.crypto,g=f.DSA,d=f.ECDSA,m=re;function y(e){return l({seq:[{int:0},{int:{bigint:e.n}},{int:e.e},{int:{bigint:e.d}},{int:{bigint:e.p}},{int:{bigint:e.q}},{int:{bigint:e.dmp1}},{int:{bigint:e.dmq1}},{int:{bigint:e.coeff}}]})}function v(e){return l({seq:[{int:1},{octstr:{hex:e.prvKeyHex}},{tag:["a0",!0,{oid:{name:e.curveName}}]},{tag:["a1",!0,{bitstr:{hex:"00"+e.pubKeyHex}}]}]})}function b(e){return l({seq:[{int:0},{int:{bigint:e.p}},{int:{bigint:e.q}},{int:{bigint:e.g}},{int:{bigint:e.y}},{int:{bigint:e.x}}]})}if((void 0!==m&&e instanceof m||void 0!==g&&e instanceof g||void 0!==d&&e instanceof d)&&1==e.isPublic&&(void 0===t||"PKCS8PUB"==t))return Ce(x=new c(e).getEncodedHex(),"PUBLIC KEY");if("PKCS1PRV"==t&&void 0!==m&&e instanceof m&&(void 0===r||null==r)&&1==e.isPrivate)return Ce(x=y(e).getEncodedHex(),"RSA PRIVATE KEY");if("PKCS1PRV"==t&&void 0!==d&&e instanceof d&&(void 0===r||null==r)&&1==e.isPrivate){var w=new u({name:e.curveName}).getEncodedHex(),S=v(e).getEncodedHex(),A="";return A+=Ce(w,"EC PARAMETERS"),A+=Ce(S,"EC PRIVATE KEY")}if("PKCS1PRV"==t&&void 0!==g&&e instanceof g&&(void 0===r||null==r)&&1==e.isPrivate)return Ce(x=b(e).getEncodedHex(),"DSA PRIVATE KEY");if("PKCS5PRV"==t&&void 0!==m&&e instanceof m&&void 0!==r&&null!=r&&1==e.isPrivate){var x=y(e).getEncodedHex();return void 0===n&&(n="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("RSA",x,r,n,s)}if("PKCS5PRV"==t&&void 0!==d&&e instanceof d&&void 0!==r&&null!=r&&1==e.isPrivate){x=v(e).getEncodedHex();return void 0===n&&(n="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("EC",x,r,n,s)}if("PKCS5PRV"==t&&void 0!==g&&e instanceof g&&void 0!==r&&null!=r&&1==e.isPrivate){x=b(e).getEncodedHex();return void 0===n&&(n="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("DSA",x,r,n,s)}var E=function(e,t){var r=B(e,t);return new l({seq:[{seq:[{oid:{name:"pkcs5PBES2"}},{seq:[{seq:[{oid:{name:"pkcs5PBKDF2"}},{seq:[{octstr:{hex:r.pbkdf2Salt}},{int:r.pbkdf2Iter}]}]},{seq:[{oid:{name:"des-EDE3-CBC"}},{octstr:{hex:r.encryptionSchemeIV}}]}]}]},{octstr:{hex:r.ciphertext}}]}).getEncodedHex()},B=function(e,t){var r=p.lib.WordArray.random(8),n=p.lib.WordArray.random(8),i=p.PBKDF2(t,r,{keySize:6,iterations:100}),s=p.enc.Hex.parse(e),a=p.TripleDES.encrypt(s,i,{iv:n})+"",o={};return o.ciphertext=a,o.pbkdf2Salt=p.enc.Hex.stringify(r),o.pbkdf2Iter=100,o.encryptionSchemeAlg="DES-EDE3-CBC",o.encryptionSchemeIV=p.enc.Hex.stringify(n),o};if("PKCS8PRV"==t&&null!=m&&e instanceof m&&1==e.isPrivate){var k=y(e).getEncodedHex();x=l({seq:[{int:0},{seq:[{oid:{name:"rsaEncryption"}},{null:!0}]},{octstr:{hex:k}}]}).getEncodedHex();return void 0===r||null==r?Ce(x,"PRIVATE KEY"):Ce(S=E(x,r),"ENCRYPTED PRIVATE KEY")}if("PKCS8PRV"==t&&void 0!==d&&e instanceof d&&1==e.isPrivate){k=new l({seq:[{int:1},{octstr:{hex:e.prvKeyHex}},{tag:["a1",!0,{bitstr:{hex:"00"+e.pubKeyHex}}]}]}).getEncodedHex(),x=l({seq:[{int:0},{seq:[{oid:{name:"ecPublicKey"}},{oid:{name:e.curveName}}]},{octstr:{hex:k}}]}).getEncodedHex();return void 0===r||null==r?Ce(x,"PRIVATE KEY"):Ce(S=E(x,r),"ENCRYPTED PRIVATE KEY")}if("PKCS8PRV"==t&&void 0!==g&&e instanceof g&&1==e.isPrivate){k=new h({bigint:e.x}).getEncodedHex(),x=l({seq:[{int:0},{seq:[{oid:{name:"dsa"}},{seq:[{int:{bigint:e.p}},{int:{bigint:e.q}},{int:{bigint:e.g}}]}]},{octstr:{hex:k}}]}).getEncodedHex();return void 0===r||null==r?Ce(x,"PRIVATE KEY"):Ce(S=E(x,r),"ENCRYPTED PRIVATE KEY")}throw new Error("unsupported object nor format")},$e.getKeyFromCSRPEM=function(e){var t=Ie(e,"CERTIFICATE REQUEST");return $e.getKeyFromCSRHex(t)},$e.getKeyFromCSRHex=function(e){var t=$e.parseCSRHex(e);return $e.getKey(t.p8pubkeyhex,null,"pkcs8pub")},$e.parseCSRHex=function(e){var t=ce,r=t.getChildIdx,n=t.getTLV,i={},s=e;if("30"!=s.substr(0,2))throw new Error("malformed CSR(code:001)");var a=r(s,0);if(a.length<1)throw new Error("malformed CSR(code:002)");if("30"!=s.substr(a[0],2))throw new Error("malformed CSR(code:003)");var o=r(s,a[0]);if(o.length<3)throw new Error("malformed CSR(code:004)");return i.p8pubkeyhex=n(s,o[2]),i},$e.getKeyID=function(e){var t=$e,r=ce;"string"==typeof e&&-1!=e.indexOf("BEGIN ")&&(e=t.getKey(e));var n=Ie(t.getPEM(e)),i=r.getIdxbyList(n,0,[1]),s=r.getV(n,i).substring(2);return ue.crypto.Util.hashHex(s,"sha1")},$e.getJWKFromKey=function(e){var t={};if(e instanceof re&&e.isPrivate)return t.kty="RSA",t.n=ve(e.n.toString(16)),t.e=ve(e.e.toString(16)),t.d=ve(e.d.toString(16)),t.p=ve(e.p.toString(16)),t.q=ve(e.q.toString(16)),t.dp=ve(e.dmp1.toString(16)),t.dq=ve(e.dmq1.toString(16)),t.qi=ve(e.coeff.toString(16)),t;if(e instanceof re&&e.isPublic)return t.kty="RSA",t.n=ve(e.n.toString(16)),t.e=ve(e.e.toString(16)),t;if(e instanceof ue.crypto.ECDSA&&e.isPrivate){if("P-256"!==(n=e.getShortNISTPCurveName())&&"P-384"!==n)throw new Error("unsupported curve name for JWT: "+n);var r=e.getPublicKeyXYHex();return t.kty="EC",t.crv=n,t.x=ve(r.x),t.y=ve(r.y),t.d=ve(e.prvKeyHex),t}if(e instanceof ue.crypto.ECDSA&&e.isPublic){var n;if("P-256"!==(n=e.getShortNISTPCurveName())&&"P-384"!==n)throw new Error("unsupported curve name for JWT: "+n);r=e.getPublicKeyXYHex();return t.kty="EC",t.crv=n,t.x=ve(r.x),t.y=ve(r.y),t}throw new Error("not supported key object")},re.getPosArrayOfChildrenFromHex=function(e){return ce.getChildIdx(e,0)},re.getHexValueArrayOfChildrenFromHex=function(e){var t,r=ce.getV,n=r(e,(t=re.getPosArrayOfChildrenFromHex(e))[0]),i=r(e,t[1]),s=r(e,t[2]),a=r(e,t[3]),o=r(e,t[4]),u=r(e,t[5]),h=r(e,t[6]),l=r(e,t[7]),c=r(e,t[8]);return(t=new Array).push(n,i,s,a,o,u,h,l,c),t},re.prototype.readPrivateKeyFromPEMString=function(e){var t=Ie(e),r=re.getHexValueArrayOfChildrenFromHex(t);this.setPrivateEx(r[1],r[2],r[3],r[4],r[5],r[6],r[7],r[8])},re.prototype.readPKCS5PrvKeyHex=function(e){var t=re.getHexValueArrayOfChildrenFromHex(e);this.setPrivateEx(t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])},re.prototype.readPKCS8PrvKeyHex=function(e){var t,r,n,i,s,a,o,u,h=ce,l=h.getVbyListEx;if(!1===h.isASN1HEX(e))throw new Error("not ASN.1 hex string");try{t=l(e,0,[2,0,1],"02"),r=l(e,0,[2,0,2],"02"),n=l(e,0,[2,0,3],"02"),i=l(e,0,[2,0,4],"02"),s=l(e,0,[2,0,5],"02"),a=l(e,0,[2,0,6],"02"),o=l(e,0,[2,0,7],"02"),u=l(e,0,[2,0,8],"02")}catch(e){throw new Error("malformed PKCS#8 plain RSA private key")}this.setPrivateEx(t,r,n,i,s,a,o,u)},re.prototype.readPKCS5PubKeyHex=function(e){var t=ce,r=t.getV;if(!1===t.isASN1HEX(e))throw new Error("keyHex is not ASN.1 hex string");var n=t.getChildIdx(e,0);if(2!==n.length||"02"!==e.substr(n[0],2)||"02"!==e.substr(n[1],2))throw new Error("wrong hex for PKCS#5 public key");var i=r(e,n[0]),s=r(e,n[1]);this.setPublic(i,s)},re.prototype.readPKCS8PubKeyHex=function(e){var t=ce;if(!1===t.isASN1HEX(e))throw new Error("not ASN.1 hex string");if("06092a864886f70d010101"!==t.getTLVbyListEx(e,0,[0,0]))throw new Error("not PKCS8 RSA public key");var r=t.getTLVbyListEx(e,0,[1,0]);this.readPKCS5PubKeyHex(r)},re.prototype.readCertPubKeyHex=function(e,t){var r,n;(r=new Xe).readCertHex(e),n=r.getPublicKeyHex(),this.readPKCS8PubKeyHex(n)};function Ge(e,t){for(var r="",n=t/4-e.length,i=0;i<n;i++)r+="0";return r+e}function We(e,t,r){for(var n="",i=0;n.length<t;)n+=Ae(r(xe(e+String.fromCharCode.apply(String,[(4278190080&i)>>24,(16711680&i)>>16,(65280&i)>>8,255&i])))),i+=1;return n}function ze(e){for(var t in ue.crypto.Util.DIGESTINFOHEAD){var r=ue.crypto.Util.DIGESTINFOHEAD[t],n=r.length;if(e.substring(0,n)==r)return[t,e.substring(n)]}return[]}function Xe(e){var t,r=ce,n=r.getChildIdx,i=r.getV,s=r.getTLV,a=r.getVbyList,o=r.getVbyListEx,u=r.getTLVbyList,h=r.getTLVbyListEx,l=r.getIdxbyList,c=r.getIdxbyListEx,f=r.getVidx,g=r.getInt,d=r.oidname,p=r.hextooidstr,m=Ie;try{t=ue.asn1.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV}catch(e){}this.HEX2STAG={"0c":"utf8",13:"prn",16:"ia5","1a":"vis","1e":"bmp"},this.hex=null,this.version=0,this.foffset=0,this.aExtInfo=null,this.getVersion=function(){if(null===this.hex||0!==this.version)return this.version;var e=u(this.hex,0,[0,0]);if("a0"==e.substr(0,2)){var t=u(e,0,[0]),r=g(t,0);if(r<0||2<r)throw new Error("malformed version field");return this.version=r+1,this.version}return this.version=1,this.foffset=-1,1},this.getSerialNumberHex=function(){return o(this.hex,0,[0,0],"02")},this.getSignatureAlgorithmField=function(){var e=h(this.hex,0,[0,1]);return this.getAlgorithmIdentifierName(e)},this.getAlgorithmIdentifierName=function(e){for(var r in t)if(e===t[r])return r;return d(o(e,0,[0],"06"))},this.getIssuer=function(){return this.getX500Name(this.getIssuerHex())},this.getIssuerHex=function(){return u(this.hex,0,[0,3+this.foffset],"30")},this.getIssuerString=function(){return this.getIssuer().str},this.getSubject=function(){return this.getX500Name(this.getSubjectHex())},this.getSubjectHex=function(){return u(this.hex,0,[0,5+this.foffset],"30")},this.getSubjectString=function(){return this.getSubject().str},this.getNotBefore=function(){var e=a(this.hex,0,[0,4+this.foffset,0]);return e=e.replace(/(..)/g,"%$1"),e=decodeURIComponent(e)},this.getNotAfter=function(){var e=a(this.hex,0,[0,4+this.foffset,1]);return e=e.replace(/(..)/g,"%$1"),e=decodeURIComponent(e)},this.getPublicKeyHex=function(){return r.getTLVbyList(this.hex,0,[0,6+this.foffset],"30")},this.getPublicKeyIdx=function(){return l(this.hex,0,[0,6+this.foffset],"30")},this.getPublicKeyContentIdx=function(){var e=this.getPublicKeyIdx();return l(this.hex,e,[1,0],"30")},this.getPublicKey=function(){return $e.getKey(this.getPublicKeyHex(),null,"pkcs8pub")},this.getSignatureAlgorithmName=function(){var e=u(this.hex,0,[1],"30");return this.getAlgorithmIdentifierName(e)},this.getSignatureValueHex=function(){return a(this.hex,0,[2],"03",!0)},this.verifySignature=function(e){var t=this.getSignatureAlgorithmField(),r=this.getSignatureValueHex(),n=u(this.hex,0,[0],"30"),i=new ue.crypto.Signature({alg:t});return i.init(e),i.updateHex(n),i.verify(r)},this.parseExt=function(e){var t,s,o;if(void 0===e){if(o=this.hex,3!==this.version)return-1;t=l(o,0,[0,7,0],"30"),s=n(o,t)}else{o=Ie(e);var u=l(o,0,[0,3,0,0],"06");if("2a864886f70d01090e"!=i(o,u))return void(this.aExtInfo=new Array);t=l(o,0,[0,3,0,1,0],"30"),s=n(o,t),this.hex=o}this.aExtInfo=new Array;for(var h=0;h<s.length;h++){var c={critical:!1},g=0;3===n(o,s[h]).length&&(c.critical=!0,g=1),c.oid=r.hextooidstr(a(o,s[h],[0],"06"));var d=l(o,s[h],[1+g]);c.vidx=f(o,d),this.aExtInfo.push(c)}},this.getExtInfo=function(e){var t=this.aExtInfo,r=e;if(e.match(/^[0-9.]+$/)||(r=ue.asn1.x509.OID.name2oid(e)),""!==r)for(var n=0;n<t.length;n++)if(t[n].oid===r)return t[n]},this.getExtBasicConstraints=function(e,t){if(void 0===e&&void 0===t){var r=this.getExtInfo("basicConstraints");if(void 0===r)return;e=s(this.hex,r.vidx),t=r.critical}var n={extname:"basicConstraints"};if(t&&(n.critical=!0),"3000"===e)return n;if("30030101ff"===e)return n.cA=!0,n;if("30060101ff02"===e.substr(0,12)){var a=i(e,10),o=parseInt(a,16);return n.cA=!0,n.pathLen=o,n}throw new Error("hExtV parse error: "+e)},this.getExtKeyUsage=function(e,t){if(void 0===e&&void 0===t){var r=this.getExtInfo("keyUsage");if(void 0===r)return;e=s(this.hex,r.vidx),t=r.critical}var n={extname:"keyUsage"};return t&&(n.critical=!0),n.names=this.getExtKeyUsageString(e).split(","),n},this.getExtKeyUsageBin=function(e){if(void 0===e){var t=this.getExtInfo("keyUsage");if(void 0===t)return"";e=s(this.hex,t.vidx)}if(8!=e.length&&10!=e.length)throw new Error("malformed key usage value: "+e);var r="000000000000000"+parseInt(e.substr(6),16).toString(2);return 8==e.length&&(r=r.slice(-8)),10==e.length&&(r=r.slice(-16)),""==(r=r.replace(/0+$/,""))&&(r="0"),r},this.getExtKeyUsageString=function(e){for(var t=this.getExtKeyUsageBin(e),r=new Array,n=0;n<t.length;n++)"1"==t.substr(n,1)&&r.push(Xe.KEYUSAGE_NAME[n]);return r.join(",")},this.getExtSubjectKeyIdentifier=function(e,t){if(void 0===e&&void 0===t){var r=this.getExtInfo("subjectKeyIdentifier");if(void 0===r)return;e=s(this.hex,r.vidx),t=r.critical}var n={extname:"subjectKeyIdentifier"};t&&(n.critical=!0);var a=i(e,0);return n.kid={hex:a},n},this.getExtAuthorityKeyIdentifier=function(e,t){if(void 0===e&&void 0===t){var r=this.getExtInfo("authorityKeyIdentifier");if(void 0===r)return;e=s(this.hex,r.vidx),t=r.critical}var a={extname:"authorityKeyIdentifier"};t&&(a.critical=!0);for(var o=n(e,0),u=0;u<o.length;u++){var h=e.substr(o[u],2);if("80"===h&&(a.kid={hex:i(e,o[u])}),"a1"===h){var l=s(e,o[u]),c=this.getGeneralNames(l);a.issuer=c[0].dn}"82"===h&&(a.sn={hex:i(e,o[u])})}return a},this.getExtExtKeyUsage=function(e,t){if(void 0===e&&void 0===t){var r=this.getExtInfo("extKeyUsage");if(void 0===r)return;e=s(this.hex,r.vidx),t=r.critical}var a={extname:"extKeyUsage",array:[]};t&&(a.critical=!0);for(var o=n(e,0),u=0;u<o.length;u++)a.array.push(d(i(e,o[u])));return a},this.getExtExtKeyUsageName=function(){var e=this.getExtInfo("extKeyUsage");if(void 0===e)return e;var t=new Array,r=s(this.hex,e.vidx);if(""===r)return t;for(var a=n(r,0),o=0;o<a.length;o++)t.push(d(i(r,a[o])));return t},this.getExtSubjectAltName=function(e,t){if(void 0===e&&void 0===t){var r=this.getExtInfo("subjectAltName");if(void 0===r)return;e=s(this.hex,r.vidx),t=r.critical}var n={extname:"subjectAltName",array:[]};return t&&(n.critical=!0),n.array=this.getGeneralNames(e),n},this.getExtIssuerAltName=function(e,t){if(void 0===e&&void 0===t){var r=this.getExtInfo("issuerAltName");if(void 0===r)return;e=s(this.hex,r.vidx),t=r.critical}var n={extname:"issuerAltName",array:[]};return t&&(n.critical=!0),n.array=this.getGeneralNames(e),n},this.getGeneralNames=function(e){for(var t=n(e,0),r=[],i=0;i<t.length;i++){var a=this.getGeneralName(s(e,t[i]));void 0!==a&&r.push(a)}return r},this.getGeneralName=function(e){var t=e.substr(0,2),r=i(e,0),n=Ae(r);return"81"==t?{rfc822:n}:"82"==t?{dns:n}:"86"==t?{uri:n}:"87"==t?{ip:Oe(r)}:"a4"==t?{dn:this.getX500Name(r)}:void 0},this.getExtSubjectAltName2=function(){var e,t,r,a=this.getExtInfo("subjectAltName");if(void 0===a)return a;for(var o=new Array,u=s(this.hex,a.vidx),h=n(u,0),l=0;l<h.length;l++)r=u.substr(h[l],2),e=i(u,h[l]),"81"===r&&(t=Se(e),o.push(["MAIL",t])),"82"===r&&(t=Se(e),o.push(["DNS",t])),"84"===r&&(t=Xe.hex2dn(e,0),o.push(["DN",t])),"86"===r&&(t=Se(e),o.push(["URI",t])),"87"===r&&(t=Oe(e),o.push(["IP",t]));return o},this.getExtCRLDistributionPoints=function(e,t){if(void 0===e&&void 0===t){var r=this.getExtInfo("cRLDistributionPoints");if(void 0===r)return;e=s(this.hex,r.vidx),t=r.critical}var i={extname:"cRLDistributionPoints",array:[]};t&&(i.critical=!0);for(var a=n(e,0),o=0;o<a.length;o++){var u=s(e,a[o]);i.array.push(this.getDistributionPoint(u))}return i},this.getDistributionPoint=function(e){for(var t={},r=n(e,0),i=0;i<r.length;i++){var a=e.substr(r[i],2),o=s(e,r[i]);"a0"==a&&(t.dpname=this.getDistributionPointName(o))}return t},this.getDistributionPointName=function(e){for(var t={},r=n(e,0),i=0;i<r.length;i++){var a=e.substr(r[i],2),o=s(e,r[i]);"a0"==a&&(t.full=this.getGeneralNames(o))}return t},this.getExtCRLDistributionPointsURI=function(){var e=this.getExtInfo("cRLDistributionPoints");if(void 0===e)return e;for(var t=new Array,r=n(this.hex,e.vidx),i=0;i<r.length;i++)try{var s=Se(a(this.hex,r[i],[0,0,0],"86"));t.push(s)}catch(e){}return t},this.getExtAIAInfo=function(){var e=this.getExtInfo("authorityInfoAccess");if(void 0===e)return e;for(var t={ocsp:[],caissuer:[]},r=n(this.hex,e.vidx),i=0;i<r.length;i++){var s=a(this.hex,r[i],[0],"06"),o=a(this.hex,r[i],[1],"86");"2b06010505073001"===s&&t.ocsp.push(Se(o)),"2b06010505073002"===s&&t.caissuer.push(Se(o))}return t},this.getExtAuthorityInfoAccess=function(e,t){if(void 0===e&&void 0===t){var r=this.getExtInfo("authorityInfoAccess");if(void 0===r)return;e=s(this.hex,r.vidx),t=r.critical}var i={extname:"authorityInfoAccess",array:[]};t&&(i.critical=!0);for(var u=n(e,0),h=0;h<u.length;h++){var l=o(e,u[h],[0],"06"),c=Se(a(e,u[h],[1],"86"));if("2b06010505073001"==l)i.array.push({ocsp:c});else{if("2b06010505073002"!=l)throw new Error("unknown method: "+l);i.array.push({caissuer:c})}}return i},this.getExtCertificatePolicies=function(e,t){if(void 0===e&&void 0===t){var r=this.getExtInfo("certificatePolicies");if(void 0===r)return;e=s(this.hex,r.vidx),t=r.critical}var i={extname:"certificatePolicies",array:[]};t&&(i.critical=!0);for(var a=n(e,0),o=0;o<a.length;o++){var u=s(e,a[o]),h=this.getPolicyInformation(u);i.array.push(h)}return i},this.getPolicyInformation=function(e){var t={},r=a(e,0,[0],"06");t.policyoid=d(r);var i=c(e,0,[1],"30");if(-1!=i){t.array=[];for(var o=n(e,i),u=0;u<o.length;u++){var h=s(e,o[u]),l=this.getPolicyQualifierInfo(h);t.array.push(l)}}return t},this.getPolicyQualifierInfo=function(e){var t={},r=a(e,0,[0],"06");if("2b06010505070201"===r){var n=o(e,0,[1],"16");t.cps=Ae(n)}else if("2b06010505070202"===r){var i=u(e,0,[1],"30");t.unotice=this.getUserNotice(i)}return t},this.getUserNotice=function(e){for(var t={},r=n(e,0),i=0;i<r.length;i++){var a=s(e,r[i]);"30"!=a.substr(0,2)&&(t.exptext=this.getDisplayText(a))}return t},this.getDisplayText=function(e){var t={};return t.type={"0c":"utf8",16:"ia5","1a":"vis","1e":"bmp"}[e.substr(0,2)],t.str=Ae(i(e,0)),t},this.getExtCRLNumber=function(e,t){var r={extname:"cRLNumber"};if(t&&(r.critical=!0),"02"==e.substr(0,2))return r.num={hex:i(e,0)},r;throw new Error("hExtV parse error: "+e)},this.getExtCRLReason=function(e,t){var r={extname:"cRLReason"};if(t&&(r.critical=!0),"0a"==e.substr(0,2))return r.code=parseInt(i(e,0),16),r;throw new Error("hExtV parse error: "+e)},this.getExtOcspNonce=function(e,t){var r={extname:"ocspNonce"};t&&(r.critical=!0);var n=i(e,0);return r.hex=n,r},this.getExtOcspNoCheck=function(e,t){var r={extname:"ocspNoCheck"};return t&&(r.critical=!0),r},this.getExtAdobeTimeStamp=function(e,t){if(void 0===e&&void 0===t){var r=this.getExtInfo("adobeTimeStamp");if(void 0===r)return;e=s(this.hex,r.vidx),t=r.critical}var i={extname:"adobeTimeStamp"};t&&(i.critical=!0);var a=n(e,0);if(a.length>1){var o=s(e,a[1]),u=this.getGeneralName(o);null!=u.uri&&(i.uri=u.uri)}if(a.length>2){var h=s(e,a[2]);"0101ff"==h&&(i.reqauth=!0),"010100"==h&&(i.reqauth=!1)}return i},this.getX500NameRule=function(e){for(var t=null,r=[],n=0;n<e.length;n++)for(var i=e[n],s=0;s<i.length;s++)r.push(i[s]);for(n=0;n<r.length;n++){var a=r[n],o=a.ds,u=a.value,h=a.type;if(":"+o,"prn"!=o&&"utf8"!=o&&"ia5"!=o)return"mixed";if("ia5"==o){if("CN"!=h)return"mixed";if(ue.lang.String.isMail(u))continue;return"mixed"}if("C"==h){if("prn"==o)continue;return"mixed"}if(":"+o,null==t)t=o;else if(t!==o)return"mixed"}return null==t?"prn":t},this.getX500Name=function(e){var t=this.getX500NameArray(e);return{array:t,str:this.dnarraytostr(t)}},this.getX500NameArray=function(e){for(var t=[],r=n(e,0),i=0;i<r.length;i++)t.push(this.getRDN(s(e,r[i])));return t},this.getRDN=function(e){for(var t=[],r=n(e,0),i=0;i<r.length;i++)t.push(this.getAttrTypeAndValue(s(e,r[i])));return t},this.getAttrTypeAndValue=function(e){var t={type:null,value:null,ds:null},r=n(e,0),i=a(e,r[0],[],"06"),s=a(e,r[1],[]),o=ue.asn1.ASN1Util.oidHexToInt(i);return t.type=ue.asn1.x509.OID.oid2atype(o),t.ds=this.HEX2STAG[e.substr(r[1],2)],"bmp"!=t.ds?t.value=Se(s):t.value=Te(s),t},this.readCertPEM=function(e){this.readCertHex(m(e))},this.readCertHex=function(e){this.hex=e,this.getVersion();try{l(this.hex,0,[0,7],"a3"),this.parseExt()}catch(e){}},this.getParam=function(){var e={};return e.version=this.getVersion(),e.serial={hex:this.getSerialNumberHex()},e.sigalg=this.getSignatureAlgorithmField(),e.issuer=this.getIssuer(),e.notbefore=this.getNotBefore(),e.notafter=this.getNotAfter(),e.subject=this.getSubject(),e.sbjpubkey=Ce(this.getPublicKeyHex(),"PUBLIC KEY"),this.aExtInfo.length>0&&(e.ext=this.getExtParamArray()),e.sighex=this.getSignatureValueHex(),e},this.getExtParamArray=function(e){null==e&&(-1!=c(this.hex,0,[0,"[3]"])&&(e=h(this.hex,0,[0,"[3]",0],"30")));for(var t=[],r=n(e,0),i=0;i<r.length;i++){var a=s(e,r[i]),o=this.getExtParam(a);null!=o&&t.push(o)}return t},this.getExtParam=function(e){var t=n(e,0).length;if(2!=t&&3!=t)throw new Error("wrong number elements in Extension: "+t+" "+e);var r=p(a(e,0,[0],"06")),i=!1;3==t&&"0101ff"==u(e,0,[1])&&(i=!0);var s=u(e,0,[t-1,0]),o=void 0;if("2.5.29.14"==r?o=this.getExtSubjectKeyIdentifier(s,i):"2.5.29.15"==r?o=this.getExtKeyUsage(s,i):"2.5.29.17"==r?o=this.getExtSubjectAltName(s,i):"2.5.29.18"==r?o=this.getExtIssuerAltName(s,i):"2.5.29.19"==r?o=this.getExtBasicConstraints(s,i):"2.5.29.31"==r?o=this.getExtCRLDistributionPoints(s,i):"2.5.29.32"==r?o=this.getExtCertificatePolicies(s,i):"2.5.29.35"==r?o=this.getExtAuthorityKeyIdentifier(s,i):"2.5.29.37"==r?o=this.getExtExtKeyUsage(s,i):"1.3.6.1.5.5.7.1.1"==r?o=this.getExtAuthorityInfoAccess(s,i):"2.5.29.20"==r?o=this.getExtCRLNumber(s,i):"2.5.29.21"==r?o=this.getExtCRLReason(s,i):"1.3.6.1.5.5.7.48.1.2"==r?o=this.getExtOcspNonce(s,i):"1.3.6.1.5.5.7.48.1.5"==r?o=this.getExtOcspNoCheck(s,i):"1.2.840.113583.1.1.9.1"==r&&(o=this.getExtAdobeTimeStamp(s,i)),null!=o)return o;var h={extname:r,extn:s};return i&&(h.critical=!0),h},this.findExt=function(e,t){for(var r=0;r<e.length;r++)if(e[r].extname==t)return e[r];return null},this.updateExtCDPFullURI=function(e,t){var r=this.findExt(e,"cRLDistributionPoints");if(null!=r&&null!=r.array)for(var n=r.array,i=0;i<n.length;i++)if(null!=n[i].dpname&&null!=n[i].dpname.full)for(var s=n[i].dpname.full,a=0;a<s.length;a++){var o=s[i];null!=o.uri&&(o.uri=t)}},this.updateExtAIAOCSP=function(e,t){var r=this.findExt(e,"authorityInfoAccess");if(null!=r&&null!=r.array)for(var n=r.array,i=0;i<n.length;i++)null!=n[i].ocsp&&(n[i].ocsp=t)},this.updateExtAIACAIssuer=function(e,t){var r=this.findExt(e,"authorityInfoAccess");if(null!=r&&null!=r.array)for(var n=r.array,i=0;i<n.length;i++)null!=n[i].caissuer&&(n[i].caissuer=t)},this.dnarraytostr=function(e){return"/"+e.map((function(e){return function(e){return e.map((function(e){return function(e){return e.type+"="+e.value}(e).replace(/\+/,"\\+")})).join("+")}(e).replace(/\//,"\\/")})).join("/")},this.getInfo=function(){var e,t,r,n,i=function(e){for(var t="",r=e.array,n=0;n<r.length;n++){var i=r[n];if(t+="    policy oid: "+i.policyoid+"\n",void 0!==i.array)for(var s=0;s<i.array.length;s++){var a=i.array[s];void 0!==a.cps&&(t+="    cps: "+a.cps+"\n")}}return t},s=function(e){for(var t="",r=e.array,n=0;n<r.length;n++){var i=r[n];try{void 0!==i.dpname.full[0].uri&&(t+="    "+i.dpname.full[0].uri+"\n")}catch(e){}try{void 0!==i.dname.full[0].dn.hex&&(t+="    "+Xe.hex2dn(i.dpname.full[0].dn.hex)+"\n")}catch(e){}}return t},a=function(e){for(var t="",r=e.array,n=0;n<r.length;n++){var i=r[n];void 0!==i.caissuer&&(t+="    caissuer: "+i.caissuer+"\n"),void 0!==i.ocsp&&(t+="    ocsp: "+i.ocsp+"\n")}return t};if(e="Basic Fields\n",e+="  serial number: "+this.getSerialNumberHex()+"\n",e+="  signature algorithm: "+this.getSignatureAlgorithmField()+"\n",e+="  issuer: "+this.getIssuerString()+"\n",e+="  notBefore: "+this.getNotBefore()+"\n",e+="  notAfter: "+this.getNotAfter()+"\n",e+="  subject: "+this.getSubjectString()+"\n",e+="  subject public key info: \n",e+="    key algorithm: "+(t=this.getPublicKey()).type+"\n","RSA"===t.type&&(e+="    n="+Ve(t.n.toString(16)).substr(0,16)+"...\n",e+="    e="+Ve(t.e.toString(16))+"\n"),null!=(r=this.aExtInfo)){e+="X509v3 Extensions:\n";for(var o=0;o<r.length;o++){var u=r[o],h=ue.asn1.x509.OID.oid2name(u.oid);""===h&&(h=u.oid);var l="";if(!0===u.critical&&(l="CRITICAL"),e+="  "+h+" "+l+":\n","basicConstraints"===h){var c=this.getExtBasicConstraints();void 0===c.cA?e+="    {}\n":(e+="    cA=true",void 0!==c.pathLen&&(e+=", pathLen="+c.pathLen),e+="\n")}else if("keyUsage"===h)e+="    "+this.getExtKeyUsageString()+"\n";else if("subjectKeyIdentifier"===h)e+="    "+this.getExtSubjectKeyIdentifier().kid.hex+"\n";else if("authorityKeyIdentifier"===h){var f=this.getExtAuthorityKeyIdentifier();void 0!==f.kid&&(e+="    kid="+f.kid.hex+"\n")}else{if("extKeyUsage"===h)e+="    "+this.getExtExtKeyUsage().array.join(", ")+"\n";else if("subjectAltName"===h)e+="    "+(n=this.getExtSubjectAltName(),JSON.stringify(n.array).replace(/[\[\]\{\}\"]/g,""))+"\n";else if("cRLDistributionPoints"===h)e+=s(this.getExtCRLDistributionPoints());else if("authorityInfoAccess"===h)e+=a(this.getExtAuthorityInfoAccess());else"certificatePolicies"===h&&(e+=i(this.getExtCertificatePolicies()))}}}return e+="signature algorithm: "+this.getSignatureAlgorithmName()+"\n",e+="signature: "+this.getSignatureValueHex().substr(0,16)+"...\n"},"string"==typeof e&&(-1!=e.indexOf("-----BEGIN")?this.readCertPEM(e):ue.lang.String.isHex(e)&&this.readCertHex(e))}re.prototype.sign=function(e,t){var r=function(e){return ue.crypto.Util.hashString(e,t)}(e);return this.signWithMessageHash(r,t)},re.prototype.signWithMessageHash=function(e,t){var r=ee(ue.crypto.Util.getPaddedDigestInfoHex(e,t,this.n.bitLength()),16);return Ge(this.doPrivate(r).toString(16),this.n.bitLength())},re.prototype.signPSS=function(e,t,r){var n,i=(n=xe(e),ue.crypto.Util.hashHex(n,t));return void 0===r&&(r=-1),this.signWithMessageHashPSS(i,t,r)},re.prototype.signWithMessageHashPSS=function(e,t,r){var n,i=Ae(e),s=i.length,a=this.n.bitLength()-1,o=Math.ceil(a/8),u=function(e){return ue.crypto.Util.hashHex(e,t)};if(-1===r||void 0===r)r=s;else if(-2===r)r=o-s-2;else if(r<-2)throw new Error("invalid salt length");if(o<s+r+2)throw new Error("data too long");var h="";r>0&&(h=new Array(r),(new Z).nextBytes(h),h=String.fromCharCode.apply(String,h));var l=Ae(u(xe("\0\0\0\0\0\0\0\0"+i+h))),c=[];for(n=0;n<o-r-s-2;n+=1)c[n]=0;var f=String.fromCharCode.apply(String,c)+""+h,g=We(l,f.length,u),d=[];for(n=0;n<f.length;n+=1)d[n]=f.charCodeAt(n)^g.charCodeAt(n);var p=65280>>8*o-a&255;for(d[0]&=~p,n=0;n<s;n++)d.push(l.charCodeAt(n));return d.push(188),Ge(this.doPrivate(new S(d)).toString(16),this.n.bitLength())},re.prototype.verify=function(e,t){if(null==(t=t.toLowerCase()).match(/^[0-9a-f]+$/))return!1;var r=ee(t,16),n=this.n.bitLength();if(r.bitLength()>n)return!1;var i=this.doPublic(r).toString(16);if(i.length+3!=n/4)return!1;var s=ze(i.replace(/^1f+00/,""));if(0==s.length)return!1;var a=s[0];return s[1]==function(e){return ue.crypto.Util.hashString(e,a)}(e)},re.prototype.verifyWithMessageHash=function(e,t){if(t.length!=Math.ceil(this.n.bitLength()/4))return!1;var r=ee(t,16);if(r.bitLength()>this.n.bitLength())return 0;var n=ze(this.doPublic(r).toString(16).replace(/^1f+00/,""));if(0==n.length)return!1;n[0];return n[1]==e},re.prototype.verifyPSS=function(e,t,r,n){var i,s=(i=xe(e),ue.crypto.Util.hashHex(i,r));return void 0===n&&(n=-1),this.verifyWithMessageHashPSS(s,t,r,n)},re.prototype.verifyWithMessageHashPSS=function(e,t,r,n){if(t.length!=Math.ceil(this.n.bitLength()/4))return!1;var i,s=new S(t,16),a=function(e){return ue.crypto.Util.hashHex(e,r)},o=Ae(e),u=o.length,h=this.n.bitLength()-1,l=Math.ceil(h/8);if(-1===n||void 0===n)n=u;else if(-2===n)n=l-u-2;else if(n<-2)throw new Error("invalid salt length");if(l<u+n+2)throw new Error("data too long");var c=this.doPublic(s).toByteArray();for(i=0;i<c.length;i+=1)c[i]&=255;for(;c.length<l;)c.unshift(0);if(188!==c[l-1])throw new Error("encoded message does not end in 0xbc");var f=(c=String.fromCharCode.apply(String,c)).substr(0,l-u-1),g=c.substr(f.length,u),d=65280>>8*l-h&255;if(0!=(f.charCodeAt(0)&d))throw new Error("bits beyond keysize not zero");var p=We(g,f.length,a),m=[];for(i=0;i<f.length;i+=1)m[i]=f.charCodeAt(i)^p.charCodeAt(i);m[0]&=~d;var y=l-u-n-2;for(i=0;i<y;i+=1)if(0!==m[i])throw new Error("leftmost octets not zero");if(1!==m[y])throw new Error("0x01 marker not found");return g===Ae(a(xe("\0\0\0\0\0\0\0\0"+o+String.fromCharCode.apply(String,m.slice(-n)))))},re.SALT_LEN_HLEN=-1,re.SALT_LEN_MAX=-2,re.SALT_LEN_RECOVER=-2,Xe.hex2dn=function(e,t){void 0===t&&(t=0);var r=new Xe;ce.getTLV(e,t);return r.getX500Name(e).str},Xe.hex2rdn=function(e,t){if(void 0===t&&(t=0),"31"!==e.substr(t,2))throw new Error("malformed RDN");for(var r=new Array,n=ce.getChildIdx(e,t),i=0;i<n.length;i++)r.push(Xe.hex2attrTypeValue(e,n[i]));return(r=r.map((function(e){return e.replace("+","\\+")}))).join("+")},Xe.hex2attrTypeValue=function(e,t){var r=ce,n=r.getV;if(void 0===t&&(t=0),"30"!==e.substr(t,2))throw new Error("malformed attribute type and value");var i=r.getChildIdx(e,t);2!==i.length||e.substr(i[0],2);var s=n(e,i[0]),a=ue.asn1.ASN1Util.oidHexToInt(s);return ue.asn1.x509.OID.oid2atype(a)+"="+Ae(n(e,i[1]))},Xe.getPublicKeyFromCertHex=function(e){var t=new Xe;return t.readCertHex(e),t.getPublicKey()},Xe.getPublicKeyFromCertPEM=function(e){var t=new Xe;return t.readCertPEM(e),t.getPublicKey()},Xe.getPublicKeyInfoPropOfCertPEM=function(e){var t,r,n=ce.getVbyList,i={};return i.algparam=null,(t=new Xe).readCertPEM(e),r=t.getPublicKeyHex(),i.keyhex=n(r,0,[1],"03").substr(2),i.algoid=n(r,0,[0,0],"06"),"2a8648ce3d0201"===i.algoid&&(i.algparam=n(r,0,[0,1],"06")),i},Xe.KEYUSAGE_NAME=["digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","keyAgreement","keyCertSign","cRLSign","encipherOnly","decipherOnly"];void 0!==ue&&ue||(ue={}),void 0!==ue.jws&&ue.jws||(ue.jws={}),ue.jws.JWS=function(){var e=ue.jws.JWS.isSafeJSONString;this.parseJWS=function(t,r){if(void 0===this.parsedJWS||!r&&void 0===this.parsedJWS.sigvalH){var n=t.match(/^([^.]+)\.([^.]+)\.([^.]+)$/);if(null==n)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";var i=n[1],s=n[2],a=n[3],o=i+"."+s;if(this.parsedJWS={},this.parsedJWS.headB64U=i,this.parsedJWS.payloadB64U=s,this.parsedJWS.sigvalB64U=a,this.parsedJWS.si=o,!r){var u=be(a),h=ee(u,16);this.parsedJWS.sigvalH=u,this.parsedJWS.sigvalBI=h}var l=le(i),c=le(s);if(this.parsedJWS.headS=l,this.parsedJWS.payloadS=c,!e(l,this.parsedJWS,"headP"))throw"malformed JSON string for JWS Head: "+l}}},ue.jws.JWS.sign=function(e,t,r,n,i){var s,a,o,u=ue,h=u.jws.JWS,l=h.readSafeJSONString,c=h.isSafeJSONString,f=u.crypto,g=(f.ECDSA,f.Mac),d=f.Signature,p=JSON;if("string"!=typeof t&&"object"!=typeof t)throw"spHeader must be JSON string or object: "+t;if("object"==typeof t&&(a=t,s=p.stringify(a)),"string"==typeof t){if(!c(s=t))throw"JWS Head is not safe JSON string: "+s;a=l(s)}if(o=r,"object"==typeof r&&(o=p.stringify(r)),""!=e&&null!=e||void 0===a.alg||(e=a.alg),""!=e&&null!=e&&void 0===a.alg&&(a.alg=e,s=p.stringify(a)),e!==a.alg)throw"alg and sHeader.alg doesn't match: "+e+"!="+a.alg;var m=null;if(void 0===h.jwsalg2sigalg[e])throw"unsupported alg name: "+e;m=h.jwsalg2sigalg[e];var y=he(s)+"."+he(o),v="";if("Hmac"==m.substr(0,4)){if(void 0===n)throw"mac key shall be specified for HS* alg";var b=new g({alg:m,prov:"cryptojs",pass:n});b.updateString(y),v=b.doFinal()}else if(-1!=m.indexOf("withECDSA")){(S=new d({alg:m})).init(n,i),S.updateString(y);var w=S.sign();v=ue.crypto.ECDSA.asn1SigToConcatSig(w)}else{var S;if("none"!=m)(S=new d({alg:m})).init(n,i),S.updateString(y),v=S.sign()}return y+"."+ve(v)},ue.jws.JWS.verify=function(e,t,r){var n,i=ue,s=i.jws.JWS,a=s.readSafeJSONString,o=i.crypto,u=o.ECDSA,h=o.Mac,l=o.Signature;n=re;var c=e.split(".");if(3!==c.length)return!1;var f=c[0]+"."+c[1],g=be(c[2]),d=a(le(c[0])),p=null,m=null;if(void 0===d.alg)throw"algorithm not specified in header";if((m=(p=d.alg).substr(0,2),null!=r&&"[object Array]"===Object.prototype.toString.call(r)&&r.length>0)&&-1==(":"+r.join(":")+":").indexOf(":"+p+":"))throw"algorithm '"+p+"' not accepted in the list";if("none"!=p&&null===t)throw"key shall be specified to verify.";if("string"==typeof t&&-1!=t.indexOf("-----BEGIN ")&&(t=$e.getKey(t)),!("RS"!=m&&"PS"!=m||t instanceof n))throw"key shall be a RSAKey obj for RS* and PS* algs";if("ES"==m&&!(t instanceof u))throw"key shall be a ECDSA obj for ES* algs";var y=null;if(void 0===s.jwsalg2sigalg[d.alg])throw"unsupported alg name: "+p;if("none"==(y=s.jwsalg2sigalg[p]))throw"not supported";if("Hmac"==y.substr(0,4)){if(void 0===t)throw"hexadecimal key shall be specified for HMAC";var v=new h({alg:y,pass:t});return v.updateString(f),g==v.doFinal()}if(-1!=y.indexOf("withECDSA")){var b,w=null;try{w=u.concatSigToASN1Sig(g)}catch(e){return!1}return(b=new l({alg:y})).init(t),b.updateString(f),b.verify(w)}return(b=new l({alg:y})).init(t),b.updateString(f),b.verify(g)},ue.jws.JWS.parse=function(e){var t,r,n,i=e.split("."),s={};if(2!=i.length&&3!=i.length)throw"malformed sJWS: wrong number of '.' splitted elements";return t=i[0],r=i[1],3==i.length&&(n=i[2]),s.headerObj=ue.jws.JWS.readSafeJSONString(le(t)),s.payloadObj=ue.jws.JWS.readSafeJSONString(le(r)),s.headerPP=JSON.stringify(s.headerObj,null,"  "),null==s.payloadObj?s.payloadPP=le(r):s.payloadPP=JSON.stringify(s.payloadObj,null,"  "),void 0!==n&&(s.sigHex=be(n)),s},ue.jws.JWS.verifyJWT=function(e,t,r){var n=ue.jws,i=n.JWS,s=i.readSafeJSONString,a=i.inArray,o=i.includedArray,u=e.split("."),h=u[0],l=u[1],c=(be(u[2]),s(le(h))),f=s(le(l));if(void 0===c.alg)return!1;if(void 0===r.alg)throw"acceptField.alg shall be specified";if(!a(c.alg,r.alg))return!1;if(void 0!==f.iss&&"object"==typeof r.iss&&!a(f.iss,r.iss))return!1;if(void 0!==f.sub&&"object"==typeof r.sub&&!a(f.sub,r.sub))return!1;if(void 0!==f.aud&&"object"==typeof r.aud)if("string"==typeof f.aud){if(!a(f.aud,r.aud))return!1}else if("object"==typeof f.aud&&!o(f.aud,r.aud))return!1;var g=n.IntDate.getNow();return void 0!==r.verifyAt&&"number"==typeof r.verifyAt&&(g=r.verifyAt),void 0!==r.gracePeriod&&"number"==typeof r.gracePeriod||(r.gracePeriod=0),!(void 0!==f.exp&&"number"==typeof f.exp&&f.exp+r.gracePeriod<g)&&(!(void 0!==f.nbf&&"number"==typeof f.nbf&&g<f.nbf-r.gracePeriod)&&(!(void 0!==f.iat&&"number"==typeof f.iat&&g<f.iat-r.gracePeriod)&&((void 0===f.jti||void 0===r.jti||f.jti===r.jti)&&!!i.verify(e,t,r.alg))))},ue.jws.JWS.includedArray=function(e,t){var r=ue.jws.JWS.inArray;if(null===e)return!1;if("object"!=typeof e)return!1;if("number"!=typeof e.length)return!1;for(var n=0;n<e.length;n++)if(!r(e[n],t))return!1;return!0},ue.jws.JWS.inArray=function(e,t){if(null===t)return!1;if("object"!=typeof t)return!1;if("number"!=typeof t.length)return!1;for(var r=0;r<t.length;r++)if(t[r]==e)return!0;return!1},ue.jws.JWS.jwsalg2sigalg={HS256:"HmacSHA256",HS384:"HmacSHA384",HS512:"HmacSHA512",RS256:"SHA256withRSA",RS384:"SHA384withRSA",RS512:"SHA512withRSA",ES256:"SHA256withECDSA",ES384:"SHA384withECDSA",PS256:"SHA256withRSAandMGF1",PS384:"SHA384withRSAandMGF1",PS512:"SHA512withRSAandMGF1",none:"none"},ue.jws.JWS.isSafeJSONString=function(e,t,r){var n=null;try{return"object"!=typeof(n=oe(e))||n.constructor===Array?0:(t&&(t[r]=n),1)}catch(e){return 0}},ue.jws.JWS.readSafeJSONString=function(e){var t=null;try{return"object"!=typeof(t=oe(e))||t.constructor===Array?null:t}catch(e){return null}},ue.jws.JWS.getEncodedSignatureValueFromJWS=function(e){var t=e.match(/^[^.]+\.[^.]+\.([^.]+)$/);if(null==t)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";return t[1]},ue.jws.JWS.getJWKthumbprint=function(e){if("RSA"!==e.kty&&"EC"!==e.kty&&"oct"!==e.kty)throw"unsupported algorithm for JWK Thumprint";var t="{";if("RSA"===e.kty){if("string"!=typeof e.n||"string"!=typeof e.e)throw"wrong n and e value for RSA key";t+='"e":"'+e.e+'",',t+='"kty":"'+e.kty+'",',t+='"n":"'+e.n+'"}'}else if("EC"===e.kty){if("string"!=typeof e.crv||"string"!=typeof e.x||"string"!=typeof e.y)throw"wrong crv, x and y value for EC key";t+='"crv":"'+e.crv+'",',t+='"kty":"'+e.kty+'",',t+='"x":"'+e.x+'",',t+='"y":"'+e.y+'"}'}else if("oct"===e.kty){if("string"!=typeof e.k)throw"wrong k value for oct(symmetric) key";t+='"kty":"'+e.kty+'",',t+='"k":"'+e.k+'"}'}var r=xe(t);return ve(ue.crypto.Util.hashHex(r,"sha256"))},ue.jws.IntDate={},ue.jws.IntDate.get=function(e){var t=ue.jws.IntDate,r=t.getNow,n=t.getZulu;if("now"==e)return r();if("now + 1hour"==e)return r()+3600;if("now + 1day"==e)return r()+86400;if("now + 1month"==e)return r()+2592e3;if("now + 1year"==e)return r()+31536e3;if(e.match(/Z$/))return n(e);if(e.match(/^[0-9]+$/))return parseInt(e);throw"unsupported format: "+e},ue.jws.IntDate.getZulu=function(e){return Pe(e)},ue.jws.IntDate.getNow=function(){return~~(new Date/1e3)},ue.jws.IntDate.intDate2UTCString=function(e){return new Date(1e3*e).toUTCString()},ue.jws.IntDate.intDate2Zulu=function(e){var t=new Date(1e3*e);return("0000"+t.getUTCFullYear()).slice(-4)+("00"+(t.getUTCMonth()+1)).slice(-2)+("00"+t.getUTCDate()).slice(-2)+("00"+t.getUTCHours()).slice(-2)+("00"+t.getUTCMinutes()).slice(-2)+("00"+t.getUTCSeconds()).slice(-2)+"Z"},void 0!==ue&&ue||(ue={}),void 0!==ue.jws&&ue.jws||(ue.jws={}),ue.jws.JWSJS=function(){var e=ue.jws.JWS,t=e.readSafeJSONString;this.aHeader=[],this.sPayload="",this.aSignature=[],this.init=function(){this.aHeader=[],this.sPayload=void 0,this.aSignature=[]},this.initWithJWS=function(e){this.init();var t=e.split(".");if(3!=t.length)throw"malformed input JWS";this.aHeader.push(t[0]),this.sPayload=t[1],this.aSignature.push(t[2])},this.addSignature=function(e,t,r,n){if(void 0===this.sPayload||null===this.sPayload)throw"there's no JSON-JS signature to add.";var i=this.aHeader.length;if(this.aHeader.length!=this.aSignature.length)throw"aHeader.length != aSignature.length";try{var s=ue.jws.JWS.sign(e,t,this.sPayload,r,n).split(".");s[0],s[2];this.aHeader.push(s[0]),this.aSignature.push(s[2])}catch(e){throw this.aHeader.length>i&&this.aHeader.pop(),this.aSignature.length>i&&this.aSignature.pop(),"addSignature failed: "+e}},this.verifyAll=function(e){if(this.aHeader.length!==e.length||this.aSignature.length!==e.length)return!1;for(var t=0;t<e.length;t++){var r=e[t];if(2!==r.length)return!1;if(!1===this.verifyNth(t,r[0],r[1]))return!1}return!0},this.verifyNth=function(t,r,n){if(this.aHeader.length<=t||this.aSignature.length<=t)return!1;var i=this.aHeader[t],s=this.aSignature[t],a=i+"."+this.sPayload+"."+s,o=!1;try{o=e.verify(a,r,n)}catch(e){return!1}return o},this.readJWSJS=function(e){if("string"==typeof e){var r=t(e);if(null==r)throw"argument is not safe JSON object string";this.aHeader=r.headers,this.sPayload=r.payload,this.aSignature=r.signatures}else try{if(!(e.headers.length>0))throw"malformed header";if(this.aHeader=e.headers,"string"!=typeof e.payload)throw"malformed signatures";if(this.sPayload=e.payload,!(e.signatures.length>0))throw"malformed signatures";this.aSignature=e.signatures}catch(e){throw"malformed JWS-JS JSON object: "+e}},this.getJSON=function(){return{headers:this.aHeader,payload:this.sPayload,signatures:this.aSignature}},this.isEmpty=function(){return 0==this.aHeader.length?1:0}},ue.crypto.ECDSA,ue.crypto.DSA,ue.crypto.Signature,ue.crypto.MessageDigest,ue.crypto.Mac,ue.crypto.Cipher,t.fs=ue,ue.crypto,ue.asn1,ue.jws,ue.lang},668:function(e,t,r){"use strict";const n=r(725);e.exports=n,n.default=n},725:function(e){"use strict";e.exports=function(e,r,n){var i,s="";if(t="",arguments.length>1){if("number"==typeof n)for(i=0;i<n;i+=1)s+=" ";else"string"==typeof n&&(s=n);if(""!==s){if(null!=r){if("function"==typeof r)return o("",{"":e},[],r,s);if(Array.isArray(r))return u("",e,[],r,s)}return h("",e,[],s)}if("function"==typeof r)return c("",{"":e},[],r);if(Array.isArray(r))return l("",e,[],r)}return f("",e,[])};var t="";const r=/[\x00-\x1f\x22\x5c]/,n=/[\x00-\x1f\x22\x5c]/g,i=["\\u0000","\\u0001","\\u0002","\\u0003","\\u0004","\\u0005","\\u0006","\\u0007","\\b","\\t","\\n","\\u000b","\\f","\\r","\\u000e","\\u000f","\\u0010","\\u0011","\\u0012","\\u0013","\\u0014","\\u0015","\\u0016","\\u0017","\\u0018","\\u0019","\\u001a","\\u001b","\\u001c","\\u001d","\\u001e","\\u001f","","",'\\"',"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\\\\"];function s(e){return i[e.charCodeAt(0)]}function a(e){if(e.length<5e3&&!r.test(e))return e;if(e.length>100)return e.replace(n,s);for(var t="",a=0,o=0;o<e.length;o++){const r=e.charCodeAt(o);(34===r||92===r||r<32)&&(t+=a===o?i[r]:`${e.slice(a,o)}${i[r]}`,a=o+1)}return 0===a?t=e:a!==o&&(t+=e.slice(a)),t}function o(e,r,n,i,s){var u,h,l;const c=t;var f=r[e];switch("object"==typeof f&&null!==f&&"function"==typeof f.toJSON&&(f=f.toJSON(e)),typeof(f=i.call(r,e,f))){case"object":if(null===f)return"null";for(u=0;u<n.length;u++)if(n[u]===f)return'"[Circular]"';if(Array.isArray(f)){if(0===f.length)return"[]";for(n.push(f),h="[",h+=`\n${t+=s}`,l=`,\n${t}`,u=0;u<f.length-1;u++){const e=o(u,f,n,i,s);h+=void 0!==e?e:"null",h+=l}const e=o(u,f,n,i,s);return h+=void 0!==e?e:"null",""!==t&&(h+=`\n${c}`),h+="]",n.pop(),t=c,h}var d=g(Object.keys(f));if(0===d.length)return"{}";n.push(f),h="{",h+=`\n${t+=s}`,l=`,\n${t}`;var p="";for(u=0;u<d.length;u++){const t=o(e=d[u],f,n,i,s);void 0!==t&&(h+=`${p}"${a(e)}": ${t}`,p=l)}return""!==p?h+=`\n${c}`:h="{",h+="}",n.pop(),t=c,h;case"string":return`"${a(f)}"`;case"number":return isFinite(f)?String(f):"null";case"boolean":return!0===f?"true":"false"}}function u(e,r,n,i,s){var o,h,l;const c=t;switch("object"==typeof r&&null!==r&&"function"==typeof r.toJSON&&(r=r.toJSON(e)),typeof r){case"object":if(null===r)return"null";for(o=0;o<n.length;o++)if(n[o]===r)return'"[Circular]"';if(Array.isArray(r)){if(0===r.length)return"[]";for(n.push(r),h="[",h+=`\n${t+=s}`,l=`,\n${t}`,o=0;o<r.length-1;o++){const e=u(o,r[o],n,i,s);h+=void 0!==e?e:"null",h+=l}const e=u(o,r[o],n,i,s);return h+=void 0!==e?e:"null",""!==t&&(h+=`\n${c}`),h+="]",n.pop(),t=c,h}if(0===i.length)return"{}";n.push(r),h="{",h+=`\n${t+=s}`,l=`,\n${t}`;var f="";for(o=0;o<i.length;o++)if("string"==typeof i[o]||"number"==typeof i[o]){const t=u(e=i[o],r[e],n,i,s);void 0!==t&&(h+=`${f}"${a(e)}": ${t}`,f=l)}return""!==f?h+=`\n${c}`:h="{",h+="}",n.pop(),t=c,h;case"string":return`"${a(r)}"`;case"number":return isFinite(r)?String(r):"null";case"boolean":return!0===r?"true":"false"}}function h(e,r,n,i){var s,o,u;const l=t;switch(typeof r){case"object":if(null===r)return"null";if("function"==typeof r.toJSON){if("object"!=typeof(r=r.toJSON(e)))return h(e,r,n,i);if(null===r)return"null"}for(s=0;s<n.length;s++)if(n[s]===r)return'"[Circular]"';if(Array.isArray(r)){if(0===r.length)return"[]";for(n.push(r),o="[",o+=`\n${t+=i}`,u=`,\n${t}`,s=0;s<r.length-1;s++){const e=h(s,r[s],n,i);o+=void 0!==e?e:"null",o+=u}const e=h(s,r[s],n,i);return o+=void 0!==e?e:"null",""!==t&&(o+=`\n${l}`),o+="]",n.pop(),t=l,o}var c=g(Object.keys(r));if(0===c.length)return"{}";n.push(r),o="{",o+=`\n${t+=i}`,u=`,\n${t}`;var f="";for(s=0;s<c.length;s++){const t=h(e=c[s],r[e],n,i);void 0!==t&&(o+=`${f}"${a(e)}": ${t}`,f=u)}return""!==f?o+=`\n${l}`:o="{",o+="}",n.pop(),t=l,o;case"string":return`"${a(r)}"`;case"number":return isFinite(r)?String(r):"null";case"boolean":return!0===r?"true":"false"}}function l(e,t,r,n){var i,s;switch("object"==typeof t&&null!==t&&"function"==typeof t.toJSON&&(t=t.toJSON(e)),typeof t){case"object":if(null===t)return"null";for(i=0;i<r.length;i++)if(r[i]===t)return'"[Circular]"';if(Array.isArray(t)){if(0===t.length)return"[]";for(r.push(t),s="[",i=0;i<t.length-1;i++){const e=l(i,t[i],r,n);s+=void 0!==e?e:"null",s+=","}const e=l(i,t[i],r,n);return s+=void 0!==e?e:"null",s+="]",r.pop(),s}if(0===n.length)return"{}";r.push(t),s="{";var o="";for(i=0;i<n.length;i++)if("string"==typeof n[i]||"number"==typeof n[i]){const u=l(e=n[i],t[e],r,n);void 0!==u&&(s+=`${o}"${a(e)}":${u}`,o=",")}return s+="}",r.pop(),s;case"string":return`"${a(t)}"`;case"number":return isFinite(t)?String(t):"null";case"boolean":return!0===t?"true":"false"}}function c(e,t,r,n){var i,s,o=t[e];switch("object"==typeof o&&null!==o&&"function"==typeof o.toJSON&&(o=o.toJSON(e)),typeof(o=n.call(t,e,o))){case"object":if(null===o)return"null";for(i=0;i<r.length;i++)if(r[i]===o)return'"[Circular]"';if(Array.isArray(o)){if(0===o.length)return"[]";for(r.push(o),s="[",i=0;i<o.length-1;i++){const e=c(i,o,r,n);s+=void 0!==e?e:"null",s+=","}const e=c(i,o,r,n);return s+=void 0!==e?e:"null",s+="]",r.pop(),s}var u=g(Object.keys(o));if(0===u.length)return"{}";r.push(o),s="{";var h="";for(i=0;i<u.length;i++){const t=c(e=u[i],o,r,n);void 0!==t&&(s+=`${h}"${a(e)}":${t}`,h=",")}return s+="}",r.pop(),s;case"string":return`"${a(o)}"`;case"number":return isFinite(o)?String(o):"null";case"boolean":return!0===o?"true":"false"}}function f(e,t,r){var n,i;switch(typeof t){case"object":if(null===t)return"null";if("function"==typeof t.toJSON){if("object"!=typeof(t=t.toJSON(e)))return f(e,t,r);if(null===t)return"null"}for(n=0;n<r.length;n++)if(r[n]===t)return'"[Circular]"';if(Array.isArray(t)){if(0===t.length)return"[]";for(r.push(t),i="[",n=0;n<t.length-1;n++){const e=f(n,t[n],r);i+=void 0!==e?e:"null",i+=","}const e=f(n,t[n],r);return i+=void 0!==e?e:"null",i+="]",r.pop(),i}var s=g(Object.keys(t));if(0===s.length)return"{}";r.push(t);var o="";for(i="{",n=0;n<s.length;n++){const u=f(e=s[n],t[e],r);void 0!==u&&(i+=`${o}"${a(e)}":${u}`,o=",")}return i+="}",r.pop(),i;case"string":return`"${a(t)}"`;case"number":return isFinite(t)?String(t):"null";case"boolean":return!0===t?"true":"false"}}function g(e){for(var t=1;t<e.length;t++){const n=e[t];for(var r=t;0!==r&&e[r-1]>n;)e[r]=e[r-1],r--;e[r]=n}return e}},682:function(e,t,r){"use strict";t.Aj=void 0;var n,i=r(764),s=(n=r(274))&&n.__esModule?n:{default:n};var a=function(e){var t=e.allowedSizes,r=e.defaultSize,n=e.padding;return function e(){var a=this,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r;if(!this||this.constructor!==e)return new e(o);if(t&&!t.includes(o))throw new Error("Unsupported hash length");var u=new s.default({capacity:o});return this.update=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8";if(i.Buffer.isBuffer(e))return u.absorb(e),a;if("string"==typeof e)return a.update(i.Buffer.from(e,t));throw new TypeError("Not a string or buffer")},this.digest=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"binary",t="string"==typeof e?{format:e}:e,r=u.squeeze({buffer:t.buffer,padding:t.padding||n});return t.format&&"binary"!==t.format?r.toString(t.format):r},this.reset=function(){return u.reset(),a},this}},o=a({allowedSizes:[224,256,384,512],defaultSize:512,padding:1});var u=a({allowedSizes:[224,256,384,512],defaultSize:512,padding:6});t.Aj=u,a({allowedSizes:[128,256],defaultSize:256,padding:31});var h=o;u.SHA3Hash=h},274:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=r(764),s=(n=r(618))&&n.__esModule?n:{default:n};var a=function(e,t){for(var r=0;r<e.length;r+=8){var n=r/4;t[n]^=e[r+7]<<24|e[r+6]<<16|e[r+5]<<8|e[r+4],t[n+1]^=e[r+3]<<24|e[r+2]<<16|e[r+1]<<8|e[r]}return t},o=function(e,t){for(var r=0;r<t.length;r+=8){var n=r/4;t[r]=e[n+1],t[r+1]=e[n+1]>>>8,t[r+2]=e[n+1]>>>16,t[r+3]=e[n+1]>>>24,t[r+4]=e[n],t[r+5]=e[n]>>>8,t[r+6]=e[n]>>>16,t[r+7]=e[n]>>>24}return t},u=function(e){var t=this,r=e.capacity,n=e.padding,u=(0,s.default)(),h=r/8,l=200-r/4,c=0,f=new Uint32Array(50),g=i.Buffer.allocUnsafe(l);return this.absorb=function(e){for(var r=0;r<e.length;r++)g[c]=e[r],(c+=1)>=l&&(a(g,f),u(f),c=0);return t},this.squeeze=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={buffer:e.buffer||i.Buffer.allocUnsafe(h),padding:e.padding||n,queue:i.Buffer.allocUnsafe(g.length),state:new Uint32Array(f.length)};g.copy(t.queue);for(var r=0;r<f.length;r++)t.state[r]=f[r];t.queue.fill(0,c),t.queue[c]|=t.padding,t.queue[l-1]|=128,a(t.queue,t.state);for(var s=0;s<t.buffer.length;s+=l)u(t.state),o(t.state,t.buffer.slice(s,s+l));return t.buffer},this.reset=function(){return g.fill(0),f.fill(0),c=0,t},this};t.default=u},298:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=(n=r(605))&&n.__esModule?n:{default:n};var s=function(e){for(var t=e.A,r=e.C,n=0;n<25;n+=5){for(var s=0;s<5;s++)(0,i.default)(t,n+s)(r,s);for(var a=0;a<5;a++){var o=2*(n+a),u=(a+1)%5*2,h=(a+2)%5*2;t[o]^=~r[u]&r[h],t[o+1]^=~r[u+1]&r[h+1]}}};t.default=s},605:function(e){"use strict";e.exports=function(e,t){return function(r,n){var i=2*n,s=2*t;r[i]=e[s],r[i+1]=e[s+1]}}},618:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=o(r(298)),i=o(r(533)),s=o(r(420)),a=o(r(959));function o(e){return e&&e.__esModule?e:{default:e}}var u=function(){var e=new Uint32Array(10),t=new Uint32Array(10),r=new Uint32Array(2);return function(o){for(var u=0;u<24;u++)(0,a.default)({A:o,C:e,D:t,W:r}),(0,s.default)({A:o,C:e,W:r}),(0,n.default)({A:o,C:e}),(0,i.default)({A:o,roundIndex:u});e.fill(0),t.fill(0),r.fill(0)}};t.default=u},533:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=(n=r(306))&&n.__esModule?n:{default:n};var s=function(e){var t=e.A,r=2*e.roundIndex;t[0]^=i.default[r],t[1]^=i.default[r+1]};t.default=s},306:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=new Uint32Array([0,1,0,32898,2147483648,32906,2147483648,2147516416,0,32907,0,2147483649,2147483648,2147516545,2147483648,32777,0,138,0,136,0,2147516425,0,2147483658,0,2147516555,2147483648,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,0,32778,2147483648,2147483658,2147483648,2147516545,2147483648,32896,0,2147483649,2147483648,2147516424]);t.default=r},420:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(325)),i=a(r(10)),s=a(r(605));function a(e){return e&&e.__esModule?e:{default:e}}var o=function(e){var t=e.A,r=e.C,a=e.W;(0,s.default)(t,1)(a,0);for(var o=0,u=0,h=0,l=32,c=0;c<24;c++){var f=n.default[c],g=i.default[c];(0,s.default)(t,f)(r,0),o=a[0],u=a[1],l=32-g,a[h=g<32?0:1]=o<<g|u>>>l,a[(h+1)%2]=u<<g|o>>>l,(0,s.default)(a,0)(t,f),(0,s.default)(r,0)(a,0)}};t.default=o},325:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=[10,7,11,17,18,3,5,16,8,21,24,4,15,23,19,13,12,2,20,14,22,9,6,1];t.default=r},10:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=[1,3,6,10,15,21,28,36,45,55,2,14,27,41,56,8,25,43,62,18,39,61,20,44];t.default=r},959:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=(n=r(605))&&n.__esModule?n:{default:n};var s=function(e){for(var t=e.A,r=e.C,n=e.D,s=e.W,a=0,o=0,u=0;u<5;u++){var h=2*u,l=2*(u+5),c=2*(u+10),f=2*(u+15),g=2*(u+20);r[h]=t[h]^t[l]^t[c]^t[f]^t[g],r[h+1]=t[h+1]^t[l+1]^t[c+1]^t[f+1]^t[g+1]}for(var d=0;d<5;d++){(0,i.default)(r,(d+1)%5)(s,0),a=s[0],o=s[1],s[0]=a<<1|o>>>31,s[1]=o<<1|a>>>31,n[2*d]=r[(d+4)%5*2]^s[0],n[2*d+1]=r[(d+4)%5*2+1]^s[1];for(var p=0;p<25;p+=5)t[2*(p+d)]^=n[2*d],t[2*(p+d)+1]^=n[2*d+1]}};t.default=s}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var s=t[n]={exports:{}};return e[n].call(s.exports,s,s.exports,r),s.exports}r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};return function(){"use strict";r.r(n),r.d(n,{BitReader:function(){return Or},boundedRandom:function(){return l},checkChainIntegrity:function(){return vr},checkPrecommitmentValue:function(){return mr},checkPulseTiming:function(){return br},fetch:function(){return Br},fetchAfter:function(){return Ir},fetchAt:function(){return Cr},fetchBefore:function(){return Fr},fetchCertAndValidatePulse:function(){return Sr},fetchCertificate:function(){return Er},fetchLatest:function(){return kr},fetchServiceInfo:function(){return xr},fetchSkiplist:function(){return Nr},fetchSubchain:function(){return Pr},getShuffleSeed:function(){return c},getTimeStamp:function(){return s},hex2buf:function(){return o},hex2bytes:function(){return a},isISODate:function(){return t},iterBitStream:function(){return h},msToNextPulse:function(){return Hr},nextPulseAt:function(){return Dr},serializePulse:function(){return pr},setBeaconDomain:function(){return gr},shuffle:function(){return d},shuffleSelf:function(){return g},validateCert:function(){return wr},validatePulse:function(){return yr},xorArrays:function(){return u},zip:function(){return i}});const e=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/;function t(t){return e.test(t)}function i(...e){const t=Math.min(...e.map((e=>e.length))),[r,...n]=e;return Array.prototype.map.call(r.slice(0,t),((e,t)=>[e,...n.map((e=>e[t]))]))}function s(e){if("string"==typeof date&&t(e))return e;if(e instanceof Date)return e.toISOString();throw new Error("Date must be an ISO compliant datetime string, or a Date instance")}function a(e){if("string"!=typeof e)throw new TypeError("Input must be a string");const t=e.length;if(t%2!=0)throw new RangeError("Input string must be an even number of characters");return Uint8Array.from({length:t/2},((t,r)=>(r*=2,parseInt(e.substring(r,r+2),16))))}function o(e){return a(e).buffer}function u(e,t){const r=i(e,t).map((([e,t])=>e^t));return e.constructor&&e.constructor.from?e.constructor.from(r):r}function*h(e){let t=0;try{for(;;)yield e(t++)}catch(e){if("Error"!==e.name||"Cannot get"!==e.message.substr(0,10))throw e}}function l(e,t){if(e<0||e%1!=0)throw new Error("Value must be a positive integer >= 2");if(e<2)return 0;const r=Math.log2(e),n=Math.ceil(r),i=1<<n;if(!Number.isSafeInteger(i*(e-1)))throw new Error("Range is too high to evaluate");if(r%1==0)return t.readBits(n,!1);let s=t.readBits(n,!1),a=s*e,o=a%i;if(o<e){const r=(i-e)%e;for(;o<r;)s=t.readBits(n,!1),a=s*e,o=a%i}return a>>n}const c=e=>Array.from(h((t=>l(t+2,e)))),f=(e,t,r)=>{t!==r&&([e[t],e[r]]=[e[r],e[t]])};function g(e,t){const r=e.length;if(!r)return e;if(r>t.length+1)throw new Error(`Insufficient sized seed to shuffle this array. Max length: ${t.length+1}`);for(let n=r;n>1;n--){const r=t[n-2];f(e,n-1,r)}return e}function d(e,t){return g(e.slice(),t)}var p=r(669),m=r(668),y=r(166),v=r(682);class b extends Error{}class w extends Error{}class S extends Error{}class A extends Error{}class x extends Error{}function E(e,t){return!!(e.content.status&t)}for(var B="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",k="undefined"==typeof Uint8Array?[]:new Uint8Array(256),C=0;C<B.length;C++)k[B.charCodeAt(C)]=C;function I(e,t,r){return e instanceof Object==!1?r:t in e?e[t]:r}function F(e,t=0,r=e.byteLength-t,n=!1){let i="";for(const s of new Uint8Array(e,t,r)){const e=s.toString(16).toUpperCase();1===e.length&&(i+="0"),i+=e,n&&(i+=" ")}return i.trim()}function P(e,t,r,n){return t instanceof ArrayBuffer==!1?(e.error='Wrong parameter: inputBuffer must be "ArrayBuffer"',!1):0===t.byteLength?(e.error="Wrong parameter: inputBuffer has zero length",!1):r<0?(e.error="Wrong parameter: inputOffset less than zero",!1):n<0?(e.error="Wrong parameter: inputLength less than zero",!1):!(t.byteLength-r-n<0)||(e.error="End of input reached before message was fully decoded (inconsistent offset and length values)",!1)}function N(e,t){let r=0;if(1===e.length)return e[0];for(let n=e.length-1;n>=0;n--)r+=e[e.length-1-n]*Math.pow(2,t*n);return r}function D(e,t,r=-1){const n=r;let i=e,s=0,a=Math.pow(2,t);for(let r=1;r<8;r++){if(e<a){let e;if(n<0)e=new ArrayBuffer(r),s=r;else{if(n<r)return new ArrayBuffer(0);e=new ArrayBuffer(n),s=n}const a=new Uint8Array(e);for(let e=r-1;e>=0;e--){const r=Math.pow(2,e*t);a[s-e-1]=Math.floor(i/r),i-=a[s-e-1]*r}return e}a*=Math.pow(2,t)}return new ArrayBuffer(0)}function H(...e){let t=0,r=0;for(const r of e)t+=r.byteLength;const n=new ArrayBuffer(t),i=new Uint8Array(n);for(const t of e)i.set(new Uint8Array(t),r),r+=t.byteLength;return n}function R(...e){let t=0,r=0;for(const r of e)t+=r.length;const n=new ArrayBuffer(t),i=new Uint8Array(n);for(const t of e)i.set(t,r),r+=t.length;return i}function O(){const e=new Uint8Array(this.valueHex);if(this.valueHex.byteLength>=2){const t=255===e[0]&&128&e[1],r=0===e[0]&&0==(128&e[1]);(t||r)&&this.warnings.push("Needlessly long format")}const t=new ArrayBuffer(this.valueHex.byteLength),r=new Uint8Array(t);for(let e=0;e<this.valueHex.byteLength;e++)r[e]=0;r[0]=128&e[0];const n=N(r,8),i=new ArrayBuffer(this.valueHex.byteLength),s=new Uint8Array(i);for(let t=0;t<this.valueHex.byteLength;t++)s[t]=e[t];s[0]&=127;return N(s,8)-n}function T(e,t){if(e.byteLength!==t.byteLength)return!1;const r=new Uint8Array(e),n=new Uint8Array(t);for(let e=0;e<r.length;e++)if(r[e]!==n[e])return!1;return!0}function L(e,t){const r=e.toString(10);if(t<r.length)return"";const n=t-r.length,i=new Array(n);for(let e=0;e<n;e++)i[e]="0";return i.join("").concat(r)}const j="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",V="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=";function U(e,t=!1,r=!1,n=!1){let i=0,s=0,a=0,o="";const u=t?V:j;if(n){let t=0;for(let r=0;r<e.length;r++)if(0!==e.charCodeAt(r)){t=r;break}e=e.slice(t)}for(;i<e.length;){const t=e.charCodeAt(i++);i>=e.length&&(s=1);const n=e.charCodeAt(i++);i>=e.length&&(a=1);const h=e.charCodeAt(i++),l=t>>2,c=(3&t)<<4|n>>4;let f=(15&n)<<2|h>>6,g=63&h;1===s?f=g=64:1===a&&(g=64),o+=r?64===f?`${u.charAt(l)}${u.charAt(c)}`:64===g?`${u.charAt(l)}${u.charAt(c)}${u.charAt(f)}`:`${u.charAt(l)}${u.charAt(c)}${u.charAt(f)}${u.charAt(g)}`:`${u.charAt(l)}${u.charAt(c)}${u.charAt(f)}${u.charAt(g)}`}return o}function _(e,t=!1,r=!1){const n=t?V:j;function i(e){for(let t=0;t<64;t++)if(n.charAt(t)===e)return t;return 64}function s(e){return 64===e?0:e}let a=0,o="";for(;a<e.length;){const t=i(e.charAt(a++)),r=a>=e.length?0:i(e.charAt(a++)),n=a>=e.length?0:i(e.charAt(a++)),u=a>=e.length?0:i(e.charAt(a++)),h=s(t)<<2|s(r)>>4,l=(15&s(r))<<4|s(n)>>2,c=(3&s(n))<<6|s(u);o+=String.fromCharCode(h),64!==n&&(o+=String.fromCharCode(l)),64!==u&&(o+=String.fromCharCode(c))}if(r){let e=-1;for(let t=o.length-1;t>=0;t--)if(0!==o.charCodeAt(t)){e=t;break}o=-1!==e?o.slice(0,e+1):""}return o}function K(e){let t="";const r=new Uint8Array(e);for(const e of r)t+=String.fromCharCode(e);return t}function M(e){const t=e.length,r=new ArrayBuffer(t),n=new Uint8Array(r);for(let r=0;r<t;r++)n[r]=e.charCodeAt(r);return r}const q=Math.log(2);function J(e){const t=Math.log(e)/q,r=Math.floor(t),n=Math.round(t);return r===n?r:n}function $(e,t){for(const r of t)delete e[r]}const G=[new Uint8Array([1])],W="0123456789";class z{constructor(e={}){this.blockLength=I(e,"blockLength",0),this.error=I(e,"error",""),this.warnings=I(e,"warnings",[]),this.valueBeforeDecode="valueBeforeDecode"in e?e.valueBeforeDecode.slice(0):new ArrayBuffer(0)}static blockName(){return"baseBlock"}toJSON(){return{blockName:this.constructor.blockName(),blockLength:this.blockLength,error:this.error,warnings:this.warnings,valueBeforeDecode:F(this.valueBeforeDecode,0,this.valueBeforeDecode.byteLength)}}}const X=e=>class extends e{constructor(e={}){super(e),this.isHexOnly=I(e,"isHexOnly",!1),this.valueHex="valueHex"in e?e.valueHex.slice(0):new ArrayBuffer(0)}static blockName(){return"hexBlock"}fromBER(e,t,r){if(!1===P(this,e,t,r))return-1;return 0===new Uint8Array(e,t,r).length?(this.warnings.push("Zero buffer length"),t):(this.valueHex=e.slice(t,t+r),this.blockLength=r,t+r)}toBER(e=!1){return!0!==this.isHexOnly?(this.error='Flag "isHexOnly" is not set, abort',new ArrayBuffer(0)):!0===e?new ArrayBuffer(this.valueHex.byteLength):this.valueHex.slice(0)}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.blockName=this.constructor.blockName(),e.isHexOnly=this.isHexOnly,e.valueHex=F(this.valueHex,0,this.valueHex.byteLength),e}};class Q extends(X(z)){constructor(e={}){super(),"idBlock"in e?(this.isHexOnly=I(e.idBlock,"isHexOnly",!1),this.valueHex=I(e.idBlock,"valueHex",new ArrayBuffer(0)),this.tagClass=I(e.idBlock,"tagClass",-1),this.tagNumber=I(e.idBlock,"tagNumber",-1),this.isConstructed=I(e.idBlock,"isConstructed",!1)):(this.tagClass=-1,this.tagNumber=-1,this.isConstructed=!1)}static blockName(){return"identificationBlock"}toBER(e=!1){let t,r,n=0;switch(this.tagClass){case 1:n|=0;break;case 2:n|=64;break;case 3:n|=128;break;case 4:n|=192;break;default:return this.error="Unknown tag class",new ArrayBuffer(0)}if(this.isConstructed&&(n|=32),this.tagNumber<31&&!this.isHexOnly){if(t=new ArrayBuffer(1),r=new Uint8Array(t),!e){let e=this.tagNumber;e&=31,n|=e,r[0]=n}return t}if(!1===this.isHexOnly){const i=D(this.tagNumber,7),s=new Uint8Array(i),a=i.byteLength;if(t=new ArrayBuffer(a+1),r=new Uint8Array(t),r[0]=31|n,!e){for(let e=0;e<a-1;e++)r[e+1]=128|s[e];r[a]=s[a-1]}return t}if(t=new ArrayBuffer(this.valueHex.byteLength+1),r=new Uint8Array(t),r[0]=31|n,!1===e){const e=new Uint8Array(this.valueHex);for(let t=0;t<e.length-1;t++)r[t+1]=128|e[t];r[this.valueHex.byteLength]=e[e.length-1]}return t}fromBER(e,t,r){if(!1===P(this,e,t,r))return-1;const n=new Uint8Array(e,t,r);if(0===n.length)return this.error="Zero buffer length",-1;switch(192&n[0]){case 0:this.tagClass=1;break;case 64:this.tagClass=2;break;case 128:this.tagClass=3;break;case 192:this.tagClass=4;break;default:return this.error="Unknown tag class",-1}this.isConstructed=32==(32&n[0]),this.isHexOnly=!1;const i=31&n[0];if(31!==i)this.tagNumber=i,this.blockLength=1;else{let e=1;this.valueHex=new ArrayBuffer(255);let t=255,r=new Uint8Array(this.valueHex);for(;128&n[e];){if(r[e-1]=127&n[e],e++,e>=n.length)return this.error="End of input reached before message was fully decoded",-1;if(e===t){t+=255;const e=new ArrayBuffer(t),n=new Uint8Array(e);for(let e=0;e<r.length;e++)n[e]=r[e];this.valueHex=new ArrayBuffer(t),r=new Uint8Array(this.valueHex)}}this.blockLength=e+1,r[e-1]=127&n[e];const i=new ArrayBuffer(e),s=new Uint8Array(i);for(let t=0;t<e;t++)s[t]=r[t];this.valueHex=new ArrayBuffer(e),r=new Uint8Array(this.valueHex),r.set(s),this.blockLength<=9?this.tagNumber=N(r,7):(this.isHexOnly=!0,this.warnings.push("Tag too long, represented as hex-coded"))}if(1===this.tagClass&&this.isConstructed)switch(this.tagNumber){case 1:case 2:case 5:case 6:case 9:case 13:case 14:case 23:case 24:case 31:case 32:case 33:case 34:return this.error="Constructed encoding used for primitive type",-1}return t+this.blockLength}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.blockName=this.constructor.blockName(),e.tagClass=this.tagClass,e.tagNumber=this.tagNumber,e.isConstructed=this.isConstructed,e}}class Y extends z{constructor(e={}){super(),"lenBlock"in e?(this.isIndefiniteForm=I(e.lenBlock,"isIndefiniteForm",!1),this.longFormUsed=I(e.lenBlock,"longFormUsed",!1),this.length=I(e.lenBlock,"length",0)):(this.isIndefiniteForm=!1,this.longFormUsed=!1,this.length=0)}static blockName(){return"lengthBlock"}fromBER(e,t,r){if(!1===P(this,e,t,r))return-1;const n=new Uint8Array(e,t,r);if(0===n.length)return this.error="Zero buffer length",-1;if(255===n[0])return this.error="Length block 0xFF is reserved by standard",-1;if(this.isIndefiniteForm=128===n[0],!0===this.isIndefiniteForm)return this.blockLength=1,t+this.blockLength;if(this.longFormUsed=!!(128&n[0]),!1===this.longFormUsed)return this.length=n[0],this.blockLength=1,t+this.blockLength;const i=127&n[0];if(i>8)return this.error="Too big integer",-1;if(i+1>n.length)return this.error="End of input reached before message was fully decoded",-1;const s=new Uint8Array(i);for(let e=0;e<i;e++)s[e]=n[e+1];return 0===s[i-1]&&this.warnings.push("Needlessly long encoded length"),this.length=N(s,8),this.longFormUsed&&this.length<=127&&this.warnings.push("Unnecessary usage of long length form"),this.blockLength=i+1,t+this.blockLength}toBER(e=!1){let t,r;if(this.length>127&&(this.longFormUsed=!0),this.isIndefiniteForm)return t=new ArrayBuffer(1),!1===e&&(r=new Uint8Array(t),r[0]=128),t;if(!0===this.longFormUsed){const n=D(this.length,8);if(n.byteLength>127)return this.error="Too big length",new ArrayBuffer(0);if(t=new ArrayBuffer(n.byteLength+1),!0===e)return t;const i=new Uint8Array(n);r=new Uint8Array(t),r[0]=128|n.byteLength;for(let e=0;e<n.byteLength;e++)r[e+1]=i[e];return t}return t=new ArrayBuffer(1),!1===e&&(r=new Uint8Array(t),r[0]=this.length),t}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.blockName=this.constructor.blockName(),e.isIndefiniteForm=this.isIndefiniteForm,e.longFormUsed=this.longFormUsed,e.length=this.length,e}}class Z extends z{constructor(e={}){super(e)}static blockName(){return"valueBlock"}fromBER(e,t,r){throw TypeError('User need to make a specific function in a class which extends "ValueBlock"')}toBER(e=!1){throw TypeError('User need to make a specific function in a class which extends "ValueBlock"')}}class ee extends z{constructor(e={},t=Z){super(e),"name"in e&&(this.name=e.name),"optional"in e&&(this.optional=e.optional),"primitiveSchema"in e&&(this.primitiveSchema=e.primitiveSchema),this.idBlock=new Q(e),this.lenBlock=new Y(e),this.valueBlock=new t(e)}static blockName(){return"BaseBlock"}fromBER(e,t,r){const n=this.valueBlock.fromBER(e,t,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}toBER(e=!1){let t;const r=this.idBlock.toBER(e),n=this.valueBlock.toBER(!0);this.lenBlock.length=n.byteLength;let i;if(t=H(r,this.lenBlock.toBER(e)),i=!1===e?this.valueBlock.toBER(e):new ArrayBuffer(this.lenBlock.length),t=H(t,i),!0===this.lenBlock.isIndefiniteForm){const r=new ArrayBuffer(2);if(!1===e){const e=new Uint8Array(r);e[0]=0,e[1]=0}t=H(t,r)}return t}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.idBlock=this.idBlock.toJSON(),e.lenBlock=this.lenBlock.toJSON(),e.valueBlock=this.valueBlock.toJSON(),"name"in this&&(e.name=this.name),"optional"in this&&(e.optional=this.optional),"primitiveSchema"in this&&(e.primitiveSchema=this.primitiveSchema.toJSON()),e}toString(){return`${this.constructor.blockName()} : ${F(this.valueBlock.valueHex)}`}}class te extends Z{constructor(e={}){super(e),this.valueHex="valueHex"in e?e.valueHex.slice(0):new ArrayBuffer(0),this.isHexOnly=I(e,"isHexOnly",!0)}fromBER(e,t,r){if(!1===P(this,e,t,r))return-1;const n=new Uint8Array(e,t,r);if(0===n.length)return this.warnings.push("Zero buffer length"),t;this.valueHex=new ArrayBuffer(n.length);const i=new Uint8Array(this.valueHex);for(let e=0;e<n.length;e++)i[e]=n[e];return this.blockLength=r,t+r}toBER(e=!1){return this.valueHex.slice(0)}static blockName(){return"PrimitiveValueBlock"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.valueHex=F(this.valueHex,0,this.valueHex.byteLength),e.isHexOnly=this.isHexOnly,e}}class re extends ee{constructor(e={}){super(e,te),this.idBlock.isConstructed=!1}static blockName(){return"PRIMITIVE"}}class ne extends Z{constructor(e={}){super(e),this.value=I(e,"value",[]),this.isIndefiniteForm=I(e,"isIndefiniteForm",!1)}fromBER(e,t,r){const n=t,i=r;if(!1===P(this,e,t,r))return-1;if(0===new Uint8Array(e,t,r).length)return this.warnings.push("Zero buffer length"),t;let s=t;for(;a=this.isIndefiniteForm,o=r,(!0===a?1:o)>0;){const t=Ze(e,s,r);if(-1===t.offset)return this.error=t.result.error,this.warnings.concat(t.result.warnings),-1;if(s=t.offset,this.blockLength+=t.result.blockLength,r-=t.result.blockLength,this.value.push(t.result),!0===this.isIndefiniteForm&&t.result.constructor.blockName()===ae.blockName())break}var a,o;return!0===this.isIndefiniteForm&&(this.value[this.value.length-1].constructor.blockName()===ae.blockName()?this.value.pop():this.warnings.push("No EndOfContent block encoded")),this.valueBeforeDecode=e.slice(n,n+i),s}toBER(e=!1){let t=new ArrayBuffer(0);for(let r=0;r<this.value.length;r++){t=H(t,this.value[r].toBER(e))}return t}static blockName(){return"ConstructedValueBlock"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}e.isIndefiniteForm=this.isIndefiniteForm,e.value=[];for(let t=0;t<this.value.length;t++)e.value.push(this.value[t].toJSON());return e}}class ie extends ee{constructor(e={}){super(e,ne),this.idBlock.isConstructed=!0}static blockName(){return"CONSTRUCTED"}fromBER(e,t,r){this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm;const n=this.valueBlock.fromBER(e,t,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}toString(){const e=[];for(const t of this.valueBlock.value)e.push(t.toString().split("\n").map((e=>`  ${e}`)).join("\n"));const t=3===this.idBlock.tagClass?`[${this.idBlock.tagNumber}]`:this.constructor.blockName();return e.length?`${t} :\n${e.join("\n")}`:`${t} :`}}class se extends Z{constructor(e={}){super(e)}fromBER(e,t,r){return t}toBER(e=!1){return new ArrayBuffer(0)}static blockName(){return"EndOfContentValueBlock"}}class ae extends ee{constructor(e={}){super(e,se),this.idBlock.tagClass=1,this.idBlock.tagNumber=0}static blockName(){return"EndOfContent"}}class oe extends Z{constructor(e={}){if(super(e),this.value=I(e,"value",!1),this.isHexOnly=I(e,"isHexOnly",!1),"valueHex"in e)this.valueHex=e.valueHex.slice(0);else if(this.valueHex=new ArrayBuffer(1),!0===this.value){new Uint8Array(this.valueHex)[0]=255}}fromBER(e,t,r){if(!1===P(this,e,t,r))return-1;const n=new Uint8Array(e,t,r);r>1&&this.warnings.push("Boolean value encoded in more then 1 octet"),this.isHexOnly=!0,this.valueHex=new ArrayBuffer(n.length);const i=new Uint8Array(this.valueHex);for(let e=0;e<n.length;e++)i[e]=n[e];return 0!==O.call(this)?this.value=!0:this.value=!1,this.blockLength=r,t+r}toBER(e=!1){return this.valueHex}static blockName(){return"BooleanValueBlock"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.value=this.value,e.isHexOnly=this.isHexOnly,e.valueHex=F(this.valueHex,0,this.valueHex.byteLength),e}}class ue extends ee{constructor(e={}){super(e,oe),this.idBlock.tagClass=1,this.idBlock.tagNumber=1}static blockName(){return"BOOLEAN"}toString(){return`${this.constructor.blockName()} : ${this.valueBlock.value}`}}class he extends ie{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=16}static blockName(){return"SEQUENCE"}}class le extends ie{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=17}static blockName(){return"SET"}}class ce extends ee{constructor(e={}){super(e,z),this.idBlock.tagClass=1,this.idBlock.tagNumber=5}static blockName(){return"NULL"}fromBER(e,t,r){return this.lenBlock.length>0&&this.warnings.push("Non-zero length of value block for Null type"),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),this.blockLength+=r,t+r>e.byteLength?(this.error="End of input reached before message was fully decoded (inconsistent offset and length values)",-1):t+r}toBER(e=!1){const t=new ArrayBuffer(2);if(!0===e)return t;const r=new Uint8Array(t);return r[0]=5,r[1]=0,t}toString(){return`${this.constructor.blockName()}`}}class fe extends(X(ne)){constructor(e={}){super(e),this.isConstructed=I(e,"isConstructed",!1)}fromBER(e,t,r){let n=0;if(!0===this.isConstructed){if(this.isHexOnly=!1,n=ne.prototype.fromBER.call(this,e,t,r),-1===n)return n;for(let e=0;e<this.value.length;e++){const t=this.value[e].constructor.blockName();if(t===ae.blockName()){if(!0===this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, OCTET STRING may consists of OCTET STRINGs only",-1}if(t!==ge.blockName())return this.error="OCTET STRING may consists of OCTET STRINGs only",-1}}else this.isHexOnly=!0,n=super.fromBER(e,t,r),this.blockLength=r;return n}toBER(e=!1){if(!0===this.isConstructed)return ne.prototype.toBER.call(this,e);let t=new ArrayBuffer(this.valueHex.byteLength);return!0===e||0===this.valueHex.byteLength||(t=this.valueHex.slice(0)),t}static blockName(){return"OctetStringValueBlock"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.isConstructed=this.isConstructed,e.isHexOnly=this.isHexOnly,e.valueHex=F(this.valueHex,0,this.valueHex.byteLength),e}}class ge extends ee{constructor(e={}){super(e,fe),this.idBlock.tagClass=1,this.idBlock.tagNumber=4}fromBER(e,t,r){if(this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,0===r)return 0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),t;if(!this.valueBlock.isConstructed){const n=e.slice(t,t+r);try{const e=et(n);-1!==e.offset&&e.offset===r&&(this.valueBlock.value=[e.result])}catch(e){}}return super.fromBER(e,t,r)}static blockName(){return"OCTET STRING"}isEqual(e){return e instanceof ge!=!1&&JSON.stringify(this)===JSON.stringify(e)}toString(){return this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length?ie.prototype.toString.call(this):`${this.constructor.blockName()} : ${F(this.valueBlock.valueHex)}`}}class de extends(X(ne)){constructor(e={}){super(e),this.unusedBits=I(e,"unusedBits",0),this.isConstructed=I(e,"isConstructed",!1),this.blockLength=this.valueHex.byteLength}fromBER(e,t,r){if(0===r)return t;let n=-1;if(!0===this.isConstructed){if(n=ne.prototype.fromBER.call(this,e,t,r),-1===n)return n;for(let e=0;e<this.value.length;e++){const t=this.value[e].constructor.blockName();if(t===ae.blockName()){if(!0===this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, BIT STRING may consists of BIT STRINGs only",-1}if(t!==pe.blockName())return this.error="BIT STRING may consists of BIT STRINGs only",-1;if(this.unusedBits>0&&this.value[e].valueBlock.unusedBits>0)return this.error='Using of "unused bits" inside constructive BIT STRING allowed for least one only',-1;if(this.unusedBits=this.value[e].valueBlock.unusedBits,this.unusedBits>7)return this.error="Unused bits for BitString must be in range 0-7",-1}return n}if(!1===P(this,e,t,r))return-1;const i=new Uint8Array(e,t,r);if(this.unusedBits=i[0],this.unusedBits>7)return this.error="Unused bits for BitString must be in range 0-7",-1;if(!this.unusedBits){const n=e.slice(t+1,t+r);try{const e=et(n);-1!==e.offset&&e.offset===r-1&&(this.value=[e.result])}catch(e){}}this.valueHex=new ArrayBuffer(i.length-1);const s=new Uint8Array(this.valueHex);for(let e=0;e<r-1;e++)s[e]=i[e+1];return this.blockLength=i.length,t+r}toBER(e=!1){if(!0===this.isConstructed)return ne.prototype.toBER.call(this,e);if(!0===e)return new ArrayBuffer(this.valueHex.byteLength+1);if(0===this.valueHex.byteLength)return new ArrayBuffer(0);const t=new Uint8Array(this.valueHex),r=new ArrayBuffer(this.valueHex.byteLength+1),n=new Uint8Array(r);n[0]=this.unusedBits;for(let e=0;e<this.valueHex.byteLength;e++)n[e+1]=t[e];return r}static blockName(){return"BitStringValueBlock"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.unusedBits=this.unusedBits,e.isConstructed=this.isConstructed,e.isHexOnly=this.isHexOnly,e.valueHex=F(this.valueHex,0,this.valueHex.byteLength),e}}class pe extends ee{constructor(e={}){super(e,de),this.idBlock.tagClass=1,this.idBlock.tagNumber=3}static blockName(){return"BIT STRING"}fromBER(e,t,r){return 0===r?t:(this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,super.fromBER(e,t,r))}isEqual(e){return e instanceof pe!=!1&&JSON.stringify(this)===JSON.stringify(e)}toString(){if(this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length)return ie.prototype.toString.call(this);{const e=[],t=new Uint8Array(this.valueBlock.valueHex);for(const r of t)e.push(r.toString(2).padStart(8,"0"));return`${this.constructor.blockName()} : ${e.join("")}`}}}class me extends(X(Z)){constructor(e={}){super(e),"value"in e&&(this.valueDec=e.value)}set valueHex(e){this._valueHex=e.slice(0),e.byteLength>=4?(this.warnings.push("Too big Integer for decoding, hex only"),this.isHexOnly=!0,this._valueDec=0):(this.isHexOnly=!1,e.byteLength>0&&(this._valueDec=O.call(this)))}get valueHex(){return this._valueHex}set valueDec(e){this._valueDec=e,this.isHexOnly=!1,this._valueHex=function(e){const t=e<0?-1*e:e;let r=128;for(let n=1;n<8;n++){if(t<=r){if(e<0){const e=D(r-t,8,n);return new Uint8Array(e)[0]|=128,e}let i=D(t,8,n),s=new Uint8Array(i);if(128&s[0]){const e=i.slice(0),t=new Uint8Array(e);i=new ArrayBuffer(i.byteLength+1),s=new Uint8Array(i);for(let r=0;r<e.byteLength;r++)s[r+1]=t[r];s[0]=0}return i}r*=Math.pow(2,8)}return new ArrayBuffer(0)}(e)}get valueDec(){return this._valueDec}fromDER(e,t,r,n=0){const i=this.fromBER(e,t,r);if(-1===i)return i;const s=new Uint8Array(this._valueHex);if(0===s[0]&&0!=(128&s[1])){const e=new ArrayBuffer(this._valueHex.byteLength-1);new Uint8Array(e).set(new Uint8Array(this._valueHex,1,this._valueHex.byteLength-1)),this._valueHex=e.slice(0)}else if(0!==n&&this._valueHex.byteLength<n){n-this._valueHex.byteLength>1&&(n=this._valueHex.byteLength+1);const e=new ArrayBuffer(n);new Uint8Array(e).set(s,n-this._valueHex.byteLength),this._valueHex=e.slice(0)}return i}toDER(e=!1){const t=new Uint8Array(this._valueHex);switch(!0){case 0!=(128&t[0]):{const e=new ArrayBuffer(this._valueHex.byteLength+1),r=new Uint8Array(e);r[0]=0,r.set(t,1),this._valueHex=e.slice(0)}break;case 0===t[0]&&0==(128&t[1]):{const e=new ArrayBuffer(this._valueHex.byteLength-1);new Uint8Array(e).set(new Uint8Array(this._valueHex,1,this._valueHex.byteLength-1)),this._valueHex=e.slice(0)}}return this.toBER(e)}fromBER(e,t,r){const n=super.fromBER(e,t,r);return-1===n?n:(this.blockLength=r,t+r)}toBER(e=!1){return this.valueHex.slice(0)}static blockName(){return"IntegerValueBlock"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.valueDec=this.valueDec,e}toString(){function e(e,t){const r=new Uint8Array([0]);let n=new Uint8Array(e),i=new Uint8Array(t),s=n.slice(0);const a=s.length-1;let o=i.slice(0);const u=o.length-1;let h=0;let l=0;for(let e=u<a?a:u;e>=0;e--,l++){switch(!0){case l<o.length:h=s[a-l]+o[u-l]+r[0];break;default:h=s[a-l]+r[0]}switch(r[0]=h/10,!0){case l>=s.length:s=R(new Uint8Array([h%10]),s);break;default:s[a-l]=h%10}}return r[0]>0&&(s=R(r,s)),s.slice(0)}function t(e){if(e>=G.length)for(let t=G.length;t<=e;t++){const e=new Uint8Array([0]);let r=G[t-1].slice(0);for(let t=r.length-1;t>=0;t--){const n=new Uint8Array([(r[t]<<1)+e[0]]);e[0]=n[0]/10,r[t]=n[0]%10}e[0]>0&&(r=R(e,r)),G.push(r)}return G[e]}function r(e,t){let r=0,n=new Uint8Array(e),i=new Uint8Array(t),s=n.slice(0);const a=s.length-1;let o=i.slice(0);const u=o.length-1;let h,l=0;for(let e=u;e>=0;e--,l++)switch(h=s[a-l]-o[u-l]-r,!0){case h<0:r=1,s[a-l]=h+10;break;default:r=0,s[a-l]=h}if(r>0)for(let e=a-u+1;e>=0;e--,l++){if(h=s[a-l]-r,!(h<0)){r=0,s[a-l]=h;break}r=1,s[a-l]=h+10}return s.slice()}const n=8*this._valueHex.byteLength-1;let i,s=new Uint8Array(8*this._valueHex.byteLength/3),a=0;const o=new Uint8Array(this._valueHex);let u="",h=!1;for(let h=this._valueHex.byteLength-1;h>=0;h--){i=o[h];for(let o=0;o<8;o++){if(1==(1&i))switch(a){case n:s=r(t(a),s),u="-";break;default:s=e(s,t(a))}a++,i>>=1}}for(let e=0;e<s.length;e++)s[e]&&(h=!0),h&&(u+=W.charAt(s[e]));return!1===h&&(u+=W.charAt(0)),u}}class ye extends ee{constructor(e={}){super(e,me),this.idBlock.tagClass=1,this.idBlock.tagNumber=2}static blockName(){return"INTEGER"}isEqual(e){return e instanceof ye?this.valueBlock.isHexOnly&&e.valueBlock.isHexOnly?T(this.valueBlock.valueHex,e.valueBlock.valueHex):this.valueBlock.isHexOnly===e.valueBlock.isHexOnly&&this.valueBlock.valueDec===e.valueBlock.valueDec:e instanceof ArrayBuffer&&T(this.valueBlock.valueHex,e)}convertToDER(){const e=new ye({valueHex:this.valueBlock.valueHex});return e.valueBlock.toDER(),e}convertFromDER(){const e=this.valueBlock.valueHex.byteLength%2?this.valueBlock.valueHex.byteLength+1:this.valueBlock.valueHex.byteLength,t=new ye({valueHex:this.valueBlock.valueHex});return t.valueBlock.fromDER(t.valueBlock.valueHex,0,t.valueBlock.valueHex.byteLength,e),t}toString(){const e=F(this.valueBlock.valueHex),t=BigInt(`0x${e}`);return`${this.constructor.blockName()} : ${t.toString()}`}}class ve extends ye{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=10}static blockName(){return"ENUMERATED"}}class be extends(X(z)){constructor(e={}){super(e),this.valueDec=I(e,"valueDec",-1),this.isFirstSid=I(e,"isFirstSid",!1)}static blockName(){return"sidBlock"}fromBER(e,t,r){if(0===r)return t;if(!1===P(this,e,t,r))return-1;const n=new Uint8Array(e,t,r);this.valueHex=new ArrayBuffer(r);let i=new Uint8Array(this.valueHex);for(let e=0;e<r&&(i[e]=127&n[e],this.blockLength++,0!=(128&n[e]));e++);const s=new ArrayBuffer(this.blockLength),a=new Uint8Array(s);for(let e=0;e<this.blockLength;e++)a[e]=i[e];return this.valueHex=s.slice(0),i=new Uint8Array(this.valueHex),0!=(128&n[this.blockLength-1])?(this.error="End of input reached before message was fully decoded",-1):(0===i[0]&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=N(i,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}toBER(e=!1){let t,r;if(this.isHexOnly){if(!0===e)return new ArrayBuffer(this.valueHex.byteLength);const n=new Uint8Array(this.valueHex);t=new ArrayBuffer(this.blockLength),r=new Uint8Array(t);for(let e=0;e<this.blockLength-1;e++)r[e]=128|n[e];return r[this.blockLength-1]=n[this.blockLength-1],t}const n=D(this.valueDec,7);if(0===n.byteLength)return this.error="Error during encoding SID value",new ArrayBuffer(0);if(t=new ArrayBuffer(n.byteLength),!1===e){const e=new Uint8Array(n);r=new Uint8Array(t);for(let t=0;t<n.byteLength-1;t++)r[t]=128|e[t];r[n.byteLength-1]=e[n.byteLength-1]}return t}toString(){let e="";if(!0===this.isHexOnly)e=F(this.valueHex,0,this.valueHex.byteLength);else if(this.isFirstSid){let t=this.valueDec;this.valueDec<=39?e="0.":this.valueDec<=79?(e="1.",t-=40):(e="2.",t-=80),e+=t.toString()}else e=this.valueDec.toString();return e}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.valueDec=this.valueDec,e.isFirstSid=this.isFirstSid,e}}class we extends Z{constructor(e={}){super(e),this.fromString(I(e,"value",""))}fromBER(e,t,r){let n=t;for(;r>0;){const t=new be;if(n=t.fromBER(e,n,r),-1===n)return this.blockLength=0,this.error=t.error,n;0===this.value.length&&(t.isFirstSid=!0),this.blockLength+=t.blockLength,r-=t.blockLength,this.value.push(t)}return n}toBER(e=!1){let t=new ArrayBuffer(0);for(let r=0;r<this.value.length;r++){const n=this.value[r].toBER(e);if(0===n.byteLength)return this.error=this.value[r].error,new ArrayBuffer(0);t=H(t,n)}return t}fromString(e){this.value=[];let t=0,r=0,n="",i=!1;do{if(r=e.indexOf(".",t),n=-1===r?e.substr(t):e.substr(t,r-t),t=r+1,i){const e=this.value[0];let t=0;switch(e.valueDec){case 0:break;case 1:t=40;break;case 2:t=80;break;default:return this.value=[],!1}const r=parseInt(n,10);if(isNaN(r))return!0;e.valueDec=r+t,i=!1}else{const e=new be;if(e.valueDec=parseInt(n,10),isNaN(e.valueDec))return!0;0===this.value.length&&(e.isFirstSid=!0,i=!0),this.value.push(e)}}while(-1!==r);return!0}toString(){let e="",t=!1;for(let r=0;r<this.value.length;r++){t=this.value[r].isHexOnly;let n=this.value[r].toString();0!==r&&(e=`${e}.`),t?(n=`{${n}}`,this.value[r].isFirstSid?e=`2.{${n} - 80}`:e+=n):e+=n}return e}static blockName(){return"ObjectIdentifierValueBlock"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}e.value=this.toString(),e.sidArray=[];for(let t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}class Se extends ee{constructor(e={}){super(e,we),this.idBlock.tagClass=1,this.idBlock.tagNumber=6}static blockName(){return"OBJECT IDENTIFIER"}toString(){return`${this.constructor.blockName()} : ${this.valueBlock.toString()}`}}class Ae extends(X(z)){constructor(e={}){super(e),this.isHexOnly=!0,this.value=""}static blockName(){return"Utf8StringValueBlock"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.value=this.value,e}}class xe extends ee{constructor(e={}){super(e,Ae),"value"in e&&this.fromString(e.value),this.idBlock.tagClass=1,this.idBlock.tagNumber=12}static blockName(){return"UTF8String"}fromBER(e,t,r){const n=this.valueBlock.fromBER(e,t,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.fromBuffer(this.valueBlock.valueHex),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}fromBuffer(e){this.valueBlock.value=String.fromCharCode.apply(null,new Uint8Array(e));try{this.valueBlock.value=decodeURIComponent(escape(this.valueBlock.value))}catch(e){this.warnings.push(`Error during "decodeURIComponent": ${e}, using raw string`)}}fromString(e){const t=unescape(encodeURIComponent(e)),r=t.length;this.valueBlock.valueHex=new ArrayBuffer(r);const n=new Uint8Array(this.valueBlock.valueHex);for(let e=0;e<r;e++)n[e]=t.charCodeAt(e);this.valueBlock.value=e}toString(){return`${this.constructor.blockName()} : ${this.valueBlock.value}`}}class Ee extends(X(z)){constructor(e={}){super(e),this.valueDec=I(e,"valueDec",-1)}static blockName(){return"relativeSidBlock"}fromBER(e,t,r){if(0===r)return t;if(!1===P(this,e,t,r))return-1;const n=new Uint8Array(e,t,r);this.valueHex=new ArrayBuffer(r);let i=new Uint8Array(this.valueHex);for(let e=0;e<r&&(i[e]=127&n[e],this.blockLength++,0!=(128&n[e]));e++);const s=new ArrayBuffer(this.blockLength),a=new Uint8Array(s);for(let e=0;e<this.blockLength;e++)a[e]=i[e];return this.valueHex=s.slice(0),i=new Uint8Array(this.valueHex),0!=(128&n[this.blockLength-1])?(this.error="End of input reached before message was fully decoded",-1):(0===i[0]&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=N(i,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}toBER(e=!1){let t,r;if(this.isHexOnly){if(!0===e)return new ArrayBuffer(this.valueHex.byteLength);const n=new Uint8Array(this.valueHex);t=new ArrayBuffer(this.blockLength),r=new Uint8Array(t);for(let e=0;e<this.blockLength-1;e++)r[e]=128|n[e];return r[this.blockLength-1]=n[this.blockLength-1],t}const n=D(this.valueDec,7);if(0===n.byteLength)return this.error="Error during encoding SID value",new ArrayBuffer(0);if(t=new ArrayBuffer(n.byteLength),!1===e){const e=new Uint8Array(n);r=new Uint8Array(t);for(let t=0;t<n.byteLength-1;t++)r[t]=128|e[t];r[n.byteLength-1]=e[n.byteLength-1]}return t}toString(){let e="";return e=!0===this.isHexOnly?F(this.valueHex,0,this.valueHex.byteLength):this.valueDec.toString(),e}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.valueDec=this.valueDec,e}}class Be extends Z{constructor(e={}){super(e),this.fromString(I(e,"value",""))}fromBER(e,t,r){let n=t;for(;r>0;){const t=new Ee;if(n=t.fromBER(e,n,r),-1===n)return this.blockLength=0,this.error=t.error,n;this.blockLength+=t.blockLength,r-=t.blockLength,this.value.push(t)}return n}toBER(e=!1){let t=new ArrayBuffer(0);for(let r=0;r<this.value.length;r++){const n=this.value[r].toBER(e);if(0===n.byteLength)return this.error=this.value[r].error,new ArrayBuffer(0);t=H(t,n)}return t}fromString(e){this.value=[];let t=0,r=0,n="";do{r=e.indexOf(".",t),n=-1===r?e.substr(t):e.substr(t,r-t),t=r+1;const i=new Ee;if(i.valueDec=parseInt(n,10),isNaN(i.valueDec))return!0;this.value.push(i)}while(-1!==r);return!0}toString(){let e="",t=!1;for(let r=0;r<this.value.length;r++){t=this.value[r].isHexOnly;let n=this.value[r].toString();0!==r&&(e=`${e}.`),t?(n=`{${n}}`,e+=n):e+=n}return e}static blockName(){return"RelativeObjectIdentifierValueBlock"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}e.value=this.toString(),e.sidArray=[];for(let t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}class ke extends ee{constructor(e={}){super(e,Be),this.idBlock.tagClass=1,this.idBlock.tagNumber=13}static blockName(){return"RelativeObjectIdentifier"}}class Ce extends(X(z)){constructor(e={}){super(e),this.isHexOnly=!0,this.value=""}static blockName(){return"BmpStringValueBlock"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.value=this.value,e}}class Ie extends ee{constructor(e={}){super(e,Ce),"value"in e&&this.fromString(e.value),this.idBlock.tagClass=1,this.idBlock.tagNumber=30}static blockName(){return"BMPString"}fromBER(e,t,r){const n=this.valueBlock.fromBER(e,t,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.fromBuffer(this.valueBlock.valueHex),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}fromBuffer(e){const t=e.slice(0),r=new Uint8Array(t);for(let e=0;e<r.length;e+=2){const t=r[e];r[e]=r[e+1],r[e+1]=t}this.valueBlock.value=String.fromCharCode.apply(null,new Uint16Array(t))}fromString(e){const t=e.length;this.valueBlock.valueHex=new ArrayBuffer(2*t);const r=new Uint8Array(this.valueBlock.valueHex);for(let n=0;n<t;n++){const t=D(e.charCodeAt(n),8),i=new Uint8Array(t);if(i.length>2)continue;const s=2-i.length;for(let e=i.length-1;e>=0;e--)r[2*n+e+s]=i[e]}this.valueBlock.value=e}toString(){return`${this.constructor.blockName()} : ${this.valueBlock.value}`}}class Fe extends(X(z)){constructor(e={}){super(e),this.isHexOnly=!0,this.value=""}static blockName(){return"UniversalStringValueBlock"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.value=this.value,e}}class Pe extends ee{constructor(e={}){super(e,Fe),"value"in e&&this.fromString(e.value),this.idBlock.tagClass=1,this.idBlock.tagNumber=28}static blockName(){return"UniversalString"}fromBER(e,t,r){const n=this.valueBlock.fromBER(e,t,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.fromBuffer(this.valueBlock.valueHex),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}fromBuffer(e){const t=e.slice(0),r=new Uint8Array(t);for(let e=0;e<r.length;e+=4)r[e]=r[e+3],r[e+1]=r[e+2],r[e+2]=0,r[e+3]=0;this.valueBlock.value=String.fromCharCode.apply(null,new Uint32Array(t))}fromString(e){const t=e.length;this.valueBlock.valueHex=new ArrayBuffer(4*t);const r=new Uint8Array(this.valueBlock.valueHex);for(let n=0;n<t;n++){const t=D(e.charCodeAt(n),8),i=new Uint8Array(t);if(i.length>4)continue;const s=4-i.length;for(let e=i.length-1;e>=0;e--)r[4*n+e+s]=i[e]}this.valueBlock.value=e}toString(){return`${this.constructor.blockName()} : ${this.valueBlock.value}`}}class Ne extends(X(z)){constructor(e={}){super(e),this.value="",this.isHexOnly=!0}static blockName(){return"SimpleStringValueBlock"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.value=this.value,e}}class De extends ee{constructor(e={}){super(e,Ne),"value"in e&&this.fromString(e.value)}static blockName(){return"SIMPLESTRING"}fromBER(e,t,r){const n=this.valueBlock.fromBER(e,t,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.fromBuffer(this.valueBlock.valueHex),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}fromBuffer(e){this.valueBlock.value=String.fromCharCode.apply(null,new Uint8Array(e))}fromString(e){const t=e.length;this.valueBlock.valueHex=new ArrayBuffer(t);const r=new Uint8Array(this.valueBlock.valueHex);for(let n=0;n<t;n++)r[n]=e.charCodeAt(n);this.valueBlock.value=e}toString(){return`${this.constructor.blockName()} : ${this.valueBlock.value}`}}class He extends De{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=18}static blockName(){return"NumericString"}}class Re extends De{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=19}static blockName(){return"PrintableString"}}class Oe extends De{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=20}static blockName(){return"TeletexString"}}class Te extends De{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=21}static blockName(){return"VideotexString"}}class Le extends De{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=22}static blockName(){return"IA5String"}}class je extends De{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=25}static blockName(){return"GraphicString"}}class Ve extends De{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=26}static blockName(){return"VisibleString"}}class Ue extends De{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=27}static blockName(){return"GeneralString"}}class _e extends De{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=29}static blockName(){return"CharacterString"}}class Ke extends Ve{constructor(e={}){if(super(e),this.year=0,this.month=0,this.day=0,this.hour=0,this.minute=0,this.second=0,"value"in e){this.fromString(e.value),this.valueBlock.valueHex=new ArrayBuffer(e.value.length);const t=new Uint8Array(this.valueBlock.valueHex);for(let r=0;r<e.value.length;r++)t[r]=e.value.charCodeAt(r)}"valueDate"in e&&(this.fromDate(e.valueDate),this.valueBlock.valueHex=this.toBuffer()),this.idBlock.tagClass=1,this.idBlock.tagNumber=23}fromBER(e,t,r){const n=this.valueBlock.fromBER(e,t,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.fromBuffer(this.valueBlock.valueHex),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}fromBuffer(e){this.fromString(String.fromCharCode.apply(null,new Uint8Array(e)))}toBuffer(){const e=this.toString(),t=new ArrayBuffer(e.length),r=new Uint8Array(t);for(let t=0;t<e.length;t++)r[t]=e.charCodeAt(t);return t}fromDate(e){this.year=e.getUTCFullYear(),this.month=e.getUTCMonth()+1,this.day=e.getUTCDate(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second))}fromString(e){const t=/(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})Z/gi.exec(e);if(null===t)return void(this.error="Wrong input string for convertion");const r=parseInt(t[1],10);this.year=r>=50?1900+r:2e3+r,this.month=parseInt(t[2],10),this.day=parseInt(t[3],10),this.hour=parseInt(t[4],10),this.minute=parseInt(t[5],10),this.second=parseInt(t[6],10)}toString(){const e=new Array(7);return e[0]=L(this.year<2e3?this.year-1900:this.year-2e3,2),e[1]=L(this.month,2),e[2]=L(this.day,2),e[3]=L(this.hour,2),e[4]=L(this.minute,2),e[5]=L(this.second,2),e[6]="Z",e.join("")}static blockName(){return"UTCTime"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.year=this.year,e.month=this.month,e.day=this.day,e.hour=this.hour,e.minute=this.minute,e.second=this.second,e}}class Me extends Ve{constructor(e={}){if(super(e),this.year=0,this.month=0,this.day=0,this.hour=0,this.minute=0,this.second=0,this.millisecond=0,"value"in e){this.fromString(e.value),this.valueBlock.valueHex=new ArrayBuffer(e.value.length);const t=new Uint8Array(this.valueBlock.valueHex);for(let r=0;r<e.value.length;r++)t[r]=e.value.charCodeAt(r)}"valueDate"in e&&(this.fromDate(e.valueDate),this.valueBlock.valueHex=this.toBuffer()),this.idBlock.tagClass=1,this.idBlock.tagNumber=24}fromBER(e,t,r){const n=this.valueBlock.fromBER(e,t,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.fromBuffer(this.valueBlock.valueHex),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}fromBuffer(e){this.fromString(String.fromCharCode.apply(null,new Uint8Array(e)))}toBuffer(){const e=this.toString(),t=new ArrayBuffer(e.length),r=new Uint8Array(t);for(let t=0;t<e.length;t++)r[t]=e.charCodeAt(t);return t}fromDate(e){this.year=e.getUTCFullYear(),this.month=e.getUTCMonth()+1,this.day=e.getUTCDate(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds(),this.millisecond=e.getUTCMilliseconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second,this.millisecond))}fromString(e){let t,r=!1,n="",i="",s=0,a=0,o=0;if("Z"===e[e.length-1])n=e.substr(0,e.length-1),r=!0;else{const t=new Number(e[e.length-1]);if(isNaN(t.valueOf()))throw new Error("Wrong input string for convertion");n=e}if(r){if(-1!==n.indexOf("+"))throw new Error("Wrong input string for convertion");if(-1!==n.indexOf("-"))throw new Error("Wrong input string for convertion")}else{let e=1,t=n.indexOf("+"),r="";if(-1===t&&(t=n.indexOf("-"),e=-1),-1!==t){if(r=n.substr(t+1),n=n.substr(0,t),2!==r.length&&4!==r.length)throw new Error("Wrong input string for convertion");let i=new Number(r.substr(0,2));if(isNaN(i.valueOf()))throw new Error("Wrong input string for convertion");if(a=e*i,4===r.length){if(i=new Number(r.substr(2,2)),isNaN(i.valueOf()))throw new Error("Wrong input string for convertion");o=e*i}}}let u=n.indexOf(".");if(-1===u&&(u=n.indexOf(",")),-1!==u){const e=new Number(`0${n.substr(u)}`);if(isNaN(e.valueOf()))throw new Error("Wrong input string for convertion");s=e.valueOf(),i=n.substr(0,u)}else i=n;switch(!0){case 8===i.length:if(t=/(\d{4})(\d{2})(\d{2})/gi,-1!==u)throw new Error("Wrong input string for convertion");break;case 10===i.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})/gi,-1!==u){let e=60*s;this.minute=Math.floor(e),e=60*(e-this.minute),this.second=Math.floor(e),e=1e3*(e-this.second),this.millisecond=Math.floor(e)}break;case 12===i.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})/gi,-1!==u){let e=60*s;this.second=Math.floor(e),e=1e3*(e-this.second),this.millisecond=Math.floor(e)}break;case 14===i.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})/gi,-1!==u){const e=1e3*s;this.millisecond=Math.floor(e)}break;default:throw new Error("Wrong input string for convertion")}const h=t.exec(i);if(null===h)throw new Error("Wrong input string for convertion");for(let e=1;e<h.length;e++)switch(e){case 1:this.year=parseInt(h[e],10);break;case 2:this.month=parseInt(h[e],10);break;case 3:this.day=parseInt(h[e],10);break;case 4:this.hour=parseInt(h[e],10)+a;break;case 5:this.minute=parseInt(h[e],10)+o;break;case 6:this.second=parseInt(h[e],10);break;default:throw new Error("Wrong input string for convertion")}if(!1===r){const e=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second,this.millisecond);this.year=e.getUTCFullYear(),this.month=e.getUTCMonth(),this.day=e.getUTCDay(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds(),this.millisecond=e.getUTCMilliseconds()}}toString(){const e=[];return e.push(L(this.year,4)),e.push(L(this.month,2)),e.push(L(this.day,2)),e.push(L(this.hour,2)),e.push(L(this.minute,2)),e.push(L(this.second,2)),0!==this.millisecond&&(e.push("."),e.push(L(this.millisecond,3))),e.push("Z"),e.join("")}static blockName(){return"GeneralizedTime"}toJSON(){let e={};try{e=super.toJSON()}catch(e){}return e.year=this.year,e.month=this.month,e.day=this.day,e.hour=this.hour,e.minute=this.minute,e.second=this.second,e.millisecond=this.millisecond,e}}class qe extends xe{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=31}static blockName(){return"DATE"}}class Je extends xe{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=32}static blockName(){return"TimeOfDay"}}class $e extends xe{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=33}static blockName(){return"DateTime"}}class Ge extends xe{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=34}static blockName(){return"Duration"}}class We extends xe{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=14}static blockName(){return"TIME"}}class ze{constructor(e={}){this.value=I(e,"value",[]),this.optional=I(e,"optional",!1)}}class Xe{constructor(e={}){this.name=I(e,"name",""),this.optional=I(e,"optional",!1)}}class Qe{constructor(e={}){this.name=I(e,"name",""),this.optional=I(e,"optional",!1),this.value=I(e,"value",new Xe),this.local=I(e,"local",!1)}}class Ye{constructor(e={}){this.data=I(e,"data",new ArrayBuffer(0))}fromBER(e,t,r){return this.data=e.slice(t,r),t+r}toBER(e=!1){return this.data}}function Ze(e,t,r){const n=t;let i=new ee({},Object);const s=new z;if(!1===P(s,e,t,r))return i.error=s.error,{offset:-1,result:i};if(0===new Uint8Array(e,t,r).length)return i.error="Zero buffer length",{offset:-1,result:i};let a=i.idBlock.fromBER(e,t,r);if(i.warnings.concat(i.idBlock.warnings),-1===a)return i.error=i.idBlock.error,{offset:-1,result:i};if(t=a,r-=i.idBlock.blockLength,a=i.lenBlock.fromBER(e,t,r),i.warnings.concat(i.lenBlock.warnings),-1===a)return i.error=i.lenBlock.error,{offset:-1,result:i};if(t=a,r-=i.lenBlock.blockLength,!1===i.idBlock.isConstructed&&!0===i.lenBlock.isIndefiniteForm)return i.error="Indefinite length form used for primitive encoding form",{offset:-1,result:i};let o=ee;switch(i.idBlock.tagClass){case 1:if(i.idBlock.tagNumber>=37&&!1===i.idBlock.isHexOnly)return i.error="UNIVERSAL 37 and upper tags are reserved by ASN.1 standard",{offset:-1,result:i};switch(i.idBlock.tagNumber){case 0:if(!0===i.idBlock.isConstructed&&i.lenBlock.length>0)return i.error="Type [UNIVERSAL 0] is reserved",{offset:-1,result:i};o=ae;break;case 1:o=ue;break;case 2:o=ye;break;case 3:o=pe;break;case 4:o=ge;break;case 5:o=ce;break;case 6:o=Se;break;case 10:o=ve;break;case 12:o=xe;break;case 13:o=ke;break;case 14:o=We;break;case 15:return i.error="[UNIVERSAL 15] is reserved by ASN.1 standard",{offset:-1,result:i};case 16:o=he;break;case 17:o=le;break;case 18:o=He;break;case 19:o=Re;break;case 20:o=Oe;break;case 21:o=Te;break;case 22:o=Le;break;case 23:o=Ke;break;case 24:o=Me;break;case 25:o=je;break;case 26:o=Ve;break;case 27:o=Ue;break;case 28:o=Pe;break;case 29:o=_e;break;case 30:o=Ie;break;case 31:o=qe;break;case 32:o=Je;break;case 33:o=$e;break;case 34:o=Ge;break;default:{let e;e=!0===i.idBlock.isConstructed?new ie:new re,e.idBlock=i.idBlock,e.lenBlock=i.lenBlock,e.warnings=i.warnings,i=e}}break;case 2:case 3:case 4:default:o=!0===i.idBlock.isConstructed?ie:re}return i=function(e,t){if(e instanceof t)return e;const r=new t;return r.idBlock=e.idBlock,r.lenBlock=e.lenBlock,r.warnings=e.warnings,r.valueBeforeDecode=e.valueBeforeDecode.slice(0),r}(i,o),a=i.fromBER(e,t,!0===i.lenBlock.isIndefiniteForm?r:i.lenBlock.length),i.valueBeforeDecode=e.slice(n,n+i.blockLength),{offset:a,result:i}}function et(e){if(0===e.byteLength){const e=new ee({},Object);return e.error="Input buffer has zero length",{offset:-1,result:e}}return Ze(e,0,e.byteLength)}function tt(e,t,r){if(r instanceof ze){const n=!1;for(let n=0;n<r.value.length;n++){if(!0===tt(e,t,r.value[n]).verified)return{verified:!0,result:e}}if(!1===n){const e={verified:!1,result:{error:"Wrong values for Choice type"}};return r.hasOwnProperty("name")&&(e.name=r.name),e}}if(r instanceof Xe)return r.hasOwnProperty("name")&&(e[r.name]=t),{verified:!0,result:e};if(e instanceof Object==!1)return{verified:!1,result:{error:"Wrong root object"}};if(t instanceof Object==!1)return{verified:!1,result:{error:"Wrong ASN.1 data"}};if(r instanceof Object==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if("idBlock"in r==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if("fromBER"in r.idBlock==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if("toBER"in r.idBlock==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};const n=r.idBlock.toBER(!1);if(0===n.byteLength)return{verified:!1,result:{error:"Error encoding idBlock for ASN.1 schema"}};if(-1===r.idBlock.fromBER(n,0,n.byteLength))return{verified:!1,result:{error:"Error decoding idBlock for ASN.1 schema"}};if(!1===r.idBlock.hasOwnProperty("tagClass"))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.tagClass!==t.idBlock.tagClass)return{verified:!1,result:e};if(!1===r.idBlock.hasOwnProperty("tagNumber"))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.tagNumber!==t.idBlock.tagNumber)return{verified:!1,result:e};if(!1===r.idBlock.hasOwnProperty("isConstructed"))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.isConstructed!==t.idBlock.isConstructed)return{verified:!1,result:e};if("isHexOnly"in r.idBlock==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.isHexOnly!==t.idBlock.isHexOnly)return{verified:!1,result:e};if(!0===r.idBlock.isHexOnly){if("valueHex"in r.idBlock==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};const n=new Uint8Array(r.idBlock.valueHex),i=new Uint8Array(t.idBlock.valueHex);if(n.length!==i.length)return{verified:!1,result:e};for(let t=0;t<n.length;t++)if(n[t]!==i[1])return{verified:!1,result:e}}if(r.hasOwnProperty("name")&&(r.name=r.name.replace(/^\s+|\s+$/g,""),""!==r.name&&(e[r.name]=t)),!0===r.idBlock.isConstructed){let n=0,i={verified:!1},s=r.valueBlock.value.length;if(s>0&&r.valueBlock.value[0]instanceof Qe&&(s=t.valueBlock.value.length),0===s)return{verified:!0,result:e};if(0===t.valueBlock.value.length&&0!==r.valueBlock.value.length){let t=!0;for(let e=0;e<r.valueBlock.value.length;e++)t=t&&(r.valueBlock.value[e].optional||!1);return!0===t?{verified:!0,result:e}:(r.hasOwnProperty("name")&&(r.name=r.name.replace(/^\s+|\s+$/g,""),""!==r.name&&delete e[r.name]),e.error="Inconsistent object length",{verified:!1,result:e})}for(let a=0;a<s;a++)if(a-n>=t.valueBlock.value.length){if(!1===r.valueBlock.value[a].optional){const t={verified:!1,result:e};return e.error="Inconsistent length between ASN.1 data and schema",r.hasOwnProperty("name")&&(r.name=r.name.replace(/^\s+|\s+$/g,""),""!==r.name&&(delete e[r.name],t.name=r.name)),t}}else if(r.valueBlock.value[0]instanceof Qe){if(i=tt(e,t.valueBlock.value[a],r.valueBlock.value[0].value),!1===i.verified){if(!0!==r.valueBlock.value[0].optional)return r.hasOwnProperty("name")&&(r.name=r.name.replace(/^\s+|\s+$/g,""),""!==r.name&&delete e[r.name]),i;n++}if("name"in r.valueBlock.value[0]&&r.valueBlock.value[0].name.length>0){let n={};n="local"in r.valueBlock.value[0]&&!0===r.valueBlock.value[0].local?t:e,void 0===n[r.valueBlock.value[0].name]&&(n[r.valueBlock.value[0].name]=[]),n[r.valueBlock.value[0].name].push(t.valueBlock.value[a])}}else if(i=tt(e,t.valueBlock.value[a-n],r.valueBlock.value[a]),!1===i.verified){if(!0!==r.valueBlock.value[a].optional)return r.hasOwnProperty("name")&&(r.name=r.name.replace(/^\s+|\s+$/g,""),""!==r.name&&delete e[r.name]),i;n++}if(!1===i.verified){const t={verified:!1,result:e};return r.hasOwnProperty("name")&&(r.name=r.name.replace(/^\s+|\s+$/g,""),""!==r.name&&(delete e[r.name],t.name=r.name)),t}return{verified:!0,result:e}}if("primitiveSchema"in r&&"valueHex"in t.valueBlock){const n=et(t.valueBlock.valueHex);if(-1===n.offset){const t={verified:!1,result:n.result};return r.hasOwnProperty("name")&&(r.name=r.name.replace(/^\s+|\s+$/g,""),""!==r.name&&(delete e[r.name],t.name=r.name)),t}return tt(e,n.result,r.primitiveSchema)}return{verified:!0,result:e}}class rt{constructor(e={}){this.algorithmId=I(e,"algorithmId",rt.defaultValues("algorithmId")),"algorithmParams"in e&&(this.algorithmParams=I(e,"algorithmParams",rt.defaultValues("algorithmParams"))),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"algorithmId":return"";case"algorithmParams":return new Xe;default:throw new Error(`Invalid member name for AlgorithmIdentifier class: ${e}`)}}static compareWithDefault(e,t){switch(e){case"algorithmId":return""===t;case"algorithmParams":return t instanceof Xe;default:throw new Error(`Invalid member name for AlgorithmIdentifier class: ${e}`)}}static schema(e={}){const t=I(e,"names",{});return new he({name:t.blockName||"",optional:t.optional||!1,value:[new Se({name:t.algorithmIdentifier||""}),new Xe({name:t.algorithmParams||"",optional:!0})]})}fromSchema(e){$(e,["algorithm","params"]);const t=tt(e,e,rt.schema({names:{algorithmIdentifier:"algorithm",algorithmParams:"params"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for AlgorithmIdentifier");this.algorithmId=t.result.algorithm.valueBlock.toString(),"params"in t.result&&(this.algorithmParams=t.result.params)}toSchema(){const e=[];return e.push(new Se({value:this.algorithmId})),"algorithmParams"in this&&this.algorithmParams instanceof Xe==!1&&e.push(this.algorithmParams),new he({value:e})}toJSON(){const e={algorithmId:this.algorithmId};return"algorithmParams"in this&&this.algorithmParams instanceof Xe==!1&&(e.algorithmParams=this.algorithmParams.toJSON()),e}isEqual(e){return e instanceof rt!=!1&&(this.algorithmId===e.algorithmId&&("algorithmParams"in this?"algorithmParams"in e&&JSON.stringify(this.algorithmParams)===JSON.stringify(e.algorithmParams):!("algorithmParams"in e)))}}class nt{constructor(e={}){this.x=I(e,"x",nt.defaultValues("x")),this.y=I(e,"y",nt.defaultValues("y")),this.namedCurve=I(e,"namedCurve",nt.defaultValues("namedCurve")),"schema"in e&&this.fromSchema(e.schema),"json"in e&&this.fromJSON(e.json)}static defaultValues(e){switch(e){case"x":case"y":return new ArrayBuffer(0);case"namedCurve":return"";default:throw new Error(`Invalid member name for ECCPublicKey class: ${e}`)}}static compareWithDefault(e,t){switch(e){case"x":case"y":return T(t,nt.defaultValues(e));case"namedCurve":return""===t;default:throw new Error(`Invalid member name for ECCPublicKey class: ${e}`)}}static schema(e={}){return new Ye}fromSchema(e){if(e instanceof ArrayBuffer==!1)throw new Error("Object's schema was not verified against input data for ECPublicKey");if(4!==new Uint8Array(e)[0])throw new Error("Object's schema was not verified against input data for ECPublicKey");let t;switch(this.namedCurve){case"1.2.840.10045.3.1.7":t=32;break;case"1.3.132.0.34":t=48;break;case"1.3.132.0.35":t=66;break;default:throw new Error(`Incorrect curve OID: ${this.namedCurve}`)}if(e.byteLength!==2*t+1)throw new Error("Object's schema was not verified against input data for ECPublicKey");this.x=e.slice(1,t+1),this.y=e.slice(1+t,2*t+1)}toSchema(){return new Ye({data:H(new Uint8Array([4]).buffer,this.x,this.y)})}toJSON(){let e="";switch(this.namedCurve){case"1.2.840.10045.3.1.7":e="P-256";break;case"1.3.132.0.34":e="P-384";break;case"1.3.132.0.35":e="P-521"}return{crv:e,x:U(K(this.x),!0,!0,!1),y:U(K(this.y),!0,!0,!1)}}fromJSON(e){let t=0;if(!("crv"in e))throw new Error('Absent mandatory parameter "crv"');switch(e.crv.toUpperCase()){case"P-256":this.namedCurve="1.2.840.10045.3.1.7",t=32;break;case"P-384":this.namedCurve="1.3.132.0.34",t=48;break;case"P-521":this.namedCurve="1.3.132.0.35",t=66}if(!("x"in e))throw new Error('Absent mandatory parameter "x"');{const r=M(_(e.x,!0));if(r.byteLength<t){this.x=new ArrayBuffer(t);const e=new Uint8Array(this.x),n=new Uint8Array(r);e.set(n,1)}else this.x=r.slice(0,t)}if(!("y"in e))throw new Error('Absent mandatory parameter "y"');{const r=M(_(e.y,!0));if(r.byteLength<t){this.y=new ArrayBuffer(t);const e=new Uint8Array(this.y),n=new Uint8Array(r);e.set(n,1)}else this.y=r.slice(0,t)}}}class it{constructor(e={}){this.modulus=I(e,"modulus",it.defaultValues("modulus")),this.publicExponent=I(e,"publicExponent",it.defaultValues("publicExponent")),"schema"in e&&this.fromSchema(e.schema),"json"in e&&this.fromJSON(e.json)}static defaultValues(e){switch(e){case"modulus":case"publicExponent":return new ye;default:throw new Error(`Invalid member name for RSAPublicKey class: ${e}`)}}static schema(e={}){const t=I(e,"names",{});return new he({name:t.blockName||"",value:[new ye({name:t.modulus||""}),new ye({name:t.publicExponent||""})]})}fromSchema(e){$(e,["modulus","publicExponent"]);const t=tt(e,e,it.schema({names:{modulus:"modulus",publicExponent:"publicExponent"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for RSAPublicKey");this.modulus=t.result.modulus.convertFromDER(256),this.publicExponent=t.result.publicExponent}toSchema(){return new he({value:[this.modulus.convertToDER(),this.publicExponent]})}toJSON(){return{n:U(K(this.modulus.valueBlock.valueHex),!0,!0,!0),e:U(K(this.publicExponent.valueBlock.valueHex),!0,!0,!0)}}fromJSON(e){if(!("n"in e))throw new Error('Absent mandatory parameter "n"');{const t=M(_(e.n,!0));this.modulus=new ye({valueHex:t.slice(0,Math.pow(2,J(t.byteLength)))})}if(!("e"in e))throw new Error('Absent mandatory parameter "e"');this.publicExponent=new ye({valueHex:M(_(e.e,!0)).slice(0,3)})}}class st{constructor(e={}){this.algorithm=I(e,"algorithm",st.defaultValues("algorithm")),this.subjectPublicKey=I(e,"subjectPublicKey",st.defaultValues("subjectPublicKey")),"parsedKey"in e&&(this.parsedKey=I(e,"parsedKey",st.defaultValues("parsedKey"))),"schema"in e&&this.fromSchema(e.schema),"json"in e&&this.fromJSON(e.json)}static defaultValues(e){switch(e){case"algorithm":return new rt;case"subjectPublicKey":return new pe;default:throw new Error(`Invalid member name for PublicKeyInfo class: ${e}`)}}static schema(e={}){const t=I(e,"names",{});return new he({name:t.blockName||"",value:[rt.schema(t.algorithm||{}),new pe({name:t.subjectPublicKey||""})]})}fromSchema(e){$(e,["algorithm","subjectPublicKey"]);const t=tt(e,e,st.schema({names:{algorithm:{names:{blockName:"algorithm"}},subjectPublicKey:"subjectPublicKey"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for PublicKeyInfo");switch(this.algorithm=new rt({schema:t.result.algorithm}),this.subjectPublicKey=t.result.subjectPublicKey,this.algorithm.algorithmId){case"1.2.840.10045.2.1":if("algorithmParams"in this.algorithm&&this.algorithm.algorithmParams.constructor.blockName()===Se.blockName())try{this.parsedKey=new nt({namedCurve:this.algorithm.algorithmParams.valueBlock.toString(),schema:this.subjectPublicKey.valueBlock.valueHex})}catch(e){}break;case"1.2.840.113549.1.1.1":{const e=et(this.subjectPublicKey.valueBlock.valueHex);if(-1!==e.offset)try{this.parsedKey=new it({schema:e.result})}catch(e){}}}}toSchema(){return new he({value:[this.algorithm.toSchema(),this.subjectPublicKey]})}toJSON(){if("parsedKey"in this==!1)return{algorithm:this.algorithm.toJSON(),subjectPublicKey:this.subjectPublicKey.toJSON()};const e={};switch(this.algorithm.algorithmId){case"1.2.840.10045.2.1":e.kty="EC";break;case"1.2.840.113549.1.1.1":e.kty="RSA"}const t=this.parsedKey.toJSON();for(const r of Object.keys(t))e[r]=t[r];return e}fromJSON(e){if("kty"in e){switch(e.kty.toUpperCase()){case"EC":this.parsedKey=new nt({json:e}),this.algorithm=new rt({algorithmId:"1.2.840.10045.2.1",algorithmParams:new Se({value:this.parsedKey.namedCurve})});break;case"RSA":this.parsedKey=new it({json:e}),this.algorithm=new rt({algorithmId:"1.2.840.113549.1.1.1",algorithmParams:new ce});break;default:throw new Error(`Invalid value for "kty" parameter: ${e.kty}`)}this.subjectPublicKey=new pe({valueHex:this.parsedKey.toSchema().toBER(!1)})}}importKey(e){let t=Promise.resolve();const r=this;if(void 0===e)return Promise.reject("Need to provide publicKey input parameter");const n=bt();return void 0===n?Promise.reject("Unable to create WebCrypto object"):(t=t.then((()=>n.exportKey("spki",e))),t=t.then((e=>{const t=et(e);try{r.fromSchema(t.result)}catch(e){return Promise.reject("Error during initializing object from schema")}}),(e=>Promise.reject(`Error during exporting public key: ${e}`))),t)}}class at{constructor(e={}){this.type=I(e,"type",at.defaultValues("type")),this.values=I(e,"values",at.defaultValues("values")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"type":return"";case"values":return[];default:throw new Error(`Invalid member name for Attribute class: ${e}`)}}static compareWithDefault(e,t){switch(e){case"type":return""===t;case"values":return 0===t.length;default:throw new Error(`Invalid member name for Attribute class: ${e}`)}}static schema(e={}){const t=I(e,"names",{});return new he({name:t.blockName||"",value:[new Se({name:t.type||""}),new le({name:t.setName||"",value:[new Qe({name:t.values||"",value:new Xe})]})]})}fromSchema(e){$(e,["type","values"]);const t=tt(e,e,at.schema({names:{type:"type",values:"values"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for Attribute");this.type=t.result.type.valueBlock.toString(),this.values=t.result.values}toSchema(){return new he({value:[new Se({value:this.type}),new le({value:this.values})]})}toJSON(){return{type:this.type,values:Array.from(this.values,(e=>e.toJSON()))}}}class ot{constructor(e={}){this.version=I(e,"version",ot.defaultValues("version")),this.privateKey=I(e,"privateKey",ot.defaultValues("privateKey")),"namedCurve"in e&&(this.namedCurve=I(e,"namedCurve",ot.defaultValues("namedCurve"))),"publicKey"in e&&(this.publicKey=I(e,"publicKey",ot.defaultValues("publicKey"))),"schema"in e&&this.fromSchema(e.schema),"json"in e&&this.fromJSON(e.json)}static defaultValues(e){switch(e){case"version":return 1;case"privateKey":return new ge;case"namedCurve":return"";case"publicKey":return new nt;default:throw new Error(`Invalid member name for ECCPrivateKey class: ${e}`)}}static compareWithDefault(e,t){switch(e){case"version":return t===ot.defaultValues(e);case"privateKey":return t.isEqual(ot.defaultValues(e));case"namedCurve":return""===t;case"publicKey":return nt.compareWithDefault("namedCurve",t.namedCurve)&&nt.compareWithDefault("x",t.x)&&nt.compareWithDefault("y",t.y);default:throw new Error(`Invalid member name for ECCPrivateKey class: ${e}`)}}static schema(e={}){const t=I(e,"names",{});return new he({name:t.blockName||"",value:[new ye({name:t.version||""}),new ge({name:t.privateKey||""}),new ie({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new Se({name:t.namedCurve||""})]}),new ie({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new pe({name:t.publicKey||""})]})]})}fromSchema(e){$(e,["version","privateKey","namedCurve","publicKey"]);const t=tt(e,e,ot.schema({names:{version:"version",privateKey:"privateKey",namedCurve:"namedCurve",publicKey:"publicKey"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for ECPrivateKey");if(this.version=t.result.version.valueBlock.valueDec,this.privateKey=t.result.privateKey,"namedCurve"in t.result&&(this.namedCurve=t.result.namedCurve.valueBlock.toString()),"publicKey"in t.result){const e={schema:t.result.publicKey.valueBlock.valueHex};"namedCurve"in this&&(e.namedCurve=this.namedCurve),this.publicKey=new nt(e)}}toSchema(){const e=[new ye({value:this.version}),this.privateKey];return"namedCurve"in this&&e.push(new ie({idBlock:{tagClass:3,tagNumber:0},value:[new Se({value:this.namedCurve})]})),"publicKey"in this&&e.push(new ie({idBlock:{tagClass:3,tagNumber:1},value:[new pe({valueHex:this.publicKey.toSchema().toBER(!1)})]})),new he({value:e})}toJSON(){if("namedCurve"in this==!1||ot.compareWithDefault("namedCurve",this.namedCurve))throw new Error('Not enough information for making JSON: absent "namedCurve" value');let e="";switch(this.namedCurve){case"1.2.840.10045.3.1.7":e="P-256";break;case"1.3.132.0.34":e="P-384";break;case"1.3.132.0.35":e="P-521"}const t={crv:e,d:U(K(this.privateKey.valueBlock.valueHex),!0,!0,!1)};if("publicKey"in this){const e=this.publicKey.toJSON();t.x=e.x,t.y=e.y}return t}fromJSON(e){let t=0;if(!("crv"in e))throw new Error('Absent mandatory parameter "crv"');switch(e.crv.toUpperCase()){case"P-256":this.namedCurve="1.2.840.10045.3.1.7",t=32;break;case"P-384":this.namedCurve="1.3.132.0.34",t=48;break;case"P-521":this.namedCurve="1.3.132.0.35",t=66}if(!("d"in e))throw new Error('Absent mandatory parameter "d"');{const r=M(_(e.d,!0));if(r.byteLength<t){const e=new ArrayBuffer(t),n=new Uint8Array(e),i=new Uint8Array(r);n.set(i,1),this.privateKey=new ge({valueHex:e})}else this.privateKey=new ge({valueHex:r.slice(0,t)})}"x"in e&&"y"in e&&(this.publicKey=new nt({json:e}))}}class ut{constructor(e={}){this.prime=I(e,"prime",ut.defaultValues("prime")),this.exponent=I(e,"exponent",ut.defaultValues("exponent")),this.coefficient=I(e,"coefficient",ut.defaultValues("coefficient")),"schema"in e&&this.fromSchema(e.schema),"json"in e&&this.fromJSON(e.json)}static defaultValues(e){switch(e){case"prime":case"exponent":case"coefficient":return new ye;default:throw new Error(`Invalid member name for OtherPrimeInfo class: ${e}`)}}static schema(e={}){const t=I(e,"names",{});return new he({name:t.blockName||"",value:[new ye({name:t.prime||""}),new ye({name:t.exponent||""}),new ye({name:t.coefficient||""})]})}fromSchema(e){$(e,["prime","exponent","coefficient"]);const t=tt(e,e,ut.schema({names:{prime:"prime",exponent:"exponent",coefficient:"coefficient"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for OtherPrimeInfo");this.prime=t.result.prime.convertFromDER(),this.exponent=t.result.exponent.convertFromDER(),this.coefficient=t.result.coefficient.convertFromDER()}toSchema(){return new he({value:[this.prime.convertToDER(),this.exponent.convertToDER(),this.coefficient.convertToDER()]})}toJSON(){return{r:U(K(this.prime.valueBlock.valueHex),!0,!0),d:U(K(this.exponent.valueBlock.valueHex),!0,!0),t:U(K(this.coefficient.valueBlock.valueHex),!0,!0)}}fromJSON(e){if(!("r"in e))throw new Error('Absent mandatory parameter "r"');if(this.prime=new ye({valueHex:M(_(e.r,!0))}),!("d"in e))throw new Error('Absent mandatory parameter "d"');if(this.exponent=new ye({valueHex:M(_(e.d,!0))}),!("t"in e))throw new Error('Absent mandatory parameter "t"');this.coefficient=new ye({valueHex:M(_(e.t,!0))})}}class ht{constructor(e={}){this.version=I(e,"version",ht.defaultValues("version")),this.modulus=I(e,"modulus",ht.defaultValues("modulus")),this.publicExponent=I(e,"publicExponent",ht.defaultValues("publicExponent")),this.privateExponent=I(e,"privateExponent",ht.defaultValues("privateExponent")),this.prime1=I(e,"prime1",ht.defaultValues("prime1")),this.prime2=I(e,"prime2",ht.defaultValues("prime2")),this.exponent1=I(e,"exponent1",ht.defaultValues("exponent1")),this.exponent2=I(e,"exponent2",ht.defaultValues("exponent2")),this.coefficient=I(e,"coefficient",ht.defaultValues("coefficient")),"otherPrimeInfos"in e&&(this.otherPrimeInfos=I(e,"otherPrimeInfos",ht.defaultValues("otherPrimeInfos"))),"schema"in e&&this.fromSchema(e.schema),"json"in e&&this.fromJSON(e.json)}static defaultValues(e){switch(e){case"version":return 0;case"modulus":case"publicExponent":case"privateExponent":case"prime1":case"prime2":case"exponent1":case"exponent2":case"coefficient":return new ye;case"otherPrimeInfos":return[];default:throw new Error(`Invalid member name for RSAPrivateKey class: ${e}`)}}static schema(e={}){const t=I(e,"names",{});return new he({name:t.blockName||"",value:[new ye({name:t.version||""}),new ye({name:t.modulus||""}),new ye({name:t.publicExponent||""}),new ye({name:t.privateExponent||""}),new ye({name:t.prime1||""}),new ye({name:t.prime2||""}),new ye({name:t.exponent1||""}),new ye({name:t.exponent2||""}),new ye({name:t.coefficient||""}),new he({optional:!0,value:[new Qe({name:t.otherPrimeInfosName||"",value:ut.schema(t.otherPrimeInfo||{})})]})]})}fromSchema(e){$(e,["version","modulus","publicExponent","privateExponent","prime1","prime2","exponent1","exponent2","coefficient","otherPrimeInfos"]);const t=tt(e,e,ht.schema({names:{version:"version",modulus:"modulus",publicExponent:"publicExponent",privateExponent:"privateExponent",prime1:"prime1",prime2:"prime2",exponent1:"exponent1",exponent2:"exponent2",coefficient:"coefficient",otherPrimeInfo:{names:{blockName:"otherPrimeInfos"}}}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for RSAPrivateKey");this.version=t.result.version.valueBlock.valueDec,this.modulus=t.result.modulus.convertFromDER(256),this.publicExponent=t.result.publicExponent,this.privateExponent=t.result.privateExponent.convertFromDER(256),this.prime1=t.result.prime1.convertFromDER(128),this.prime2=t.result.prime2.convertFromDER(128),this.exponent1=t.result.exponent1.convertFromDER(128),this.exponent2=t.result.exponent2.convertFromDER(128),this.coefficient=t.result.coefficient.convertFromDER(128),"otherPrimeInfos"in t.result&&(this.otherPrimeInfos=Array.from(t.result.otherPrimeInfos,(e=>new ut({schema:e}))))}toSchema(){const e=[];return e.push(new ye({value:this.version})),e.push(this.modulus.convertToDER()),e.push(this.publicExponent),e.push(this.privateExponent.convertToDER()),e.push(this.prime1.convertToDER()),e.push(this.prime2.convertToDER()),e.push(this.exponent1.convertToDER()),e.push(this.exponent2.convertToDER()),e.push(this.coefficient.convertToDER()),"otherPrimeInfos"in this&&e.push(new he({value:Array.from(this.otherPrimeInfos,(e=>e.toSchema()))})),new he({value:e})}toJSON(){const e={n:U(K(this.modulus.valueBlock.valueHex),!0,!0,!0),e:U(K(this.publicExponent.valueBlock.valueHex),!0,!0,!0),d:U(K(this.privateExponent.valueBlock.valueHex),!0,!0,!0),p:U(K(this.prime1.valueBlock.valueHex),!0,!0,!0),q:U(K(this.prime2.valueBlock.valueHex),!0,!0,!0),dp:U(K(this.exponent1.valueBlock.valueHex),!0,!0,!0),dq:U(K(this.exponent2.valueBlock.valueHex),!0,!0,!0),qi:U(K(this.coefficient.valueBlock.valueHex),!0,!0,!0)};return"otherPrimeInfos"in this&&(e.oth=Array.from(this.otherPrimeInfos,(e=>e.toJSON()))),e}fromJSON(e){if(!("n"in e))throw new Error('Absent mandatory parameter "n"');if(this.modulus=new ye({valueHex:M(_(e.n,!0,!0))}),!("e"in e))throw new Error('Absent mandatory parameter "e"');if(this.publicExponent=new ye({valueHex:M(_(e.e,!0,!0))}),!("d"in e))throw new Error('Absent mandatory parameter "d"');if(this.privateExponent=new ye({valueHex:M(_(e.d,!0,!0))}),!("p"in e))throw new Error('Absent mandatory parameter "p"');if(this.prime1=new ye({valueHex:M(_(e.p,!0,!0))}),!("q"in e))throw new Error('Absent mandatory parameter "q"');if(this.prime2=new ye({valueHex:M(_(e.q,!0,!0))}),!("dp"in e))throw new Error('Absent mandatory parameter "dp"');if(this.exponent1=new ye({valueHex:M(_(e.dp,!0,!0))}),!("dq"in e))throw new Error('Absent mandatory parameter "dq"');if(this.exponent2=new ye({valueHex:M(_(e.dq,!0,!0))}),!("qi"in e))throw new Error('Absent mandatory parameter "qi"');this.coefficient=new ye({valueHex:M(_(e.qi,!0,!0))}),"oth"in e&&(this.otherPrimeInfos=Array.from(e.oth,(e=>new ut({json:e}))))}}class lt{constructor(e={}){this.version=I(e,"version",lt.defaultValues("version")),this.privateKeyAlgorithm=I(e,"privateKeyAlgorithm",lt.defaultValues("privateKeyAlgorithm")),this.privateKey=I(e,"privateKey",lt.defaultValues("privateKey")),"attributes"in e&&(this.attributes=I(e,"attributes",lt.defaultValues("attributes"))),"parsedKey"in e&&(this.parsedKey=I(e,"parsedKey",lt.defaultValues("parsedKey"))),"schema"in e&&this.fromSchema(e.schema),"json"in e&&this.fromJSON(e.json)}static defaultValues(e){switch(e){case"version":return 0;case"privateKeyAlgorithm":return new rt;case"privateKey":return new ge;case"attributes":return[];case"parsedKey":return{};default:throw new Error(`Invalid member name for PrivateKeyInfo class: ${e}`)}}static schema(e={}){const t=I(e,"names",{});return new he({name:t.blockName||"",value:[new ye({name:t.version||""}),rt.schema(t.privateKeyAlgorithm||{}),new ge({name:t.privateKey||""}),new ie({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new Qe({name:t.attributes||"",value:at.schema()})]})]})}fromSchema(e){$(e,["version","privateKeyAlgorithm","privateKey","attributes"]);const t=tt(e,e,lt.schema({names:{version:"version",privateKeyAlgorithm:{names:{blockName:"privateKeyAlgorithm"}},privateKey:"privateKey",attributes:"attributes"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for PrivateKeyInfo");switch(this.version=t.result.version.valueBlock.valueDec,this.privateKeyAlgorithm=new rt({schema:t.result.privateKeyAlgorithm}),this.privateKey=t.result.privateKey,"attributes"in t.result&&(this.attributes=Array.from(t.result.attributes,(e=>new at({schema:e})))),this.privateKeyAlgorithm.algorithmId){case"1.2.840.113549.1.1.1":{const e=et(this.privateKey.valueBlock.valueHex);-1!==e.offset&&(this.parsedKey=new ht({schema:e.result}))}break;case"1.2.840.10045.2.1":if("algorithmParams"in this.privateKeyAlgorithm&&this.privateKeyAlgorithm.algorithmParams instanceof Se){const e=et(this.privateKey.valueBlock.valueHex);-1!==e.offset&&(this.parsedKey=new ot({namedCurve:this.privateKeyAlgorithm.algorithmParams.valueBlock.toString(),schema:e.result}))}}}toSchema(){const e=[new ye({value:this.version}),this.privateKeyAlgorithm.toSchema(),this.privateKey];return"attributes"in this&&e.push(new ie({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.attributes,(e=>e.toSchema()))})),new he({value:e})}toJSON(){if("parsedKey"in this==!1){const e={version:this.version,privateKeyAlgorithm:this.privateKeyAlgorithm.toJSON(),privateKey:this.privateKey.toJSON()};return"attributes"in this&&(e.attributes=Array.from(this.attributes,(e=>e.toJSON()))),e}const e={};switch(this.privateKeyAlgorithm.algorithmId){case"1.2.840.10045.2.1":e.kty="EC";break;case"1.2.840.113549.1.1.1":e.kty="RSA"}const t=this.parsedKey.toJSON();for(const r of Object.keys(t))e[r]=t[r];return e}fromJSON(e){if("kty"in e){switch(e.kty.toUpperCase()){case"EC":this.parsedKey=new ot({json:e}),this.privateKeyAlgorithm=new rt({algorithmId:"1.2.840.10045.2.1",algorithmParams:new Se({value:this.parsedKey.namedCurve})});break;case"RSA":this.parsedKey=new ht({json:e}),this.privateKeyAlgorithm=new rt({algorithmId:"1.2.840.113549.1.1.1",algorithmParams:new ce});break;default:throw new Error(`Invalid value for "kty" parameter: ${e.kty}`)}this.privateKey=new ge({valueHex:this.parsedKey.toSchema().toBER(!1)})}}}class ct{constructor(e={}){if(this.contentType=I(e,"contentType",ct.defaultValues("contentType")),this.contentEncryptionAlgorithm=I(e,"contentEncryptionAlgorithm",ct.defaultValues("contentEncryptionAlgorithm")),"encryptedContent"in e&&(this.encryptedContent=e.encryptedContent,1===this.encryptedContent.idBlock.tagClass&&4===this.encryptedContent.idBlock.tagNumber&&!1===this.encryptedContent.idBlock.isConstructed)){const e=new ge({idBlock:{isConstructed:!0},isConstructed:!0});let t=0,r=this.encryptedContent.valueBlock.valueHex.byteLength;for(;r>0;){const n=new Uint8Array(this.encryptedContent.valueBlock.valueHex,t,t+1024>this.encryptedContent.valueBlock.valueHex.byteLength?this.encryptedContent.valueBlock.valueHex.byteLength-t:1024),i=new ArrayBuffer(n.length),s=new Uint8Array(i);for(let e=0;e<s.length;e++)s[e]=n[e];e.valueBlock.value.push(new ge({valueHex:i})),r-=n.length,t+=n.length}this.encryptedContent=e}"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"contentType":return"";case"contentEncryptionAlgorithm":return new rt;case"encryptedContent":return new ge;default:throw new Error(`Invalid member name for EncryptedContentInfo class: ${e}`)}}static compareWithDefault(e,t){switch(e){case"contentType":return""===t;case"contentEncryptionAlgorithm":return""===t.algorithmId&&"algorithmParams"in t==!1;case"encryptedContent":return t.isEqual(ct.defaultValues(e));default:throw new Error(`Invalid member name for EncryptedContentInfo class: ${e}`)}}static schema(e={}){const t=I(e,"names",{});return new he({name:t.blockName||"",value:[new Se({name:t.contentType||""}),rt.schema(t.contentEncryptionAlgorithm||{}),new ze({value:[new ie({name:t.encryptedContent||"",idBlock:{tagClass:3,tagNumber:0},value:[new Qe({value:new ge})]}),new re({name:t.encryptedContent||"",idBlock:{tagClass:3,tagNumber:0}})]})]})}fromSchema(e){$(e,["contentType","contentEncryptionAlgorithm","encryptedContent"]);const t=tt(e,e,ct.schema({names:{contentType:"contentType",contentEncryptionAlgorithm:{names:{blockName:"contentEncryptionAlgorithm"}},encryptedContent:"encryptedContent"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for EncryptedContentInfo");this.contentType=t.result.contentType.valueBlock.toString(),this.contentEncryptionAlgorithm=new rt({schema:t.result.contentEncryptionAlgorithm}),"encryptedContent"in t.result&&(this.encryptedContent=t.result.encryptedContent,this.encryptedContent.idBlock.tagClass=1,this.encryptedContent.idBlock.tagNumber=4)}toSchema(){const e={isIndefiniteForm:!1},t=[];if(t.push(new Se({value:this.contentType})),t.push(this.contentEncryptionAlgorithm.toSchema()),"encryptedContent"in this){e.isIndefiniteForm=this.encryptedContent.idBlock.isConstructed;const r=this.encryptedContent;r.idBlock.tagClass=3,r.idBlock.tagNumber=0,r.lenBlock.isIndefiniteForm=this.encryptedContent.idBlock.isConstructed,t.push(r)}return new he({lenBlock:e,value:t})}toJSON(){const e={contentType:this.contentType,contentEncryptionAlgorithm:this.contentEncryptionAlgorithm.toJSON()};return"encryptedContent"in this&&(e.encryptedContent=this.encryptedContent.toJSON()),e}}class ft{constructor(e={}){this.hashAlgorithm=I(e,"hashAlgorithm",ft.defaultValues("hashAlgorithm")),this.maskGenAlgorithm=I(e,"maskGenAlgorithm",ft.defaultValues("maskGenAlgorithm")),this.saltLength=I(e,"saltLength",ft.defaultValues("saltLength")),this.trailerField=I(e,"trailerField",ft.defaultValues("trailerField")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"hashAlgorithm":return new rt({algorithmId:"1.3.14.3.2.26",algorithmParams:new ce});case"maskGenAlgorithm":return new rt({algorithmId:"1.2.840.113549.1.1.8",algorithmParams:new rt({algorithmId:"1.3.14.3.2.26",algorithmParams:new ce}).toSchema()});case"saltLength":return 20;case"trailerField":return 1;default:throw new Error(`Invalid member name for RSASSAPSSParams class: ${e}`)}}static schema(e={}){const t=I(e,"names",{});return new he({name:t.blockName||"",value:[new ie({idBlock:{tagClass:3,tagNumber:0},optional:!0,value:[rt.schema(t.hashAlgorithm||{})]}),new ie({idBlock:{tagClass:3,tagNumber:1},optional:!0,value:[rt.schema(t.maskGenAlgorithm||{})]}),new ie({idBlock:{tagClass:3,tagNumber:2},optional:!0,value:[new ye({name:t.saltLength||""})]}),new ie({idBlock:{tagClass:3,tagNumber:3},optional:!0,value:[new ye({name:t.trailerField||""})]})]})}fromSchema(e){$(e,["hashAlgorithm","maskGenAlgorithm","saltLength","trailerField"]);const t=tt(e,e,ft.schema({names:{hashAlgorithm:{names:{blockName:"hashAlgorithm"}},maskGenAlgorithm:{names:{blockName:"maskGenAlgorithm"}},saltLength:"saltLength",trailerField:"trailerField"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for RSASSAPSSParams");"hashAlgorithm"in t.result&&(this.hashAlgorithm=new rt({schema:t.result.hashAlgorithm})),"maskGenAlgorithm"in t.result&&(this.maskGenAlgorithm=new rt({schema:t.result.maskGenAlgorithm})),"saltLength"in t.result&&(this.saltLength=t.result.saltLength.valueBlock.valueDec),"trailerField"in t.result&&(this.trailerField=t.result.trailerField.valueBlock.valueDec)}toSchema(){const e=[];return this.hashAlgorithm.isEqual(ft.defaultValues("hashAlgorithm"))||e.push(new ie({idBlock:{tagClass:3,tagNumber:0},value:[this.hashAlgorithm.toSchema()]})),this.maskGenAlgorithm.isEqual(ft.defaultValues("maskGenAlgorithm"))||e.push(new ie({idBlock:{tagClass:3,tagNumber:1},value:[this.maskGenAlgorithm.toSchema()]})),this.saltLength!==ft.defaultValues("saltLength")&&e.push(new ie({idBlock:{tagClass:3,tagNumber:2},value:[new ye({value:this.saltLength})]})),this.trailerField!==ft.defaultValues("trailerField")&&e.push(new ie({idBlock:{tagClass:3,tagNumber:3},value:[new ye({value:this.trailerField})]})),new he({value:e})}toJSON(){const e={};return this.hashAlgorithm.isEqual(ft.defaultValues("hashAlgorithm"))||(e.hashAlgorithm=this.hashAlgorithm.toJSON()),this.maskGenAlgorithm.isEqual(ft.defaultValues("maskGenAlgorithm"))||(e.maskGenAlgorithm=this.maskGenAlgorithm.toJSON()),this.saltLength!==ft.defaultValues("saltLength")&&(e.saltLength=this.saltLength),this.trailerField!==ft.defaultValues("trailerField")&&(e.trailerField=this.trailerField),e}}class gt{constructor(e={}){this.salt=I(e,"salt",gt.defaultValues("salt")),this.iterationCount=I(e,"iterationCount",gt.defaultValues("iterationCount")),"keyLength"in e&&(this.keyLength=I(e,"keyLength",gt.defaultValues("keyLength"))),"prf"in e&&(this.prf=I(e,"prf",gt.defaultValues("prf"))),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"salt":return{};case"iterationCount":return-1;case"keyLength":return 0;case"prf":return new rt({algorithmId:"1.3.14.3.2.26",algorithmParams:new ce});default:throw new Error(`Invalid member name for PBKDF2Params class: ${e}`)}}static schema(e={}){const t=I(e,"names",{});return new he({name:t.blockName||"",value:[new ze({value:[new ge({name:t.saltPrimitive||""}),rt.schema(t.saltConstructed||{})]}),new ye({name:t.iterationCount||""}),new ye({name:t.keyLength||"",optional:!0}),rt.schema(t.prf||{names:{optional:!0}})]})}fromSchema(e){$(e,["salt","iterationCount","keyLength","prf"]);const t=tt(e,e,gt.schema({names:{saltPrimitive:"salt",saltConstructed:{names:{blockName:"salt"}},iterationCount:"iterationCount",keyLength:"keyLength",prf:{names:{blockName:"prf",optional:!0}}}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for PBKDF2Params");this.salt=t.result.salt,this.iterationCount=t.result.iterationCount.valueBlock.valueDec,"keyLength"in t.result&&(this.keyLength=t.result.keyLength.valueBlock.valueDec),"prf"in t.result&&(this.prf=new rt({schema:t.result.prf}))}toSchema(){const e=[];return e.push(this.salt),e.push(new ye({value:this.iterationCount})),"keyLength"in this&&gt.defaultValues("keyLength")!==this.keyLength&&e.push(new ye({value:this.keyLength})),"prf"in this&&!1===gt.defaultValues("prf").isEqual(this.prf)&&e.push(this.prf.toSchema()),new he({value:e})}toJSON(){const e={salt:this.salt.toJSON(),iterationCount:this.iterationCount};return"keyLength"in this&&gt.defaultValues("keyLength")!==this.keyLength&&(e.keyLength=this.keyLength),"prf"in this&&!1===gt.defaultValues("prf").isEqual(this.prf)&&(e.prf=this.prf.toJSON()),e}}class dt{constructor(e={}){this.keyDerivationFunc=I(e,"keyDerivationFunc",dt.defaultValues("keyDerivationFunc")),this.encryptionScheme=I(e,"encryptionScheme",dt.defaultValues("encryptionScheme")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"keyDerivationFunc":case"encryptionScheme":return new rt;default:throw new Error(`Invalid member name for PBES2Params class: ${e}`)}}static schema(e={}){const t=I(e,"names",{});return new he({name:t.blockName||"",value:[rt.schema(t.keyDerivationFunc||{}),rt.schema(t.encryptionScheme||{})]})}fromSchema(e){$(e,["keyDerivationFunc","encryptionScheme"]);const t=tt(e,e,dt.schema({names:{keyDerivationFunc:{names:{blockName:"keyDerivationFunc"}},encryptionScheme:{names:{blockName:"encryptionScheme"}}}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for PBES2Params");this.keyDerivationFunc=new rt({schema:t.result.keyDerivationFunc}),this.encryptionScheme=new rt({schema:t.result.encryptionScheme})}toSchema(){return new he({value:[this.keyDerivationFunc.toSchema(),this.encryptionScheme.toSchema()]})}toJSON(){return{keyDerivationFunc:this.keyDerivationFunc.toJSON(),encryptionScheme:this.encryptionScheme.toJSON()}}}function pt(e,t,r,n,i,s){let a,o;const u=[];switch(t.toUpperCase()){case"SHA-1":a=20,o=64;break;case"SHA-256":a=32,o=64;break;case"SHA-384":a=48,o=128;break;case"SHA-512":a=64,o=128;break;default:throw new Error("Unsupported hashing algorithm")}const h=new Uint8Array(n),l=new ArrayBuffer(2*n.byteLength+2),c=new Uint8Array(l);for(let e=0;e<h.length;e++)c[2*e]=0,c[2*e+1]=h[e];c[c.length-2]=0,c[c.length-1]=0,n=l.slice(0);const f=new ArrayBuffer(o),g=new Uint8Array(f);for(let e=0;e<f.byteLength;e++)g[e]=3;const d=i.byteLength,p=o*Math.ceil(d/o),m=new ArrayBuffer(p),y=new Uint8Array(m),v=new Uint8Array(i);for(let e=0;e<p;e++)y[e]=v[e%d];const b=n.byteLength,w=o*Math.ceil(b/o),S=new ArrayBuffer(w),A=new Uint8Array(S),x=new Uint8Array(n);for(let e=0;e<w;e++)A[e]=x[e%b];const E=m.byteLength+S.byteLength;let B=new ArrayBuffer(E),k=new Uint8Array(B);k.set(y),k.set(A,y.length);const C=Math.ceil((r>>3)/a);let I=Promise.resolve(B);for(let r=0;r<=C;r++){I=I.then((e=>{const t=new ArrayBuffer(f.byteLength+e.byteLength),r=new Uint8Array(t);return r.set(g),r.set(k,g.length),t}));for(let r=0;r<s;r++)I=I.then((r=>e.digest({name:t},new Uint8Array(r))));I=I.then((e=>{const t=new ArrayBuffer(o),r=new Uint8Array(t);for(let n=0;n<t.byteLength;n++)r[n]=e[n%e.length];const n=Math.ceil(d/o)+Math.ceil(b/o),i=[];let s=0,a=o;for(let e=0;e<n;e++){const e=Array.from(new Uint8Array(B.slice(s,s+a)));s+=o,s+o>B.byteLength&&(a=B.byteLength-s);let n=511;for(let i=t.byteLength-1;i>=0;i--)n>>=8,n+=r[i]+e[i],e[i]=255&n;i.push(...e)}return B=new ArrayBuffer(i.length),k=new Uint8Array(B),k.set(i),u.push(...new Uint8Array(e)),B}))}return I=I.then((()=>{const e=new ArrayBuffer(r>>3);return new Uint8Array(e).set(new Uint8Array(u).slice(0,r>>3)),e})),I}class mt{constructor(e={}){this.crypto=I(e,"crypto",{}),this.subtle=I(e,"subtle",{}),this.name=I(e,"name","")}importKey(e,t,r,n,i){let s={};switch(t instanceof Uint8Array&&(t=t.buffer),e.toLowerCase()){case"raw":return this.subtle.importKey("raw",t,r,n,i);case"spki":{const e=et(t);if(-1===e.offset)return Promise.reject("Incorrect keyData");const a=new st;try{a.fromSchema(e.result)}catch(e){return Promise.reject("Incorrect keyData")}switch(r.name.toUpperCase()){case"RSA-PSS":switch(r.hash.name.toUpperCase()){case"SHA-1":s.alg="PS1";break;case"SHA-256":s.alg="PS256";break;case"SHA-384":s.alg="PS384";break;case"SHA-512":s.alg="PS512";break;default:return Promise.reject(`Incorrect hash algorithm: ${r.hash.name.toUpperCase()}`)}case"RSASSA-PKCS1-V1_5":{if(i=["verify"],s.kty="RSA",s.ext=n,s.key_ops=i,"1.2.840.113549.1.1.1"!==a.algorithm.algorithmId)return Promise.reject(`Incorrect public key algorithm: ${a.algorithm.algorithmId}`);if("alg"in s==!1)switch(r.hash.name.toUpperCase()){case"SHA-1":s.alg="RS1";break;case"SHA-256":s.alg="RS256";break;case"SHA-384":s.alg="RS384";break;case"SHA-512":s.alg="RS512";break;default:return Promise.reject(`Incorrect hash algorithm: ${r.hash.name.toUpperCase()}`)}const e=a.toJSON();for(const t of Object.keys(e))s[t]=e[t]}break;case"ECDSA":i=["verify"];case"ECDH":{if(s={kty:"EC",ext:n,key_ops:i},"1.2.840.10045.2.1"!==a.algorithm.algorithmId)return Promise.reject(`Incorrect public key algorithm: ${a.algorithm.algorithmId}`);const e=a.toJSON();for(const t of Object.keys(e))s[t]=e[t]}break;case"RSA-OAEP":{if(s.kty="RSA",s.ext=n,s.key_ops=i,"safari"===this.name.toLowerCase())s.alg="RSA-OAEP";else switch(r.hash.name.toUpperCase()){case"SHA-1":s.alg="RSA-OAEP";break;case"SHA-256":s.alg="RSA-OAEP-256";break;case"SHA-384":s.alg="RSA-OAEP-384";break;case"SHA-512":s.alg="RSA-OAEP-512";break;default:return Promise.reject(`Incorrect hash algorithm: ${r.hash.name.toUpperCase()}`)}const e=a.toJSON();for(const t of Object.keys(e))s[t]=e[t]}break;case"RSAES-PKCS1-V1_5":{s.kty="RSA",s.ext=n,s.key_ops=i,s.alg="PS1";const e=a.toJSON();for(const t of Object.keys(e))s[t]=e[t]}break;default:return Promise.reject(`Incorrect algorithm name: ${r.name.toUpperCase()}`)}}break;case"pkcs8":{const e=new lt,a=et(t);if(-1===a.offset)return Promise.reject("Incorrect keyData");try{e.fromSchema(a.result)}catch(e){return Promise.reject("Incorrect keyData")}if("parsedKey"in e==!1)return Promise.reject("Incorrect keyData");switch(r.name.toUpperCase()){case"RSA-PSS":switch(r.hash.name.toUpperCase()){case"SHA-1":s.alg="PS1";break;case"SHA-256":s.alg="PS256";break;case"SHA-384":s.alg="PS384";break;case"SHA-512":s.alg="PS512";break;default:return Promise.reject(`Incorrect hash algorithm: ${r.hash.name.toUpperCase()}`)}case"RSASSA-PKCS1-V1_5":{if(i=["sign"],s.kty="RSA",s.ext=n,s.key_ops=i,"1.2.840.113549.1.1.1"!==e.privateKeyAlgorithm.algorithmId)return Promise.reject(`Incorrect private key algorithm: ${e.privateKeyAlgorithm.algorithmId}`);if("alg"in s==!1)switch(r.hash.name.toUpperCase()){case"SHA-1":s.alg="RS1";break;case"SHA-256":s.alg="RS256";break;case"SHA-384":s.alg="RS384";break;case"SHA-512":s.alg="RS512";break;default:return Promise.reject(`Incorrect hash algorithm: ${r.hash.name.toUpperCase()}`)}const t=e.toJSON();for(const e of Object.keys(t))s[e]=t[e]}break;case"ECDSA":i=["sign"];case"ECDH":{if(s={kty:"EC",ext:n,key_ops:i},"1.2.840.10045.2.1"!==e.privateKeyAlgorithm.algorithmId)return Promise.reject(`Incorrect algorithm: ${e.privateKeyAlgorithm.algorithmId}`);const t=e.toJSON();for(const e of Object.keys(t))s[e]=t[e]}break;case"RSA-OAEP":{if(s.kty="RSA",s.ext=n,s.key_ops=i,"safari"===this.name.toLowerCase())s.alg="RSA-OAEP";else switch(r.hash.name.toUpperCase()){case"SHA-1":s.alg="RSA-OAEP";break;case"SHA-256":s.alg="RSA-OAEP-256";break;case"SHA-384":s.alg="RSA-OAEP-384";break;case"SHA-512":s.alg="RSA-OAEP-512";break;default:return Promise.reject(`Incorrect hash algorithm: ${r.hash.name.toUpperCase()}`)}const t=e.toJSON();for(const e of Object.keys(t))s[e]=t[e]}break;case"RSAES-PKCS1-V1_5":{i=["decrypt"],s.kty="RSA",s.ext=n,s.key_ops=i,s.alg="PS1";const t=e.toJSON();for(const e of Object.keys(t))s[e]=t[e]}break;default:return Promise.reject(`Incorrect algorithm name: ${r.name.toUpperCase()}`)}}break;case"jwk":s=t;break;default:return Promise.reject(`Incorrect format: ${e}`)}return"safari"===this.name.toLowerCase()?Promise.resolve().then((()=>this.subtle.importKey("jwk",M(JSON.stringify(s)),r,n,i))).then((e=>e),(()=>this.subtle.importKey("jwk",s,r,n,i))):this.subtle.importKey("jwk",s,r,n,i)}exportKey(e,t){let r=this.subtle.exportKey("jwk",t);switch("safari"===this.name.toLowerCase()&&(r=r.then((e=>e instanceof ArrayBuffer?JSON.parse(K(e)):e))),e.toLowerCase()){case"raw":return this.subtle.exportKey("raw",t);case"spki":r=r.then((e=>{const t=new st;try{t.fromJSON(e)}catch(e){return Promise.reject("Incorrect key data")}return t.toSchema().toBER(!1)}));break;case"pkcs8":r=r.then((e=>{const t=new lt;try{t.fromJSON(e)}catch(e){return Promise.reject("Incorrect key data")}return t.toSchema().toBER(!1)}));break;case"jwk":break;default:return Promise.reject(`Incorrect format: ${e}`)}return r}convert(e,t,r,n,i,s){switch(e.toLowerCase()){case"raw":switch(t.toLowerCase()){case"raw":return Promise.resolve(r);case"spki":return Promise.resolve().then((()=>this.importKey("raw",r,n,i,s))).then((e=>this.exportKey("spki",e)));case"pkcs8":return Promise.resolve().then((()=>this.importKey("raw",r,n,i,s))).then((e=>this.exportKey("pkcs8",e)));case"jwk":return Promise.resolve().then((()=>this.importKey("raw",r,n,i,s))).then((e=>this.exportKey("jwk",e)));default:return Promise.reject(`Incorrect outputFormat: ${t}`)}case"spki":switch(t.toLowerCase()){case"raw":return Promise.resolve().then((()=>this.importKey("spki",r,n,i,s))).then((e=>this.exportKey("raw",e)));case"spki":return Promise.resolve(r);case"pkcs8":return Promise.reject("Impossible to convert between SPKI/PKCS8");case"jwk":return Promise.resolve().then((()=>this.importKey("spki",r,n,i,s))).then((e=>this.exportKey("jwk",e)));default:return Promise.reject(`Incorrect outputFormat: ${t}`)}case"pkcs8":switch(t.toLowerCase()){case"raw":return Promise.resolve().then((()=>this.importKey("pkcs8",r,n,i,s))).then((e=>this.exportKey("raw",e)));case"spki":return Promise.reject("Impossible to convert between SPKI/PKCS8");case"pkcs8":return Promise.resolve(r);case"jwk":return Promise.resolve().then((()=>this.importKey("pkcs8",r,n,i,s))).then((e=>this.exportKey("jwk",e)));default:return Promise.reject(`Incorrect outputFormat: ${t}`)}case"jwk":switch(t.toLowerCase()){case"raw":return Promise.resolve().then((()=>this.importKey("jwk",r,n,i,s))).then((e=>this.exportKey("raw",e)));case"spki":return Promise.resolve().then((()=>this.importKey("jwk",r,n,i,s))).then((e=>this.exportKey("spki",e)));case"pkcs8":return Promise.resolve().then((()=>this.importKey("jwk",r,n,i,s))).then((e=>this.exportKey("pkcs8",e)));case"jwk":return Promise.resolve(r);default:return Promise.reject(`Incorrect outputFormat: ${t}`)}default:return Promise.reject(`Incorrect inputFormat: ${e}`)}}encrypt(...e){return this.subtle.encrypt(...e)}decrypt(...e){return this.subtle.decrypt(...e)}sign(...e){return this.subtle.sign(...e)}verify(...e){return this.subtle.verify(...e)}digest(...e){return this.subtle.digest(...e)}generateKey(...e){return this.subtle.generateKey(...e)}deriveKey(...e){return this.subtle.deriveKey(...e)}deriveBits(...e){return this.subtle.deriveBits(...e)}wrapKey(...e){return this.subtle.wrapKey(...e)}unwrapKey(...e){return this.subtle.unwrapKey(...e)}getRandomValues(e){if("getRandomValues"in this.crypto==!1)throw new Error("No support for getRandomValues");return this.crypto.getRandomValues(e)}getAlgorithmByOID(e){switch(e){case"1.2.840.113549.1.1.1":return{name:"RSAES-PKCS1-v1_5"};case"1.2.840.113549.1.1.5":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-1"}};case"1.2.840.113549.1.1.11":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"1.2.840.113549.1.1.12":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-384"}};case"1.2.840.113549.1.1.13":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-512"}};case"1.2.840.113549.1.1.10":return{name:"RSA-PSS"};case"1.2.840.113549.1.1.7":return{name:"RSA-OAEP"};case"1.2.840.10045.2.1":case"1.2.840.10045.4.1":return{name:"ECDSA",hash:{name:"SHA-1"}};case"1.2.840.10045.4.3.2":return{name:"ECDSA",hash:{name:"SHA-256"}};case"1.2.840.10045.4.3.3":return{name:"ECDSA",hash:{name:"SHA-384"}};case"1.2.840.10045.4.3.4":return{name:"ECDSA",hash:{name:"SHA-512"}};case"1.3.133.16.840.63.0.2":return{name:"ECDH",kdf:"SHA-1"};case"1.3.132.1.11.1":return{name:"ECDH",kdf:"SHA-256"};case"1.3.132.1.11.2":return{name:"ECDH",kdf:"SHA-384"};case"1.3.132.1.11.3":return{name:"ECDH",kdf:"SHA-512"};case"2.16.840.1.101.3.4.1.2":return{name:"AES-CBC",length:128};case"2.16.840.1.101.3.4.1.22":return{name:"AES-CBC",length:192};case"2.16.840.1.101.3.4.1.42":return{name:"AES-CBC",length:256};case"2.16.840.1.101.3.4.1.6":return{name:"AES-GCM",length:128};case"2.16.840.1.101.3.4.1.26":return{name:"AES-GCM",length:192};case"2.16.840.1.101.3.4.1.46":return{name:"AES-GCM",length:256};case"2.16.840.1.101.3.4.1.4":return{name:"AES-CFB",length:128};case"2.16.840.1.101.3.4.1.24":return{name:"AES-CFB",length:192};case"2.16.840.1.101.3.4.1.44":return{name:"AES-CFB",length:256};case"2.16.840.1.101.3.4.1.5":return{name:"AES-KW",length:128};case"2.16.840.1.101.3.4.1.25":return{name:"AES-KW",length:192};case"2.16.840.1.101.3.4.1.45":return{name:"AES-KW",length:256};case"1.2.840.113549.2.7":return{name:"HMAC",hash:{name:"SHA-1"}};case"1.2.840.113549.2.9":return{name:"HMAC",hash:{name:"SHA-256"}};case"1.2.840.113549.2.10":return{name:"HMAC",hash:{name:"SHA-384"}};case"1.2.840.113549.2.11":return{name:"HMAC",hash:{name:"SHA-512"}};case"1.2.840.113549.1.9.16.3.5":return{name:"DH"};case"1.3.14.3.2.26":return{name:"SHA-1"};case"2.16.840.1.101.3.4.2.1":return{name:"SHA-256"};case"2.16.840.1.101.3.4.2.2":return{name:"SHA-384"};case"2.16.840.1.101.3.4.2.3":return{name:"SHA-512"};case"1.2.840.113549.1.5.12":return{name:"PBKDF2"};case"1.2.840.10045.3.1.7":return{name:"P-256"};case"1.3.132.0.34":return{name:"P-384"};case"1.3.132.0.35":return{name:"P-521"}}return{}}getOIDByAlgorithm(e){let t="";switch(e.name.toUpperCase()){case"RSAES-PKCS1-V1_5":t="1.2.840.113549.1.1.1";break;case"RSASSA-PKCS1-V1_5":switch(e.hash.name.toUpperCase()){case"SHA-1":t="1.2.840.113549.1.1.5";break;case"SHA-256":t="1.2.840.113549.1.1.11";break;case"SHA-384":t="1.2.840.113549.1.1.12";break;case"SHA-512":t="1.2.840.113549.1.1.13"}break;case"RSA-PSS":t="1.2.840.113549.1.1.10";break;case"RSA-OAEP":t="1.2.840.113549.1.1.7";break;case"ECDSA":switch(e.hash.name.toUpperCase()){case"SHA-1":t="1.2.840.10045.4.1";break;case"SHA-256":t="1.2.840.10045.4.3.2";break;case"SHA-384":t="1.2.840.10045.4.3.3";break;case"SHA-512":t="1.2.840.10045.4.3.4"}break;case"ECDH":switch(e.kdf.toUpperCase()){case"SHA-1":t="1.3.133.16.840.63.0.2";break;case"SHA-256":t="1.3.132.1.11.1";break;case"SHA-384":t="1.3.132.1.11.2";break;case"SHA-512":t="1.3.132.1.11.3"}break;case"AES-CTR":break;case"AES-CBC":switch(e.length){case 128:t="2.16.840.1.101.3.4.1.2";break;case 192:t="2.16.840.1.101.3.4.1.22";break;case 256:t="2.16.840.1.101.3.4.1.42"}break;case"AES-CMAC":break;case"AES-GCM":switch(e.length){case 128:t="2.16.840.1.101.3.4.1.6";break;case 192:t="2.16.840.1.101.3.4.1.26";break;case 256:t="2.16.840.1.101.3.4.1.46"}break;case"AES-CFB":switch(e.length){case 128:t="2.16.840.1.101.3.4.1.4";break;case 192:t="2.16.840.1.101.3.4.1.24";break;case 256:t="2.16.840.1.101.3.4.1.44"}break;case"AES-KW":switch(e.length){case 128:t="2.16.840.1.101.3.4.1.5";break;case 192:t="2.16.840.1.101.3.4.1.25";break;case 256:t="2.16.840.1.101.3.4.1.45"}break;case"HMAC":switch(e.hash.name.toUpperCase()){case"SHA-1":t="1.2.840.113549.2.7";break;case"SHA-256":t="1.2.840.113549.2.9";break;case"SHA-384":t="1.2.840.113549.2.10";break;case"SHA-512":t="1.2.840.113549.2.11"}break;case"DH":t="1.2.840.113549.1.9.16.3.5";break;case"SHA-1":t="1.3.14.3.2.26";break;case"SHA-256":t="2.16.840.1.101.3.4.2.1";break;case"SHA-384":t="2.16.840.1.101.3.4.2.2";break;case"SHA-512":t="2.16.840.1.101.3.4.2.3";break;case"CONCAT":case"HKDF":break;case"PBKDF2":t="1.2.840.113549.1.5.12";break;case"P-256":t="1.2.840.10045.3.1.7";break;case"P-384":t="1.3.132.0.34";break;case"P-521":t="1.3.132.0.35"}return t}getAlgorithmParameters(e,t){let r={algorithm:{},usages:[]};switch(e.toUpperCase()){case"RSAES-PKCS1-V1_5":case"RSASSA-PKCS1-V1_5":switch(t.toLowerCase()){case"generatekey":r={algorithm:{name:"RSASSA-PKCS1-v1_5",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},usages:["sign","verify"]};break;case"verify":case"sign":case"importkey":r={algorithm:{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},usages:["verify"]};break;case"exportkey":default:return{algorithm:{name:"RSASSA-PKCS1-v1_5"},usages:[]}}break;case"RSA-PSS":switch(t.toLowerCase()){case"sign":case"verify":r={algorithm:{name:"RSA-PSS",hash:{name:"SHA-1"},saltLength:20},usages:["sign","verify"]};break;case"generatekey":r={algorithm:{name:"RSA-PSS",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-1"}},usages:["sign","verify"]};break;case"importkey":r={algorithm:{name:"RSA-PSS",hash:{name:"SHA-1"}},usages:["verify"]};break;case"exportkey":default:return{algorithm:{name:"RSA-PSS"},usages:[]}}break;case"RSA-OAEP":switch(t.toLowerCase()){case"encrypt":case"decrypt":r={algorithm:{name:"RSA-OAEP"},usages:["encrypt","decrypt"]};break;case"generatekey":r={algorithm:{name:"RSA-OAEP",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;case"importkey":r={algorithm:{name:"RSA-OAEP",hash:{name:"SHA-256"}},usages:["encrypt"]};break;case"exportkey":default:return{algorithm:{name:"RSA-OAEP"},usages:[]}}break;case"ECDSA":switch(t.toLowerCase()){case"generatekey":r={algorithm:{name:"ECDSA",namedCurve:"P-256"},usages:["sign","verify"]};break;case"importkey":r={algorithm:{name:"ECDSA",namedCurve:"P-256"},usages:["verify"]};break;case"verify":case"sign":r={algorithm:{name:"ECDSA",hash:{name:"SHA-256"}},usages:["sign"]};break;default:return{algorithm:{name:"ECDSA"},usages:[]}}break;case"ECDH":switch(t.toLowerCase()){case"exportkey":case"importkey":case"generatekey":r={algorithm:{name:"ECDH",namedCurve:"P-256"},usages:["deriveKey","deriveBits"]};break;case"derivekey":case"derivebits":r={algorithm:{name:"ECDH",namedCurve:"P-256",public:[]},usages:["encrypt","decrypt"]};break;default:return{algorithm:{name:"ECDH"},usages:[]}}break;case"AES-CTR":switch(t.toLowerCase()){case"importkey":case"exportkey":case"generatekey":r={algorithm:{name:"AES-CTR",length:256},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;case"decrypt":case"encrypt":r={algorithm:{name:"AES-CTR",counter:new Uint8Array(16),length:10},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;default:return{algorithm:{name:"AES-CTR"},usages:[]}}break;case"AES-CBC":switch(t.toLowerCase()){case"importkey":case"exportkey":case"generatekey":r={algorithm:{name:"AES-CBC",length:256},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;case"decrypt":case"encrypt":r={algorithm:{name:"AES-CBC",iv:this.getRandomValues(new Uint8Array(16))},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;default:return{algorithm:{name:"AES-CBC"},usages:[]}}break;case"AES-GCM":switch(t.toLowerCase()){case"importkey":case"exportkey":case"generatekey":r={algorithm:{name:"AES-GCM",length:256},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;case"decrypt":case"encrypt":r={algorithm:{name:"AES-GCM",iv:this.getRandomValues(new Uint8Array(16))},usages:["encrypt","decrypt","wrapKey","unwrapKey"]};break;default:return{algorithm:{name:"AES-GCM"},usages:[]}}break;case"AES-KW":switch(t.toLowerCase()){case"importkey":case"exportkey":case"generatekey":case"wrapkey":case"unwrapkey":r={algorithm:{name:"AES-KW",length:256},usages:["wrapKey","unwrapKey"]};break;default:return{algorithm:{name:"AES-KW"},usages:[]}}break;case"HMAC":switch(t.toLowerCase()){case"sign":case"verify":r={algorithm:{name:"HMAC"},usages:["sign","verify"]};break;case"importkey":case"exportkey":case"generatekey":r={algorithm:{name:"HMAC",length:32,hash:{name:"SHA-256"}},usages:["sign","verify"]};break;default:return{algorithm:{name:"HMAC"},usages:[]}}break;case"HKDF":switch(t.toLowerCase()){case"derivekey":r={algorithm:{name:"HKDF",hash:"SHA-256",salt:new Uint8Array([]),info:new Uint8Array([])},usages:["encrypt","decrypt"]};break;default:return{algorithm:{name:"HKDF"},usages:[]}}break;case"PBKDF2":switch(t.toLowerCase()){case"derivekey":r={algorithm:{name:"PBKDF2",hash:{name:"SHA-256"},salt:new Uint8Array([]),iterations:1e4},usages:["encrypt","decrypt"]};break;default:return{algorithm:{name:"PBKDF2"},usages:[]}}}return r}getHashAlgorithm(e){let t="";switch(e.algorithmId){case"1.2.840.10045.4.1":case"1.2.840.113549.1.1.5":t="SHA-1";break;case"1.2.840.10045.4.3.2":case"1.2.840.113549.1.1.11":t="SHA-256";break;case"1.2.840.10045.4.3.3":case"1.2.840.113549.1.1.12":t="SHA-384";break;case"1.2.840.10045.4.3.4":case"1.2.840.113549.1.1.13":t="SHA-512";break;case"1.2.840.113549.1.1.10":try{const r=new ft({schema:e.algorithmParams});if("hashAlgorithm"in r){const e=this.getAlgorithmByOID(r.hashAlgorithm.algorithmId);if("name"in e==!1)return"";t=e.name}else t="SHA-1"}catch(e){}}return t}encryptEncryptedContentInfo(e){if(e instanceof Object==!1)return Promise.reject('Parameters must have type "Object"');if("password"in e==!1)return Promise.reject('Absent mandatory parameter "password"');if("contentEncryptionAlgorithm"in e==!1)return Promise.reject('Absent mandatory parameter "contentEncryptionAlgorithm"');if("hmacHashAlgorithm"in e==!1)return Promise.reject('Absent mandatory parameter "hmacHashAlgorithm"');if("iterationCount"in e==!1)return Promise.reject('Absent mandatory parameter "iterationCount"');if("contentToEncrypt"in e==!1)return Promise.reject('Absent mandatory parameter "contentToEncrypt"');if("contentType"in e==!1)return Promise.reject('Absent mandatory parameter "contentType"');const t=this.getOIDByAlgorithm(e.contentEncryptionAlgorithm);if(""===t)return Promise.reject('Wrong "contentEncryptionAlgorithm" value');const r=this.getOIDByAlgorithm({name:"PBKDF2"});if(""===r)return Promise.reject("Can not find OID for PBKDF2");const n=this.getOIDByAlgorithm({name:"HMAC",hash:{name:e.hmacHashAlgorithm}});if(""===n)return Promise.reject(`Incorrect value for "hmacHashAlgorithm": ${e.hmacHashAlgorithm}`);let i=Promise.resolve();const s=new ArrayBuffer(16),a=new Uint8Array(s);this.getRandomValues(a);const o=new ArrayBuffer(64),u=new Uint8Array(o);this.getRandomValues(u);const h=new Uint8Array(e.contentToEncrypt),l=new gt({salt:new ge({valueHex:o}),iterationCount:e.iterationCount,prf:new rt({algorithmId:n,algorithmParams:new ce})});return i=i.then((()=>{const t=new Uint8Array(e.password);return this.importKey("raw",t,"PBKDF2",!1,["deriveKey"])}),(e=>Promise.reject(e))),i=i.then((t=>this.deriveKey({name:"PBKDF2",hash:{name:e.hmacHashAlgorithm},salt:u,iterations:e.iterationCount},t,e.contentEncryptionAlgorithm,!1,["encrypt"])),(e=>Promise.reject(e))),i=i.then((t=>this.encrypt({name:e.contentEncryptionAlgorithm.name,iv:a},t,h)),(e=>Promise.reject(e))),i=i.then((n=>{const i=new dt({keyDerivationFunc:new rt({algorithmId:r,algorithmParams:l.toSchema()}),encryptionScheme:new rt({algorithmId:t,algorithmParams:new ge({valueHex:s})})});return new ct({contentType:e.contentType,contentEncryptionAlgorithm:new rt({algorithmId:"1.2.840.113549.1.5.13",algorithmParams:i.toSchema()}),encryptedContent:new ge({valueHex:n})})}),(e=>Promise.reject(e))),i}decryptEncryptedContentInfo(e){if(e instanceof Object==!1)return Promise.reject('Parameters must have type "Object"');if("password"in e==!1)return Promise.reject('Absent mandatory parameter "password"');if("encryptedContentInfo"in e==!1)return Promise.reject('Absent mandatory parameter "encryptedContentInfo"');if("1.2.840.113549.1.5.13"!==e.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId)return Promise.reject(`Unknown "contentEncryptionAlgorithm": ${e.encryptedContentInfo.contentEncryptionAlgorithm.algorithmId}`);let t,r,n=Promise.resolve();try{t=new dt({schema:e.encryptedContentInfo.contentEncryptionAlgorithm.algorithmParams})}catch(e){return Promise.reject('Incorrectly encoded "pbes2Parameters"')}try{r=new gt({schema:t.keyDerivationFunc.algorithmParams})}catch(e){return Promise.reject('Incorrectly encoded "pbkdf2Params"')}const i=this.getAlgorithmByOID(t.encryptionScheme.algorithmId);if("name"in i==!1)return Promise.reject(`Incorrect OID for "contentEncryptionAlgorithm": ${t.encryptionScheme.algorithmId}`);const s=t.encryptionScheme.algorithmParams.valueBlock.valueHex,a=new Uint8Array(s),o=r.salt.valueBlock.valueHex,u=new Uint8Array(o),h=r.iterationCount;let l="SHA-1";if("prf"in r){const e=this.getAlgorithmByOID(r.prf.algorithmId);if("name"in e==!1)return Promise.reject("Incorrect OID for HMAC hash algorithm");l=e.hash.name}return n=n.then((()=>this.importKey("raw",e.password,"PBKDF2",!1,["deriveKey"])),(e=>Promise.reject(e))),n=n.then((e=>this.deriveKey({name:"PBKDF2",hash:{name:l},salt:u,iterations:h},e,i,!1,["decrypt"])),(e=>Promise.reject(e))),n=n.then((t=>{let r=new ArrayBuffer(0);if(!1===e.encryptedContentInfo.encryptedContent.idBlock.isConstructed)r=e.encryptedContentInfo.encryptedContent.valueBlock.valueHex;else for(const t of e.encryptedContentInfo.encryptedContent.valueBlock.value)r=H(r,t.valueBlock.valueHex);return this.decrypt({name:i.name,iv:a},t,r)}),(e=>Promise.reject(e))),n}stampDataWithPassword(e){if(e instanceof Object==!1)return Promise.reject('Parameters must have type "Object"');if("password"in e==!1)return Promise.reject('Absent mandatory parameter "password"');if("hashAlgorithm"in e==!1)return Promise.reject('Absent mandatory parameter "hashAlgorithm"');if("salt"in e==!1)return Promise.reject('Absent mandatory parameter "iterationCount"');if("iterationCount"in e==!1)return Promise.reject('Absent mandatory parameter "salt"');if("contentToStamp"in e==!1)return Promise.reject('Absent mandatory parameter "contentToStamp"');let t;switch(e.hashAlgorithm.toLowerCase()){case"sha-1":t=160;break;case"sha-256":t=256;break;case"sha-384":t=384;break;case"sha-512":t=512;break;default:return Promise.reject(`Incorrect "parameters.hashAlgorithm" parameter: ${e.hashAlgorithm}`)}let r=Promise.resolve();const n={name:"HMAC",length:t,hash:{name:e.hashAlgorithm}};return r=r.then((()=>pt(this,e.hashAlgorithm,t,e.password,e.salt,e.iterationCount))),r=r.then((e=>this.importKey("raw",new Uint8Array(e),n,!1,["sign"]))),r=r.then((t=>this.sign(n,t,new Uint8Array(e.contentToStamp))),(e=>Promise.reject(e))),r}verifyDataStampedWithPassword(e){if(e instanceof Object==!1)return Promise.reject('Parameters must have type "Object"');if("password"in e==!1)return Promise.reject('Absent mandatory parameter "password"');if("hashAlgorithm"in e==!1)return Promise.reject('Absent mandatory parameter "hashAlgorithm"');if("salt"in e==!1)return Promise.reject('Absent mandatory parameter "iterationCount"');if("iterationCount"in e==!1)return Promise.reject('Absent mandatory parameter "salt"');if("contentToVerify"in e==!1)return Promise.reject('Absent mandatory parameter "contentToVerify"');if("signatureToVerify"in e==!1)return Promise.reject('Absent mandatory parameter "signatureToVerify"');let t;switch(e.hashAlgorithm.toLowerCase()){case"sha-1":t=160;break;case"sha-256":t=256;break;case"sha-384":t=384;break;case"sha-512":t=512;break;default:return Promise.reject(`Incorrect "parameters.hashAlgorithm" parameter: ${e.hashAlgorithm}`)}let r=Promise.resolve();const n={name:"HMAC",length:t,hash:{name:e.hashAlgorithm}};return r=r.then((()=>pt(this,e.hashAlgorithm,t,e.password,e.salt,e.iterationCount))),r=r.then((e=>this.importKey("raw",new Uint8Array(e),n,!1,["verify"]))),r=r.then((t=>this.verify(n,t,new Uint8Array(e.signatureToVerify),new Uint8Array(e.contentToVerify))),(e=>Promise.reject(e))),r}getSignatureParameters(e,t="SHA-1"){if(""===this.getOIDByAlgorithm({name:t}))return Promise.reject(`Unsupported hash algorithm: ${t}`);const r=new rt,n=this.getAlgorithmParameters(e.algorithm.name,"sign");switch(n.algorithm.hash.name=t,e.algorithm.name.toUpperCase()){case"RSASSA-PKCS1-V1_5":case"ECDSA":r.algorithmId=this.getOIDByAlgorithm(n.algorithm);break;case"RSA-PSS":{switch(t.toUpperCase()){case"SHA-256":n.algorithm.saltLength=32;break;case"SHA-384":n.algorithm.saltLength=48;break;case"SHA-512":n.algorithm.saltLength=64}const e={};if("SHA-1"!==t.toUpperCase()){const r=this.getOIDByAlgorithm({name:t});if(""===r)return Promise.reject(`Unsupported hash algorithm: ${t}`);e.hashAlgorithm=new rt({algorithmId:r,algorithmParams:new ce}),e.maskGenAlgorithm=new rt({algorithmId:"1.2.840.113549.1.1.8",algorithmParams:e.hashAlgorithm.toSchema()})}20!==n.algorithm.saltLength&&(e.saltLength=n.algorithm.saltLength);const i=new ft(e);r.algorithmId="1.2.840.113549.1.1.10",r.algorithmParams=i.toSchema()}break;default:return Promise.reject(`Unsupported signature algorithm: ${e.algorithm.name}`)}return Promise.resolve().then((()=>({signatureAlgorithm:r,parameters:n})))}signWithPrivateKey(e,t,r){return this.sign(r.algorithm,t,new Uint8Array(e)).then((e=>("ECDSA"===r.algorithm.name&&(e=function(e){if(e.byteLength%2!=0)return new ArrayBuffer(0);const t=e.byteLength/2,r=new ArrayBuffer(t);new Uint8Array(r).set(new Uint8Array(e,0,t));const n=new ye({valueHex:r}),i=new ArrayBuffer(t);new Uint8Array(i).set(new Uint8Array(e,t,t));const s=new ye({valueHex:i});return new he({value:[n.convertToDER(),s.convertToDER()]}).toBER(!1)}(e)),e)),(e=>Promise.reject(`Signing error: ${e}`)))}fillPublicKeyParameters(e,t){const r={},n=this.getHashAlgorithm(t);if(""===n)return Promise.reject(`Unsupported signature algorithm: ${t.algorithmId}`);let i;i="1.2.840.113549.1.1.10"===t.algorithmId?t.algorithmId:e.algorithm.algorithmId;const s=this.getAlgorithmByOID(i);if("name"in s==="")return Promise.reject(`Unsupported public key algorithm: ${t.algorithmId}`);if(r.algorithm=this.getAlgorithmParameters(s.name,"importkey"),"hash"in r.algorithm.algorithm&&(r.algorithm.algorithm.hash.name=n),"ECDSA"===s.name){let t=!1;if("algorithmParams"in e.algorithm==!0&&"idBlock"in e.algorithm.algorithmParams&&1===e.algorithm.algorithmParams.idBlock.tagClass&&6===e.algorithm.algorithmParams.idBlock.tagNumber&&(t=!0),!1===t)return Promise.reject("Incorrect type for ECDSA public key parameters");const n=this.getAlgorithmByOID(e.algorithm.algorithmParams.valueBlock.toString());if("name"in n==!1)return Promise.reject(`Unsupported named curve algorithm: ${e.algorithm.algorithmParams.valueBlock.toString()}`);r.algorithm.algorithm.namedCurve=n.name}return r}getPublicKey(e,t,r=null){null===r&&(r=this.fillPublicKeyParameters(e,t));const n=e.toSchema().toBER(!1),i=new Uint8Array(n);return this.importKey("spki",i,r.algorithm.algorithm,!0,r.algorithm.usages)}verifyWithPublicKey(e,t,r,n,i=null){let s=Promise.resolve();if(null===i){if(""===(i=this.getHashAlgorithm(n)))return Promise.reject(`Unsupported signature algorithm: ${n.algorithmId}`);s=s.then((()=>this.getPublicKey(r,n)))}else{const e={};let t;t="1.2.840.113549.1.1.10"===n.algorithmId?n.algorithmId:r.algorithm.algorithmId;const a=this.getAlgorithmByOID(t);if("name"in a==="")return Promise.reject(`Unsupported public key algorithm: ${n.algorithmId}`);if(e.algorithm=this.getAlgorithmParameters(a.name,"importkey"),"hash"in e.algorithm.algorithm&&(e.algorithm.algorithm.hash.name=i),"ECDSA"===a.name){let t=!1;if("algorithmParams"in r.algorithm==!0&&"idBlock"in r.algorithm.algorithmParams&&1===r.algorithm.algorithmParams.idBlock.tagClass&&6===r.algorithm.algorithmParams.idBlock.tagNumber&&(t=!0),!1===t)return Promise.reject("Incorrect type for ECDSA public key parameters");const n=this.getAlgorithmByOID(r.algorithm.algorithmParams.valueBlock.toString());if("name"in n==!1)return Promise.reject(`Unsupported named curve algorithm: ${r.algorithm.algorithmParams.valueBlock.toString()}`);e.algorithm.algorithm.namedCurve=n.name}s=s.then((()=>this.getPublicKey(r,null,e)))}return s=s.then((r=>{const s=this.getAlgorithmParameters(r.algorithm.name,"verify");"hash"in s.algorithm&&(s.algorithm.hash.name=i);let a=t.valueBlock.valueHex;if("ECDSA"===r.algorithm.name){a=function(e){if(e instanceof he==!1)return new ArrayBuffer(0);if(2!==e.valueBlock.value.length)return new ArrayBuffer(0);if(e.valueBlock.value[0]instanceof ye==!1)return new ArrayBuffer(0);if(e.valueBlock.value[1]instanceof ye==!1)return new ArrayBuffer(0);const t=e.valueBlock.value[0].convertFromDER(),r=e.valueBlock.value[1].convertFromDER();switch(!0){case t.valueBlock.valueHex.byteLength<r.valueBlock.valueHex.byteLength:{if(r.valueBlock.valueHex.byteLength-t.valueBlock.valueHex.byteLength!=1)throw new Error("Incorrect DER integer decoding");const e=r.valueBlock.valueHex.byteLength,n=new Uint8Array(t.valueBlock.valueHex),i=new ArrayBuffer(e),s=new Uint8Array(i);return s.set(n,1),s[0]=0,H(i,r.valueBlock.valueHex)}case t.valueBlock.valueHex.byteLength>r.valueBlock.valueHex.byteLength:{if(t.valueBlock.valueHex.byteLength-r.valueBlock.valueHex.byteLength!=1)throw new Error("Incorrect DER integer decoding");const e=t.valueBlock.valueHex.byteLength,n=new Uint8Array(r.valueBlock.valueHex),i=new ArrayBuffer(e),s=new Uint8Array(i);return s.set(n,1),s[0]=0,H(t.valueBlock.valueHex,i)}default:if(t.valueBlock.valueHex.byteLength%2){const e=t.valueBlock.valueHex.byteLength+1,n=new Uint8Array(t.valueBlock.valueHex),i=new ArrayBuffer(e),s=new Uint8Array(i);s.set(n,1),s[0]=0;const a=new Uint8Array(r.valueBlock.valueHex),o=new ArrayBuffer(e),u=new Uint8Array(o);return u.set(a,1),u[0]=0,H(i,o)}}return H(t.valueBlock.valueHex,r.valueBlock.valueHex)}(et(a).result)}if("RSA-PSS"===r.algorithm.name){let e;try{e=new ft({schema:n.algorithmParams})}catch(e){return Promise.reject(e)}s.algorithm.saltLength="saltLength"in e?e.saltLength:20;let t="SHA-1";if("hashAlgorithm"in e){const r=this.getAlgorithmByOID(e.hashAlgorithm.algorithmId);if("name"in r==!1)return Promise.reject(`Unrecognized hash algorithm: ${e.hashAlgorithm.algorithmId}`);t=r.name}s.algorithm.hash.name=t}return this.verify(s.algorithm,r,new Uint8Array(a),new Uint8Array(e))})),s}}let yt={name:"none",crypto:null,subtle:null};function vt(){if("undefined"!=typeof process&&"pid"in process&&void 0!==r.g&&"undefined"==typeof window){let e;try{e=r.g[process.pid].pkijs.engine}catch(e){throw new Error('Please call "setEngine" before call to "getEngine"')}return e}return yt}function bt(){const e=vt();if(null!==e.subtle)return e.subtle}function wt(e){let t=!1,r="";const n=e.trim();for(let e=0;e<n.length;e++)32===n.charCodeAt(e)?!1===t&&(t=!0):(t&&(r+=" ",t=!1),r+=n[e]);return r.toLowerCase()}!function(){if("undefined"!=typeof self&&"crypto"in self){let e="webcrypto";const t=self.crypto;let r;if("webkitSubtle"in self.crypto){try{r=self.crypto.webkitSubtle}catch(e){r=self.crypto.subtle}e="safari"}"subtle"in self.crypto&&(r=self.crypto.subtle),yt=void 0===r?{name:e,crypto:t,subtle:null}:{name:e,crypto:t,subtle:new mt({name:e,crypto:self.crypto,subtle:r})}}!function(e,t,n){if("undefined"!=typeof process&&"pid"in process&&void 0!==r.g&&"undefined"==typeof window){if(void 0===r.g[process.pid])r.g[process.pid]={};else if("object"!=typeof r.g[process.pid])throw new Error(`Name global.${process.pid} already exists and it is not an object`);if(void 0===r.g[process.pid].pkijs)r.g[process.pid].pkijs={};else if("object"!=typeof r.g[process.pid].pkijs)throw new Error(`Name global.${process.pid}.pkijs already exists and it is not an object`);r.g[process.pid].pkijs.engine={name:e,crypto:t,subtle:n}}else yt.name!==e&&(yt={name:e,crypto:t,subtle:n})}(yt.name,yt.crypto,yt.subtle)}();class St{constructor(e={}){this.type=I(e,"type",St.defaultValues("type")),this.value=I(e,"value",St.defaultValues("value")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"type":return"";case"value":return{};default:throw new Error(`Invalid member name for AttributeTypeAndValue class: ${e}`)}}static schema(e={}){const t=I(e,"names",{});return new he({name:t.blockName||"",value:[new Se({name:t.type||""}),new Xe({name:t.value||""})]})}static blockName(){return"AttributeTypeAndValue"}fromSchema(e){$(e,["type","typeValue"]);const t=tt(e,e,St.schema({names:{type:"type",value:"typeValue"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for AttributeTypeAndValue");this.type=t.result.type.valueBlock.toString(),this.value=t.result.typeValue}toSchema(){return new he({value:[new Se({value:this.type}),this.value]})}toJSON(){const e={type:this.type};return 0!==Object.keys(this.value).length?e.value=this.value.toJSON():e.value=this.value,e}isEqual(e){const t=[xe.blockName(),Ie.blockName(),Pe.blockName(),He.blockName(),Re.blockName(),Oe.blockName(),Te.blockName(),Le.blockName(),je.blockName(),Ve.blockName(),Ue.blockName(),_e.blockName()];if(e.constructor.blockName()===St.blockName()){if(this.type!==e.type)return!1;let r=[!1,!1];const n=this.value.constructor.blockName();for(const i of t)n===i&&(r[0]=!0),e.value.constructor.blockName()===i&&(r[1]=!0);if(r[0]^r[1])return!1;if(r=r[0]&&r[1],r){const t=wt(this.value.valueBlock.value),r=wt(e.value.valueBlock.value);if(0!==t.localeCompare(r))return!1}else if(!1===T(this.value.valueBeforeDecode,e.value.valueBeforeDecode))return!1;return!0}return e instanceof ArrayBuffer&&T(this.value.valueBeforeDecode,e)}}class At{constructor(e={}){this.typesAndValues=I(e,"typesAndValues",At.defaultValues("typesAndValues")),this.valueBeforeDecode=I(e,"valueBeforeDecode",At.defaultValues("valueBeforeDecode")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"typesAndValues":return[];case"valueBeforeDecode":return new ArrayBuffer(0);default:throw new Error(`Invalid member name for RelativeDistinguishedNames class: ${e}`)}}static compareWithDefault(e,t){switch(e){case"typesAndValues":return 0===t.length;case"valueBeforeDecode":return 0===t.byteLength;default:throw new Error(`Invalid member name for RelativeDistinguishedNames class: ${e}`)}}static schema(e={}){const t=I(e,"names",{});return new he({name:t.blockName||"",value:[new Qe({name:t.repeatedSequence||"",value:new le({value:[new Qe({name:t.repeatedSet||"",value:St.schema(t.typeAndValue||{})})]})})]})}fromSchema(e){$(e,["RDN","typesAndValues"]);const t=tt(e,e,At.schema({names:{blockName:"RDN",repeatedSet:"typesAndValues"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for RelativeDistinguishedNames");"typesAndValues"in t.result&&(this.typesAndValues=Array.from(t.result.typesAndValues,(e=>new St({schema:e})))),this.valueBeforeDecode=t.result.RDN.valueBeforeDecode}toSchema(){if(0===this.valueBeforeDecode.byteLength)return new he({value:[new le({value:Array.from(this.typesAndValues,(e=>e.toSchema()))})]});return et(this.valueBeforeDecode).result}toJSON(){return{typesAndValues:Array.from(this.typesAndValues,(e=>e.toJSON()))}}isEqual(e){if(e instanceof At){if(this.typesAndValues.length!==e.typesAndValues.length)return!1;for(const[t,r]of this.typesAndValues.entries())if(!1===r.isEqual(e.typesAndValues[t]))return!1;return!0}return e instanceof ArrayBuffer&&T(this.valueBeforeDecode,e)}}function xt(e={},t=!1){const r=I(e,"names",{});return new he({optional:t,value:[new ie({optional:!0,idBlock:{tagClass:2,tagNumber:1},name:r.country_name||"",value:[new ze({value:[new He,new Re]})]}),new ie({optional:!0,idBlock:{tagClass:2,tagNumber:2},name:r.administration_domain_name||"",value:[new ze({value:[new He,new Re]})]}),new re({optional:!0,idBlock:{tagClass:3,tagNumber:0},name:r.network_address||"",isHexOnly:!0}),new re({optional:!0,idBlock:{tagClass:3,tagNumber:1},name:r.terminal_identifier||"",isHexOnly:!0}),new ie({optional:!0,idBlock:{tagClass:3,tagNumber:2},name:r.private_domain_name||"",value:[new ze({value:[new He,new Re]})]}),new re({optional:!0,idBlock:{tagClass:3,tagNumber:3},name:r.organization_name||"",isHexOnly:!0}),new re({optional:!0,name:r.numeric_user_identifier||"",idBlock:{tagClass:3,tagNumber:4},isHexOnly:!0}),new ie({optional:!0,name:r.personal_name||"",idBlock:{tagClass:3,tagNumber:5},value:[new re({idBlock:{tagClass:3,tagNumber:0},isHexOnly:!0}),new re({optional:!0,idBlock:{tagClass:3,tagNumber:1},isHexOnly:!0}),new re({optional:!0,idBlock:{tagClass:3,tagNumber:2},isHexOnly:!0}),new re({optional:!0,idBlock:{tagClass:3,tagNumber:3},isHexOnly:!0})]}),new ie({optional:!0,name:r.organizational_unit_names||"",idBlock:{tagClass:3,tagNumber:6},value:[new Qe({value:new Re})]})]})}function Et(e=!1){return new he({optional:e,value:[new Re,new Re]})}function Bt(e=!1){return new le({optional:e,value:[new re({optional:!0,idBlock:{tagClass:3,tagNumber:0},isHexOnly:!0}),new ie({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new Xe]})]})}class kt{constructor(e={}){this.type=I(e,"type",kt.defaultValues("type")),this.value=I(e,"value",kt.defaultValues("value")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"type":return 9;case"value":return{};default:throw new Error(`Invalid member name for GeneralName class: ${e}`)}}static compareWithDefault(e,t){switch(e){case"type":return t===kt.defaultValues(e);case"value":return 0===Object.keys(t).length;default:throw new Error(`Invalid member name for GeneralName class: ${e}`)}}static schema(e={}){const t=I(e,"names",{});return new ze({value:[new ie({idBlock:{tagClass:3,tagNumber:0},name:t.blockName||"",value:[new Se,new ie({idBlock:{tagClass:3,tagNumber:0},value:[new Xe]})]}),new re({name:t.blockName||"",idBlock:{tagClass:3,tagNumber:1}}),new re({name:t.blockName||"",idBlock:{tagClass:3,tagNumber:2}}),new ie({idBlock:{tagClass:3,tagNumber:3},name:t.blockName||"",value:[xt(t.builtInStandardAttributes||{},!1),Et(!0),Bt(!0)]}),new ie({idBlock:{tagClass:3,tagNumber:4},name:t.blockName||"",value:[At.schema(t.directoryName||{})]}),new ie({idBlock:{tagClass:3,tagNumber:5},name:t.blockName||"",value:[new ie({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new ze({value:[new Oe,new Re,new Pe,new xe,new Ie]})]}),new ie({idBlock:{tagClass:3,tagNumber:1},value:[new ze({value:[new Oe,new Re,new Pe,new xe,new Ie]})]})]}),new re({name:t.blockName||"",idBlock:{tagClass:3,tagNumber:6}}),new re({name:t.blockName||"",idBlock:{tagClass:3,tagNumber:7}}),new re({name:t.blockName||"",idBlock:{tagClass:3,tagNumber:8}})]})}fromSchema(e){$(e,["blockName","otherName","rfc822Name","dNSName","x400Address","directoryName","ediPartyName","uniformResourceIdentifier","iPAddress","registeredID"]);const t=tt(e,e,kt.schema({names:{blockName:"blockName",otherName:"otherName",rfc822Name:"rfc822Name",dNSName:"dNSName",x400Address:"x400Address",directoryName:{names:{blockName:"directoryName"}},ediPartyName:"ediPartyName",uniformResourceIdentifier:"uniformResourceIdentifier",iPAddress:"iPAddress",registeredID:"registeredID"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for GeneralName");switch(this.type=t.result.blockName.idBlock.tagNumber,this.type){case 0:this.value=t.result.blockName;break;case 1:case 2:case 6:{const e=t.result.blockName;e.idBlock.tagClass=1,e.idBlock.tagNumber=22;const r=e.toBER(!1);this.value=et(r).result.valueBlock.value}break;case 3:this.value=t.result.blockName;break;case 4:this.value=new At({schema:t.result.directoryName});break;case 5:this.value=t.result.ediPartyName;break;case 7:this.value=new ge({valueHex:t.result.blockName.valueBlock.valueHex});break;case 8:{const e=t.result.blockName;e.idBlock.tagClass=1,e.idBlock.tagNumber=6;const r=e.toBER(!1);this.value=et(r).result.valueBlock.toString()}}}toSchema(){switch(this.type){case 0:case 3:case 5:return new ie({idBlock:{tagClass:3,tagNumber:this.type},value:[this.value]});case 1:case 2:case 6:{const e=new Le({value:this.value});return e.idBlock.tagClass=3,e.idBlock.tagNumber=this.type,e}case 4:return new ie({idBlock:{tagClass:3,tagNumber:4},value:[this.value.toSchema()]});case 7:{const e=this.value;return e.idBlock.tagClass=3,e.idBlock.tagNumber=this.type,e}case 8:{const e=new Se({value:this.value});return e.idBlock.tagClass=3,e.idBlock.tagNumber=this.type,e}default:return kt.schema()}}toJSON(){const e={type:this.type,value:""};if("string"==typeof this.value)e.value=this.value;else try{e.value=this.value.toJSON()}catch(e){}return e}}class Ct{constructor(e={}){this.accessMethod=I(e,"accessMethod",Ct.defaultValues("accessMethod")),this.accessLocation=I(e,"accessLocation",Ct.defaultValues("accessLocation")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"accessMethod":return"";case"accessLocation":return new kt;default:throw new Error(`Invalid member name for AccessDescription class: ${e}`)}}static schema(e={}){const t=I(e,"names",{});return new he({name:t.blockName||"",value:[new Se({name:t.accessMethod||""}),kt.schema(t.accessLocation||{})]})}fromSchema(e){$(e,["accessMethod","accessLocation"]);const t=tt(e,e,Ct.schema({names:{accessMethod:"accessMethod",accessLocation:{names:{blockName:"accessLocation"}}}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for AccessDescription");this.accessMethod=t.result.accessMethod.valueBlock.toString(),this.accessLocation=new kt({schema:t.result.accessLocation})}toSchema(){return new he({value:[new Se({value:this.accessMethod}),this.accessLocation.toSchema()]})}toJSON(){return{accessMethod:this.accessMethod,accessLocation:this.accessLocation.toJSON()}}}class It{constructor(e={}){this.altNames=I(e,"altNames",It.defaultValues("altNames")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"altNames":return[];default:throw new Error(`Invalid member name for AltName class: ${e}`)}}static schema(e={}){const t=I(e,"names",{});return new he({name:t.blockName||"",value:[new Qe({name:t.altNames||"",value:kt.schema()})]})}fromSchema(e){$(e,["altNames"]);const t=tt(e,e,It.schema({names:{altNames:"altNames"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for AltName");"altNames"in t.result&&(this.altNames=Array.from(t.result.altNames,(e=>new kt({schema:e}))))}toSchema(){return new he({value:Array.from(this.altNames,(e=>e.toSchema()))})}toJSON(){return{altNames:Array.from(this.altNames,(e=>e.toJSON()))}}}class Ft{constructor(e={}){this.type=I(e,"type",Ft.defaultValues("type")),this.value=I(e,"value",Ft.defaultValues("value")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"type":return 0;case"value":return new Date(0,0,0);default:throw new Error(`Invalid member name for Time class: ${e}`)}}static schema(e={},t=!1){const r=I(e,"names",{});return new ze({optional:t,value:[new Ke({name:r.utcTimeName||""}),new Me({name:r.generalTimeName||""})]})}fromSchema(e){$(e,["utcTimeName","generalTimeName"]);const t=tt(e,e,Ft.schema({names:{utcTimeName:"utcTimeName",generalTimeName:"generalTimeName"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for Time");"utcTimeName"in t.result&&(this.type=0,this.value=t.result.utcTimeName.toDate()),"generalTimeName"in t.result&&(this.type=1,this.value=t.result.generalTimeName.toDate())}toSchema(){let e={};return 0===this.type&&(e=new Ke({valueDate:this.value})),1===this.type&&(e=new Me({valueDate:this.value})),e}toJSON(){return{type:this.type,value:this.value}}}class Pt{constructor(e={}){this.attributes=I(e,"attributes",Pt.defaultValues("attributes")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"attributes":return[];default:throw new Error(`Invalid member name for SubjectDirectoryAttributes class: ${e}`)}}static schema(e={}){const t=I(e,"names",{});return new he({name:t.blockName||"",value:[new Qe({name:t.attributes||"",value:at.schema()})]})}fromSchema(e){$(e,["attributes"]);const t=tt(e,e,Pt.schema({names:{attributes:"attributes"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for SubjectDirectoryAttributes");this.attributes=Array.from(t.result.attributes,(e=>new at({schema:e})))}toSchema(){return new he({value:Array.from(this.attributes,(e=>e.toSchema()))})}toJSON(){return{attributes:Array.from(this.attributes,(e=>e.toJSON()))}}}class Nt{constructor(e={}){"notBefore"in e&&(this.notBefore=I(e,"notBefore",Nt.defaultValues("notBefore"))),"notAfter"in e&&(this.notAfter=I(e,"notAfter",Nt.defaultValues("notAfter"))),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"notBefore":case"notAfter":return new Date;default:throw new Error(`Invalid member name for PrivateKeyUsagePeriod class: ${e}`)}}static schema(e={}){const t=I(e,"names",{});return new he({name:t.blockName||"",value:[new re({name:t.notBefore||"",optional:!0,idBlock:{tagClass:3,tagNumber:0}}),new re({name:t.notAfter||"",optional:!0,idBlock:{tagClass:3,tagNumber:1}})]})}fromSchema(e){$(e,["notBefore","notAfter"]);const t=tt(e,e,Nt.schema({names:{notBefore:"notBefore",notAfter:"notAfter"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for PrivateKeyUsagePeriod");if("notBefore"in t.result){const e=new Me;e.fromBuffer(t.result.notBefore.valueBlock.valueHex),this.notBefore=e.toDate()}if("notAfter"in t.result){const e=new Me({valueHex:t.result.notAfter.valueBlock.valueHex});e.fromBuffer(t.result.notAfter.valueBlock.valueHex),this.notAfter=e.toDate()}}toSchema(){const e=[];return"notBefore"in this&&e.push(new re({idBlock:{tagClass:3,tagNumber:0},valueHex:new Me({valueDate:this.notBefore}).valueBlock.valueHex})),"notAfter"in this&&e.push(new re({idBlock:{tagClass:3,tagNumber:1},valueHex:new Me({valueDate:this.notAfter}).valueBlock.valueHex})),new he({value:e})}toJSON(){const e={};return"notBefore"in this&&(e.notBefore=this.notBefore),"notAfter"in this&&(e.notAfter=this.notAfter),e}}class Dt{constructor(e={}){this.cA=I(e,"cA",!1),"pathLenConstraint"in e&&(this.pathLenConstraint=I(e,"pathLenConstraint",0)),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"cA":return!1;default:throw new Error(`Invalid member name for BasicConstraints class: ${e}`)}}static schema(e={}){const t=I(e,"names",{});return new he({name:t.blockName||"",value:[new ue({optional:!0,name:t.cA||""}),new ye({optional:!0,name:t.pathLenConstraint||""})]})}fromSchema(e){$(e,["cA","pathLenConstraint"]);const t=tt(e,e,Dt.schema({names:{cA:"cA",pathLenConstraint:"pathLenConstraint"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for BasicConstraints");"cA"in t.result&&(this.cA=t.result.cA.valueBlock.value),"pathLenConstraint"in t.result&&(t.result.pathLenConstraint.valueBlock.isHexOnly?this.pathLenConstraint=t.result.pathLenConstraint:this.pathLenConstraint=t.result.pathLenConstraint.valueBlock.valueDec)}toSchema(){const e=[];return this.cA!==Dt.defaultValues("cA")&&e.push(new ue({value:this.cA})),"pathLenConstraint"in this&&(this.pathLenConstraint instanceof ye?e.push(this.pathLenConstraint):e.push(new ye({value:this.pathLenConstraint}))),new he({value:e})}toJSON(){const e={};return this.cA!==Dt.defaultValues("cA")&&(e.cA=this.cA),"pathLenConstraint"in this&&(this.pathLenConstraint instanceof ye?e.pathLenConstraint=this.pathLenConstraint.toJSON():e.pathLenConstraint=this.pathLenConstraint),e}}class Ht{constructor(e={}){"distributionPoint"in e&&(this.distributionPoint=I(e,"distributionPoint",Ht.defaultValues("distributionPoint"))),this.onlyContainsUserCerts=I(e,"onlyContainsUserCerts",Ht.defaultValues("onlyContainsUserCerts")),this.onlyContainsCACerts=I(e,"onlyContainsCACerts",Ht.defaultValues("onlyContainsCACerts")),"onlySomeReasons"in e&&(this.onlySomeReasons=I(e,"onlySomeReasons",Ht.defaultValues("onlySomeReasons"))),this.indirectCRL=I(e,"indirectCRL",Ht.defaultValues("indirectCRL")),this.onlyContainsAttributeCerts=I(e,"onlyContainsAttributeCerts",Ht.defaultValues("onlyContainsAttributeCerts")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"distributionPoint":return[];case"onlyContainsUserCerts":case"onlyContainsCACerts":return!1;case"onlySomeReasons":return 0;case"indirectCRL":case"onlyContainsAttributeCerts":return!1;default:throw new Error(`Invalid member name for IssuingDistributionPoint class: ${e}`)}}static schema(e={}){const t=I(e,"names",{});return new he({name:t.blockName||"",value:[new ie({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new ze({value:[new ie({name:t.distributionPoint||"",idBlock:{tagClass:3,tagNumber:0},value:[new Qe({name:t.distributionPointNames||"",value:kt.schema()})]}),new ie({name:t.distributionPoint||"",idBlock:{tagClass:3,tagNumber:1},value:At.schema().valueBlock.value})]})]}),new re({name:t.onlyContainsUserCerts||"",optional:!0,idBlock:{tagClass:3,tagNumber:1}}),new re({name:t.onlyContainsCACerts||"",optional:!0,idBlock:{tagClass:3,tagNumber:2}}),new re({name:t.onlySomeReasons||"",optional:!0,idBlock:{tagClass:3,tagNumber:3}}),new re({name:t.indirectCRL||"",optional:!0,idBlock:{tagClass:3,tagNumber:4}}),new re({name:t.onlyContainsAttributeCerts||"",optional:!0,idBlock:{tagClass:3,tagNumber:5}})]})}fromSchema(e){$(e,["distributionPoint","distributionPointNames","onlyContainsUserCerts","onlyContainsCACerts","onlySomeReasons","indirectCRL","onlyContainsAttributeCerts"]);const t=tt(e,e,Ht.schema({names:{distributionPoint:"distributionPoint",distributionPointNames:"distributionPointNames",onlyContainsUserCerts:"onlyContainsUserCerts",onlyContainsCACerts:"onlyContainsCACerts",onlySomeReasons:"onlySomeReasons",indirectCRL:"indirectCRL",onlyContainsAttributeCerts:"onlyContainsAttributeCerts"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for IssuingDistributionPoint");if("distributionPoint"in t.result)switch(!0){case 0===t.result.distributionPoint.idBlock.tagNumber:this.distributionPoint=Array.from(t.result.distributionPointNames,(e=>new kt({schema:e})));break;case 1===t.result.distributionPoint.idBlock.tagNumber:this.distributionPoint=new At({schema:new he({value:t.result.distributionPoint.valueBlock.value})});break;default:throw new Error("Unknown tagNumber for distributionPoint: {$asn1.result.distributionPoint.idBlock.tagNumber}")}if("onlyContainsUserCerts"in t.result){const e=new Uint8Array(t.result.onlyContainsUserCerts.valueBlock.valueHex);this.onlyContainsUserCerts=0!==e[0]}if("onlyContainsCACerts"in t.result){const e=new Uint8Array(t.result.onlyContainsCACerts.valueBlock.valueHex);this.onlyContainsCACerts=0!==e[0]}if("onlySomeReasons"in t.result){const e=new Uint8Array(t.result.onlySomeReasons.valueBlock.valueHex);this.onlySomeReasons=e[0]}if("indirectCRL"in t.result){const e=new Uint8Array(t.result.indirectCRL.valueBlock.valueHex);this.indirectCRL=0!==e[0]}if("onlyContainsAttributeCerts"in t.result){const e=new Uint8Array(t.result.onlyContainsAttributeCerts.valueBlock.valueHex);this.onlyContainsAttributeCerts=0!==e[0]}}toSchema(){const e=[];if("distributionPoint"in this){let t;this.distributionPoint instanceof Array?t=new ie({idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.distributionPoint,(e=>e.toSchema()))}):(t=this.distributionPoint.toSchema(),t.idBlock.tagClass=3,t.idBlock.tagNumber=1),e.push(new ie({idBlock:{tagClass:3,tagNumber:0},value:[t]}))}if(this.onlyContainsUserCerts!==Ht.defaultValues("onlyContainsUserCerts")&&e.push(new re({idBlock:{tagClass:3,tagNumber:1},valueHex:new Uint8Array([255]).buffer})),this.onlyContainsCACerts!==Ht.defaultValues("onlyContainsCACerts")&&e.push(new re({idBlock:{tagClass:3,tagNumber:2},valueHex:new Uint8Array([255]).buffer})),"onlySomeReasons"in this){const t=new ArrayBuffer(1);new Uint8Array(t)[0]=this.onlySomeReasons,e.push(new re({idBlock:{tagClass:3,tagNumber:3},valueHex:t}))}return this.indirectCRL!==Ht.defaultValues("indirectCRL")&&e.push(new re({idBlock:{tagClass:3,tagNumber:4},valueHex:new Uint8Array([255]).buffer})),this.onlyContainsAttributeCerts!==Ht.defaultValues("onlyContainsAttributeCerts")&&e.push(new re({idBlock:{tagClass:3,tagNumber:5},valueHex:new Uint8Array([255]).buffer})),new he({value:e})}toJSON(){const e={};return"distributionPoint"in this&&(this.distributionPoint instanceof Array?e.distributionPoint=Array.from(this.distributionPoint,(e=>e.toJSON())):e.distributionPoint=this.distributionPoint.toJSON()),this.onlyContainsUserCerts!==Ht.defaultValues("onlyContainsUserCerts")&&(e.onlyContainsUserCerts=this.onlyContainsUserCerts),this.onlyContainsCACerts!==Ht.defaultValues("onlyContainsCACerts")&&(e.onlyContainsCACerts=this.onlyContainsCACerts),"onlySomeReasons"in this&&(e.onlySomeReasons=this.onlySomeReasons),this.indirectCRL!==Ht.defaultValues("indirectCRL")&&(e.indirectCRL=this.indirectCRL),this.onlyContainsAttributeCerts!==Ht.defaultValues("onlyContainsAttributeCerts")&&(e.onlyContainsAttributeCerts=this.onlyContainsAttributeCerts),e}}class Rt{constructor(e={}){this.names=I(e,"names",Rt.defaultValues("names")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"names":return[];default:throw new Error(`Invalid member name for GeneralNames class: ${e}`)}}static schema(e={},t=!1){const r=I(e,"names",{});return new he({optional:t,name:r.blockName||"",value:[new Qe({name:r.generalNames||"",value:kt.schema()})]})}fromSchema(e){$(e,["names","generalNames"]);const t=tt(e,e,Rt.schema({names:{blockName:"names",generalNames:"generalNames"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for GeneralNames");this.names=Array.from(t.result.generalNames,(e=>new kt({schema:e})))}toSchema(){return new he({value:Array.from(this.names,(e=>e.toSchema()))})}toJSON(){return{names:Array.from(this.names,(e=>e.toJSON()))}}}class Ot{constructor(e={}){this.base=I(e,"base",Ot.defaultValues("base")),this.minimum=I(e,"minimum",Ot.defaultValues("minimum")),"maximum"in e&&(this.maximum=I(e,"maximum",Ot.defaultValues("maximum"))),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"base":return new kt;case"minimum":case"maximum":return 0;default:throw new Error(`Invalid member name for GeneralSubtree class: ${e}`)}}static schema(e={}){const t=I(e,"names",{});return new he({name:t.blockName||"",value:[kt.schema(t.base||{}),new ie({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new ye({name:t.minimum||""})]}),new ie({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new ye({name:t.maximum||""})]})]})}fromSchema(e){$(e,["base","minimum","maximum"]);const t=tt(e,e,Ot.schema({names:{base:{names:{blockName:"base"}},minimum:"minimum",maximum:"maximum"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for GeneralSubtree");this.base=new kt({schema:t.result.base}),"minimum"in t.result&&(t.result.minimum.valueBlock.isHexOnly?this.minimum=t.result.minimum:this.minimum=t.result.minimum.valueBlock.valueDec),"maximum"in t.result&&(t.result.maximum.valueBlock.isHexOnly?this.maximum=t.result.maximum:this.maximum=t.result.maximum.valueBlock.valueDec)}toSchema(){const e=[];if(e.push(this.base.toSchema()),0!==this.minimum){let t=0;t=this.minimum instanceof ye?this.minimum:new ye({value:this.minimum}),e.push(new ie({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[t]}))}if("maximum"in this){let t=0;t=this.maximum instanceof ye?this.maximum:new ye({value:this.maximum}),e.push(new ie({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[t]}))}return new he({value:e})}toJSON(){const e={base:this.base.toJSON()};return 0!==this.minimum&&("number"==typeof this.minimum?e.minimum=this.minimum:e.minimum=this.minimum.toJSON()),"maximum"in this&&("number"==typeof this.maximum?e.maximum=this.maximum:e.maximum=this.maximum.toJSON()),e}}class Tt{constructor(e={}){"permittedSubtrees"in e&&(this.permittedSubtrees=I(e,"permittedSubtrees",Tt.defaultValues("permittedSubtrees"))),"excludedSubtrees"in e&&(this.excludedSubtrees=I(e,"excludedSubtrees",Tt.defaultValues("excludedSubtrees"))),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"permittedSubtrees":case"excludedSubtrees":return[];default:throw new Error(`Invalid member name for NameConstraints class: ${e}`)}}static schema(e={}){const t=I(e,"names",{});return new he({name:t.blockName||"",value:[new ie({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new Qe({name:t.permittedSubtrees||"",value:Ot.schema()})]}),new ie({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new Qe({name:t.excludedSubtrees||"",value:Ot.schema()})]})]})}fromSchema(e){$(e,["permittedSubtrees","excludedSubtrees"]);const t=tt(e,e,Tt.schema({names:{permittedSubtrees:"permittedSubtrees",excludedSubtrees:"excludedSubtrees"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for NameConstraints");"permittedSubtrees"in t.result&&(this.permittedSubtrees=Array.from(t.result.permittedSubtrees,(e=>new Ot({schema:e})))),"excludedSubtrees"in t.result&&(this.excludedSubtrees=Array.from(t.result.excludedSubtrees,(e=>new Ot({schema:e}))))}toSchema(){const e=[];return"permittedSubtrees"in this&&e.push(new ie({idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.permittedSubtrees,(e=>e.toSchema()))})),"excludedSubtrees"in this&&e.push(new ie({idBlock:{tagClass:3,tagNumber:1},value:Array.from(this.excludedSubtrees,(e=>e.toSchema()))})),new he({value:e})}toJSON(){const e={};return"permittedSubtrees"in this&&(e.permittedSubtrees=Array.from(this.permittedSubtrees,(e=>e.toJSON()))),"excludedSubtrees"in this&&(e.excludedSubtrees=Array.from(this.excludedSubtrees,(e=>e.toJSON()))),e}}class Lt{constructor(e={}){"distributionPoint"in e&&(this.distributionPoint=I(e,"distributionPoint",Lt.defaultValues("distributionPoint"))),"reasons"in e&&(this.reasons=I(e,"reasons",Lt.defaultValues("reasons"))),"cRLIssuer"in e&&(this.cRLIssuer=I(e,"cRLIssuer",Lt.defaultValues("cRLIssuer"))),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"distributionPoint":return[];case"reasons":return new pe;case"cRLIssuer":return[];default:throw new Error(`Invalid member name for DistributionPoint class: ${e}`)}}static schema(e={}){const t=I(e,"names",{});return new he({name:t.blockName||"",value:[new ie({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new ze({value:[new ie({name:t.distributionPoint||"",optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new Qe({name:t.distributionPointNames||"",value:kt.schema()})]}),new ie({name:t.distributionPoint||"",optional:!0,idBlock:{tagClass:3,tagNumber:1},value:At.schema().valueBlock.value})]})]}),new re({name:t.reasons||"",optional:!0,idBlock:{tagClass:3,tagNumber:1}}),new ie({name:t.cRLIssuer||"",optional:!0,idBlock:{tagClass:3,tagNumber:2},value:[new Qe({name:t.cRLIssuerNames||"",value:kt.schema()})]})]})}fromSchema(e){$(e,["distributionPoint","distributionPointNames","reasons","cRLIssuer","cRLIssuerNames"]);const t=tt(e,e,Lt.schema({names:{distributionPoint:"distributionPoint",distributionPointNames:"distributionPointNames",reasons:"reasons",cRLIssuer:"cRLIssuer",cRLIssuerNames:"cRLIssuerNames"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for DistributionPoint");"distributionPoint"in t.result&&(0===t.result.distributionPoint.idBlock.tagNumber&&(this.distributionPoint=Array.from(t.result.distributionPointNames,(e=>new kt({schema:e})))),1===t.result.distributionPoint.idBlock.tagNumber&&(this.distributionPoint=new At({schema:new he({value:t.result.distributionPoint.valueBlock.value})}))),"reasons"in t.result&&(this.reasons=new pe({valueHex:t.result.reasons.valueBlock.valueHex})),"cRLIssuer"in t.result&&(this.cRLIssuer=Array.from(t.result.cRLIssuerNames,(e=>new kt({schema:e}))))}toSchema(){const e=[];if("distributionPoint"in this){let t;t=this.distributionPoint instanceof Array?new ie({idBlock:{tagClass:3,tagNumber:0},value:Array.from(this.distributionPoint,(e=>e.toSchema()))}):new ie({idBlock:{tagClass:3,tagNumber:1},value:[this.distributionPoint.toSchema()]}),e.push(new ie({idBlock:{tagClass:3,tagNumber:0},value:[t]}))}return"reasons"in this&&e.push(new re({idBlock:{tagClass:3,tagNumber:1},valueHex:this.reasons.valueBlock.valueHex})),"cRLIssuer"in this&&e.push(new ie({idBlock:{tagClass:3,tagNumber:2},value:Array.from(this.cRLIssuer,(e=>e.toSchema()))})),new he({value:e})}toJSON(){const e={};return"distributionPoint"in this&&(this.distributionPoint instanceof Array?e.distributionPoint=Array.from(this.distributionPoint,(e=>e.toJSON())):e.distributionPoint=this.distributionPoint.toJSON()),"reasons"in this&&(e.reasons=this.reasons.toJSON()),"cRLIssuer"in this&&(e.cRLIssuer=Array.from(this.cRLIssuer,(e=>e.toJSON()))),e}}class jt{constructor(e={}){this.distributionPoints=I(e,"distributionPoints",jt.defaultValues("distributionPoints")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"distributionPoints":return[];default:throw new Error(`Invalid member name for CRLDistributionPoints class: ${e}`)}}static schema(e={}){const t=I(e,"names",{});return new he({name:t.blockName||"",value:[new Qe({name:t.distributionPoints||"",value:Lt.schema()})]})}fromSchema(e){$(e,["distributionPoints"]);const t=tt(e,e,jt.schema({names:{distributionPoints:"distributionPoints"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for CRLDistributionPoints");this.distributionPoints=Array.from(t.result.distributionPoints,(e=>new Lt({schema:e})))}toSchema(){return new he({value:Array.from(this.distributionPoints,(e=>e.toSchema()))})}toJSON(){return{distributionPoints:Array.from(this.distributionPoints,(e=>e.toJSON()))}}}class Vt{constructor(e={}){this.policyQualifierId=I(e,"policyQualifierId",Vt.defaultValues("policyQualifierId")),this.qualifier=I(e,"qualifier",Vt.defaultValues("qualifier")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"policyQualifierId":return"";case"qualifier":return new Xe;default:throw new Error(`Invalid member name for PolicyQualifierInfo class: ${e}`)}}static schema(e={}){const t=I(e,"names",{});return new he({name:t.blockName||"",value:[new Se({name:t.policyQualifierId||""}),new Xe({name:t.qualifier||""})]})}fromSchema(e){$(e,["policyQualifierId","qualifier"]);const t=tt(e,e,Vt.schema({names:{policyQualifierId:"policyQualifierId",qualifier:"qualifier"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for PolicyQualifierInfo");this.policyQualifierId=t.result.policyQualifierId.valueBlock.toString(),this.qualifier=t.result.qualifier}toSchema(){return new he({value:[new Se({value:this.policyQualifierId}),this.qualifier]})}toJSON(){return{policyQualifierId:this.policyQualifierId,qualifier:this.qualifier.toJSON()}}}class Ut{constructor(e={}){this.policyIdentifier=I(e,"policyIdentifier",Ut.defaultValues("policyIdentifier")),"policyQualifiers"in e&&(this.policyQualifiers=I(e,"policyQualifiers",Ut.defaultValues("policyQualifiers"))),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"policyIdentifier":return"";case"policyQualifiers":return[];default:throw new Error(`Invalid member name for PolicyInformation class: ${e}`)}}static schema(e={}){const t=I(e,"names",{});return new he({name:t.blockName||"",value:[new Se({name:t.policyIdentifier||""}),new he({optional:!0,value:[new Qe({name:t.policyQualifiers||"",value:Vt.schema()})]})]})}fromSchema(e){$(e,["policyIdentifier","policyQualifiers"]);const t=tt(e,e,Ut.schema({names:{policyIdentifier:"policyIdentifier",policyQualifiers:"policyQualifiers"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for PolicyInformation");this.policyIdentifier=t.result.policyIdentifier.valueBlock.toString(),"policyQualifiers"in t.result&&(this.policyQualifiers=Array.from(t.result.policyQualifiers,(e=>new Vt({schema:e}))))}toSchema(){const e=[];return e.push(new Se({value:this.policyIdentifier})),"policyQualifiers"in this&&e.push(new he({value:Array.from(this.policyQualifiers,(e=>e.toSchema()))})),new he({value:e})}toJSON(){const e={policyIdentifier:this.policyIdentifier};return"policyQualifiers"in this&&(e.policyQualifiers=Array.from(this.policyQualifiers,(e=>e.toJSON()))),e}}class _t{constructor(e={}){this.certificatePolicies=I(e,"certificatePolicies",_t.defaultValues("certificatePolicies")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"certificatePolicies":return[];default:throw new Error(`Invalid member name for CertificatePolicies class: ${e}`)}}static schema(e={}){const t=I(e,"names",{});return new he({name:t.blockName||"",value:[new Qe({name:t.certificatePolicies||"",value:Ut.schema()})]})}fromSchema(e){$(e,["certificatePolicies"]);const t=tt(e,e,_t.schema({names:{certificatePolicies:"certificatePolicies"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for CertificatePolicies");this.certificatePolicies=Array.from(t.result.certificatePolicies,(e=>new Ut({schema:e})))}toSchema(){return new he({value:Array.from(this.certificatePolicies,(e=>e.toSchema()))})}toJSON(){return{certificatePolicies:Array.from(this.certificatePolicies,(e=>e.toJSON()))}}}class Kt{constructor(e={}){this.issuerDomainPolicy=I(e,"issuerDomainPolicy",Kt.defaultValues("issuerDomainPolicy")),this.subjectDomainPolicy=I(e,"subjectDomainPolicy",Kt.defaultValues("subjectDomainPolicy")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"issuerDomainPolicy":case"subjectDomainPolicy":return"";default:throw new Error(`Invalid member name for PolicyMapping class: ${e}`)}}static schema(e={}){const t=I(e,"names",{});return new he({name:t.blockName||"",value:[new Se({name:t.issuerDomainPolicy||""}),new Se({name:t.subjectDomainPolicy||""})]})}fromSchema(e){$(e,["issuerDomainPolicy","subjectDomainPolicy"]);const t=tt(e,e,Kt.schema({names:{issuerDomainPolicy:"issuerDomainPolicy",subjectDomainPolicy:"subjectDomainPolicy"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for PolicyMapping");this.issuerDomainPolicy=t.result.issuerDomainPolicy.valueBlock.toString(),this.subjectDomainPolicy=t.result.subjectDomainPolicy.valueBlock.toString()}toSchema(){return new he({value:[new Se({value:this.issuerDomainPolicy}),new Se({value:this.subjectDomainPolicy})]})}toJSON(){return{issuerDomainPolicy:this.issuerDomainPolicy,subjectDomainPolicy:this.subjectDomainPolicy}}}class Mt{constructor(e={}){this.mappings=I(e,"mappings",Mt.defaultValues("mappings")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"mappings":return[];default:throw new Error(`Invalid member name for PolicyMappings class: ${e}`)}}static schema(e={}){const t=I(e,"names",{});return new he({name:t.blockName||"",value:[new Qe({name:t.mappings||"",value:Kt.schema()})]})}fromSchema(e){$(e,["mappings"]);const t=tt(e,e,Mt.schema({names:{mappings:"mappings"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for PolicyMappings");this.mappings=Array.from(t.result.mappings,(e=>new Kt({schema:e})))}toSchema(){return new he({value:Array.from(this.mappings,(e=>e.toSchema()))})}toJSON(){return{mappings:Array.from(this.mappings,(e=>e.toJSON()))}}}class qt{constructor(e={}){"keyIdentifier"in e&&(this.keyIdentifier=I(e,"keyIdentifier",qt.defaultValues("keyIdentifier"))),"authorityCertIssuer"in e&&(this.authorityCertIssuer=I(e,"authorityCertIssuer",qt.defaultValues("authorityCertIssuer"))),"authorityCertSerialNumber"in e&&(this.authorityCertSerialNumber=I(e,"authorityCertSerialNumber",qt.defaultValues("authorityCertSerialNumber"))),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"keyIdentifier":return new ge;case"authorityCertIssuer":return[];case"authorityCertSerialNumber":return new ye;default:throw new Error(`Invalid member name for AuthorityKeyIdentifier class: ${e}`)}}static schema(e={}){const t=I(e,"names",{});return new he({name:t.blockName||"",value:[new re({name:t.keyIdentifier||"",optional:!0,idBlock:{tagClass:3,tagNumber:0}}),new ie({optional:!0,idBlock:{tagClass:3,tagNumber:1},value:[new Qe({name:t.authorityCertIssuer||"",value:kt.schema()})]}),new re({name:t.authorityCertSerialNumber||"",optional:!0,idBlock:{tagClass:3,tagNumber:2}})]})}fromSchema(e){$(e,["keyIdentifier","authorityCertIssuer","authorityCertSerialNumber"]);const t=tt(e,e,qt.schema({names:{keyIdentifier:"keyIdentifier",authorityCertIssuer:"authorityCertIssuer",authorityCertSerialNumber:"authorityCertSerialNumber"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for AuthorityKeyIdentifier");"keyIdentifier"in t.result&&(this.keyIdentifier=new ge({valueHex:t.result.keyIdentifier.valueBlock.valueHex})),"authorityCertIssuer"in t.result&&(this.authorityCertIssuer=Array.from(t.result.authorityCertIssuer,(e=>new kt({schema:e})))),"authorityCertSerialNumber"in t.result&&(this.authorityCertSerialNumber=new ye({valueHex:t.result.authorityCertSerialNumber.valueBlock.valueHex}))}toSchema(){const e=[];return"keyIdentifier"in this&&e.push(new re({idBlock:{tagClass:3,tagNumber:0},valueHex:this.keyIdentifier.valueBlock.valueHex})),"authorityCertIssuer"in this&&e.push(new ie({idBlock:{tagClass:3,tagNumber:1},value:Array.from(this.authorityCertIssuer,(e=>e.toSchema()))})),"authorityCertSerialNumber"in this&&e.push(new re({idBlock:{tagClass:3,tagNumber:2},valueHex:this.authorityCertSerialNumber.valueBlock.valueHex})),new he({value:e})}toJSON(){const e={};return"keyIdentifier"in this&&(e.keyIdentifier=this.keyIdentifier.toJSON()),"authorityCertIssuer"in this&&(e.authorityCertIssuer=Array.from(this.authorityCertIssuer,(e=>e.toJSON()))),"authorityCertSerialNumber"in this&&(e.authorityCertSerialNumber=this.authorityCertSerialNumber.toJSON()),e}}class Jt{constructor(e={}){"requireExplicitPolicy"in e&&(this.requireExplicitPolicy=I(e,"requireExplicitPolicy",Jt.defaultValues("requireExplicitPolicy"))),"inhibitPolicyMapping"in e&&(this.inhibitPolicyMapping=I(e,"inhibitPolicyMapping",Jt.defaultValues("inhibitPolicyMapping"))),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"requireExplicitPolicy":case"inhibitPolicyMapping":return 0;default:throw new Error(`Invalid member name for PolicyConstraints class: ${e}`)}}static schema(e={}){const t=I(e,"names",{});return new he({name:t.blockName||"",value:[new re({name:t.requireExplicitPolicy||"",optional:!0,idBlock:{tagClass:3,tagNumber:0}}),new re({name:t.inhibitPolicyMapping||"",optional:!0,idBlock:{tagClass:3,tagNumber:1}})]})}fromSchema(e){$(e,["requireExplicitPolicy","inhibitPolicyMapping"]);const t=tt(e,e,Jt.schema({names:{requireExplicitPolicy:"requireExplicitPolicy",inhibitPolicyMapping:"inhibitPolicyMapping"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for PolicyConstraints");if("requireExplicitPolicy"in t.result){const e=t.result.requireExplicitPolicy;e.idBlock.tagClass=1,e.idBlock.tagNumber=2;const r=et(e.toBER(!1));this.requireExplicitPolicy=r.result.valueBlock.valueDec}if("inhibitPolicyMapping"in t.result){const e=t.result.inhibitPolicyMapping;e.idBlock.tagClass=1,e.idBlock.tagNumber=2;const r=et(e.toBER(!1));this.inhibitPolicyMapping=r.result.valueBlock.valueDec}}toSchema(){const e=[];if("requireExplicitPolicy"in this){const t=new ye({value:this.requireExplicitPolicy});t.idBlock.tagClass=3,t.idBlock.tagNumber=0,e.push(t)}if("inhibitPolicyMapping"in this){const t=new ye({value:this.inhibitPolicyMapping});t.idBlock.tagClass=3,t.idBlock.tagNumber=1,e.push(t)}return new he({value:e})}toJSON(){const e={};return"requireExplicitPolicy"in this&&(e.requireExplicitPolicy=this.requireExplicitPolicy),"inhibitPolicyMapping"in this&&(e.inhibitPolicyMapping=this.inhibitPolicyMapping),e}}class $t{constructor(e={}){this.keyPurposes=I(e,"keyPurposes",$t.defaultValues("keyPurposes")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"keyPurposes":return[];default:throw new Error(`Invalid member name for ExtKeyUsage class: ${e}`)}}static schema(e={}){const t=I(e,"names",{});return new he({name:t.blockName||"",value:[new Qe({name:t.keyPurposes||"",value:new Se})]})}fromSchema(e){$(e,["keyPurposes"]);const t=tt(e,e,$t.schema({names:{keyPurposes:"keyPurposes"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for ExtKeyUsage");this.keyPurposes=Array.from(t.result.keyPurposes,(e=>e.valueBlock.toString()))}toSchema(){return new he({value:Array.from(this.keyPurposes,(e=>new Se({value:e})))})}toJSON(){return{keyPurposes:Array.from(this.keyPurposes)}}}class Gt{constructor(e={}){this.accessDescriptions=I(e,"accessDescriptions",Gt.defaultValues("accessDescriptions")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"accessDescriptions":return[];default:throw new Error(`Invalid member name for InfoAccess class: ${e}`)}}static schema(e={}){const t=I(e,"names",{});return new he({name:t.blockName||"",value:[new Qe({name:t.accessDescriptions||"",value:Ct.schema()})]})}fromSchema(e){$(e,["accessDescriptions"]);const t=tt(e,e,Gt.schema({names:{accessDescriptions:"accessDescriptions"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for InfoAccess");this.accessDescriptions=Array.from(t.result.accessDescriptions,(e=>new Ct({schema:e})))}toSchema(){return new he({value:Array.from(this.accessDescriptions,(e=>e.toSchema()))})}toJSON(){return{accessDescriptions:Array.from(this.accessDescriptions,(e=>e.toJSON()))}}}class Wt{constructor(e={}){this.clear();for(const t of Object.keys(e))switch(t){case"length":this.length=e.length;break;case"stub":for(let t=0;t<this._view.length;t++)this._view[t]=e.stub;break;case"view":this.fromUint8Array(e.view);break;case"buffer":this.fromArrayBuffer(e.buffer);break;case"string":this.fromString(e.string);break;case"hexstring":this.fromHexString(e.hexstring)}}set buffer(e){this._buffer=e.slice(0),this._view=new Uint8Array(this._buffer)}get buffer(){return this._buffer}set view(e){this._buffer=new ArrayBuffer(e.length),this._view=new Uint8Array(this._buffer),this._view.set(e)}get view(){return this._view}get length(){return this._buffer.byteLength}set length(e){this._buffer=new ArrayBuffer(e),this._view=new Uint8Array(this._buffer)}clear(){this._buffer=new ArrayBuffer(0),this._view=new Uint8Array(this._buffer)}fromArrayBuffer(e){this.buffer=e}fromUint8Array(e){this._buffer=new ArrayBuffer(e.length),this._view=new Uint8Array(this._buffer),this._view.set(e)}fromString(e){const t=e.length;this.length=t;for(let r=0;r<t;r++)this.view[r]=e.charCodeAt(r)}toString(e=0,t=this.view.length-e){let r="";(e>=this.view.length||e<0)&&(e=0),(t>=this.view.length||t<0)&&(t=this.view.length-e);for(let n=e;n<e+t;n++)r+=String.fromCharCode(this.view[n]);return r}fromHexString(e){const t=e.length;this.buffer=new ArrayBuffer(t>>1),this.view=new Uint8Array(this.buffer);const r=new Map;r.set("0",0),r.set("1",1),r.set("2",2),r.set("3",3),r.set("4",4),r.set("5",5),r.set("6",6),r.set("7",7),r.set("8",8),r.set("9",9),r.set("A",10),r.set("a",10),r.set("B",11),r.set("b",11),r.set("C",12),r.set("c",12),r.set("D",13),r.set("d",13),r.set("E",14),r.set("e",14),r.set("F",15),r.set("f",15);let n=0,i=0;for(let s=0;s<t;s++)s%2?(i|=r.get(e.charAt(s)),this.view[n]=i,n++):i=r.get(e.charAt(s))<<4}toHexString(e=0,t=this.view.length-e){let r="";(e>=this.view.length||e<0)&&(e=0),(t>=this.view.length||t<0)&&(t=this.view.length-e);for(let n=e;n<e+t;n++){const e=this.view[n].toString(16).toUpperCase();r=r+(1==e.length?"0":"")+e}return r}copy(e=0,t=this._buffer.byteLength-e){if(0===e&&0===this._buffer.byteLength)return new Wt;if(e<0||e>this._buffer.byteLength-1)throw new Error(`Wrong start position: ${e}`);const r=new Wt;return r._buffer=this._buffer.slice(e,e+t),r._view=new Uint8Array(r._buffer),r}slice(e=0,t=this._buffer.byteLength){if(0===e&&0===this._buffer.byteLength)return new Wt;if(e<0||e>this._buffer.byteLength-1)throw new Error(`Wrong start position: ${e}`);const r=new Wt;return r._buffer=this._buffer.slice(e,t),r._view=new Uint8Array(r._buffer),r}realloc(e){const t=new ArrayBuffer(e),r=new Uint8Array(t);e>this._view.length?r.set(this._view):r.set(new Uint8Array(this._buffer,0,e)),this._buffer=t.slice(0),this._view=new Uint8Array(this._buffer)}append(e){const t=this._buffer.byteLength,r=e._buffer.byteLength,n=e._view.slice();this.realloc(t+r),this._view.set(n,t)}insert(e,t=0,r=this._buffer.byteLength-t){return!(t>this._buffer.byteLength-1)&&(r>this._buffer.byteLength-t&&(r=this._buffer.byteLength-t),r>e._buffer.byteLength&&(r=e._buffer.byteLength),r==e._buffer.byteLength?this._view.set(e._view,t):this._view.set(e._view.slice(0,r),t),!0)}isEqual(e){if(this._buffer.byteLength!=e._buffer.byteLength)return!1;for(let t=0;t<e._buffer.byteLength;t++)if(this.view[t]!=e.view[t])return!1;return!0}isEqualView(e){if(e.length!=this.view.length)return!1;for(let t=0;t<e.length;t++)if(this.view[t]!=e[t])return!1;return!0}findPattern(e,t=null,r=null,n=!1){null==t&&(t=n?this.buffer.byteLength:0),t>this.buffer.byteLength&&(t=this.buffer.byteLength),n?(null==r&&(r=t),r>t&&(r=t)):(null==r&&(r=this.buffer.byteLength-t),r>this.buffer.byteLength-t&&(r=this.buffer.byteLength-t));const i=e.buffer.byteLength;if(i>r)return-1;const s=[];for(let t=0;t<i;t++)s.push(e.view[t]);for(let e=0;e<=r-i;e++){let r=!0;const a=n?t-i-e:t+e;for(let e=0;e<i;e++)if(this.view[e+a]!=s[e]){r=!1;break}if(r)return n?t-i-e:t+i+e}return-1}findFirstIn(e,t=null,r=null,n=!1){null==t&&(t=n?this.buffer.byteLength:0),t>this.buffer.byteLength&&(t=this.buffer.byteLength),n?(null==r&&(r=t),r>t&&(r=t)):(null==r&&(r=this.buffer.byteLength-t),r>this.buffer.byteLength-t&&(r=this.buffer.byteLength-t));const i={id:-1,position:n?0:t+r,length:0};for(let s=0;s<e.length;s++){const a=this.findPattern(e[s],t,r,n);if(-1!=a){let t=!1;const r=e[s].length;n?a-r>=i.position-i.length&&(t=!0):a-r<=i.position-i.length&&(t=!0),t&&(i.position=a,i.id=s,i.length=r)}}return i}findAllIn(e,t=0,r=this.buffer.byteLength-t){const n=[];if(null==t&&(t=0),t>this.buffer.byteLength-1)return n;null==r&&(r=this.buffer.byteLength-t),r>this.buffer.byteLength-t&&(r=this.buffer.byteLength-t);let i={id:-1,position:t};for(;;){const t=i.position;if(i=this.findFirstIn(e,i.position,r),-1==i.id)break;r-=i.position-t,n.push({id:i.id,position:i.position})}return n}findAllPatternIn(e,t=0,r=this.buffer.byteLength-t){null==t&&(t=0),t>this.buffer.byteLength&&(t=this.buffer.byteLength),null==r&&(r=this.buffer.byteLength-t),r>this.buffer.byteLength-t&&(r=this.buffer.byteLength-t);const n=[],i=e.buffer.byteLength;if(i>r)return-1;const s=Array.from(e.view);for(let e=0;e<=r-i;e++){let r=!0;const a=t+e;for(let e=0;e<i;e++)if(this.view[e+a]!=s[e]){r=!1;break}r&&(n.push(t+i+e),e+=i-1)}return n}findFirstNotIn(e,t=null,r=null,n=!1){null==t&&(t=n?this.buffer.byteLength:0),t>this.buffer.byteLength&&(t=this.buffer.byteLength),n?(null==r&&(r=t),r>t&&(r=t)):(null==r&&(r=this.buffer.byteLength-t),r>this.buffer.byteLength-t&&(r=this.buffer.byteLength-t));const i={left:{id:-1,position:t},right:{id:-1,position:0},value:new Wt};let s=r;for(;s>0;){if(i.right=this.findFirstIn(e,n?t-r+s:t+r-s,s,n),-1==i.right.id){r=s,n?t-=r:t=i.left.position,i.value=new Wt,i.value._buffer=this._buffer.slice(t,t+r),i.value._view=new Uint8Array(i.value._buffer);break}if(i.right.position!=(n?i.left.position-e[i.right.id].buffer.byteLength:i.left.position+e[i.right.id].buffer.byteLength)){n?(t=i.right.position+e[i.right.id].buffer.byteLength,r=i.left.position-i.right.position-e[i.right.id].buffer.byteLength):(t=i.left.position,r=i.right.position-i.left.position-e[i.right.id].buffer.byteLength),i.value=new Wt,i.value._buffer=this._buffer.slice(t,t+r),i.value._view=new Uint8Array(i.value._buffer);break}i.left=i.right,s-=e[i.right.id]._buffer.byteLength}if(n){const e=i.right;i.right=i.left,i.left=e}return i}findAllNotIn(e,t=null,r=null){const n=[];if(null==t&&(t=0),t>this.buffer.byteLength-1)return n;null==r&&(r=this.buffer.byteLength-t),r>this.buffer.byteLength-t&&(r=this.buffer.byteLength-t);let i={left:{id:-1,position:t},right:{id:-1,position:t},value:new Wt};do{const t=i.right.position;i=this.findFirstNotIn(e,i.right.position,r),r-=i.right.position-t,n.push({left:{id:i.left.id,position:i.left.position},right:{id:i.right.id,position:i.right.position},value:i.value})}while(-1!=i.right.id);return n}findFirstSequence(e,t=null,r=null,n=!1){null==t&&(t=n?this.buffer.byteLength:0),t>this.buffer.byteLength&&(t=this.buffer.byteLength),n?(null==r&&(r=t),r>t&&(r=t)):(null==r&&(r=this.buffer.byteLength-t),r>this.buffer.byteLength-t&&(r=this.buffer.byteLength-t));const i=this.skipNotPatterns(e,t,r,n);if(-1==i)return{position:-1,value:new Wt};const s=this.skipPatterns(e,i,r-(n?t-i:i-t),n);n?(t=s,r=i-s):(t=i,r=s-i);const a=new Wt;return a._buffer=this._buffer.slice(t,t+r),a._view=new Uint8Array(a._buffer),{position:s,value:a}}findAllSequences(e,t=null,r=null){const n=[];if(null==t&&(t=0),t>this.buffer.byteLength-1)return n;null==r&&(r=this.buffer.byteLength-t),r>this.buffer.byteLength-t&&(r=this.buffer.byteLength-t);let i={position:t,value:new Wt};do{const t=i.position;i=this.findFirstSequence(e,i.position,r),-1!=i.position&&(r-=i.position-t,n.push({position:i.position,value:i.value}))}while(-1!=i.position);return n}findPairedPatterns(e,t,r=null,n=null){const i=[];if(e.isEqual(t))return i;if(null==r&&(r=0),r>this.buffer.byteLength-1)return i;null==n&&(n=this.buffer.byteLength-r),n>this.buffer.byteLength-r&&(n=this.buffer.byteLength-r);let s=0;const a=this.findAllPatternIn(e,r,n);if(0==a.length)return i;const o=this.findAllPatternIn(t,r,n);if(0==o.length)return i;for(;s<a.length&&0!=o.length;)if(a[0]!=o[0]){if(a[s]>o[0])break;for(;a[s]<o[0]&&(s++,!(s>=a.length)););i.push({left:a[s-1],right:o[0]}),a.splice(s-1,1),o.splice(0,1),s=0}else i.push({left:a[0],right:o[0]}),a.splice(0,1),o.splice(0,1);return i.sort(((e,t)=>e.left-t.left)),i}findPairedArrays(e,t,r=null,n=null){const i=[];if(null==r&&(r=0),r>this.buffer.byteLength-1)return i;null==n&&(n=this.buffer.byteLength-r),n>this.buffer.byteLength-r&&(n=this.buffer.byteLength-r);let s=0;const a=this.findAllIn(e,r,n);if(0==a.length)return i;const o=this.findAllIn(t,r,n);if(0==o.length)return i;for(;s<a.length&&0!=o.length;)if(a[0].position!=o[0].position){if(a[s].position>o[0].position)break;for(;a[s].position<o[0].position&&(s++,!(s>=a.length)););i.push({left:a[s-1],right:o[0]}),a.splice(s-1,1),o.splice(0,1),s=0}else i.push({left:a[0],right:o[0]}),a.splice(0,1),o.splice(0,1);return i.sort(((e,t)=>e.left.position-t.left.position)),i}replacePattern(e,t,r=null,n=null,i=null){let s,a;const o={status:-1,searchPatternPositions:[],replacePatternPositions:[]};if(null==r&&(r=0),r>this.buffer.byteLength-1)return!1;if(null==n&&(n=this.buffer.byteLength-r),n>this.buffer.byteLength-r&&(n=this.buffer.byteLength-r),null==i){if(s=this.findAllIn([e],r,n),0==s.length)return o}else s=i;o.searchPatternPositions.push(...Array.from(s,(e=>e.position)));const u=e.buffer.byteLength-t.buffer.byteLength,h=new ArrayBuffer(this.view.length-s.length*u),l=new Uint8Array(h);for(l.set(new Uint8Array(this.buffer,0,r)),a=0;a<s.length;a++){const n=0==a?r:s[a-1].position;l.set(new Uint8Array(this.buffer,n,s[a].position-e.buffer.byteLength-n),n-a*u),l.set(t.view,s[a].position-e.buffer.byteLength-a*u),o.replacePatternPositions.push(s[a].position-e.buffer.byteLength-a*u)}return a--,l.set(new Uint8Array(this.buffer,s[a].position,this.buffer.byteLength-s[a].position),s[a].position-e.buffer.byteLength+t.buffer.byteLength-a*u),this.buffer=h,this.view=new Uint8Array(this.buffer),o.status=1,o}skipPatterns(e,t=null,r=null,n=!1){null==t&&(t=n?this.buffer.byteLength:0),t>this.buffer.byteLength&&(t=this.buffer.byteLength),n?(null==r&&(r=t),r>t&&(r=t)):(null==r&&(r=this.buffer.byteLength-t),r>this.buffer.byteLength-t&&(r=this.buffer.byteLength-t));let i=t;for(let s=0;s<e.length;s++){const a=e[s].buffer.byteLength,o=n?i-a:i;let u=!0;for(let t=0;t<a;t++)if(this.view[t+o]!=e[s].view[t]){u=!1;break}if(u)if(s=-1,n){if(i-=a,i<=0)return i}else if(i+=a,i>=t+r)return i}return i}skipNotPatterns(e,t=null,r=null,n=!1){null==t&&(t=n?this.buffer.byteLength:0),t>this.buffer.byteLength&&(t=this.buffer.byteLength),n?(null==r&&(r=t),r>t&&(r=t)):(null==r&&(r=this.buffer.byteLength-t),r>this.buffer.byteLength-t&&(r=this.buffer.byteLength-t));let i=-1;for(let s=0;s<r;s++){for(let r=0;r<e.length;r++){const a=e[r].buffer.byteLength,o=n?t-s-a:t+s;let u=!0;for(let t=0;t<a;t++)if(this.view[t+o]!=e[r].view[t]){u=!1;break}if(u){i=n?t-s:t+s;break}}if(-1!=i)break}return i}}class zt{constructor(e={}){this.stream=new Wt,this._length=0,this.backward=!1,this._start=0,this.appendBlock=0,this.prevLength=0,this.prevStart=0;for(const t of Object.keys(e))switch(t){case"stream":this.stream=e.stream;break;case"backward":this.backward=e.backward,this._start=this.stream.buffer.byteLength;break;case"length":this._length=e.length;break;case"start":this._start=e.start;break;case"appendBlock":this.appendBlock=e.appendBlock;break;case"view":this.stream=new Wt({view:e.view});break;case"buffer":this.stream=new Wt({buffer:e.buffer});break;case"string":this.stream=new Wt({string:e.string});break;case"hexstring":this.stream=new Wt({hexstring:e.hexstring})}}set stream(e){this._stream=e,this.prevLength=this._length,this._length=e._buffer.byteLength,this.prevStart=this._start,this._start=0}get stream(){return this._stream}set length(e){this.prevLength=this._length,this._length=e}get length(){return this.appendBlock?this.start:this._length}set start(e){e>this.stream.buffer.byteLength||(this.prevStart=this._start,this.prevLength=this._length,this._length-=this.backward?this._start-e:e-this._start,this._start=e)}get start(){return this._start}get buffer(){return this._stream._buffer.slice(0,this._length)}resetPosition(){this._start=this.prevStart,this._length=this.prevLength}findPattern(e,t=null){(null==t||t>this.length)&&(t=this.length);const r=this.stream.findPattern(e,this.start,this.length,this.backward);if(-1==r)return r;if(this.backward){if(r<this.start-e.buffer.byteLength-t)return-1}else if(r>this.start+e.buffer.byteLength+t)return-1;return this.start=r,r}findFirstIn(e,t=null){(null==t||t>this.length)&&(t=this.length);const r=this.stream.findFirstIn(e,this.start,this.length,this.backward);if(-1==r.id)return r;if(this.backward){if(r.position<this.start-e[r.id].buffer.byteLength-t)return{id:-1,position:this.backward?0:this.start+this.length}}else if(r.position>this.start+e[r.id].buffer.byteLength+t)return{id:-1,position:this.backward?0:this.start+this.length};return this.start=r.position,r}findAllIn(e){const t=this.backward?this.start-this.length:this.start;return this.stream.findAllIn(e,t,this.length)}findFirstNotIn(e,t=null){(null==t||t>this._length)&&(t=this._length);const r=this._stream.findFirstNotIn(e,this._start,this._length,this.backward);if(-1==r.left.id&&-1==r.right.id)return r;if(this.backward){if(-1!=r.right.id&&r.right.position<this._start-e[r.right.id]._buffer.byteLength-t)return{left:{id:-1,position:this._start},right:{id:-1,position:0},value:new Wt}}else if(-1!=r.left.id&&r.left.position>this._start+e[r.left.id]._buffer.byteLength+t)return{left:{id:-1,position:this._start},right:{id:-1,position:0},value:new Wt};return this.backward?-1==r.left.id?this.start=0:this.start=r.left.position:-1==r.right.id?this.start=this._start+this._length:this.start=r.right.position,r}findAllNotIn(e){const t=this.backward?this._start-this._length:this._start;return this._stream.findAllNotIn(e,t,this._length)}findFirstSequence(e,t=null,r=null){(null==t||t>this._length)&&(t=this._length),(null==r||r>t)&&(r=t);const n=this._stream.findFirstSequence(e,this._start,t,this.backward);if(0==n.value.buffer.byteLength)return n;if(this.backward){if(n.position<this._start-n.value._buffer.byteLength-r)return{position:-1,value:new Wt}}else if(n.position>this._start+n.value._buffer.byteLength+r)return{position:-1,value:new Wt};return this.start=n.position,n}findAllSequences(e){const t=this.backward?this.start-this.length:this.start;return this.stream.findAllSequences(e,t,this.length)}findPairedPatterns(e,t,r=null){(null==r||r>this.length)&&(r=this.length);const n=this.backward?this.start-this.length:this.start,i=this.stream.findPairedPatterns(e,t,n,this.length);if(i.length)if(this.backward){if(i[0].right<this.start-t.buffer.byteLength-r)return[]}else if(i[0].left>this.start+e.buffer.byteLength+r)return[];return i}findPairedArrays(e,t,r=null){(null==r||r>this.length)&&(r=this.length);const n=this.backward?this.start-this.length:this.start,i=this.stream.findPairedArrays(e,t,n,this.length);if(i.length)if(this.backward){if(i[0].right.position<this.start-t[i[0].right.id].buffer.byteLength-r)return[]}else if(i[0].left.position>this.start+e[i[0].left.id].buffer.byteLength+r)return[];return i}replacePattern(e,t){const r=this.backward?this.start-this.length:this.start;return this.stream.replacePattern(e,t,r,this.length)}skipPatterns(e){const t=this.stream.skipPatterns(e,this.start,this.length,this.backward);return this.start=t,t}skipNotPatterns(e){const t=this.stream.skipNotPatterns(e,this.start,this.length,this.backward);return-1==t?-1:(this.start=t,t)}append(e){this._start+e._buffer.byteLength>this._stream._buffer.byteLength&&(e._buffer.byteLength>this.appendBlock&&(this.appendBlock=e._buffer.byteLength+1e3),this._stream.realloc(this._stream._buffer.byteLength+this.appendBlock)),this._stream._view.set(e._view,this._start),this._length+=2*e._buffer.byteLength,this.start=this._start+e._buffer.byteLength,this.prevLength-=2*e._buffer.byteLength}appendView(e){this._start+e.length>this._stream._buffer.byteLength&&(e.length>this.appendBlock&&(this.appendBlock=e.length+1e3),this._stream.realloc(this._stream._buffer.byteLength+this.appendBlock)),this._stream._view.set(e,this._start),this._length+=2*e.length,this.start=this._start+e.length,this.prevLength-=2*e.length}appendChar(e){this._start+1>this._stream._buffer.byteLength&&(1>this.appendBlock&&(this.appendBlock=1e3),this._stream.realloc(this._stream._buffer.byteLength+this.appendBlock)),this._stream._view[this._start]=e,this._length+=2,this.start=this._start+1,this.prevLength-=2}appendUint16(e){this._start+2>this._stream._buffer.byteLength&&(2>this.appendBlock&&(this.appendBlock=1e3),this._stream.realloc(this._stream._buffer.byteLength+this.appendBlock));const t=new Uint16Array([e]),r=new Uint8Array(t.buffer);this._stream._view[this._start]=r[1],this._stream._view[this._start+1]=r[0],this._length+=4,this.start=this._start+2,this.prevLength-=4}appendUint24(e){this._start+3>this._stream._buffer.byteLength&&(3>this.appendBlock&&(this.appendBlock=1e3),this._stream.realloc(this._stream._buffer.byteLength+this.appendBlock));const t=new Uint32Array([e]),r=new Uint8Array(t.buffer);this._stream._view[this._start]=r[2],this._stream._view[this._start+1]=r[1],this._stream._view[this._start+2]=r[0],this._length+=6,this.start=this._start+3,this.prevLength-=6}appendUint32(e){this._start+4>this._stream._buffer.byteLength&&(4>this.appendBlock&&(this.appendBlock=1e3),this._stream.realloc(this._stream._buffer.byteLength+this.appendBlock));const t=new Uint32Array([e]),r=new Uint8Array(t.buffer);this._stream._view[this._start]=r[3],this._stream._view[this._start+1]=r[2],this._stream._view[this._start+2]=r[1],this._stream._view[this._start+3]=r[0],this._length+=8,this.start=this._start+4,this.prevLength-=8}getBlock(e,t=!0){if(this._length<=0)return[];let r;if(this._length<e&&(e=this._length),this.backward){const t=this._stream._buffer.slice(this._length-e,this._length),n=new Uint8Array(t);r=new Array(e);for(let t=0;t<e;t++)r[e-1-t]=n[t]}else{const t=this._stream._buffer.slice(this._start,this._start+e);r=Array.from(new Uint8Array(t))}return t&&(this.start+=this.backward?-1*e:e),r}getUint16(e=!0){const t=this.getBlock(2,e);if(t.length<2)return 0;const r=new Uint16Array(1),n=new Uint8Array(r.buffer);return n[0]=t[1],n[1]=t[0],r[0]}getInt16(e=!0){const t=this.getBlock(2,e);if(t.length<2)return 0;const r=new Int16Array(1),n=new Uint8Array(r.buffer);return n[0]=t[1],n[1]=t[0],r[0]}getUint24(e=!0){const t=this.getBlock(3,e);if(t.length<3)return 0;const r=new Uint32Array(1),n=new Uint8Array(r.buffer);for(let e=3;e>=1;e--)n[3-e]=t[e-1];return r[0]}getUint32(e=!0){const t=this.getBlock(4,e);if(t.length<4)return 0;const r=new Uint32Array(1),n=new Uint8Array(r.buffer);for(let e=3;e>=0;e--)n[3-e]=t[e];return r[0]}getInt32(e=!0){const t=this.getBlock(4,e);if(t.length<4)return 0;const r=new Int32Array(1),n=new Uint8Array(r.buffer);for(let e=3;e>=0;e--)n[3-e]=t[e];return r[0]}}class Xt{constructor(e={}){this.version=I(e,"version",Xt.defaultValues("version")),this.logID=I(e,"logID",Xt.defaultValues("logID")),this.timestamp=I(e,"timestamp",Xt.defaultValues("timestamp")),this.extensions=I(e,"extensions",Xt.defaultValues("extensions")),this.hashAlgorithm=I(e,"hashAlgorithm",Xt.defaultValues("hashAlgorithm")),this.signatureAlgorithm=I(e,"signatureAlgorithm",Xt.defaultValues("signatureAlgorithm")),this.signature=I(e,"signature",Xt.defaultValues("signature")),"schema"in e&&this.fromSchema(e.schema),"stream"in e&&this.fromStream(e.stream)}static defaultValues(e){switch(e){case"version":return 0;case"logID":case"extensions":return new ArrayBuffer(0);case"timestamp":return new Date(0);case"hashAlgorithm":case"signatureAlgorithm":return"";case"signature":return new Xe;default:throw new Error(`Invalid member name for SignedCertificateTimestamp class: ${e}`)}}fromSchema(e){if(e instanceof Ye==!1)throw new Error("Object's schema was not verified against input data for SignedCertificateTimestamp");const t=new zt({stream:new Wt({buffer:e.data})});this.fromStream(t)}fromStream(e){const t=e.getUint16();if(this.version=e.getBlock(1)[0],0===this.version){this.logID=new Uint8Array(e.getBlock(32)).buffer.slice(0),this.timestamp=new Date(N(new Uint8Array(e.getBlock(8)),8));const r=e.getUint16();switch(this.extensions=new Uint8Array(e.getBlock(r)).buffer.slice(0),e.getBlock(1)[0]){case 0:this.hashAlgorithm="none";break;case 1:this.hashAlgorithm="md5";break;case 2:this.hashAlgorithm="sha1";break;case 3:this.hashAlgorithm="sha224";break;case 4:this.hashAlgorithm="sha256";break;case 5:this.hashAlgorithm="sha384";break;case 6:this.hashAlgorithm="sha512";break;default:throw new Error("Object's stream was not correct for SignedCertificateTimestamp")}switch(e.getBlock(1)[0]){case 0:this.signatureAlgorithm="anonymous";break;case 1:this.signatureAlgorithm="rsa";break;case 2:this.signatureAlgorithm="dsa";break;case 3:this.signatureAlgorithm="ecdsa";break;default:throw new Error("Object's stream was not correct for SignedCertificateTimestamp")}const n=e.getUint16(),i=et(new Uint8Array(e.getBlock(n)).buffer.slice(0));if(-1===i.offset)throw new Error("Object's stream was not correct for SignedCertificateTimestamp");if(this.signature=i.result,t!==47+r+n)throw new Error("Object's stream was not correct for SignedCertificateTimestamp")}}toSchema(){const e=this.toStream();return new Ye({data:e.stream.buffer})}toStream(){const e=new zt;e.appendUint16(47+this.extensions.byteLength+this.signature.valueBeforeDecode.byteLength),e.appendChar(this.version),e.appendView(new Uint8Array(this.logID));const t=new ArrayBuffer(8),r=new Uint8Array(t),n=D(this.timestamp.valueOf(),8);let i,s;switch(r.set(new Uint8Array(n),8-n.byteLength),e.appendView(r),e.appendUint16(this.extensions.byteLength),this.extensions.byteLength&&e.appendView(new Uint8Array(this.extensions)),this.hashAlgorithm.toLowerCase()){case"none":i=0;break;case"md5":i=1;break;case"sha1":i=2;break;case"sha224":i=3;break;case"sha256":i=4;break;case"sha384":i=5;break;case"sha512":i=6;break;default:throw new Error(`Incorrect data for hashAlgorithm: ${this.hashAlgorithm}`)}switch(e.appendChar(i),this.signatureAlgorithm.toLowerCase()){case"anonymous":s=0;break;case"rsa":s=1;break;case"dsa":s=2;break;case"ecdsa":s=3;break;default:throw new Error(`Incorrect data for signatureAlgorithm: ${this.signatureAlgorithm}`)}e.appendChar(s);const a=this.signature.toBER(!1);return e.appendUint16(a.byteLength),e.appendView(new Uint8Array(a)),e}toJSON(){return{version:this.version,logID:F(this.logID),timestamp:this.timestamp,extensions:F(this.extensions),hashAlgorithm:this.hashAlgorithm,signatureAlgorithm:this.signatureAlgorithm,signature:this.signature.toJSON()}}async verify(e,t,r=0){let n,i=U(K(this.logID)),s=null,a=new zt;for(const t of e)if(t.log_id===i){s=t.key;break}if(null===s)throw new Error(`Public key not found for CT with logId: ${i}`);const o=et(M(_(s)));if(-1===o.offset)throw new Error(`Incorrect key value for CT Log with logId: ${i}`);n=new st({schema:o.result}),a.appendChar(0),a.appendChar(0);const u=new ArrayBuffer(8),h=new Uint8Array(u),l=D(this.timestamp.valueOf(),8);return h.set(new Uint8Array(l),8-l.byteLength),a.appendView(h),a.appendUint16(r),0===r&&a.appendUint24(t.byteLength),a.appendView(new Uint8Array(t)),a.appendUint16(this.extensions.byteLength),0!==this.extensions.byteLength&&a.appendView(new Uint8Array(this.extensions)),vt().subtle.verifyWithPublicKey(a._stream._buffer.slice(0,a._length),{valueBlock:{valueHex:this.signature.toBER(!1)}},n,{algorithmId:""},"SHA-256")}}class Qt{constructor(e={}){this.timestamps=I(e,"timestamps",Qt.defaultValues("timestamps")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"timestamps":return[];default:throw new Error(`Invalid member name for SignedCertificateTimestampList class: ${e}`)}}static compareWithDefault(e,t){switch(e){case"timestamps":return 0===t.length;default:throw new Error(`Invalid member name for SignedCertificateTimestampList class: ${e}`)}}static schema(e={}){const t=I(e,"names",{});return"optional"in t==!1&&(t.optional=!1),new ge({name:t.blockName||"SignedCertificateTimestampList",optional:t.optional})}fromSchema(e){if(e instanceof ge==!1)throw new Error("Object's schema was not verified against input data for SignedCertificateTimestampList");const t=new zt({stream:new Wt({buffer:e.valueBlock.valueHex})});if(t.getUint16()!==t.length)throw new Error("Object's schema was not verified against input data for SignedCertificateTimestampList");for(;t.length;)this.timestamps.push(new Xt({stream:t}))}toSchema(){const e=new zt;let t=0;const r=[];for(const e of this.timestamps){const n=e.toStream();r.push(n),t+=n.stream.buffer.byteLength}e.appendUint16(t);for(const t of r)e.appendView(t.stream.view);return new ge({valueHex:e.stream.buffer.slice(0)})}toJSON(){return{timestamps:Array.from(this.timestamps,(e=>e.toJSON()))}}}class Yt{constructor(e={}){this.templateID=I(e,"templateID",Yt.defaultValues("templateID")),"templateMajorVersion"in e&&(this.templateMajorVersion=I(e,"templateMajorVersion",Yt.defaultValues("templateMajorVersion"))),"templateMinorVersion"in e&&(this.templateMinorVersion=I(e,"templateMinorVersion",Yt.defaultValues("templateMinorVersion"))),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"templateID":return"";case"templateMajorVersion":case"templateMinorVersion":return 0;default:throw new Error(`Invalid member name for CertificateTemplate class: ${e}`)}}static schema(e={}){const t=I(e,"names",{});return new he({name:t.blockName||"",value:[new Se({name:t.templateID||""}),new ye({name:t.templateMajorVersion||"",optional:!0}),new ye({name:t.templateMinorVersion||"",optional:!0})]})}fromSchema(e){$(e,["templateID","templateMajorVersion","templateMinorVersion"]);let t=tt(e,e,Yt.schema({names:{templateID:"templateID",templateMajorVersion:"templateMajorVersion",templateMinorVersion:"templateMinorVersion"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for CertificateTemplate");this.templateID=t.result.templateID.valueBlock.toString(),"templateMajorVersion"in t.result&&(this.templateMajorVersion=t.result.templateMajorVersion.valueBlock.valueDec),"templateMinorVersion"in t.result&&(this.templateMinorVersion=t.result.templateMinorVersion.valueBlock.valueDec)}toSchema(){const e=[];return e.push(new Se({value:this.templateID})),"templateMajorVersion"in this&&e.push(new ye({value:this.templateMajorVersion})),"templateMinorVersion"in this&&e.push(new ye({value:this.templateMinorVersion})),new he({value:e})}toJSON(){const e={extnID:this.templateID};return"templateMajorVersion"in this&&(e.templateMajorVersion=this.templateMajorVersion),"templateMinorVersion"in this&&(e.templateMinorVersion=this.templateMinorVersion),e}}class Zt{constructor(e={}){this.certificateIndex=I(e,"certificateIndex",Zt.defaultValues("certificateIndex")),this.keyIndex=I(e,"keyIndex",Zt.defaultValues("keyIndex")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"certificateIndex":case"keyIndex":return 0;default:throw new Error(`Invalid member name for CAVersion class: ${e}`)}}static schema(e={}){return new ye}fromSchema(e){if(e.constructor.blockName()!==ye.blockName())throw new Error("Object's schema was not verified against input data for CAVersion");let t=e.valueBlock.valueHex.slice(0);const r=new Uint8Array(t);switch(!0){case t.byteLength<4:{const e=new ArrayBuffer(4);new Uint8Array(e).set(r,4-t.byteLength),t=e.slice(0)}break;case t.byteLength>4:{const e=new ArrayBuffer(4);new Uint8Array(e).set(r.slice(0,4)),t=e.slice(0)}}const n=t.slice(0,2),i=new Uint8Array(n);let s=i[0];i[0]=i[1],i[1]=s;const a=new Uint16Array(n);this.keyIndex=a[0];const o=t.slice(2),u=new Uint8Array(o);s=u[0],u[0]=u[1],u[1]=s;const h=new Uint16Array(o);this.certificateIndex=h[0]}toSchema(){const e=new ArrayBuffer(2);new Uint16Array(e)[0]=this.certificateIndex;const t=new Uint8Array(e);let r=t[0];t[0]=t[1],t[1]=r;const n=new ArrayBuffer(2);new Uint16Array(n)[0]=this.keyIndex;const i=new Uint8Array(n);return r=i[0],i[0]=i[1],i[1]=r,new ye({valueHex:H(n,e)})}toJSON(){return{certificateIndex:this.certificateIndex,keyIndex:this.keyIndex}}}class er{constructor(e={}){this.id=I(e,"id",er.defaultValues("id")),"type"in e&&(this.type=I(e,"type",er.defaultValues("type"))),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"id":return"";case"type":return new ce;default:throw new Error(`Invalid member name for QCStatement class: ${e}`)}}static compareWithDefault(e,t){switch(e){case"id":return""===t;case"type":return t instanceof ce;default:throw new Error(`Invalid member name for QCStatement class: ${e}`)}}static schema(e={}){const t=I(e,"names",{});return new he({name:t.blockName||"",value:[new Se({name:t.id||""}),new Xe({name:t.type||"",optional:!0})]})}fromSchema(e){$(e,["id","type"]);const t=tt(e,e,er.schema({names:{id:"id",type:"type"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for QCStatement");this.id=t.result.id.valueBlock.toString(),"type"in t.result&&(this.type=t.result.type)}toSchema(){const e=[new Se({value:this.id})];return"type"in this&&e.push(this.type),new he({value:e})}toJSON(){const e={id:this.id};return"type"in this&&(e.type=this.type.toJSON()),e}}class tr{constructor(e={}){this.values=I(e,"values",tr.defaultValues("values")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"values":return[];default:throw new Error(`Invalid member name for QCStatements class: ${e}`)}}static compareWithDefault(e,t){switch(e){case"values":return 0===t.length;default:throw new Error(`Invalid member name for QCStatements class: ${e}`)}}static schema(e={}){const t=I(e,"names",{});return new he({name:t.blockName||"",value:[new Qe({name:t.values||"",value:er.schema(t.value||{})})]})}fromSchema(e){$(e,["values"]);const t=tt(e,e,tr.schema({names:{values:"values"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for QCStatements");this.values=Array.from(t.result.values,(e=>new er({schema:e})))}toSchema(){return new he({value:Array.from(this.values,(e=>e.toSchema()))})}toJSON(){return{extensions:Array.from(this.values,(e=>e.toJSON()))}}}class rr{constructor(e={}){this.extnID=I(e,"extnID",rr.defaultValues("extnID")),this.critical=I(e,"critical",rr.defaultValues("critical")),this.extnValue="extnValue"in e?new ge({valueHex:e.extnValue}):rr.defaultValues("extnValue"),"parsedValue"in e&&(this.parsedValue=I(e,"parsedValue",rr.defaultValues("parsedValue"))),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"extnID":return"";case"critical":return!1;case"extnValue":return new ge;case"parsedValue":return{};default:throw new Error(`Invalid member name for Extension class: ${e}`)}}static schema(e={}){const t=I(e,"names",{});return new he({name:t.blockName||"",value:[new Se({name:t.extnID||""}),new ue({name:t.critical||"",optional:!0}),new ge({name:t.extnValue||""})]})}fromSchema(e){$(e,["extnID","critical","extnValue"]);let t=tt(e,e,rr.schema({names:{extnID:"extnID",critical:"critical",extnValue:"extnValue"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for Extension");if(this.extnID=t.result.extnID.valueBlock.toString(),"critical"in t.result&&(this.critical=t.result.critical.valueBlock.value),this.extnValue=t.result.extnValue,t=et(this.extnValue.valueBlock.valueHex),-1!==t.offset)switch(this.extnID){case"2.5.29.9":try{this.parsedValue=new Pt({schema:t.result})}catch(e){this.parsedValue=new Pt,this.parsedValue.parsingError="Incorrectly formated SubjectDirectoryAttributes"}break;case"2.5.29.14":case"2.5.29.15":this.parsedValue=t.result;break;case"2.5.29.16":try{this.parsedValue=new Nt({schema:t.result})}catch(e){this.parsedValue=new Nt,this.parsedValue.parsingError="Incorrectly formated PrivateKeyUsagePeriod"}break;case"2.5.29.17":case"2.5.29.18":try{this.parsedValue=new It({schema:t.result})}catch(e){this.parsedValue=new It,this.parsedValue.parsingError="Incorrectly formated AltName"}break;case"2.5.29.19":try{this.parsedValue=new Dt({schema:t.result})}catch(e){this.parsedValue=new Dt,this.parsedValue.parsingError="Incorrectly formated BasicConstraints"}break;case"2.5.29.20":case"2.5.29.27":case"2.5.29.21":case"2.5.29.24":this.parsedValue=t.result;break;case"2.5.29.28":try{this.parsedValue=new Ht({schema:t.result})}catch(e){this.parsedValue=new Ht,this.parsedValue.parsingError="Incorrectly formated IssuingDistributionPoint"}break;case"2.5.29.29":try{this.parsedValue=new Rt({schema:t.result})}catch(e){this.parsedValue=new Rt,this.parsedValue.parsingError="Incorrectly formated GeneralNames"}break;case"2.5.29.30":try{this.parsedValue=new Tt({schema:t.result})}catch(e){this.parsedValue=new Tt,this.parsedValue.parsingError="Incorrectly formated NameConstraints"}break;case"2.5.29.31":case"2.5.29.46":try{this.parsedValue=new jt({schema:t.result})}catch(e){this.parsedValue=new jt,this.parsedValue.parsingError="Incorrectly formated CRLDistributionPoints"}break;case"2.5.29.32":case"1.3.6.1.4.1.311.21.10":try{this.parsedValue=new _t({schema:t.result})}catch(e){this.parsedValue=new _t,this.parsedValue.parsingError="Incorrectly formated CertificatePolicies"}break;case"2.5.29.33":try{this.parsedValue=new Mt({schema:t.result})}catch(e){this.parsedValue=new Mt,this.parsedValue.parsingError="Incorrectly formated CertificatePolicies"}break;case"2.5.29.35":try{this.parsedValue=new qt({schema:t.result})}catch(e){this.parsedValue=new qt,this.parsedValue.parsingError="Incorrectly formated AuthorityKeyIdentifier"}break;case"2.5.29.36":try{this.parsedValue=new Jt({schema:t.result})}catch(e){this.parsedValue=new Jt,this.parsedValue.parsingError="Incorrectly formated PolicyConstraints"}break;case"2.5.29.37":try{this.parsedValue=new $t({schema:t.result})}catch(e){this.parsedValue=new $t,this.parsedValue.parsingError="Incorrectly formated ExtKeyUsage"}break;case"2.5.29.54":this.parsedValue=t.result;break;case"1.3.6.1.5.5.7.1.1":case"1.3.6.1.5.5.7.1.11":try{this.parsedValue=new Gt({schema:t.result})}catch(e){this.parsedValue=new Gt,this.parsedValue.parsingError="Incorrectly formated InfoAccess"}break;case"1.3.6.1.4.1.11129.2.4.2":try{this.parsedValue=new Qt({schema:t.result})}catch(e){this.parsedValue=new Qt,this.parsedValue.parsingError="Incorrectly formated SignedCertificateTimestampList"}break;case"1.3.6.1.4.1.311.20.2":case"1.3.6.1.4.1.311.21.2":this.parsedValue=t.result;break;case"1.3.6.1.4.1.311.21.7":try{this.parsedValue=new Yt({schema:t.result})}catch(e){this.parsedValue=new Yt,this.parsedValue.parsingError="Incorrectly formated CertificateTemplate"}break;case"1.3.6.1.4.1.311.21.1":try{this.parsedValue=new Zt({schema:t.result})}catch(e){this.parsedValue=new Zt,this.parsedValue.parsingError="Incorrectly formated CAVersion"}break;case"1.3.6.1.5.5.7.1.3":try{this.parsedValue=new tr({schema:t.result})}catch(e){this.parsedValue=new tr,this.parsedValue.parsingError="Incorrectly formated QCStatements"}}}toSchema(){const e=[];return e.push(new Se({value:this.extnID})),this.critical!==rr.defaultValues("critical")&&e.push(new ue({value:this.critical})),e.push(this.extnValue),new he({value:e})}toJSON(){const e={extnID:this.extnID,extnValue:this.extnValue.toJSON()};return this.critical!==rr.defaultValues("critical")&&(e.critical=this.critical),"parsedValue"in this&&"toJSON"in this.parsedValue&&(e.parsedValue=this.parsedValue.toJSON()),e}}class nr{constructor(e={}){this.extensions=I(e,"extensions",nr.defaultValues("extensions")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"extensions":return[];default:throw new Error(`Invalid member name for Extensions class: ${e}`)}}static schema(e={},t=!1){const r=I(e,"names",{});return new he({optional:t,name:r.blockName||"",value:[new Qe({name:r.extensions||"",value:rr.schema(r.extension||{})})]})}fromSchema(e){$(e,["extensions"]);const t=tt(e,e,nr.schema({names:{extensions:"extensions"}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for Extensions");this.extensions=Array.from(t.result.extensions,(e=>new rr({schema:e})))}toSchema(){return new he({value:Array.from(this.extensions,(e=>e.toSchema()))})}toJSON(){return{extensions:Array.from(this.extensions,(e=>e.toJSON()))}}}function ir(e={}){const t=I(e,"names",{});return new he({name:t.blockName||"tbsCertificate",value:[new ie({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new ye({name:t.tbsCertificateVersion||"tbsCertificate.version"})]}),new ye({name:t.tbsCertificateSerialNumber||"tbsCertificate.serialNumber"}),rt.schema(t.signature||{names:{blockName:"tbsCertificate.signature"}}),At.schema(t.issuer||{names:{blockName:"tbsCertificate.issuer"}}),new he({name:t.tbsCertificateValidity||"tbsCertificate.validity",value:[Ft.schema(t.notBefore||{names:{utcTimeName:"tbsCertificate.notBefore",generalTimeName:"tbsCertificate.notBefore"}}),Ft.schema(t.notAfter||{names:{utcTimeName:"tbsCertificate.notAfter",generalTimeName:"tbsCertificate.notAfter"}})]}),At.schema(t.subject||{names:{blockName:"tbsCertificate.subject"}}),st.schema(t.subjectPublicKeyInfo||{names:{blockName:"tbsCertificate.subjectPublicKeyInfo"}}),new re({name:t.tbsCertificateIssuerUniqueID||"tbsCertificate.issuerUniqueID",optional:!0,idBlock:{tagClass:3,tagNumber:1}}),new re({name:t.tbsCertificateSubjectUniqueID||"tbsCertificate.subjectUniqueID",optional:!0,idBlock:{tagClass:3,tagNumber:2}}),new ie({optional:!0,idBlock:{tagClass:3,tagNumber:3},value:[nr.schema(t.extensions||{names:{blockName:"tbsCertificate.extensions"}})]})]})}class sr{constructor(e={}){this.tbs=I(e,"tbs",sr.defaultValues("tbs")),this.version=I(e,"version",sr.defaultValues("version")),this.serialNumber=I(e,"serialNumber",sr.defaultValues("serialNumber")),this.signature=I(e,"signature",sr.defaultValues("signature")),this.issuer=I(e,"issuer",sr.defaultValues("issuer")),this.notBefore=I(e,"notBefore",sr.defaultValues("notBefore")),this.notAfter=I(e,"notAfter",sr.defaultValues("notAfter")),this.subject=I(e,"subject",sr.defaultValues("subject")),this.subjectPublicKeyInfo=I(e,"subjectPublicKeyInfo",sr.defaultValues("subjectPublicKeyInfo")),"issuerUniqueID"in e&&(this.issuerUniqueID=I(e,"issuerUniqueID",sr.defaultValues("issuerUniqueID"))),"subjectUniqueID"in e&&(this.subjectUniqueID=I(e,"subjectUniqueID",sr.defaultValues("subjectUniqueID"))),"extensions"in e&&(this.extensions=I(e,"extensions",sr.defaultValues("extensions"))),this.signatureAlgorithm=I(e,"signatureAlgorithm",sr.defaultValues("signatureAlgorithm")),this.signatureValue=I(e,"signatureValue",sr.defaultValues("signatureValue")),"schema"in e&&this.fromSchema(e.schema)}static defaultValues(e){switch(e){case"tbs":return new ArrayBuffer(0);case"version":return 0;case"serialNumber":return new ye;case"signature":return new rt;case"issuer":return new At;case"notBefore":case"notAfter":return new Ft;case"subject":return new At;case"subjectPublicKeyInfo":return new st;case"issuerUniqueID":case"subjectUniqueID":return new ArrayBuffer(0);case"extensions":return[];case"signatureAlgorithm":return new rt;case"signatureValue":return new pe;default:throw new Error(`Invalid member name for Certificate class: ${e}`)}}static schema(e={}){const t=I(e,"names",{});return new he({name:t.blockName||"",value:[ir(t.tbsCertificate),rt.schema(t.signatureAlgorithm||{names:{blockName:"signatureAlgorithm"}}),new pe({name:t.signatureValue||"signatureValue"})]})}fromSchema(e){$(e,["tbsCertificate","tbsCertificate.extensions","tbsCertificate.version","tbsCertificate.serialNumber","tbsCertificate.signature","tbsCertificate.issuer","tbsCertificate.notBefore","tbsCertificate.notAfter","tbsCertificate.subject","tbsCertificate.subjectPublicKeyInfo","tbsCertificate.issuerUniqueID","tbsCertificate.subjectUniqueID","signatureAlgorithm","signatureValue"]);const t=tt(e,e,sr.schema({names:{tbsCertificate:{names:{extensions:{names:{extensions:"tbsCertificate.extensions"}}}}}}));if(!1===t.verified)throw new Error("Object's schema was not verified against input data for Certificate");this.tbs=t.result.tbsCertificate.valueBeforeDecode,"tbsCertificate.version"in t.result&&(this.version=t.result["tbsCertificate.version"].valueBlock.valueDec),this.serialNumber=t.result["tbsCertificate.serialNumber"],this.signature=new rt({schema:t.result["tbsCertificate.signature"]}),this.issuer=new At({schema:t.result["tbsCertificate.issuer"]}),this.notBefore=new Ft({schema:t.result["tbsCertificate.notBefore"]}),this.notAfter=new Ft({schema:t.result["tbsCertificate.notAfter"]}),this.subject=new At({schema:t.result["tbsCertificate.subject"]}),this.subjectPublicKeyInfo=new st({schema:t.result["tbsCertificate.subjectPublicKeyInfo"]}),"tbsCertificate.issuerUniqueID"in t.result&&(this.issuerUniqueID=t.result["tbsCertificate.issuerUniqueID"].valueBlock.valueHex),"tbsCertificate.subjectUniqueID"in t.result&&(this.subjectUniqueID=t.result["tbsCertificate.subjectUniqueID"].valueBlock.valueHex),"tbsCertificate.extensions"in t.result&&(this.extensions=Array.from(t.result["tbsCertificate.extensions"],(e=>new rr({schema:e})))),this.signatureAlgorithm=new rt({schema:t.result.signatureAlgorithm}),this.signatureValue=t.result.signatureValue}encodeTBS(){const e=[];return"version"in this&&this.version!==sr.defaultValues("version")&&e.push(new ie({optional:!0,idBlock:{tagClass:3,tagNumber:0},value:[new ye({value:this.version})]})),e.push(this.serialNumber),e.push(this.signature.toSchema()),e.push(this.issuer.toSchema()),e.push(new he({value:[this.notBefore.toSchema(),this.notAfter.toSchema()]})),e.push(this.subject.toSchema()),e.push(this.subjectPublicKeyInfo.toSchema()),"issuerUniqueID"in this&&e.push(new re({optional:!0,idBlock:{tagClass:3,tagNumber:1},valueHex:this.issuerUniqueID})),"subjectUniqueID"in this&&e.push(new re({optional:!0,idBlock:{tagClass:3,tagNumber:2},valueHex:this.subjectUniqueID})),"extensions"in this&&e.push(new ie({optional:!0,idBlock:{tagClass:3,tagNumber:3},value:[new he({value:Array.from(this.extensions,(e=>e.toSchema()))})]})),new he({value:e})}toSchema(e=!1){let t={};if(!1===e){if(0===this.tbs.length)return sr.schema().value[0];t=et(this.tbs).result}else t=this.encodeTBS();return new he({value:[t,this.signatureAlgorithm.toSchema(),this.signatureValue]})}toJSON(){const e={tbs:F(this.tbs,0,this.tbs.byteLength),serialNumber:this.serialNumber.toJSON(),signature:this.signature.toJSON(),issuer:this.issuer.toJSON(),notBefore:this.notBefore.toJSON(),notAfter:this.notAfter.toJSON(),subject:this.subject.toJSON(),subjectPublicKeyInfo:this.subjectPublicKeyInfo.toJSON(),signatureAlgorithm:this.signatureAlgorithm.toJSON(),signatureValue:this.signatureValue.toJSON()};return"version"in this&&this.version!==sr.defaultValues("version")&&(e.version=this.version),"issuerUniqueID"in this&&(e.issuerUniqueID=F(this.issuerUniqueID,0,this.issuerUniqueID.byteLength)),"subjectUniqueID"in this&&(e.subjectUniqueID=F(this.subjectUniqueID,0,this.subjectUniqueID.byteLength)),"extensions"in this&&(e.extensions=Array.from(this.extensions,(e=>e.toJSON()))),e}getPublicKey(e=null){return vt().subtle.getPublicKey(this.subjectPublicKeyInfo,this.signatureAlgorithm,e)}getKeyHash(e="SHA-1"){const t=bt();return void 0===t?Promise.reject("Unable to create WebCrypto object"):t.digest({name:e},new Uint8Array(this.subjectPublicKeyInfo.subjectPublicKey.valueBlock.valueHex))}sign(e,t="SHA-1"){if(void 0===e)return Promise.reject("Need to provide a private key for signing");let r,n=Promise.resolve();const i=vt();return n=n.then((()=>i.subtle.getSignatureParameters(e,t))),n=n.then((e=>{r=e.parameters,this.signature=e.signatureAlgorithm,this.signatureAlgorithm=e.signatureAlgorithm})),n=n.then((()=>{this.tbs=this.encodeTBS().toBER(!1)})),n=n.then((()=>i.subtle.signWithPrivateKey(this.tbs,e,r))),n=n.then((e=>{this.signatureValue=new pe({valueHex:e})})),n}verify(e=null){let t={};return null!==e?t=e.subjectPublicKeyInfo:this.issuer.isEqual(this.subject)&&(t=this.subjectPublicKeyInfo),t instanceof st==!1?Promise.reject("Please provide issuer certificate as a parameter"):vt().subtle.verifyWithPublicKey(this.tbs,this.signatureValue,t,this.signatureAlgorithm)}}class ar{constructor(e={}){this.trustedCerts=I(e,"trustedCerts",this.defaultValues("trustedCerts")),this.certs=I(e,"certs",this.defaultValues("certs")),this.crls=I(e,"crls",this.defaultValues("crls")),this.ocsps=I(e,"ocsps",this.defaultValues("ocsps")),this.checkDate=I(e,"checkDate",this.defaultValues("checkDate")),this.findOrigin=I(e,"findOrigin",this.defaultValues("findOrigin")),this.findIssuer=I(e,"findIssuer",this.defaultValues("findIssuer"))}static defaultFindOrigin(e,t){0===e.tbs.byteLength&&(e.tbs=e.encodeTBS());for(const r of t.certs)if(0===r.tbs.byteLength&&(r.tbs=r.encodeTBS()),T(e.tbs,r.tbs))return"Intermediate Certificates";for(const r of t.trustedCerts)if(0===r.tbs.byteLength&&(r.tbs=r.encodeTBS()),T(e.tbs,r.tbs))return"Trusted Certificates";return"Unknown"}async defaultFindIssuer(e,t){let r=[],n=null,i=null,s=null;if(e.subject.isEqual(e.issuer))try{if(!0===await e.verify())return[e]}catch(e){}if("extensions"in e)for(const t of e.extensions)if("2.5.29.35"===t.extnID){"keyIdentifier"in t.parsedValue?n=t.parsedValue.keyIdentifier:("authorityCertIssuer"in t.parsedValue&&(i=t.parsedValue.authorityCertIssuer),"authorityCertSerialNumber"in t.parsedValue&&(s=t.parsedValue.authorityCertSerialNumber));break}function a(t){if(null!==n&&"extensions"in t){let e=!1;for(const i of t.extensions)if("2.5.29.14"===i.extnID){e=!0,T(i.parsedValue.valueBlock.valueHex,n.valueBlock.valueHex)&&r.push(t);break}if(e)return}let a=!1;null!==s&&(a=t.serialNumber.isEqual(s)),null!==i?t.subject.isEqual(i)&&a&&r.push(t):e.issuer.isEqual(t.subject)&&r.push(t)}for(const e of t.trustedCerts)a(e);for(const e of t.certs)a(e);for(let t=0;t<r.length;t++)try{!1===await e.verify(r[t])&&r.splice(t,1)}catch(e){r.splice(t,1)}return r}defaultValues(e){switch(e){case"trustedCerts":case"certs":case"crls":case"ocsps":return[];case"checkDate":return new Date;case"findOrigin":return ar.defaultFindOrigin;case"findIssuer":return this.defaultFindIssuer;default:throw new Error(`Invalid member name for CertificateChainValidationEngine class: ${e}`)}}async sort(e=!1){const t=[],r=this;async function n(e){const n=[],i=[],s=[];if(n.push(...t.filter((t=>e.issuer.isEqual(t.subject)))),0===n.length)return{status:1,statusMessage:"No certificate's issuers"};if(i.push(...r.crls.filter((t=>t.issuer.isEqual(e.issuer)))),0===i.length)return{status:2,statusMessage:"No CRLs for specific certificate issuer"};for(let e=0;e<i.length;e++)if(!(i[e].nextUpdate.value<r.checkDate))for(let t=0;t<n.length;t++)try{if(await i[e].verify({issuerCertificate:n[t]})){s.push({crl:i[e],certificate:n[t]});break}}catch(e){}return s.length?{status:0,statusMessage:"",result:s}:{status:3,statusMessage:"No valid CRLs found"}}async function i(e,t){const n=(i=e.signatureAlgorithm.algorithmId,vt().subtle.getAlgorithmByOID(i));var i;if("name"in n==!1)return 1;if("hash"in n==!1)return 1;for(let n=0;n<r.ocsps.length;n++){const i=await r.ocsps[n].getCertificateStatus(e,t);if(i.isForCertificate)return 0===i.status?0:1}return 2}async function s(e,t=!1){let r=!1,n=!1,i=!1,s=!1;if("extensions"in e){for(let t=0;t<e.extensions.length;t++){if(!0===e.extensions[t].critical&&"parsedValue"in e.extensions[t]==!1)return{result:!1,resultCode:6,resultMessage:`Unable to parse critical certificate extension: ${e.extensions[t].extnID}`};if("2.5.29.15"===e.extensions[t].extnID){i=!0;const r=new Uint8Array(e.extensions[t].parsedValue.valueBlock.valueHex);4==(4&r[0])&&(n=!0),2==(2&r[0])&&(s=!0)}"2.5.29.19"===e.extensions[t].extnID&&"cA"in e.extensions[t].parsedValue&&!0===e.extensions[t].parsedValue.cA&&(r=!0)}if(!0===n&&!1===r)return{result:!1,resultCode:3,resultMessage:'Unable to build certificate chain - using "keyCertSign" flag set without BasicConstaints'};if(!0===i&&!0===r&&!1===n)return{result:!1,resultCode:4,resultMessage:'Unable to build certificate chain - "keyCertSign" flag was not set'};if(!0===r&&!0===i&&t&&!1===s)return{result:!1,resultCode:5,resultMessage:'Unable to build certificate chain - intermediate certificate must have "cRLSign" key usage flag'}}return!1===r?{result:!1,resultCode:7,resultMessage:"Unable to build certificate chain - more than one possible end-user certificate"}:{result:!0,resultCode:0,resultMessage:""}}t.push(...r.trustedCerts),t.push(...r.certs);for(let e=0;e<t.length;e++)for(let r=0;r<t.length;r++)if(e!==r&&T(t[e].tbs,t[r].tbs)){t.splice(r,1),e=0;break}let a;const o=[t[t.length-1]];if(a=await async function e(t){const n=[];function i(e){let t=!0;for(let r=0;r<e.length;r++){for(let n=0;n<e.length;n++)if(n!==r&&e[r]===e[n]){t=!1;break}if(!t)break}return t}const s=await r.findIssuer(t,r);if(0===s.length)throw new Error("No valid certificate paths found");for(let r=0;r<s.length;r++){if(T(s[r].tbs,t.tbs)){n.push([s[r]]);continue}const a=await e(s[r]);for(let e=0;e<a.length;e++){const t=a[e].slice();t.splice(0,0,s[r]),i(t)?n.push(t):n.push(a[e])}}return n}(t[t.length-1]),0===a.length)return{result:!1,resultCode:60,resultMessage:"Unable to find certificate path"};for(let e=0;e<a.length;e++){let t=!1;for(let n=0;n<a[e].length;n++){const i=a[e][n];for(let e=0;e<r.trustedCerts.length;e++)if(T(i.tbs,r.trustedCerts[e].tbs)){t=!0;break}if(t)break}t||(a.splice(e,1),e=0)}if(0===a.length)throw{result:!1,resultCode:97,resultMessage:"No valid certificate paths found"};let u=a[0].length,h=0;for(let e=0;e<a.length;e++)a[e].length<u&&(u=a[e].length,h=e);for(let e=0;e<a[h].length;e++)o.push(a[h][e]);if(a=await async function(t,a){for(let e=0;e<t.length;e++)if(t[e].notBefore.value>a||t[e].notAfter.value<a)return{result:!1,resultCode:8,resultMessage:"The certificate is either not yet valid or expired"};if(t.length<2)return{result:!1,resultCode:9,resultMessage:"Too short certificate path"};for(let e=t.length-2;e>=0;e--)if(!1===t[e].issuer.isEqual(t[e].subject)&&!1===t[e].issuer.isEqual(t[e+1].subject))return{result:!1,resultCode:10,resultMessage:"Incorrect name chaining"};if(0!==r.crls.length||0!==r.ocsps.length)for(let a=0;a<t.length-1;a++){let o=2,u={status:0,statusMessage:""};if(0!==r.ocsps.length)switch(o=await i(t[a],t[a+1]),o){case 0:continue;case 1:return{result:!1,resultCode:12,resultMessage:"One of certificates was revoked via OCSP response"}}if(0!==r.crls.length){if(u=await n(t[a]),0===u.status)for(let e=0;e<u.result.length;e++){if(u.result[e].crl.isCertificateRevoked(t[a]))return{result:!1,resultCode:12,resultMessage:"One of certificates had been revoked"};if(!1===(await s(u.result[e].certificate,!0)).result)return{result:!1,resultCode:13,resultMessage:"CRL issuer certificate is not a CA certificate or does not have crlSign flag"}}else if(!1===e)throw{result:!1,resultCode:11,resultMessage:`No revocation values found for one of certificates: ${u.statusMessage}`}}else if(2===o)return{result:!1,resultCode:11,resultMessage:"No revocation values found for one of certificates"};if(2===o&&2===u.status&&e){const e=t[a+1];let r=!1;if("extensions"in e)for(const t of e.extensions)switch(t.extnID){case"2.5.29.31":case"2.5.29.46":case"1.3.6.1.5.5.7.1.1":r=!0}if(r)throw{result:!1,resultCode:11,resultMessage:`No revocation values found for one of certificates: ${u.statusMessage}`}}}for(let e=1;e<t.length;e++){if(!1===(await s(t[e])).result)return{result:!1,resultCode:14,resultMessage:"One of intermediate certificates is not a CA certificate"}}return{result:!0}}(o,r.checkDate),!1===a.result)throw a;return o}async verify(e={}){function t(e,t){const r=wt(e),n=wt(t),i=r.split("."),s=n.split("."),a=i.length,o=s.length;if(0===a||0===o||a<o)return!1;for(let e=0;e<a;e++)if(0===i[e].length)return!1;for(let e=0;e<o;e++)if(0===s[e].length){if(0===e){if(1===o)return!1;continue}return!1}for(let e=0;e<o;e++)if(0!==s[o-1-e].length&&0!==i[a-1-e].localeCompare(s[o-1-e]))return!1;return!0}function r(e,r){const n=wt(e),i=wt(r),s=n.split("@"),a=i.split("@");if(0===s.length||0===a.length||s.length<a.length)return!1;if(1===a.length){if(t(s[1],a[0])){const e=s[1].split("."),t=a[0].split(".");return 0===t[0].length||e.length===t.length}return!1}return 0===n.localeCompare(i)}function n(e,r){let n=wt(e);const i=wt(r),s=n.split("/");if(i.split("/").length>1)return!1;if(s.length>1)for(let e=0;e<s.length;e++)if(s[e].length>0&&":"!==s[e].charAt(s[e].length-1)){n=s[e].split(":")[0];break}if(t(n,i)){const e=n.split("."),t=i.split(".");return 0===t[0].length||e.length===t.length}return!1}function i(e,t){const r=new Uint8Array(e.valueBlock.valueHex),n=new Uint8Array(t.valueBlock.valueHex);if(4===r.length&&8===n.length){for(let e=0;e<4;e++)if((r[e]^n[e])&n[e+4])return!1;return!0}if(16===r.length&&32===n.length){for(let e=0;e<16;e++)if((r[e]^n[e])&n[e+16])return!1;return!0}return!1}function s(e,t){if(0===e.typesAndValues.length||0===t.typesAndValues.length)return!0;if(e.typesAndValues.length<t.typesAndValues.length)return!1;let r=!0,n=0;for(let i=0;i<t.typesAndValues.length;i++){let s=!1;for(let a=n;a<e.typesAndValues.length;a++)if(s=e.typesAndValues[a].isEqual(t.typesAndValues[i]),e.typesAndValues[a].type===t.typesAndValues[i].type&&(r=r&&s),!0===s){if(0===n||n===a){n=a+1;break}return!1}if(!1===s)return!1}return 0!==n&&r}try{if(0===this.certs.length)throw"Empty certificate array";let a=!1;"passedWhenNotRevValues"in e&&(a=e.passedWhenNotRevValues);let o=[];o.push("2.5.29.32.0");let u=!1,h=!1,l=!1,c=[],f=[],g=[];"initialPolicySet"in e&&(o=e.initialPolicySet),"initialExplicitPolicy"in e&&(u=e.initialExplicitPolicy),"initialPolicyMappingInhibit"in e&&(h=e.initialPolicyMappingInhibit),"initialInhibitPolicy"in e&&(l=e.initialInhibitPolicy),"initialPermittedSubtreesSet"in e&&(c=e.initialPermittedSubtreesSet),"initialExcludedSubtreesSet"in e&&(f=e.initialExcludedSubtreesSet),"initialRequiredNameForms"in e&&(g=e.initialRequiredNameForms);let d=u,p=h,m=l;const y=new Array(3);y[0]=!1,y[1]=!1,y[2]=!1;let v=0,b=0,w=0,S=c,A=f;const x=g;let E=1;this.certs=await this.sort(a);const B=[];B.push("2.5.29.32.0");const k=[],C=new Array(this.certs.length-1);for(let e=0;e<this.certs.length-1;e++)C[e]=!0;k.push(C);const I=new Array(this.certs.length-1),F=new Array(this.certs.length-1);let P=d?this.certs.length-1:-1;for(let e=this.certs.length-2;e>=0;e--,E++)if("extensions"in this.certs[e]){for(let t=0;t<this.certs[e].extensions.length;t++){if("2.5.29.32"===this.certs[e].extensions[t].extnID){F[e]=this.certs[e].extensions[t].parsedValue;for(let t=0;t<B.length;t++)if("2.5.29.32.0"===B[t]){delete k[t][e];break}for(let r=0;r<this.certs[e].extensions[t].parsedValue.certificatePolicies.length;r++){let n=-1;for(let i=0;i<B.length;i++)if(this.certs[e].extensions[t].parsedValue.certificatePolicies[r].policyIdentifier===B[i]){n=i;break}if(-1===n){B.push(this.certs[e].extensions[t].parsedValue.certificatePolicies[r].policyIdentifier);const n=new Array(this.certs.length-1);n[e]=!0,k.push(n)}else k[n][e]=!0}}if("2.5.29.33"===this.certs[e].extensions[t].extnID){if(p)return{result:!1,resultCode:98,resultMessage:"Policy mapping prohibited"};I[e]=this.certs[e].extensions[t].parsedValue}"2.5.29.36"===this.certs[e].extensions[t].extnID&&!1===d&&(0===this.certs[e].extensions[t].parsedValue.requireExplicitPolicy?(d=!0,P=e):!1===y[0]?(y[0]=!0,v=this.certs[e].extensions[t].parsedValue.requireExplicitPolicy):v=v>this.certs[e].extensions[t].parsedValue.requireExplicitPolicy?this.certs[e].extensions[t].parsedValue.requireExplicitPolicy:v,0===this.certs[e].extensions[t].parsedValue.inhibitPolicyMapping?p=!0:!1===y[1]?(y[1]=!0,b=this.certs[e].extensions[t].parsedValue.inhibitPolicyMapping+1):b=b>this.certs[e].extensions[t].parsedValue.inhibitPolicyMapping+1?this.certs[e].extensions[t].parsedValue.inhibitPolicyMapping+1:b),"2.5.29.54"===this.certs[e].extensions[t].extnID&&!1===m&&(0===this.certs[e].extensions[t].parsedValue.valueBlock.valueDec?m=!0:!1===y[2]?(y[2]=!0,w=this.certs[e].extensions[t].parsedValue.valueBlock.valueDec):w=w>this.certs[e].extensions[t].parsedValue.valueBlock.valueDec?this.certs[e].extensions[t].parsedValue.valueBlock.valueDec:w)}if(!0===m){let t=-1;for(let e=0;e<B.length;e++)if("2.5.29.32.0"===B[e]){t=e;break}-1!==t&&delete k[0][e]}!1===d&&!0===y[0]&&(v--,0===v&&(d=!0,P=e,y[0]=!1)),!1===p&&!0===y[1]&&(b--,0===b&&(p=!0,y[1]=!1)),!1===m&&!0===y[2]&&(w--,0===w&&(m=!0,y[2]=!1))}for(let e=0;e<this.certs.length-1;e++)if(e<this.certs.length-2&&void 0!==I[e+1])for(let t=0;t<I[e+1].mappings.length;t++){if("2.5.29.32.0"===I[e+1].mappings[t].issuerDomainPolicy||"2.5.29.32.0"===I[e+1].mappings[t].subjectDomainPolicy)return{result:!1,resultCode:99,resultMessage:'The "anyPolicy" should not be a part of policy mapping scheme'};let r=-1,n=-1;for(let i=0;i<B.length;i++)B[i]===I[e+1].mappings[t].issuerDomainPolicy&&(r=i),B[i]===I[e+1].mappings[t].subjectDomainPolicy&&(n=i);void 0!==k[r][e]&&delete k[r][e];for(let i=0;i<F[e].certificatePolicies.length;i++)if(I[e+1].mappings[t].subjectDomainPolicy===F[e].certificatePolicies[i].policyIdentifier&&-1!==r&&-1!==n)for(let t=0;t<=e;t++)void 0!==k[n][t]&&(k[r][t]=!0,delete k[n][t])}for(let e=0;e<B.length;e++)if("2.5.29.32.0"===B[e])for(let t=0;t<P;t++)delete k[e][t];const N=[];for(let e=0;e<k.length;e++){let t=!0;for(let r=0;r<this.certs.length-1;r++){let n=!1;if(r<P&&"2.5.29.32.0"===B[e]&&B.length>1){t=!1;break}if(void 0===k[e][r]){if(r>=P)for(let e=0;e<B.length;e++)if("2.5.29.32.0"===B[e]){!0===k[e][r]&&(n=!0);break}if(!n){t=!1;break}}}!0===t&&N.push(B[e])}let D=[];if(1===o.length&&"2.5.29.32.0"===o[0]&&!1===d)D=o;else if(1===N.length&&"2.5.29.32.0"===N[0])D=o;else for(let e=0;e<N.length;e++)for(let t=0;t<o.length;t++)if(o[t]===N[e]||"2.5.29.32.0"===o[t]){D.push(N[e]);break}const H={result:D.length>0,resultCode:0,resultMessage:D.length>0?"":'Zero "userConstrPolicies" array, no intersections with "authConstrPolicies"',authConstrPolicies:N,userConstrPolicies:D,explicitPolicyIndicator:d,policyMappings:I,certificatePath:this.certs};if(0===D.length)return H;if(!1===H.result)return H;E=1;for(let e=this.certs.length-2;e>=0;e--,E++){let a=[],o=[],u=[];if("extensions"in this.certs[e])for(let t=0;t<this.certs[e].extensions.length;t++)"2.5.29.30"===this.certs[e].extensions[t].extnID&&("permittedSubtrees"in this.certs[e].extensions[t].parsedValue&&(o=o.concat(this.certs[e].extensions[t].parsedValue.permittedSubtrees)),"excludedSubtrees"in this.certs[e].extensions[t].parsedValue&&(u=u.concat(this.certs[e].extensions[t].parsedValue.excludedSubtrees))),"2.5.29.17"===this.certs[e].extensions[t].extnID&&(a=a.concat(this.certs[e].extensions[t].parsedValue.altNames));let h=x.length<=0;for(let t=0;t<x.length;t++)switch(x[t].base.type){case 4:if(x[t].base.value.typesAndValues.length!==this.certs[e].subject.typesAndValues.length)continue;h=!0;for(let r=0;r<this.certs[e].subject.typesAndValues.length;r++)if(this.certs[e].subject.typesAndValues[r].type!==x[t].base.value.typesAndValues[r].type){h=!1;break}if(!0===h)break}if(!1===h)throw H.result=!1,H.resultCode=21,H.resultMessage="No neccessary name form found",H;const l=[];l[0]=[],l[1]=[],l[2]=[],l[3]=[],l[4]=[];for(let e=0;e<S.length;e++)switch(S[e].base.type){case 1:l[0].push(S[e]);break;case 2:l[1].push(S[e]);break;case 4:l[2].push(S[e]);break;case 6:l[3].push(S[e]);break;case 7:l[4].push(S[e])}for(let o=0;o<5;o++){let u=!1,h=!1;const c=l[o];for(let l=0;l<c.length;l++){switch(o){case 0:if(a.length>0)for(let e=0;e<a.length;e++)1===a[e].type&&(h=!0,u=u||r(a[e].value,c[l].base.value));else for(let t=0;t<this.certs[e].subject.typesAndValues.length;t++)"1.2.840.113549.1.9.1"!==this.certs[e].subject.typesAndValues[t].type&&"0.9.2342.19200300.100.1.3"!==this.certs[e].subject.typesAndValues[t].type||(h=!0,u=u||r(this.certs[e].subject.typesAndValues[t].value.valueBlock.value,c[l].base.value));break;case 1:if(a.length>0)for(let e=0;e<a.length;e++)2===a[e].type&&(h=!0,u=u||t(a[e].value,c[l].base.value));break;case 2:h=!0,u=s(this.certs[e].subject,c[l].base.value);break;case 3:if(a.length>0)for(let e=0;e<a.length;e++)6===a[e].type&&(h=!0,u=u||n(a[e].value,c[l].base.value));break;case 4:if(a.length>0)for(let e=0;e<a.length;e++)7===a[e].type&&(h=!0,u=u||i(a[e].value,c[l].base.value))}if(u)break}if(!1===u&&c.length>0&&h)throw H.result=!1,H.resultCode=41,H.resultMessage='Failed to meet "permitted sub-trees" name constraint',H}let c=!1;for(let o=0;o<A.length;o++){switch(A[o].base.type){case 1:if(a.length>=0)for(let e=0;e<a.length;e++)1===a[e].type&&(c=c||r(a[e].value,A[o].base.value));else for(let t=0;t<this.certs[e].subject.typesAndValues.length;t++)"1.2.840.113549.1.9.1"!==this.certs[e].subject.typesAndValues[t].type&&"0.9.2342.19200300.100.1.3"!==this.certs[e].subject.typesAndValues[t].type||(c=c||r(this.certs[e].subject.typesAndValues[t].value.valueBlock.value,A[o].base.value));break;case 2:if(a.length>0)for(let e=0;e<a.length;e++)2===a[e].type&&(c=c||t(a[e].value,A[o].base.value));break;case 4:c=c||s(this.certs[e].subject,A[o].base.value);break;case 6:if(a.length>0)for(let e=0;e<a.length;e++)6===a[e].type&&(c=c||n(a[e].value,A[o].base.value));break;case 7:if(a.length>0)for(let e=0;e<a.length;e++)7===a[e].type&&(c=c||i(a[e].value,A[o].base.value))}if(c)break}if(!0===c)throw H.result=!1,H.resultCode=42,H.resultMessage='Failed to meet "excluded sub-trees" name constraint',H;S=S.concat(o),A=A.concat(u)}return H}catch(e){if(e instanceof Object){if("resultMessage"in e)return e;if("message"in e)return{result:!1,resultCode:-1,resultMessage:e.message}}return{result:!1,resultCode:-1,resultMessage:e}}}}function or(e){if("string"!=typeof e)throw new Error("Expected PEM as string");const t=et(function(e){var t,r,n,i,s,a=.75*e.length,o=e.length,u=0;"="===e[e.length-1]&&(a--,"="===e[e.length-2]&&a--);var h=new ArrayBuffer(a),l=new Uint8Array(h);for(t=0;t<o;t+=4)r=k[e.charCodeAt(t)],n=k[e.charCodeAt(t+1)],i=k[e.charCodeAt(t+2)],s=k[e.charCodeAt(t+3)],l[u++]=r<<2|n>>4,l[u++]=(15&n)<<4|i>>2,l[u++]=(3&i)<<6|63&s;return h}(e.replace(/(-----(BEGIN|END) CERTIFICATE-----|[\n\r\s])/g,"")));return new sr({schema:t.result})}const ur={},hr={trustedCerts:[or("-----BEGIN CERTIFICATE-----\nMIIFBzCCAu+gAwIBAgIEHM6S6zANBgkqhkiG9w0BAQsFADAhMR8wHQYDVQQDDBZZ\ndWJpY28gWXViaUhTTSBSb290IENBMCAXDTE3MDEwMTAwMDAwMFoYDzIwNzExMDA1\nMDAwMDAwWjAhMR8wHQYDVQQDDBZZdWJpY28gWXViaUhTTSBSb290IENBMIICIjAN\nBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEA4WqC8Krz1pXqgD4Bj3g/dosh/soy\ndDCbNQ1uePeONXO5u4Kswi+jXPmcU9uqxIrNC6+t7Mwc+yyBAZBvIl6w+h5qwT7z\nE7VTjeWBTP/4w0NXzgkPZgXWl6XIZNCJQfSSUxfh/NW7KCQySpDUGkR8hFHYwZTI\nUD90/chv7lc1zcpaIgJDQ7m3IbPKKbaRrrc7ZUSB1cCFM7P6ESuJiTMKITNTMyW2\nqoa8YTaAxHXIiiqmnff2ObtsPKtjfh8aHDdBdpZ8TqBCu8ht+3tpZpe2lnfqJBUG\nN9wqIp+h1JLaKXN4NTr+VlUNEEGwMEJNKMtt3p1qxHmyHV4vSd5mOT4SY81MNL0C\nv3HAHgR1lT7o8rMDTjB1PZP9v8Np2rpuvlog34eMsIBApP78zSjQrImQiHAYcADc\nRZX6nSTOFyNdfjWtKxybdiFZpTpuLtGPwF7i3ISYQXambmaEqw83jCqIMMF4jFMk\nKjA8UZnJRW+53pM5Gy6hQzhlJpwhE9d/L87VeR2ei0sidO1rDB9pQOdy9z41EBw4\npH5Aa99CPcOn16Eg4TS5838as2pG3xFgWBiVxipMW72pejBD5G5kk/hpbOW5QO6v\naXBLmngq4o3IySmM9J9IPRXuZrhmu2uafIvp3o67/lUcuqGEnxjG+Sj5q51g12E6\nsVXauoxqhGOhllcCAwEAAaNFMEMwHQYDVR0OBBYEFFKoA9OFueJx/kakn9SHmy3/\nyIycMBIGA1UdEwEB/wQIMAYBAf8CAQIwDgYDVR0PAQH/BAQDAgEGMA0GCSqGSIb3\nDQEBCwUAA4ICAQBRyFzKyZYRnr8lWRHI8asrOMm7HMETWE4HziCYlrZkZNp2EVdy\nZFgzJqIwXI9hrYp1CWnow86rUhFjAdgGhhG/wEvyX97G0xPsNS3x77uF4RpNe7ry\n44PcwXJWqo8JhdNCbSAVR+Tqm/k/WF7A+qflevS4K4G7ADlm0W41FBpehYMynC/G\n3ykOtBTfLkOfeoJbTlhhwe7z3Oq9V7O+whTgUoeCKYW14d9xnmVM1uJvHcGl+fO3\n9kgYfTsNwdJFVy/9Xq4b3QXpQSQ71JhL58JIpnkLqd5Utf4K1jAFu/bQQMWpdghw\nS8D9kfnV/tpJ6lXtxMrjVtF0BO1EPvNv+nWeRog794KkID+KGIL+eF7lDpYe8rrV\naqB1wZJ9mPeqJBtD5T8E5FhuOzBBeM3sVh0d8OVh8P0QLhBVYAU23S99PRkb3hgx\ngQ7gK8wdMaCekYG1Dw6i7TMVhDQd/ZRuo6vmyhtDrzVLc5eTwHpzba+OyDza/24s\nkakyoyKReuLlpMby4WhuhTzptROImNmQpeSfEM6w2aJpsIO8BFVBkZSJCtHEfBgO\n/QLNr17cvMmOIwFLAeHiWlgSWTrHOD/8O95d5iXrtXzOf2iPGA26JczJSeLjvnAA\ntHEbofSLGYZdgbQ8mQpXzkBsuvX/wpDiDvB4mIfjDWQv9hgo0edbkRUhEA==\n-----END CERTIFICATE-----")],certs:[or("-----BEGIN CERTIFICATE-----\nMIIELjCCAhagAwIBAgIDZuAUMA0GCSqGSIb3DQEBCwUAMCExHzAdBgNVBAMMFll1\nYmljbyBZdWJpSFNNIFJvb3QgQ0EwIBcNMTcwMTAxMDAwMDAwWhgPMjA3MTEwMDUw\nMDAwMDBaMCgxJjAkBgNVBAMMHVl1YmljbyBZdWJpSFNNIDY3NDIwMzYgU3ViLUNB\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAx3CHbP9E0idgDVwT9Kgu\nnNPi3sFdcRAIKeQvLeGIP76AK/e80PYpRS/ZGw0s8qvpR669g0akz3xOVJj61q5c\nOl48OnEtIi/sukcZpUNOnNe4JKQlJmHFBXUtFg497T+YWqYY0ZEJeXhpzl0CZzEN\nvQIoRn7dWI4+8iZ3LLUkZ0jQAR486HERw5+wcZi9jZd/16ZrWpEMu5WNpR2OzjPM\neoaPh6st7wvmEJSjUttPM1tagX2fgbz9hi86LMHeXUVFYij+yd1gLTVxJV+DQ1dU\n1n+XpZoge84RBFVYCcK9qgyUjPJWQzKggu02Bg0UIAzL03dmYYHyii3XnuicNJI9\nhwIDAQABo2YwZDAdBgNVHQ4EFgQU5F2l82GwkbMNjyxvoEDbb+9XkY4wHwYDVR0j\nBBgwFoAUUqgD04W54nH+RqSf1IebLf/IjJwwEgYDVR0TAQH/BAgwBgEB/wIBATAO\nBgNVHQ8BAf8EBAMCAQYwDQYJKoZIhvcNAQELBQADggIBALX6NZ/qgB4zRxFFAEw0\nZDAX5BwcW1SN9q4mGWCeSMtPW5LT3ST20DPLKHrg1C+8a5ZX77EDYefEKT6TqbXG\nKFgWCAzCdhSz4YJIaq8/XCTaM5O15l6byrV0UC4KboM4fLIve5fVRS3Nn3pf2lD3\n7czTFjqnyZ+iM6i/OxpIJaULPO8yFG2nY2ZLdVDLB8AmF3E+W1nlyn9mpcXuSTRc\nRSMtcQ6V5fV9UTnPriX2Lu2DkcK//xEhz4u6oisE94RNtIrtG3OJKMgCHDw4RzI0\nTl5yLLjqS9tHlIg39EfDZR0aglpBHA8NVjbbPFS2LWASpcdt029poAPLHOjtsmkf\nPiqhni0RyndtjmrVS+l4tvXNRFwBRjJHHBNwNbIZrLvQG4jzOQmn//1OWOHl4q97\n+MX6hy4c1Tri0rpRw4XmvusrO5lO6SQsvrSM8MqcwxDwPxhjipOMTNsYFYWBVRIr\nH60yxz7w25coT6Rs3Pl6674JBUtv4tDCxSTiCG8KlvquovJJnUf3MIY5STtjXr1/\njuA5/QnjReLuF/iOG6Gsy4U1Qn3q9BO8hlXWylb7RY96L7Iz3rto4pFmZCONousS\nD1mJ+5XBTWEUZlp4as54oJhxF88/4kusPZ9ozMteMeax61BKyQBL7RaEl1KV7snX\nItgTwk7SgyLM0cZufUi0Rh/s\n-----END CERTIFICATE-----")]},lr={},cr={},fr=p.create({baseURL:"https://random.colorado.edu/api/",timeout:1e4,headers:{Accept:"application/vnd.curby.v1+json"}});function gr(e){"http"!==e.substr(0,4)&&(e="https://"+e),fr.defaults.baseURL=`${e}/api/`}function dr(e){switch(e.content.cypher_suite){case 0:return(()=>{const e=new v.Aj(512);return(t,r,n)=>(e.reset(),e.update(t,r),e.digest(n||r))})();default:throw new Error(`Cypher suite ${e.content.cypher_suite} not implemented`)}}function pr(e){return m(e.content)}function mr(e,t){const r=u(a(t.content.local_random_value),a(e.value)),n=dr(e)(Buffer.from(r.buffer),null,"hex");if(!(e.content.precommitment_value===n))throw new x("Invalid Precommitment Value");return!0}function yr(e,t){if(0!==e.content.pulse_index&&E(e,1))throw new w("Pulse has unmatched precommitment value");const r=pr(e);let n=!1;if(r in ur)n=e.signature===ur[r];else{const i=function(e){switch(e.content.cypher_suite){case 0:return"SHA256withECDSA";default:throw new Error(`Cypher suite ${e.content.cypher_suite} not implemented`)}}(e),s=new y.fs.crypto.Signature({alg:i});s.init(t),s.updateString(r),n=s.verify(e.signature)}if(!n)throw new b("Invalid pulse signature!");ur[r]=e.signature;if(dr(e)(e.signature,"hex")!==e.value)throw new w("Pulse value does not match hash of signature!");return!0}function vr(e){(e=e.slice(0)).sort(((e,t)=>e.content.pulse_index-t.content.pulse_index));return i(e,e.slice(1)).every((([e,t])=>{const r=t.content.skip_anchors.some((t=>t.value===e.value));if(!r)throw new A(`Provided chain is broken between pulse ${e.content.pulse_index} and ${t.content.pulse_index}`);return r}))}function br(e,t={latest:!0}){if(E(e,2)&&0!==e.content.pulse_index)throw new S("Pulse Status signifying TimeGap");if(t.latest){if(Hr(e)>0)return e;throw new S("Unexpected Pulse Timing")}if(t.after){const r=new Date(t.after).getTime();if(new Date(e.content.time_stamp).getTime()-r<=e.content.period)return e;throw new S("Unexpected Pulse Timing")}if(t.at){const r=new Date(t.at).getTime();if(new Date(e.content.time_stamp).getTime()-r<e.content.period)return e;throw new S("Unexpected Pulse Timing")}if(t.before){if(new Date(t.before).getTime()-new Date(e.content.time_stamp).getTime()<e.content.period)return e;throw new S("Unexpected Pulse Timing")}throw new Error("Invalid rule specified")}async function wr(e,t=!0){if(e in lr)return e;t&&await async function(){const e=await xr();return Promise.all(e.hsm_attestation_cert_ids.map((e=>fr(`/certificate/${e}`,{responseType:"text"}).then((e=>e.data)).then((e=>wr(e,!1))))))}();const r=or(e);return await function({trustedCerts:e=[],certs:t=[]}){return new ar({trustedCerts:e,certs:t}).verify()}({trustedCerts:hr.trustedCerts,certs:hr.certs.concat(Object.values(lr))}),lr[e]=r,e}async function Sr(e){const t=e.content.certificate_id;let r=cr[t];return r||(r=await Er(t),cr[t]=r),yr(e,r),e}async function Ar(e){const t=e.data;return await Sr(t),t}function xr(){return fr("/").then((e=>e.data))}function Er(e){return fr(`/certificate/${e}`,{responseType:"text"}).then((e=>e.data)).then((e=>wr(e)))}function Br(e,t){return fr(`/chain/${e}/pulse/${t}`).then(Ar)}function kr(){return fr("/latest").then(Ar).then((e=>br(e)))}function Cr(e){const t=s(e);return fr(`/at/${t}`).then(Ar).then((t=>br(t,{at:e})))}function Ir(e){const t=s(e);return fr(`/after/${t}`).then(Ar).then((t=>br(t,{after:e})))}function Fr(e){const t=s(e);return fr(`/before/${t}`).then(Ar).then((t=>br(t,{before:e})))}function Pr(e,t,r){return fr(`/chain/${e}/subchain/${t}/${r}`).then((e=>e.data)).then((e=>(e.pulses.forEach(Sr),vr(e.pulses),e)))}function Nr(e,t,r){return fr(`/chain/${e}/skiplist/${t}/${r}`).then((e=>e.data)).then((e=>(e.pulses.forEach(Sr),vr(e.pulses),e)))}function Dr(e){const t=new Date(e.content.time_stamp);return t.setTime(t.getTime()+e.content.period),t}function Hr(e){return Dr(e).getTime()-(new Date).getTime()}var Rr=r(797);class Or{static from(e){return"object"==typeof e?Or.from(e.value):new Or(o(e))}constructor(e){if(!(e instanceof ArrayBuffer))throw new Error("Value passed to constructor is not an ArrayBuffer");this.buffer=e,this._shuffleSeed=null}get shuffleSeed(){return this._shuffleSeed||(this._shuffleSeed=c(this.stream())),this._shuffleSeed}get maxShuffleLength(){return this.shuffleSeed.length+1}dataView(e,t){return new DataView(this.buffer,e,t)}stream(){return new Rr.BitStream(this.buffer)}view(){return new Rr.BitView(this.buffer)}shuffled(e){return d(e,this.shuffleSeed)}applyShuffle(e){g(e,this.shuffleSeed)}unfold(e,t=Array){const r=this.stream();return t.from(h((t=>e(r,t))))}}}(),n}()}));
//# sourceMappingURL=curbyjs.js.map